HloModule jit_compiled_generate_function, entry_computation_layout={(pred[1,31]{1,0}, s32[1,31]{1,0}, f32[256000,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=5*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=10*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=15*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=20*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=25*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=30*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=35*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=40*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=45*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=50*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=55*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=60*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=65*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=70*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=75*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=80*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=85*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=90*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=95*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=100*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=105*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=110*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=115*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=120*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=125*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=130*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=135*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=140*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=145*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=150*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=155*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=160*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=165*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=170*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=175*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=180*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=185*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=190*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=195*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=200*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=205*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=210*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=215*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=220*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=225*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=230*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=235*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=240*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=245*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=250*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=255*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=260*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=265*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=270*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=275*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=280*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=285*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0})->(pred[1,31]{1,0}, s32[1,31]{1,0})}, allow_spmd_sharding_propagation_to_parameters={true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true}, allow_spmd_sharding_propagation_to_output={true,true}

_where.343 {
  Arg_0.344 = pred[1,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/token_embedding/jit(_take)/pjit"}
  Arg_1.345 = s32[1,31]{1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/token_embedding/jit(_take)/pjit"}
  Arg_2.346 = s32[1,31]{1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/token_embedding/jit(_take)/pjit"}
  ROOT select.347 = s32[1,31]{1,0} select(Arg_0.344, Arg_1.345, Arg_2.346), metadata={op_name="jit(compiled_generate_function)/jit(main)/token_embedding/jit(_take)/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
}

region_0.348 {
  Arg_0.349 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/token_embedding/jit(_take)/reduce_and"}
  Arg_1.350 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/token_embedding/jit(_take)/reduce_and"}
  ROOT and.351 = pred[] and(Arg_0.349, Arg_1.350), metadata={op_name="jit(compiled_generate_function)/jit(main)/token_embedding/jit(_take)/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
}

_take.352 {
  Arg_1.354 = s32[1,31]{1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/token_embedding/pjit"}
  constant.364 = s32[] constant(0)
  broadcast.365 = s32[1,31]{1,0} broadcast(constant.364), dimensions={}
  compare.366 = pred[1,31]{1,0} compare(Arg_1.354, broadcast.365), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/token_embedding/jit(_take)/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
  constant.361 = s32[] constant(256000)
  broadcast.362 = s32[1,31]{1,0} broadcast(constant.361), dimensions={}
  add.367 = s32[1,31]{1,0} add(Arg_1.354, broadcast.362), metadata={op_name="jit(compiled_generate_function)/jit(main)/token_embedding/jit(_take)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
  call.368 = s32[1,31]{1,0} call(compare.366, add.367, Arg_1.354), to_apply=_where.343
  reshape.369 = s32[1,31,1]{2,1,0} reshape(call.368), metadata={op_name="jit(compiled_generate_function)/jit(main)/token_embedding/jit(_take)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
  constant.359 = s32[] constant(0)
  broadcast.360 = s32[1,31,1]{2,1,0} broadcast(constant.359), dimensions={}
  compare.370 = pred[1,31,1]{2,1,0} compare(reshape.369, broadcast.360), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/token_embedding/jit(_take)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
  constant.357 = s32[] constant(255999)
  broadcast.358 = s32[1,31,1]{2,1,0} broadcast(constant.357), dimensions={}
  compare.371 = pred[1,31,1]{2,1,0} compare(reshape.369, broadcast.358), direction=LE, metadata={op_name="jit(compiled_generate_function)/jit(main)/token_embedding/jit(_take)/le" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
  and.372 = pred[1,31,1]{2,1,0} and(compare.370, compare.371), metadata={op_name="jit(compiled_generate_function)/jit(main)/token_embedding/jit(_take)/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
  constant.363 = pred[] constant(true)
  reduce.373 = pred[1,31]{1,0} reduce(and.372, constant.363), dimensions={2}, to_apply=region_0.348, metadata={op_name="jit(compiled_generate_function)/jit(main)/token_embedding/jit(_take)/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
  broadcast.375 = pred[1,31,2304]{2,1,0} broadcast(reduce.373), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/token_embedding/jit(_take)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
  Arg_0.353 = f32[256000,2304]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/token_embedding/pjit"}
  gather.374 = f32[1,31,2304]{2,1,0} gather(Arg_0.353, reshape.369), offset_dims={2}, collapsed_slice_dims={0}, start_index_map={0}, index_vector_dim=2, slice_sizes={1,2304}, metadata={op_name="jit(compiled_generate_function)/jit(main)/token_embedding/jit(_take)/gather" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
  constant.355 = f32[] constant(nan)
  broadcast.356 = f32[1,31,2304]{2,1,0} broadcast(constant.355), dimensions={}
  ROOT select.376 = f32[1,31,2304]{2,1,0} select(broadcast.375, gather.374, broadcast.356), metadata={op_name="jit(compiled_generate_function)/jit(main)/token_embedding/jit(_take)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
} // _take.352

region_1.380 {
  Arg_0.381 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/reduce_sum"}
  Arg_1.382 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/reduce_sum"}
  ROOT add.383 = f32[] add(Arg_0.381, Arg_1.382), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu.483 {
  iota.489 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.490 = s32[31,31]{1,0} broadcast(iota.489), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.487 = s32[] constant(-4096)
  broadcast.488 = s32[31,31]{1,0} broadcast(constant.487), dimensions={}
  add.491 = s32[31,31]{1,0} add(broadcast.490, broadcast.488), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.492 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.493 = s32[31,31]{1,0} broadcast(iota.492), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.494 = pred[31,31]{1,0} compare(add.491, broadcast.493), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.485 = pred[] constant(false)
  broadcast.486 = pred[31,31]{1,0} broadcast(constant.485), dimensions={}
  Arg_0.484 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.495 = pred[31,31]{1,0} select(compare.494, broadcast.486, Arg_0.484), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu.483

tril.497 {
  iota.503 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.504 = s32[31,31]{1,0} broadcast(iota.503), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.501 = s32[] constant(4095)
  broadcast.502 = s32[31,31]{1,0} broadcast(constant.501), dimensions={}
  add.505 = s32[31,31]{1,0} add(broadcast.504, broadcast.502), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.506 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.507 = s32[31,31]{1,0} broadcast(iota.506), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.508 = pred[31,31]{1,0} compare(add.505, broadcast.507), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.498 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  constant.499 = pred[] constant(false)
  broadcast.500 = pred[31,31]{1,0} broadcast(constant.499), dimensions={}
  ROOT select.509 = pred[31,31]{1,0} select(compare.508, Arg_0.498, broadcast.500), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril.497

region_2.522 {
  Arg_0.523 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/reduce_max"}
  Arg_1.524 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/reduce_max"}
  ROOT maximum.525 = f32[] maximum(Arg_0.523, Arg_1.524), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_3.534 {
  Arg_0.535 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/reduce_sum"}
  Arg_1.536 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/reduce_sum"}
  ROOT add.537 = f32[] add(Arg_0.535, Arg_1.536), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_4.549 {
  Arg_0.550 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/reduce_and"}
  Arg_1.551 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/reduce_and"}
  ROOT and.552 = pred[] and(Arg_0.550, Arg_1.551), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.555 {
  Arg_0.556 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.559 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.556), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.560 = pred[1,31]{1,0} reshape(broadcast.559), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.561 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.560), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.557 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.558 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.562 = f32[1,31,8,256]{3,2,1,0} select(broadcast.561, Arg_1.557, Arg_2.558), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.555

region_5.566 {
  Arg_0.567 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/reduce_sum"}
  Arg_1.568 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/reduce_sum"}
  ROOT add.569 = f32[] add(Arg_0.567, Arg_1.568), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_6.588 {
  Arg_0.589 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/reduce_sum"}
  Arg_1.590 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/reduce_sum"}
  ROOT add.591 = f32[] add(Arg_0.589, Arg_1.590), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_7.622 {
  Arg_0.623 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/reduce_sum"}
  Arg_1.624 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/reduce_sum"}
  ROOT add.625 = f32[] add(Arg_0.623, Arg_1.624), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_8.644 {
  Arg_0.645 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/reduce_sum"}
  Arg_1.646 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/reduce_sum"}
  ROOT add.647 = f32[] add(Arg_0.645, Arg_1.646), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_9.755 {
  Arg_0.756 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/reduce_max"}
  Arg_1.757 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/reduce_max"}
  ROOT maximum.758 = f32[] maximum(Arg_0.756, Arg_1.757), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_10.767 {
  Arg_0.768 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/reduce_sum"}
  Arg_1.769 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/reduce_sum"}
  ROOT add.770 = f32[] add(Arg_0.768, Arg_1.769), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_11.782 {
  Arg_0.783 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/reduce_and"}
  Arg_1.784 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/reduce_and"}
  ROOT and.785 = pred[] and(Arg_0.783, Arg_1.784), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.788 {
  Arg_0.789 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.792 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.789), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.793 = pred[1,31]{1,0} reshape(broadcast.792), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.794 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.793), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.790 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.791 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.795 = f32[1,31,8,256]{3,2,1,0} select(broadcast.794, Arg_1.790, Arg_2.791), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.788

region_12.799 {
  Arg_0.800 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/reduce_sum"}
  Arg_1.801 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/reduce_sum"}
  ROOT add.802 = f32[] add(Arg_0.800, Arg_1.801), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_13.821 {
  Arg_0.822 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/reduce_sum"}
  Arg_1.823 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/reduce_sum"}
  ROOT add.824 = f32[] add(Arg_0.822, Arg_1.823), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_14.855 {
  Arg_0.856 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/reduce_sum"}
  Arg_1.857 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/reduce_sum"}
  ROOT add.858 = f32[] add(Arg_0.856, Arg_1.857), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_15.877 {
  Arg_0.878 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/reduce_sum"}
  Arg_1.879 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/reduce_sum"}
  ROOT add.880 = f32[] add(Arg_0.878, Arg_1.879), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu.980 {
  iota.986 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.987 = s32[31,31]{1,0} broadcast(iota.986), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.984 = s32[] constant(-4096)
  broadcast.985 = s32[31,31]{1,0} broadcast(constant.984), dimensions={}
  add.988 = s32[31,31]{1,0} add(broadcast.987, broadcast.985), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.989 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.990 = s32[31,31]{1,0} broadcast(iota.989), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.991 = pred[31,31]{1,0} compare(add.988, broadcast.990), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.982 = pred[] constant(false)
  broadcast.983 = pred[31,31]{1,0} broadcast(constant.982), dimensions={}
  Arg_0.981 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.992 = pred[31,31]{1,0} select(compare.991, broadcast.983, Arg_0.981), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu.980

tril.994 {
  iota.1000 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.1001 = s32[31,31]{1,0} broadcast(iota.1000), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.998 = s32[] constant(4095)
  broadcast.999 = s32[31,31]{1,0} broadcast(constant.998), dimensions={}
  add.1002 = s32[31,31]{1,0} add(broadcast.1001, broadcast.999), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.1003 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.1004 = s32[31,31]{1,0} broadcast(iota.1003), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.1005 = pred[31,31]{1,0} compare(add.1002, broadcast.1004), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.995 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  constant.996 = pred[] constant(false)
  broadcast.997 = pred[31,31]{1,0} broadcast(constant.996), dimensions={}
  ROOT select.1006 = pred[31,31]{1,0} select(compare.1005, Arg_0.995, broadcast.997), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril.994

region_16.1019 {
  Arg_0.1020 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/reduce_max"}
  Arg_1.1021 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/reduce_max"}
  ROOT maximum.1022 = f32[] maximum(Arg_0.1020, Arg_1.1021), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_17.1031 {
  Arg_0.1032 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/reduce_sum"}
  Arg_1.1033 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/reduce_sum"}
  ROOT add.1034 = f32[] add(Arg_0.1032, Arg_1.1033), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_18.1046 {
  Arg_0.1047 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/reduce_and"}
  Arg_1.1048 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/reduce_and"}
  ROOT and.1049 = pred[] and(Arg_0.1047, Arg_1.1048), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.1052 {
  Arg_0.1053 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.1056 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.1053), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.1057 = pred[1,31]{1,0} reshape(broadcast.1056), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.1058 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.1057), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.1054 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.1055 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.1059 = f32[1,31,8,256]{3,2,1,0} select(broadcast.1058, Arg_1.1054, Arg_2.1055), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.1052

region_19.1063 {
  Arg_0.1064 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/reduce_sum"}
  Arg_1.1065 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/reduce_sum"}
  ROOT add.1066 = f32[] add(Arg_0.1064, Arg_1.1065), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_20.1085 {
  Arg_0.1086 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/reduce_sum"}
  Arg_1.1087 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/reduce_sum"}
  ROOT add.1088 = f32[] add(Arg_0.1086, Arg_1.1087), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_21.1119 {
  Arg_0.1120 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/reduce_sum"}
  Arg_1.1121 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/reduce_sum"}
  ROOT add.1122 = f32[] add(Arg_0.1120, Arg_1.1121), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_22.1141 {
  Arg_0.1142 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/reduce_sum"}
  Arg_1.1143 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/reduce_sum"}
  ROOT add.1144 = f32[] add(Arg_0.1142, Arg_1.1143), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_23.1252 {
  Arg_0.1253 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/reduce_max"}
  Arg_1.1254 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/reduce_max"}
  ROOT maximum.1255 = f32[] maximum(Arg_0.1253, Arg_1.1254), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_24.1264 {
  Arg_0.1265 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/reduce_sum"}
  Arg_1.1266 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/reduce_sum"}
  ROOT add.1267 = f32[] add(Arg_0.1265, Arg_1.1266), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_25.1279 {
  Arg_0.1280 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/reduce_and"}
  Arg_1.1281 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/reduce_and"}
  ROOT and.1282 = pred[] and(Arg_0.1280, Arg_1.1281), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.1285 {
  Arg_0.1286 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.1289 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.1286), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.1290 = pred[1,31]{1,0} reshape(broadcast.1289), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.1291 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.1290), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.1287 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.1288 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.1292 = f32[1,31,8,256]{3,2,1,0} select(broadcast.1291, Arg_1.1287, Arg_2.1288), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.1285

region_26.1296 {
  Arg_0.1297 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/reduce_sum"}
  Arg_1.1298 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/reduce_sum"}
  ROOT add.1299 = f32[] add(Arg_0.1297, Arg_1.1298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_27.1318 {
  Arg_0.1319 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/reduce_sum"}
  Arg_1.1320 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/reduce_sum"}
  ROOT add.1321 = f32[] add(Arg_0.1319, Arg_1.1320), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_28.1352 {
  Arg_0.1353 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/reduce_sum"}
  Arg_1.1354 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/reduce_sum"}
  ROOT add.1355 = f32[] add(Arg_0.1353, Arg_1.1354), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_29.1374 {
  Arg_0.1375 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/reduce_sum"}
  Arg_1.1376 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/reduce_sum"}
  ROOT add.1377 = f32[] add(Arg_0.1375, Arg_1.1376), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu.1477 {
  iota.1483 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.1484 = s32[31,31]{1,0} broadcast(iota.1483), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.1481 = s32[] constant(-4096)
  broadcast.1482 = s32[31,31]{1,0} broadcast(constant.1481), dimensions={}
  add.1485 = s32[31,31]{1,0} add(broadcast.1484, broadcast.1482), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.1486 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.1487 = s32[31,31]{1,0} broadcast(iota.1486), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.1488 = pred[31,31]{1,0} compare(add.1485, broadcast.1487), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.1479 = pred[] constant(false)
  broadcast.1480 = pred[31,31]{1,0} broadcast(constant.1479), dimensions={}
  Arg_0.1478 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.1489 = pred[31,31]{1,0} select(compare.1488, broadcast.1480, Arg_0.1478), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu.1477

tril.1491 {
  iota.1497 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.1498 = s32[31,31]{1,0} broadcast(iota.1497), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.1495 = s32[] constant(4095)
  broadcast.1496 = s32[31,31]{1,0} broadcast(constant.1495), dimensions={}
  add.1499 = s32[31,31]{1,0} add(broadcast.1498, broadcast.1496), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.1500 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.1501 = s32[31,31]{1,0} broadcast(iota.1500), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.1502 = pred[31,31]{1,0} compare(add.1499, broadcast.1501), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.1492 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  constant.1493 = pred[] constant(false)
  broadcast.1494 = pred[31,31]{1,0} broadcast(constant.1493), dimensions={}
  ROOT select.1503 = pred[31,31]{1,0} select(compare.1502, Arg_0.1492, broadcast.1494), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril.1491

region_30.1516 {
  Arg_0.1517 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/reduce_max"}
  Arg_1.1518 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/reduce_max"}
  ROOT maximum.1519 = f32[] maximum(Arg_0.1517, Arg_1.1518), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_31.1528 {
  Arg_0.1529 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/reduce_sum"}
  Arg_1.1530 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/reduce_sum"}
  ROOT add.1531 = f32[] add(Arg_0.1529, Arg_1.1530), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_32.1543 {
  Arg_0.1544 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/reduce_and"}
  Arg_1.1545 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/reduce_and"}
  ROOT and.1546 = pred[] and(Arg_0.1544, Arg_1.1545), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.1549 {
  Arg_0.1550 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.1553 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.1550), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.1554 = pred[1,31]{1,0} reshape(broadcast.1553), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.1555 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.1554), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.1551 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.1552 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.1556 = f32[1,31,8,256]{3,2,1,0} select(broadcast.1555, Arg_1.1551, Arg_2.1552), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.1549

region_33.1560 {
  Arg_0.1561 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/reduce_sum"}
  Arg_1.1562 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/reduce_sum"}
  ROOT add.1563 = f32[] add(Arg_0.1561, Arg_1.1562), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_34.1582 {
  Arg_0.1583 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/reduce_sum"}
  Arg_1.1584 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/reduce_sum"}
  ROOT add.1585 = f32[] add(Arg_0.1583, Arg_1.1584), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_35.1616 {
  Arg_0.1617 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/reduce_sum"}
  Arg_1.1618 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/reduce_sum"}
  ROOT add.1619 = f32[] add(Arg_0.1617, Arg_1.1618), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_36.1638 {
  Arg_0.1639 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/reduce_sum"}
  Arg_1.1640 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/reduce_sum"}
  ROOT add.1641 = f32[] add(Arg_0.1639, Arg_1.1640), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_37.1749 {
  Arg_0.1750 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/reduce_max"}
  Arg_1.1751 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/reduce_max"}
  ROOT maximum.1752 = f32[] maximum(Arg_0.1750, Arg_1.1751), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_38.1761 {
  Arg_0.1762 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/reduce_sum"}
  Arg_1.1763 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/reduce_sum"}
  ROOT add.1764 = f32[] add(Arg_0.1762, Arg_1.1763), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_39.1776 {
  Arg_0.1777 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/reduce_and"}
  Arg_1.1778 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/reduce_and"}
  ROOT and.1779 = pred[] and(Arg_0.1777, Arg_1.1778), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.1782 {
  Arg_0.1783 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.1786 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.1783), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.1787 = pred[1,31]{1,0} reshape(broadcast.1786), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.1788 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.1787), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.1784 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.1785 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.1789 = f32[1,31,8,256]{3,2,1,0} select(broadcast.1788, Arg_1.1784, Arg_2.1785), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.1782

region_40.1793 {
  Arg_0.1794 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/reduce_sum"}
  Arg_1.1795 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/reduce_sum"}
  ROOT add.1796 = f32[] add(Arg_0.1794, Arg_1.1795), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_41.1815 {
  Arg_0.1816 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/reduce_sum"}
  Arg_1.1817 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/reduce_sum"}
  ROOT add.1818 = f32[] add(Arg_0.1816, Arg_1.1817), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_42.1849 {
  Arg_0.1850 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/reduce_sum"}
  Arg_1.1851 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/reduce_sum"}
  ROOT add.1852 = f32[] add(Arg_0.1850, Arg_1.1851), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_43.1871 {
  Arg_0.1872 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/reduce_sum"}
  Arg_1.1873 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/reduce_sum"}
  ROOT add.1874 = f32[] add(Arg_0.1872, Arg_1.1873), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu.1974 {
  iota.1980 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.1981 = s32[31,31]{1,0} broadcast(iota.1980), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.1978 = s32[] constant(-4096)
  broadcast.1979 = s32[31,31]{1,0} broadcast(constant.1978), dimensions={}
  add.1982 = s32[31,31]{1,0} add(broadcast.1981, broadcast.1979), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.1983 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.1984 = s32[31,31]{1,0} broadcast(iota.1983), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.1985 = pred[31,31]{1,0} compare(add.1982, broadcast.1984), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.1976 = pred[] constant(false)
  broadcast.1977 = pred[31,31]{1,0} broadcast(constant.1976), dimensions={}
  Arg_0.1975 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.1986 = pred[31,31]{1,0} select(compare.1985, broadcast.1977, Arg_0.1975), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu.1974

tril.1988 {
  iota.1994 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.1995 = s32[31,31]{1,0} broadcast(iota.1994), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.1992 = s32[] constant(4095)
  broadcast.1993 = s32[31,31]{1,0} broadcast(constant.1992), dimensions={}
  add.1996 = s32[31,31]{1,0} add(broadcast.1995, broadcast.1993), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.1997 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.1998 = s32[31,31]{1,0} broadcast(iota.1997), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.1999 = pred[31,31]{1,0} compare(add.1996, broadcast.1998), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.1989 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  constant.1990 = pred[] constant(false)
  broadcast.1991 = pred[31,31]{1,0} broadcast(constant.1990), dimensions={}
  ROOT select.2000 = pred[31,31]{1,0} select(compare.1999, Arg_0.1989, broadcast.1991), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril.1988

region_44.2013 {
  Arg_0.2014 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/reduce_max"}
  Arg_1.2015 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/reduce_max"}
  ROOT maximum.2016 = f32[] maximum(Arg_0.2014, Arg_1.2015), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_45.2025 {
  Arg_0.2026 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/reduce_sum"}
  Arg_1.2027 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/reduce_sum"}
  ROOT add.2028 = f32[] add(Arg_0.2026, Arg_1.2027), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_46.2040 {
  Arg_0.2041 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/reduce_and"}
  Arg_1.2042 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/reduce_and"}
  ROOT and.2043 = pred[] and(Arg_0.2041, Arg_1.2042), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.2046 {
  Arg_0.2047 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.2050 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.2047), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.2051 = pred[1,31]{1,0} reshape(broadcast.2050), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.2052 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.2051), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.2048 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.2049 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.2053 = f32[1,31,8,256]{3,2,1,0} select(broadcast.2052, Arg_1.2048, Arg_2.2049), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.2046

region_47.2057 {
  Arg_0.2058 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/reduce_sum"}
  Arg_1.2059 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/reduce_sum"}
  ROOT add.2060 = f32[] add(Arg_0.2058, Arg_1.2059), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_48.2079 {
  Arg_0.2080 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/reduce_sum"}
  Arg_1.2081 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/reduce_sum"}
  ROOT add.2082 = f32[] add(Arg_0.2080, Arg_1.2081), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_49.2113 {
  Arg_0.2114 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/reduce_sum"}
  Arg_1.2115 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/reduce_sum"}
  ROOT add.2116 = f32[] add(Arg_0.2114, Arg_1.2115), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_50.2135 {
  Arg_0.2136 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/reduce_sum"}
  Arg_1.2137 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/reduce_sum"}
  ROOT add.2138 = f32[] add(Arg_0.2136, Arg_1.2137), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_51.2246 {
  Arg_0.2247 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/reduce_max"}
  Arg_1.2248 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/reduce_max"}
  ROOT maximum.2249 = f32[] maximum(Arg_0.2247, Arg_1.2248), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_52.2258 {
  Arg_0.2259 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/reduce_sum"}
  Arg_1.2260 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/reduce_sum"}
  ROOT add.2261 = f32[] add(Arg_0.2259, Arg_1.2260), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_53.2273 {
  Arg_0.2274 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/reduce_and"}
  Arg_1.2275 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/reduce_and"}
  ROOT and.2276 = pred[] and(Arg_0.2274, Arg_1.2275), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.2279 {
  Arg_0.2280 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.2283 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.2280), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.2284 = pred[1,31]{1,0} reshape(broadcast.2283), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.2285 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.2284), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.2281 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.2282 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.2286 = f32[1,31,8,256]{3,2,1,0} select(broadcast.2285, Arg_1.2281, Arg_2.2282), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.2279

region_54.2290 {
  Arg_0.2291 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/reduce_sum"}
  Arg_1.2292 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/reduce_sum"}
  ROOT add.2293 = f32[] add(Arg_0.2291, Arg_1.2292), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_55.2312 {
  Arg_0.2313 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/reduce_sum"}
  Arg_1.2314 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/reduce_sum"}
  ROOT add.2315 = f32[] add(Arg_0.2313, Arg_1.2314), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_56.2346 {
  Arg_0.2347 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/reduce_sum"}
  Arg_1.2348 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/reduce_sum"}
  ROOT add.2349 = f32[] add(Arg_0.2347, Arg_1.2348), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_57.2368 {
  Arg_0.2369 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/reduce_sum"}
  Arg_1.2370 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/reduce_sum"}
  ROOT add.2371 = f32[] add(Arg_0.2369, Arg_1.2370), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu.2471 {
  iota.2477 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.2478 = s32[31,31]{1,0} broadcast(iota.2477), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.2475 = s32[] constant(-4096)
  broadcast.2476 = s32[31,31]{1,0} broadcast(constant.2475), dimensions={}
  add.2479 = s32[31,31]{1,0} add(broadcast.2478, broadcast.2476), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.2480 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.2481 = s32[31,31]{1,0} broadcast(iota.2480), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.2482 = pred[31,31]{1,0} compare(add.2479, broadcast.2481), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.2473 = pred[] constant(false)
  broadcast.2474 = pred[31,31]{1,0} broadcast(constant.2473), dimensions={}
  Arg_0.2472 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.2483 = pred[31,31]{1,0} select(compare.2482, broadcast.2474, Arg_0.2472), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu.2471

tril.2485 {
  iota.2491 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.2492 = s32[31,31]{1,0} broadcast(iota.2491), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.2489 = s32[] constant(4095)
  broadcast.2490 = s32[31,31]{1,0} broadcast(constant.2489), dimensions={}
  add.2493 = s32[31,31]{1,0} add(broadcast.2492, broadcast.2490), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.2494 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.2495 = s32[31,31]{1,0} broadcast(iota.2494), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.2496 = pred[31,31]{1,0} compare(add.2493, broadcast.2495), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.2486 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  constant.2487 = pred[] constant(false)
  broadcast.2488 = pred[31,31]{1,0} broadcast(constant.2487), dimensions={}
  ROOT select.2497 = pred[31,31]{1,0} select(compare.2496, Arg_0.2486, broadcast.2488), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril.2485

region_58.2510 {
  Arg_0.2511 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/reduce_max"}
  Arg_1.2512 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/reduce_max"}
  ROOT maximum.2513 = f32[] maximum(Arg_0.2511, Arg_1.2512), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_59.2522 {
  Arg_0.2523 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/reduce_sum"}
  Arg_1.2524 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/reduce_sum"}
  ROOT add.2525 = f32[] add(Arg_0.2523, Arg_1.2524), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_60.2537 {
  Arg_0.2538 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/reduce_and"}
  Arg_1.2539 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/reduce_and"}
  ROOT and.2540 = pred[] and(Arg_0.2538, Arg_1.2539), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.2543 {
  Arg_0.2544 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.2547 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.2544), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.2548 = pred[1,31]{1,0} reshape(broadcast.2547), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.2549 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.2548), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.2545 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.2546 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.2550 = f32[1,31,8,256]{3,2,1,0} select(broadcast.2549, Arg_1.2545, Arg_2.2546), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.2543

region_61.2554 {
  Arg_0.2555 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/reduce_sum"}
  Arg_1.2556 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/reduce_sum"}
  ROOT add.2557 = f32[] add(Arg_0.2555, Arg_1.2556), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_62.2576 {
  Arg_0.2577 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/reduce_sum"}
  Arg_1.2578 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/reduce_sum"}
  ROOT add.2579 = f32[] add(Arg_0.2577, Arg_1.2578), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_63.2610 {
  Arg_0.2611 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/reduce_sum"}
  Arg_1.2612 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/reduce_sum"}
  ROOT add.2613 = f32[] add(Arg_0.2611, Arg_1.2612), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_64.2632 {
  Arg_0.2633 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/reduce_sum"}
  Arg_1.2634 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/reduce_sum"}
  ROOT add.2635 = f32[] add(Arg_0.2633, Arg_1.2634), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_65.2743 {
  Arg_0.2744 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/reduce_max"}
  Arg_1.2745 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/reduce_max"}
  ROOT maximum.2746 = f32[] maximum(Arg_0.2744, Arg_1.2745), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_66.2755 {
  Arg_0.2756 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/reduce_sum"}
  Arg_1.2757 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/reduce_sum"}
  ROOT add.2758 = f32[] add(Arg_0.2756, Arg_1.2757), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_67.2770 {
  Arg_0.2771 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/reduce_and"}
  Arg_1.2772 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/reduce_and"}
  ROOT and.2773 = pred[] and(Arg_0.2771, Arg_1.2772), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.2776 {
  Arg_0.2777 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.2780 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.2777), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.2781 = pred[1,31]{1,0} reshape(broadcast.2780), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.2782 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.2781), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.2778 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.2779 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.2783 = f32[1,31,8,256]{3,2,1,0} select(broadcast.2782, Arg_1.2778, Arg_2.2779), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.2776

region_68.2787 {
  Arg_0.2788 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/reduce_sum"}
  Arg_1.2789 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/reduce_sum"}
  ROOT add.2790 = f32[] add(Arg_0.2788, Arg_1.2789), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_69.2809 {
  Arg_0.2810 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/reduce_sum"}
  Arg_1.2811 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/reduce_sum"}
  ROOT add.2812 = f32[] add(Arg_0.2810, Arg_1.2811), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_70.2843 {
  Arg_0.2844 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/reduce_sum"}
  Arg_1.2845 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/reduce_sum"}
  ROOT add.2846 = f32[] add(Arg_0.2844, Arg_1.2845), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_71.2865 {
  Arg_0.2866 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/reduce_sum"}
  Arg_1.2867 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/reduce_sum"}
  ROOT add.2868 = f32[] add(Arg_0.2866, Arg_1.2867), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu.2968 {
  iota.2974 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.2975 = s32[31,31]{1,0} broadcast(iota.2974), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.2972 = s32[] constant(-4096)
  broadcast.2973 = s32[31,31]{1,0} broadcast(constant.2972), dimensions={}
  add.2976 = s32[31,31]{1,0} add(broadcast.2975, broadcast.2973), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.2977 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.2978 = s32[31,31]{1,0} broadcast(iota.2977), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.2979 = pred[31,31]{1,0} compare(add.2976, broadcast.2978), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.2970 = pred[] constant(false)
  broadcast.2971 = pred[31,31]{1,0} broadcast(constant.2970), dimensions={}
  Arg_0.2969 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.2980 = pred[31,31]{1,0} select(compare.2979, broadcast.2971, Arg_0.2969), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu.2968

tril.2982 {
  iota.2988 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.2989 = s32[31,31]{1,0} broadcast(iota.2988), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.2986 = s32[] constant(4095)
  broadcast.2987 = s32[31,31]{1,0} broadcast(constant.2986), dimensions={}
  add.2990 = s32[31,31]{1,0} add(broadcast.2989, broadcast.2987), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.2991 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.2992 = s32[31,31]{1,0} broadcast(iota.2991), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.2993 = pred[31,31]{1,0} compare(add.2990, broadcast.2992), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.2983 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  constant.2984 = pred[] constant(false)
  broadcast.2985 = pred[31,31]{1,0} broadcast(constant.2984), dimensions={}
  ROOT select.2994 = pred[31,31]{1,0} select(compare.2993, Arg_0.2983, broadcast.2985), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril.2982

region_72.3007 {
  Arg_0.3008 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/reduce_max"}
  Arg_1.3009 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/reduce_max"}
  ROOT maximum.3010 = f32[] maximum(Arg_0.3008, Arg_1.3009), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_73.3019 {
  Arg_0.3020 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/reduce_sum"}
  Arg_1.3021 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/reduce_sum"}
  ROOT add.3022 = f32[] add(Arg_0.3020, Arg_1.3021), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_74.3034 {
  Arg_0.3035 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/reduce_and"}
  Arg_1.3036 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/reduce_and"}
  ROOT and.3037 = pred[] and(Arg_0.3035, Arg_1.3036), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.3040 {
  Arg_0.3041 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.3044 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.3041), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.3045 = pred[1,31]{1,0} reshape(broadcast.3044), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.3046 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.3045), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.3042 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.3043 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.3047 = f32[1,31,8,256]{3,2,1,0} select(broadcast.3046, Arg_1.3042, Arg_2.3043), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.3040

region_75.3051 {
  Arg_0.3052 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/reduce_sum"}
  Arg_1.3053 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/reduce_sum"}
  ROOT add.3054 = f32[] add(Arg_0.3052, Arg_1.3053), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_76.3073 {
  Arg_0.3074 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/reduce_sum"}
  Arg_1.3075 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/reduce_sum"}
  ROOT add.3076 = f32[] add(Arg_0.3074, Arg_1.3075), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_77.3107 {
  Arg_0.3108 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/reduce_sum"}
  Arg_1.3109 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/reduce_sum"}
  ROOT add.3110 = f32[] add(Arg_0.3108, Arg_1.3109), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_78.3129 {
  Arg_0.3130 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/reduce_sum"}
  Arg_1.3131 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/reduce_sum"}
  ROOT add.3132 = f32[] add(Arg_0.3130, Arg_1.3131), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_79.3240 {
  Arg_0.3241 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/reduce_max"}
  Arg_1.3242 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/reduce_max"}
  ROOT maximum.3243 = f32[] maximum(Arg_0.3241, Arg_1.3242), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_80.3252 {
  Arg_0.3253 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/reduce_sum"}
  Arg_1.3254 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/reduce_sum"}
  ROOT add.3255 = f32[] add(Arg_0.3253, Arg_1.3254), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_81.3267 {
  Arg_0.3268 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/reduce_and"}
  Arg_1.3269 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/reduce_and"}
  ROOT and.3270 = pred[] and(Arg_0.3268, Arg_1.3269), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.3273 {
  Arg_0.3274 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.3277 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.3274), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.3278 = pred[1,31]{1,0} reshape(broadcast.3277), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.3279 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.3278), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.3275 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.3276 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.3280 = f32[1,31,8,256]{3,2,1,0} select(broadcast.3279, Arg_1.3275, Arg_2.3276), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.3273

region_82.3284 {
  Arg_0.3285 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/reduce_sum"}
  Arg_1.3286 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/reduce_sum"}
  ROOT add.3287 = f32[] add(Arg_0.3285, Arg_1.3286), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_83.3306 {
  Arg_0.3307 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/reduce_sum"}
  Arg_1.3308 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/reduce_sum"}
  ROOT add.3309 = f32[] add(Arg_0.3307, Arg_1.3308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_84.3340 {
  Arg_0.3341 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/reduce_sum"}
  Arg_1.3342 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/reduce_sum"}
  ROOT add.3343 = f32[] add(Arg_0.3341, Arg_1.3342), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_85.3362 {
  Arg_0.3363 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/reduce_sum"}
  Arg_1.3364 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/reduce_sum"}
  ROOT add.3365 = f32[] add(Arg_0.3363, Arg_1.3364), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu.3465 {
  iota.3471 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.3472 = s32[31,31]{1,0} broadcast(iota.3471), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.3469 = s32[] constant(-4096)
  broadcast.3470 = s32[31,31]{1,0} broadcast(constant.3469), dimensions={}
  add.3473 = s32[31,31]{1,0} add(broadcast.3472, broadcast.3470), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.3474 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.3475 = s32[31,31]{1,0} broadcast(iota.3474), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.3476 = pred[31,31]{1,0} compare(add.3473, broadcast.3475), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.3467 = pred[] constant(false)
  broadcast.3468 = pred[31,31]{1,0} broadcast(constant.3467), dimensions={}
  Arg_0.3466 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.3477 = pred[31,31]{1,0} select(compare.3476, broadcast.3468, Arg_0.3466), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu.3465

tril.3479 {
  iota.3485 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.3486 = s32[31,31]{1,0} broadcast(iota.3485), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.3483 = s32[] constant(4095)
  broadcast.3484 = s32[31,31]{1,0} broadcast(constant.3483), dimensions={}
  add.3487 = s32[31,31]{1,0} add(broadcast.3486, broadcast.3484), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.3488 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.3489 = s32[31,31]{1,0} broadcast(iota.3488), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.3490 = pred[31,31]{1,0} compare(add.3487, broadcast.3489), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.3480 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  constant.3481 = pred[] constant(false)
  broadcast.3482 = pred[31,31]{1,0} broadcast(constant.3481), dimensions={}
  ROOT select.3491 = pred[31,31]{1,0} select(compare.3490, Arg_0.3480, broadcast.3482), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril.3479

region_86.3504 {
  Arg_0.3505 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/reduce_max"}
  Arg_1.3506 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/reduce_max"}
  ROOT maximum.3507 = f32[] maximum(Arg_0.3505, Arg_1.3506), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_87.3516 {
  Arg_0.3517 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/reduce_sum"}
  Arg_1.3518 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/reduce_sum"}
  ROOT add.3519 = f32[] add(Arg_0.3517, Arg_1.3518), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_88.3531 {
  Arg_0.3532 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/reduce_and"}
  Arg_1.3533 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/reduce_and"}
  ROOT and.3534 = pred[] and(Arg_0.3532, Arg_1.3533), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.3537 {
  Arg_0.3538 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.3541 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.3538), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.3542 = pred[1,31]{1,0} reshape(broadcast.3541), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.3543 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.3542), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.3539 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.3540 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.3544 = f32[1,31,8,256]{3,2,1,0} select(broadcast.3543, Arg_1.3539, Arg_2.3540), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.3537

region_89.3548 {
  Arg_0.3549 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/reduce_sum"}
  Arg_1.3550 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/reduce_sum"}
  ROOT add.3551 = f32[] add(Arg_0.3549, Arg_1.3550), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_90.3570 {
  Arg_0.3571 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/reduce_sum"}
  Arg_1.3572 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/reduce_sum"}
  ROOT add.3573 = f32[] add(Arg_0.3571, Arg_1.3572), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_91.3604 {
  Arg_0.3605 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/reduce_sum"}
  Arg_1.3606 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/reduce_sum"}
  ROOT add.3607 = f32[] add(Arg_0.3605, Arg_1.3606), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_92.3626 {
  Arg_0.3627 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/reduce_sum"}
  Arg_1.3628 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/reduce_sum"}
  ROOT add.3629 = f32[] add(Arg_0.3627, Arg_1.3628), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_93.3737 {
  Arg_0.3738 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/reduce_max"}
  Arg_1.3739 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/reduce_max"}
  ROOT maximum.3740 = f32[] maximum(Arg_0.3738, Arg_1.3739), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_94.3749 {
  Arg_0.3750 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/reduce_sum"}
  Arg_1.3751 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/reduce_sum"}
  ROOT add.3752 = f32[] add(Arg_0.3750, Arg_1.3751), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_95.3764 {
  Arg_0.3765 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/reduce_and"}
  Arg_1.3766 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/reduce_and"}
  ROOT and.3767 = pred[] and(Arg_0.3765, Arg_1.3766), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.3770 {
  Arg_0.3771 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.3774 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.3771), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.3775 = pred[1,31]{1,0} reshape(broadcast.3774), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.3776 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.3775), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.3772 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.3773 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.3777 = f32[1,31,8,256]{3,2,1,0} select(broadcast.3776, Arg_1.3772, Arg_2.3773), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.3770

region_96.3781 {
  Arg_0.3782 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/reduce_sum"}
  Arg_1.3783 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/reduce_sum"}
  ROOT add.3784 = f32[] add(Arg_0.3782, Arg_1.3783), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_97.3803 {
  Arg_0.3804 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/reduce_sum"}
  Arg_1.3805 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/reduce_sum"}
  ROOT add.3806 = f32[] add(Arg_0.3804, Arg_1.3805), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_98.3837 {
  Arg_0.3838 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/reduce_sum"}
  Arg_1.3839 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/reduce_sum"}
  ROOT add.3840 = f32[] add(Arg_0.3838, Arg_1.3839), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_99.3859 {
  Arg_0.3860 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/reduce_sum"}
  Arg_1.3861 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/reduce_sum"}
  ROOT add.3862 = f32[] add(Arg_0.3860, Arg_1.3861), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu.3962 {
  iota.3968 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.3969 = s32[31,31]{1,0} broadcast(iota.3968), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.3966 = s32[] constant(-4096)
  broadcast.3967 = s32[31,31]{1,0} broadcast(constant.3966), dimensions={}
  add.3970 = s32[31,31]{1,0} add(broadcast.3969, broadcast.3967), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.3971 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.3972 = s32[31,31]{1,0} broadcast(iota.3971), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.3973 = pred[31,31]{1,0} compare(add.3970, broadcast.3972), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.3964 = pred[] constant(false)
  broadcast.3965 = pred[31,31]{1,0} broadcast(constant.3964), dimensions={}
  Arg_0.3963 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.3974 = pred[31,31]{1,0} select(compare.3973, broadcast.3965, Arg_0.3963), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu.3962

tril.3976 {
  iota.3982 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.3983 = s32[31,31]{1,0} broadcast(iota.3982), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.3980 = s32[] constant(4095)
  broadcast.3981 = s32[31,31]{1,0} broadcast(constant.3980), dimensions={}
  add.3984 = s32[31,31]{1,0} add(broadcast.3983, broadcast.3981), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.3985 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.3986 = s32[31,31]{1,0} broadcast(iota.3985), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.3987 = pred[31,31]{1,0} compare(add.3984, broadcast.3986), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.3977 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  constant.3978 = pred[] constant(false)
  broadcast.3979 = pred[31,31]{1,0} broadcast(constant.3978), dimensions={}
  ROOT select.3988 = pred[31,31]{1,0} select(compare.3987, Arg_0.3977, broadcast.3979), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril.3976

region_100.4001 {
  Arg_0.4002 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/reduce_max"}
  Arg_1.4003 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/reduce_max"}
  ROOT maximum.4004 = f32[] maximum(Arg_0.4002, Arg_1.4003), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_101.4013 {
  Arg_0.4014 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/reduce_sum"}
  Arg_1.4015 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/reduce_sum"}
  ROOT add.4016 = f32[] add(Arg_0.4014, Arg_1.4015), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_102.4028 {
  Arg_0.4029 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/reduce_and"}
  Arg_1.4030 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/reduce_and"}
  ROOT and.4031 = pred[] and(Arg_0.4029, Arg_1.4030), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.4034 {
  Arg_0.4035 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.4038 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.4035), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.4039 = pred[1,31]{1,0} reshape(broadcast.4038), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.4040 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.4039), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.4036 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.4037 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.4041 = f32[1,31,8,256]{3,2,1,0} select(broadcast.4040, Arg_1.4036, Arg_2.4037), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.4034

region_103.4045 {
  Arg_0.4046 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/reduce_sum"}
  Arg_1.4047 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/reduce_sum"}
  ROOT add.4048 = f32[] add(Arg_0.4046, Arg_1.4047), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_104.4067 {
  Arg_0.4068 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/reduce_sum"}
  Arg_1.4069 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/reduce_sum"}
  ROOT add.4070 = f32[] add(Arg_0.4068, Arg_1.4069), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_105.4101 {
  Arg_0.4102 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/reduce_sum"}
  Arg_1.4103 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/reduce_sum"}
  ROOT add.4104 = f32[] add(Arg_0.4102, Arg_1.4103), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_106.4123 {
  Arg_0.4124 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/reduce_sum"}
  Arg_1.4125 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/reduce_sum"}
  ROOT add.4126 = f32[] add(Arg_0.4124, Arg_1.4125), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_107.4234 {
  Arg_0.4235 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/reduce_max"}
  Arg_1.4236 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/reduce_max"}
  ROOT maximum.4237 = f32[] maximum(Arg_0.4235, Arg_1.4236), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_108.4246 {
  Arg_0.4247 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/reduce_sum"}
  Arg_1.4248 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/reduce_sum"}
  ROOT add.4249 = f32[] add(Arg_0.4247, Arg_1.4248), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_109.4261 {
  Arg_0.4262 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/reduce_and"}
  Arg_1.4263 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/reduce_and"}
  ROOT and.4264 = pred[] and(Arg_0.4262, Arg_1.4263), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.4267 {
  Arg_0.4268 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.4271 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.4268), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.4272 = pred[1,31]{1,0} reshape(broadcast.4271), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.4273 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.4272), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.4269 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.4270 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.4274 = f32[1,31,8,256]{3,2,1,0} select(broadcast.4273, Arg_1.4269, Arg_2.4270), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.4267

region_110.4278 {
  Arg_0.4279 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/reduce_sum"}
  Arg_1.4280 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/reduce_sum"}
  ROOT add.4281 = f32[] add(Arg_0.4279, Arg_1.4280), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_111.4300 {
  Arg_0.4301 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/reduce_sum"}
  Arg_1.4302 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/reduce_sum"}
  ROOT add.4303 = f32[] add(Arg_0.4301, Arg_1.4302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_112.4334 {
  Arg_0.4335 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/reduce_sum"}
  Arg_1.4336 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/reduce_sum"}
  ROOT add.4337 = f32[] add(Arg_0.4335, Arg_1.4336), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_113.4356 {
  Arg_0.4357 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/reduce_sum"}
  Arg_1.4358 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/reduce_sum"}
  ROOT add.4359 = f32[] add(Arg_0.4357, Arg_1.4358), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu.4459 {
  iota.4465 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.4466 = s32[31,31]{1,0} broadcast(iota.4465), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.4463 = s32[] constant(-4096)
  broadcast.4464 = s32[31,31]{1,0} broadcast(constant.4463), dimensions={}
  add.4467 = s32[31,31]{1,0} add(broadcast.4466, broadcast.4464), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.4468 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.4469 = s32[31,31]{1,0} broadcast(iota.4468), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.4470 = pred[31,31]{1,0} compare(add.4467, broadcast.4469), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.4461 = pred[] constant(false)
  broadcast.4462 = pred[31,31]{1,0} broadcast(constant.4461), dimensions={}
  Arg_0.4460 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.4471 = pred[31,31]{1,0} select(compare.4470, broadcast.4462, Arg_0.4460), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu.4459

tril.4473 {
  iota.4479 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.4480 = s32[31,31]{1,0} broadcast(iota.4479), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.4477 = s32[] constant(4095)
  broadcast.4478 = s32[31,31]{1,0} broadcast(constant.4477), dimensions={}
  add.4481 = s32[31,31]{1,0} add(broadcast.4480, broadcast.4478), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.4482 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.4483 = s32[31,31]{1,0} broadcast(iota.4482), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.4484 = pred[31,31]{1,0} compare(add.4481, broadcast.4483), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.4474 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  constant.4475 = pred[] constant(false)
  broadcast.4476 = pred[31,31]{1,0} broadcast(constant.4475), dimensions={}
  ROOT select.4485 = pred[31,31]{1,0} select(compare.4484, Arg_0.4474, broadcast.4476), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril.4473

region_114.4498 {
  Arg_0.4499 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/reduce_max"}
  Arg_1.4500 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/reduce_max"}
  ROOT maximum.4501 = f32[] maximum(Arg_0.4499, Arg_1.4500), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_115.4510 {
  Arg_0.4511 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/reduce_sum"}
  Arg_1.4512 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/reduce_sum"}
  ROOT add.4513 = f32[] add(Arg_0.4511, Arg_1.4512), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_116.4525 {
  Arg_0.4526 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/reduce_and"}
  Arg_1.4527 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/reduce_and"}
  ROOT and.4528 = pred[] and(Arg_0.4526, Arg_1.4527), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.4531 {
  Arg_0.4532 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.4535 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.4532), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.4536 = pred[1,31]{1,0} reshape(broadcast.4535), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.4537 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.4536), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.4533 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.4534 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.4538 = f32[1,31,8,256]{3,2,1,0} select(broadcast.4537, Arg_1.4533, Arg_2.4534), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.4531

region_117.4542 {
  Arg_0.4543 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/reduce_sum"}
  Arg_1.4544 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/reduce_sum"}
  ROOT add.4545 = f32[] add(Arg_0.4543, Arg_1.4544), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_118.4564 {
  Arg_0.4565 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/reduce_sum"}
  Arg_1.4566 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/reduce_sum"}
  ROOT add.4567 = f32[] add(Arg_0.4565, Arg_1.4566), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_119.4598 {
  Arg_0.4599 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/reduce_sum"}
  Arg_1.4600 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/reduce_sum"}
  ROOT add.4601 = f32[] add(Arg_0.4599, Arg_1.4600), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_120.4620 {
  Arg_0.4621 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/reduce_sum"}
  Arg_1.4622 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/reduce_sum"}
  ROOT add.4623 = f32[] add(Arg_0.4621, Arg_1.4622), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_121.4731 {
  Arg_0.4732 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/reduce_max"}
  Arg_1.4733 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/reduce_max"}
  ROOT maximum.4734 = f32[] maximum(Arg_0.4732, Arg_1.4733), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_122.4743 {
  Arg_0.4744 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/reduce_sum"}
  Arg_1.4745 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/reduce_sum"}
  ROOT add.4746 = f32[] add(Arg_0.4744, Arg_1.4745), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_123.4758 {
  Arg_0.4759 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/reduce_and"}
  Arg_1.4760 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/reduce_and"}
  ROOT and.4761 = pred[] and(Arg_0.4759, Arg_1.4760), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.4764 {
  Arg_0.4765 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.4768 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.4765), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.4769 = pred[1,31]{1,0} reshape(broadcast.4768), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.4770 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.4769), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.4766 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.4767 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.4771 = f32[1,31,8,256]{3,2,1,0} select(broadcast.4770, Arg_1.4766, Arg_2.4767), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.4764

region_124.4775 {
  Arg_0.4776 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/reduce_sum"}
  Arg_1.4777 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/reduce_sum"}
  ROOT add.4778 = f32[] add(Arg_0.4776, Arg_1.4777), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_125.4797 {
  Arg_0.4798 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/reduce_sum"}
  Arg_1.4799 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/reduce_sum"}
  ROOT add.4800 = f32[] add(Arg_0.4798, Arg_1.4799), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_126.4831 {
  Arg_0.4832 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/reduce_sum"}
  Arg_1.4833 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/reduce_sum"}
  ROOT add.4834 = f32[] add(Arg_0.4832, Arg_1.4833), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_127.4853 {
  Arg_0.4854 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/reduce_sum"}
  Arg_1.4855 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/reduce_sum"}
  ROOT add.4856 = f32[] add(Arg_0.4854, Arg_1.4855), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu.4956 {
  iota.4962 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.4963 = s32[31,31]{1,0} broadcast(iota.4962), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.4960 = s32[] constant(-4096)
  broadcast.4961 = s32[31,31]{1,0} broadcast(constant.4960), dimensions={}
  add.4964 = s32[31,31]{1,0} add(broadcast.4963, broadcast.4961), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.4965 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.4966 = s32[31,31]{1,0} broadcast(iota.4965), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.4967 = pred[31,31]{1,0} compare(add.4964, broadcast.4966), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.4958 = pred[] constant(false)
  broadcast.4959 = pred[31,31]{1,0} broadcast(constant.4958), dimensions={}
  Arg_0.4957 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.4968 = pred[31,31]{1,0} select(compare.4967, broadcast.4959, Arg_0.4957), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu.4956

tril.4970 {
  iota.4976 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.4977 = s32[31,31]{1,0} broadcast(iota.4976), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.4974 = s32[] constant(4095)
  broadcast.4975 = s32[31,31]{1,0} broadcast(constant.4974), dimensions={}
  add.4978 = s32[31,31]{1,0} add(broadcast.4977, broadcast.4975), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.4979 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.4980 = s32[31,31]{1,0} broadcast(iota.4979), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.4981 = pred[31,31]{1,0} compare(add.4978, broadcast.4980), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.4971 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  constant.4972 = pred[] constant(false)
  broadcast.4973 = pred[31,31]{1,0} broadcast(constant.4972), dimensions={}
  ROOT select.4982 = pred[31,31]{1,0} select(compare.4981, Arg_0.4971, broadcast.4973), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril.4970

region_128.4995 {
  Arg_0.4996 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/reduce_max"}
  Arg_1.4997 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/reduce_max"}
  ROOT maximum.4998 = f32[] maximum(Arg_0.4996, Arg_1.4997), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_129.5007 {
  Arg_0.5008 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/reduce_sum"}
  Arg_1.5009 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/reduce_sum"}
  ROOT add.5010 = f32[] add(Arg_0.5008, Arg_1.5009), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_130.5022 {
  Arg_0.5023 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/reduce_and"}
  Arg_1.5024 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/reduce_and"}
  ROOT and.5025 = pred[] and(Arg_0.5023, Arg_1.5024), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.5028 {
  Arg_0.5029 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.5032 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.5029), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.5033 = pred[1,31]{1,0} reshape(broadcast.5032), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.5034 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.5033), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.5030 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.5031 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.5035 = f32[1,31,8,256]{3,2,1,0} select(broadcast.5034, Arg_1.5030, Arg_2.5031), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.5028

region_131.5039 {
  Arg_0.5040 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/reduce_sum"}
  Arg_1.5041 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/reduce_sum"}
  ROOT add.5042 = f32[] add(Arg_0.5040, Arg_1.5041), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_132.5061 {
  Arg_0.5062 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/reduce_sum"}
  Arg_1.5063 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/reduce_sum"}
  ROOT add.5064 = f32[] add(Arg_0.5062, Arg_1.5063), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_133.5095 {
  Arg_0.5096 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/reduce_sum"}
  Arg_1.5097 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/reduce_sum"}
  ROOT add.5098 = f32[] add(Arg_0.5096, Arg_1.5097), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_134.5117 {
  Arg_0.5118 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/reduce_sum"}
  Arg_1.5119 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/reduce_sum"}
  ROOT add.5120 = f32[] add(Arg_0.5118, Arg_1.5119), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_135.5228 {
  Arg_0.5229 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/reduce_max"}
  Arg_1.5230 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/reduce_max"}
  ROOT maximum.5231 = f32[] maximum(Arg_0.5229, Arg_1.5230), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_136.5240 {
  Arg_0.5241 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/reduce_sum"}
  Arg_1.5242 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/reduce_sum"}
  ROOT add.5243 = f32[] add(Arg_0.5241, Arg_1.5242), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_137.5255 {
  Arg_0.5256 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/reduce_and"}
  Arg_1.5257 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/reduce_and"}
  ROOT and.5258 = pred[] and(Arg_0.5256, Arg_1.5257), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.5261 {
  Arg_0.5262 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.5265 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.5262), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.5266 = pred[1,31]{1,0} reshape(broadcast.5265), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.5267 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.5266), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.5263 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.5264 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.5268 = f32[1,31,8,256]{3,2,1,0} select(broadcast.5267, Arg_1.5263, Arg_2.5264), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.5261

region_138.5272 {
  Arg_0.5273 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/reduce_sum"}
  Arg_1.5274 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/reduce_sum"}
  ROOT add.5275 = f32[] add(Arg_0.5273, Arg_1.5274), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_139.5294 {
  Arg_0.5295 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/reduce_sum"}
  Arg_1.5296 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/reduce_sum"}
  ROOT add.5297 = f32[] add(Arg_0.5295, Arg_1.5296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_140.5328 {
  Arg_0.5329 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/reduce_sum"}
  Arg_1.5330 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/reduce_sum"}
  ROOT add.5331 = f32[] add(Arg_0.5329, Arg_1.5330), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_141.5350 {
  Arg_0.5351 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/reduce_sum"}
  Arg_1.5352 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/reduce_sum"}
  ROOT add.5353 = f32[] add(Arg_0.5351, Arg_1.5352), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu.5453 {
  iota.5459 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.5460 = s32[31,31]{1,0} broadcast(iota.5459), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.5457 = s32[] constant(-4096)
  broadcast.5458 = s32[31,31]{1,0} broadcast(constant.5457), dimensions={}
  add.5461 = s32[31,31]{1,0} add(broadcast.5460, broadcast.5458), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.5462 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.5463 = s32[31,31]{1,0} broadcast(iota.5462), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.5464 = pred[31,31]{1,0} compare(add.5461, broadcast.5463), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.5455 = pred[] constant(false)
  broadcast.5456 = pred[31,31]{1,0} broadcast(constant.5455), dimensions={}
  Arg_0.5454 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.5465 = pred[31,31]{1,0} select(compare.5464, broadcast.5456, Arg_0.5454), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu.5453

tril.5467 {
  iota.5473 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.5474 = s32[31,31]{1,0} broadcast(iota.5473), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.5471 = s32[] constant(4095)
  broadcast.5472 = s32[31,31]{1,0} broadcast(constant.5471), dimensions={}
  add.5475 = s32[31,31]{1,0} add(broadcast.5474, broadcast.5472), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.5476 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.5477 = s32[31,31]{1,0} broadcast(iota.5476), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.5478 = pred[31,31]{1,0} compare(add.5475, broadcast.5477), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.5468 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  constant.5469 = pred[] constant(false)
  broadcast.5470 = pred[31,31]{1,0} broadcast(constant.5469), dimensions={}
  ROOT select.5479 = pred[31,31]{1,0} select(compare.5478, Arg_0.5468, broadcast.5470), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril.5467

region_142.5492 {
  Arg_0.5493 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/reduce_max"}
  Arg_1.5494 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/reduce_max"}
  ROOT maximum.5495 = f32[] maximum(Arg_0.5493, Arg_1.5494), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_143.5504 {
  Arg_0.5505 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/reduce_sum"}
  Arg_1.5506 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/reduce_sum"}
  ROOT add.5507 = f32[] add(Arg_0.5505, Arg_1.5506), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_144.5519 {
  Arg_0.5520 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/reduce_and"}
  Arg_1.5521 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/reduce_and"}
  ROOT and.5522 = pred[] and(Arg_0.5520, Arg_1.5521), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.5525 {
  Arg_0.5526 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.5529 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.5526), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.5530 = pred[1,31]{1,0} reshape(broadcast.5529), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.5531 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.5530), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.5527 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.5528 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.5532 = f32[1,31,8,256]{3,2,1,0} select(broadcast.5531, Arg_1.5527, Arg_2.5528), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.5525

region_145.5536 {
  Arg_0.5537 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/reduce_sum"}
  Arg_1.5538 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/reduce_sum"}
  ROOT add.5539 = f32[] add(Arg_0.5537, Arg_1.5538), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_146.5558 {
  Arg_0.5559 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/reduce_sum"}
  Arg_1.5560 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/reduce_sum"}
  ROOT add.5561 = f32[] add(Arg_0.5559, Arg_1.5560), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_147.5592 {
  Arg_0.5593 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/reduce_sum"}
  Arg_1.5594 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/reduce_sum"}
  ROOT add.5595 = f32[] add(Arg_0.5593, Arg_1.5594), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_148.5614 {
  Arg_0.5615 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/reduce_sum"}
  Arg_1.5616 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/reduce_sum"}
  ROOT add.5617 = f32[] add(Arg_0.5615, Arg_1.5616), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_149.5725 {
  Arg_0.5726 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/reduce_max"}
  Arg_1.5727 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/reduce_max"}
  ROOT maximum.5728 = f32[] maximum(Arg_0.5726, Arg_1.5727), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_150.5737 {
  Arg_0.5738 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/reduce_sum"}
  Arg_1.5739 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/reduce_sum"}
  ROOT add.5740 = f32[] add(Arg_0.5738, Arg_1.5739), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_151.5752 {
  Arg_0.5753 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/reduce_and"}
  Arg_1.5754 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/reduce_and"}
  ROOT and.5755 = pred[] and(Arg_0.5753, Arg_1.5754), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.5758 {
  Arg_0.5759 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.5762 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.5759), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.5763 = pred[1,31]{1,0} reshape(broadcast.5762), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.5764 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.5763), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.5760 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.5761 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.5765 = f32[1,31,8,256]{3,2,1,0} select(broadcast.5764, Arg_1.5760, Arg_2.5761), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.5758

region_152.5769 {
  Arg_0.5770 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/reduce_sum"}
  Arg_1.5771 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/reduce_sum"}
  ROOT add.5772 = f32[] add(Arg_0.5770, Arg_1.5771), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_153.5791 {
  Arg_0.5792 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/reduce_sum"}
  Arg_1.5793 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/reduce_sum"}
  ROOT add.5794 = f32[] add(Arg_0.5792, Arg_1.5793), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_154.5825 {
  Arg_0.5826 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/reduce_sum"}
  Arg_1.5827 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/reduce_sum"}
  ROOT add.5828 = f32[] add(Arg_0.5826, Arg_1.5827), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_155.5847 {
  Arg_0.5848 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/reduce_sum"}
  Arg_1.5849 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/reduce_sum"}
  ROOT add.5850 = f32[] add(Arg_0.5848, Arg_1.5849), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu.5950 {
  iota.5956 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.5957 = s32[31,31]{1,0} broadcast(iota.5956), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.5954 = s32[] constant(-4096)
  broadcast.5955 = s32[31,31]{1,0} broadcast(constant.5954), dimensions={}
  add.5958 = s32[31,31]{1,0} add(broadcast.5957, broadcast.5955), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.5959 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.5960 = s32[31,31]{1,0} broadcast(iota.5959), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.5961 = pred[31,31]{1,0} compare(add.5958, broadcast.5960), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.5952 = pred[] constant(false)
  broadcast.5953 = pred[31,31]{1,0} broadcast(constant.5952), dimensions={}
  Arg_0.5951 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.5962 = pred[31,31]{1,0} select(compare.5961, broadcast.5953, Arg_0.5951), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu.5950

tril.5964 {
  iota.5970 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.5971 = s32[31,31]{1,0} broadcast(iota.5970), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.5968 = s32[] constant(4095)
  broadcast.5969 = s32[31,31]{1,0} broadcast(constant.5968), dimensions={}
  add.5972 = s32[31,31]{1,0} add(broadcast.5971, broadcast.5969), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.5973 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.5974 = s32[31,31]{1,0} broadcast(iota.5973), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.5975 = pred[31,31]{1,0} compare(add.5972, broadcast.5974), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.5965 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  constant.5966 = pred[] constant(false)
  broadcast.5967 = pred[31,31]{1,0} broadcast(constant.5966), dimensions={}
  ROOT select.5976 = pred[31,31]{1,0} select(compare.5975, Arg_0.5965, broadcast.5967), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril.5964

region_156.5989 {
  Arg_0.5990 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/reduce_max"}
  Arg_1.5991 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/reduce_max"}
  ROOT maximum.5992 = f32[] maximum(Arg_0.5990, Arg_1.5991), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_157.6001 {
  Arg_0.6002 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/reduce_sum"}
  Arg_1.6003 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/reduce_sum"}
  ROOT add.6004 = f32[] add(Arg_0.6002, Arg_1.6003), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_158.6016 {
  Arg_0.6017 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/reduce_and"}
  Arg_1.6018 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/reduce_and"}
  ROOT and.6019 = pred[] and(Arg_0.6017, Arg_1.6018), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.6022 {
  Arg_0.6023 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.6026 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.6023), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.6027 = pred[1,31]{1,0} reshape(broadcast.6026), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.6028 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.6027), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.6024 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.6025 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.6029 = f32[1,31,8,256]{3,2,1,0} select(broadcast.6028, Arg_1.6024, Arg_2.6025), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.6022

region_159.6033 {
  Arg_0.6034 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/reduce_sum"}
  Arg_1.6035 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/reduce_sum"}
  ROOT add.6036 = f32[] add(Arg_0.6034, Arg_1.6035), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_160.6055 {
  Arg_0.6056 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/reduce_sum"}
  Arg_1.6057 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/reduce_sum"}
  ROOT add.6058 = f32[] add(Arg_0.6056, Arg_1.6057), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_161.6089 {
  Arg_0.6090 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/reduce_sum"}
  Arg_1.6091 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/reduce_sum"}
  ROOT add.6092 = f32[] add(Arg_0.6090, Arg_1.6091), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_162.6111 {
  Arg_0.6112 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/reduce_sum"}
  Arg_1.6113 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/reduce_sum"}
  ROOT add.6114 = f32[] add(Arg_0.6112, Arg_1.6113), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_163.6222 {
  Arg_0.6223 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/reduce_max"}
  Arg_1.6224 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/reduce_max"}
  ROOT maximum.6225 = f32[] maximum(Arg_0.6223, Arg_1.6224), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_164.6234 {
  Arg_0.6235 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/reduce_sum"}
  Arg_1.6236 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/reduce_sum"}
  ROOT add.6237 = f32[] add(Arg_0.6235, Arg_1.6236), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_165.6249 {
  Arg_0.6250 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/reduce_and"}
  Arg_1.6251 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/reduce_and"}
  ROOT and.6252 = pred[] and(Arg_0.6250, Arg_1.6251), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.6255 {
  Arg_0.6256 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.6259 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.6256), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.6260 = pred[1,31]{1,0} reshape(broadcast.6259), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.6261 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.6260), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.6257 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.6258 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.6262 = f32[1,31,8,256]{3,2,1,0} select(broadcast.6261, Arg_1.6257, Arg_2.6258), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.6255

region_166.6266 {
  Arg_0.6267 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/reduce_sum"}
  Arg_1.6268 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/reduce_sum"}
  ROOT add.6269 = f32[] add(Arg_0.6267, Arg_1.6268), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_167.6288 {
  Arg_0.6289 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/reduce_sum"}
  Arg_1.6290 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/reduce_sum"}
  ROOT add.6291 = f32[] add(Arg_0.6289, Arg_1.6290), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_168.6322 {
  Arg_0.6323 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/reduce_sum"}
  Arg_1.6324 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/reduce_sum"}
  ROOT add.6325 = f32[] add(Arg_0.6323, Arg_1.6324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_169.6344 {
  Arg_0.6345 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/reduce_sum"}
  Arg_1.6346 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/reduce_sum"}
  ROOT add.6347 = f32[] add(Arg_0.6345, Arg_1.6346), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu.6447 {
  iota.6453 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.6454 = s32[31,31]{1,0} broadcast(iota.6453), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.6451 = s32[] constant(-4096)
  broadcast.6452 = s32[31,31]{1,0} broadcast(constant.6451), dimensions={}
  add.6455 = s32[31,31]{1,0} add(broadcast.6454, broadcast.6452), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.6456 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.6457 = s32[31,31]{1,0} broadcast(iota.6456), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.6458 = pred[31,31]{1,0} compare(add.6455, broadcast.6457), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.6449 = pred[] constant(false)
  broadcast.6450 = pred[31,31]{1,0} broadcast(constant.6449), dimensions={}
  Arg_0.6448 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.6459 = pred[31,31]{1,0} select(compare.6458, broadcast.6450, Arg_0.6448), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu.6447

tril.6461 {
  iota.6467 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.6468 = s32[31,31]{1,0} broadcast(iota.6467), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.6465 = s32[] constant(4095)
  broadcast.6466 = s32[31,31]{1,0} broadcast(constant.6465), dimensions={}
  add.6469 = s32[31,31]{1,0} add(broadcast.6468, broadcast.6466), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.6470 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.6471 = s32[31,31]{1,0} broadcast(iota.6470), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.6472 = pred[31,31]{1,0} compare(add.6469, broadcast.6471), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.6462 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  constant.6463 = pred[] constant(false)
  broadcast.6464 = pred[31,31]{1,0} broadcast(constant.6463), dimensions={}
  ROOT select.6473 = pred[31,31]{1,0} select(compare.6472, Arg_0.6462, broadcast.6464), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril.6461

region_170.6486 {
  Arg_0.6487 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/reduce_max"}
  Arg_1.6488 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/reduce_max"}
  ROOT maximum.6489 = f32[] maximum(Arg_0.6487, Arg_1.6488), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_171.6498 {
  Arg_0.6499 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/reduce_sum"}
  Arg_1.6500 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/reduce_sum"}
  ROOT add.6501 = f32[] add(Arg_0.6499, Arg_1.6500), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_172.6513 {
  Arg_0.6514 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/reduce_and"}
  Arg_1.6515 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/reduce_and"}
  ROOT and.6516 = pred[] and(Arg_0.6514, Arg_1.6515), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_0.6519 {
  Arg_0.6520 = pred[1,31,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  broadcast.6523 = pred[1,31,1,1]{3,2,1,0} broadcast(Arg_0.6520), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.6524 = pred[1,31]{1,0} reshape(broadcast.6523), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.6525 = pred[1,31,8,256]{3,2,1,0} broadcast(reshape.6524), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.6521 = f32[1,31,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  Arg_2.6522 = f32[1,31,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/pjit"}
  ROOT select.6526 = f32[1,31,8,256]{3,2,1,0} select(broadcast.6525, Arg_1.6521, Arg_2.6522), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_0.6519

region_173.6530 {
  Arg_0.6531 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/reduce_sum"}
  Arg_1.6532 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/reduce_sum"}
  ROOT add.6533 = f32[] add(Arg_0.6531, Arg_1.6532), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_174.6552 {
  Arg_0.6553 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/reduce_sum"}
  Arg_1.6554 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/reduce_sum"}
  ROOT add.6555 = f32[] add(Arg_0.6553, Arg_1.6554), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_175.6586 {
  Arg_0.6587 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/reduce_sum"}
  Arg_1.6588 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/reduce_sum"}
  ROOT add.6589 = f32[] add(Arg_0.6587, Arg_1.6588), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_176.6608 {
  Arg_0.6609 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/reduce_sum"}
  Arg_1.6610 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/reduce_sum"}
  ROOT add.6611 = f32[] add(Arg_0.6609, Arg_1.6610), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_177.6691 {
  Arg_0.6692 = s32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/reduce_sum"}
  Arg_1.6693 = s32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/reduce_sum"}
  ROOT add.6694 = s32[] add(Arg_0.6692, Arg_1.6693), metadata={op_name="jit(compiled_generate_function)/jit(main)/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1237}
}

region_178.6696 {
  Arg_0.6697 = s32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/reduce_min"}
  Arg_1.6698 = s32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/reduce_min"}
  ROOT minimum.6699 = s32[] minimum(Arg_0.6697, Arg_1.6698), metadata={op_name="jit(compiled_generate_function)/jit(main)/reduce_min" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=816}
}

_where_2.6703 {
  Arg_0.6704 = pred[1,1]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/jit(_take)/pjit"}
  Arg_1.6705 = s32[1,1]{1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/jit(_take)/pjit"}
  Arg_2.6706 = s32[1,1]{1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/jit(_take)/pjit"}
  ROOT select.6707 = s32[1,1]{1,0} select(Arg_0.6704, Arg_1.6705, Arg_2.6706), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/jit(_take)/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
}

region_180.6708 {
  Arg_0.6709 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/jit(_take)/reduce_and"}
  Arg_1.6710 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/jit(_take)/reduce_and"}
  ROOT and.6711 = pred[] and(Arg_0.6709, Arg_1.6710), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/jit(_take)/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
}

_take_1.6712 {
  Arg_1.6714 = s32[1,1]{1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/pjit"}
  constant.6721 = s32[1,1]{1,0} constant({ {0} })
  compare.6722 = pred[1,1]{1,0} compare(Arg_1.6714, constant.6721), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/jit(_take)/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
  constant.6719 = s32[1,1]{1,0} constant({ {256000} })
  add.6723 = s32[1,1]{1,0} add(Arg_1.6714, constant.6719), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/jit(_take)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
  call.6724 = s32[1,1]{1,0} call(compare.6722, add.6723, Arg_1.6714), to_apply=_where_2.6703
  reshape.6725 = s32[1,1,1]{2,1,0} reshape(call.6724), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/jit(_take)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
  constant.6718 = s32[1,1,1]{2,1,0} constant({ { {0} } })
  compare.6726 = pred[1,1,1]{2,1,0} compare(reshape.6725, constant.6718), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/jit(_take)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
  constant.6717 = s32[1,1,1]{2,1,0} constant({ { {255999} } })
  compare.6727 = pred[1,1,1]{2,1,0} compare(reshape.6725, constant.6717), direction=LE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/jit(_take)/le" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
  and.6728 = pred[1,1,1]{2,1,0} and(compare.6726, compare.6727), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/jit(_take)/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
  constant.6720 = pred[] constant(true)
  reduce.6729 = pred[1,1]{1,0} reduce(and.6728, constant.6720), dimensions={2}, to_apply=region_180.6708, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/jit(_take)/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
  broadcast.6731 = pred[1,1,2304]{2,1,0} broadcast(reduce.6729), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/jit(_take)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
  Arg_0.6713 = f32[256000,2304]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/pjit"}
  gather.6730 = f32[1,1,2304]{2,1,0} gather(Arg_0.6713, reshape.6725), offset_dims={2}, collapsed_slice_dims={0}, start_index_map={0}, index_vector_dim=2, slice_sizes={1,2304}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/jit(_take)/gather" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
  constant.6715 = f32[] constant(nan)
  broadcast.6716 = f32[1,1,2304]{2,1,0} broadcast(constant.6715), dimensions={}
  ROOT select.6732 = f32[1,1,2304]{2,1,0} select(broadcast.6731, gather.6730, broadcast.6716), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/jit(_take)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1018}
} // _take_1.6712

region_181.6733 {
  Arg_0.6734 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_attention_norm/reduce_sum"}
  Arg_1.6735 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_attention_norm/reduce_sum"}
  ROOT add.6736 = f32[] add(Arg_0.6734, Arg_1.6735), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu_3.6737 {
  iota.6743 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.6744 = s32[31,31]{1,0} broadcast(iota.6743), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.6741 = s32[] constant(-4096)
  broadcast.6742 = s32[31,31]{1,0} broadcast(constant.6741), dimensions={}
  add.6745 = s32[31,31]{1,0} add(broadcast.6744, broadcast.6742), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.6746 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.6747 = s32[31,31]{1,0} broadcast(iota.6746), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.6748 = pred[31,31]{1,0} compare(add.6745, broadcast.6747), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.6739 = pred[] constant(false)
  broadcast.6740 = pred[31,31]{1,0} broadcast(constant.6739), dimensions={}
  Arg_0.6738 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.6749 = pred[31,31]{1,0} select(compare.6748, broadcast.6740, Arg_0.6738), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu_3.6737

tril_4.6750 {
  iota.6756 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.6757 = s32[31,31]{1,0} broadcast(iota.6756), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.6754 = s32[] constant(4095)
  broadcast.6755 = s32[31,31]{1,0} broadcast(constant.6754), dimensions={}
  add.6758 = s32[31,31]{1,0} add(broadcast.6757, broadcast.6755), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.6759 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.6760 = s32[31,31]{1,0} broadcast(iota.6759), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.6761 = pred[31,31]{1,0} compare(add.6758, broadcast.6760), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.6751 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  constant.6752 = pred[] constant(false)
  broadcast.6753 = pred[31,31]{1,0} broadcast(constant.6752), dimensions={}
  ROOT select.6762 = pred[31,31]{1,0} select(compare.6761, Arg_0.6751, broadcast.6753), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril_4.6750

region_182.6763 {
  Arg_0.6764 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/reduce_max"}
  Arg_1.6765 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/reduce_max"}
  ROOT maximum.6766 = f32[] maximum(Arg_0.6764, Arg_1.6765), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_183.6767 {
  Arg_0.6768 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/reduce_sum"}
  Arg_1.6769 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/reduce_sum"}
  ROOT add.6770 = f32[] add(Arg_0.6768, Arg_1.6769), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_184.6771 {
  Arg_0.6772 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/reduce_and"}
  Arg_1.6773 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/reduce_and"}
  ROOT and.6774 = pred[] and(Arg_0.6772, Arg_1.6773), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.6775 {
  Arg_0.6776 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.6779 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.6776), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.6780 = pred[1,1]{1,0} reshape(broadcast.6779), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.6781 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.6780), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.6777 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.6778 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.6782 = f32[1,1,8,256]{3,2,1,0} select(broadcast.6781, Arg_1.6777, Arg_2.6778), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.6775

region_185.6783 {
  Arg_0.6784 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_attention_norm/reduce_sum"}
  Arg_1.6785 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_attention_norm/reduce_sum"}
  ROOT add.6786 = f32[] add(Arg_0.6784, Arg_1.6785), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_186.6787 {
  Arg_0.6788 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_ffw_norm/reduce_sum"}
  Arg_1.6789 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_ffw_norm/reduce_sum"}
  ROOT add.6790 = f32[] add(Arg_0.6788, Arg_1.6789), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_187.6791 {
  Arg_0.6792 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_ffw_norm/reduce_sum"}
  Arg_1.6793 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_ffw_norm/reduce_sum"}
  ROOT add.6794 = f32[] add(Arg_0.6792, Arg_1.6793), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_188.6795 {
  Arg_0.6796 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_attention_norm/reduce_sum"}
  Arg_1.6797 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_attention_norm/reduce_sum"}
  ROOT add.6798 = f32[] add(Arg_0.6796, Arg_1.6797), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_189.6799 {
  Arg_0.6800 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/reduce_max"}
  Arg_1.6801 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/reduce_max"}
  ROOT maximum.6802 = f32[] maximum(Arg_0.6800, Arg_1.6801), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_190.6803 {
  Arg_0.6804 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/reduce_sum"}
  Arg_1.6805 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/reduce_sum"}
  ROOT add.6806 = f32[] add(Arg_0.6804, Arg_1.6805), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_191.6807 {
  Arg_0.6808 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/reduce_and"}
  Arg_1.6809 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/reduce_and"}
  ROOT and.6810 = pred[] and(Arg_0.6808, Arg_1.6809), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.6811 {
  Arg_0.6812 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.6815 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.6812), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.6816 = pred[1,1]{1,0} reshape(broadcast.6815), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.6817 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.6816), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.6813 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.6814 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.6818 = f32[1,1,8,256]{3,2,1,0} select(broadcast.6817, Arg_1.6813, Arg_2.6814), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.6811

region_192.6819 {
  Arg_0.6820 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_attention_norm/reduce_sum"}
  Arg_1.6821 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_attention_norm/reduce_sum"}
  ROOT add.6822 = f32[] add(Arg_0.6820, Arg_1.6821), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_193.6823 {
  Arg_0.6824 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_ffw_norm/reduce_sum"}
  Arg_1.6825 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_ffw_norm/reduce_sum"}
  ROOT add.6826 = f32[] add(Arg_0.6824, Arg_1.6825), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_194.6827 {
  Arg_0.6828 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_ffw_norm/reduce_sum"}
  Arg_1.6829 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_ffw_norm/reduce_sum"}
  ROOT add.6830 = f32[] add(Arg_0.6828, Arg_1.6829), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_195.6831 {
  Arg_0.6832 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_attention_norm/reduce_sum"}
  Arg_1.6833 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_attention_norm/reduce_sum"}
  ROOT add.6834 = f32[] add(Arg_0.6832, Arg_1.6833), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu_3.6835 {
  iota.6841 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.6842 = s32[31,31]{1,0} broadcast(iota.6841), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.6839 = s32[] constant(-4096)
  broadcast.6840 = s32[31,31]{1,0} broadcast(constant.6839), dimensions={}
  add.6843 = s32[31,31]{1,0} add(broadcast.6842, broadcast.6840), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.6844 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.6845 = s32[31,31]{1,0} broadcast(iota.6844), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.6846 = pred[31,31]{1,0} compare(add.6843, broadcast.6845), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.6837 = pred[] constant(false)
  broadcast.6838 = pred[31,31]{1,0} broadcast(constant.6837), dimensions={}
  Arg_0.6836 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.6847 = pred[31,31]{1,0} select(compare.6846, broadcast.6838, Arg_0.6836), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu_3.6835

tril_4.6848 {
  iota.6854 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.6855 = s32[31,31]{1,0} broadcast(iota.6854), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.6852 = s32[] constant(4095)
  broadcast.6853 = s32[31,31]{1,0} broadcast(constant.6852), dimensions={}
  add.6856 = s32[31,31]{1,0} add(broadcast.6855, broadcast.6853), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.6857 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.6858 = s32[31,31]{1,0} broadcast(iota.6857), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.6859 = pred[31,31]{1,0} compare(add.6856, broadcast.6858), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.6849 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  constant.6850 = pred[] constant(false)
  broadcast.6851 = pred[31,31]{1,0} broadcast(constant.6850), dimensions={}
  ROOT select.6860 = pred[31,31]{1,0} select(compare.6859, Arg_0.6849, broadcast.6851), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril_4.6848

region_196.6861 {
  Arg_0.6862 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/reduce_max"}
  Arg_1.6863 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/reduce_max"}
  ROOT maximum.6864 = f32[] maximum(Arg_0.6862, Arg_1.6863), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_197.6865 {
  Arg_0.6866 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/reduce_sum"}
  Arg_1.6867 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/reduce_sum"}
  ROOT add.6868 = f32[] add(Arg_0.6866, Arg_1.6867), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_198.6869 {
  Arg_0.6870 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/reduce_and"}
  Arg_1.6871 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/reduce_and"}
  ROOT and.6872 = pred[] and(Arg_0.6870, Arg_1.6871), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.6873 {
  Arg_0.6874 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.6877 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.6874), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.6878 = pred[1,1]{1,0} reshape(broadcast.6877), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.6879 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.6878), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.6875 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.6876 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.6880 = f32[1,1,8,256]{3,2,1,0} select(broadcast.6879, Arg_1.6875, Arg_2.6876), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.6873

region_199.6881 {
  Arg_0.6882 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_attention_norm/reduce_sum"}
  Arg_1.6883 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_attention_norm/reduce_sum"}
  ROOT add.6884 = f32[] add(Arg_0.6882, Arg_1.6883), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_200.6885 {
  Arg_0.6886 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_ffw_norm/reduce_sum"}
  Arg_1.6887 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_ffw_norm/reduce_sum"}
  ROOT add.6888 = f32[] add(Arg_0.6886, Arg_1.6887), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_201.6889 {
  Arg_0.6890 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_ffw_norm/reduce_sum"}
  Arg_1.6891 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_ffw_norm/reduce_sum"}
  ROOT add.6892 = f32[] add(Arg_0.6890, Arg_1.6891), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_202.6893 {
  Arg_0.6894 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_attention_norm/reduce_sum"}
  Arg_1.6895 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_attention_norm/reduce_sum"}
  ROOT add.6896 = f32[] add(Arg_0.6894, Arg_1.6895), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_203.6897 {
  Arg_0.6898 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/reduce_max"}
  Arg_1.6899 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/reduce_max"}
  ROOT maximum.6900 = f32[] maximum(Arg_0.6898, Arg_1.6899), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_204.6901 {
  Arg_0.6902 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/reduce_sum"}
  Arg_1.6903 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/reduce_sum"}
  ROOT add.6904 = f32[] add(Arg_0.6902, Arg_1.6903), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_205.6905 {
  Arg_0.6906 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/reduce_and"}
  Arg_1.6907 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/reduce_and"}
  ROOT and.6908 = pred[] and(Arg_0.6906, Arg_1.6907), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.6909 {
  Arg_0.6910 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.6913 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.6910), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.6914 = pred[1,1]{1,0} reshape(broadcast.6913), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.6915 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.6914), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.6911 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.6912 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.6916 = f32[1,1,8,256]{3,2,1,0} select(broadcast.6915, Arg_1.6911, Arg_2.6912), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.6909

region_206.6917 {
  Arg_0.6918 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_attention_norm/reduce_sum"}
  Arg_1.6919 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_attention_norm/reduce_sum"}
  ROOT add.6920 = f32[] add(Arg_0.6918, Arg_1.6919), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_207.6921 {
  Arg_0.6922 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_ffw_norm/reduce_sum"}
  Arg_1.6923 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_ffw_norm/reduce_sum"}
  ROOT add.6924 = f32[] add(Arg_0.6922, Arg_1.6923), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_208.6925 {
  Arg_0.6926 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_ffw_norm/reduce_sum"}
  Arg_1.6927 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_ffw_norm/reduce_sum"}
  ROOT add.6928 = f32[] add(Arg_0.6926, Arg_1.6927), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_209.6929 {
  Arg_0.6930 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_attention_norm/reduce_sum"}
  Arg_1.6931 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_attention_norm/reduce_sum"}
  ROOT add.6932 = f32[] add(Arg_0.6930, Arg_1.6931), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu_3.6933 {
  iota.6939 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.6940 = s32[31,31]{1,0} broadcast(iota.6939), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.6937 = s32[] constant(-4096)
  broadcast.6938 = s32[31,31]{1,0} broadcast(constant.6937), dimensions={}
  add.6941 = s32[31,31]{1,0} add(broadcast.6940, broadcast.6938), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.6942 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.6943 = s32[31,31]{1,0} broadcast(iota.6942), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.6944 = pred[31,31]{1,0} compare(add.6941, broadcast.6943), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.6935 = pred[] constant(false)
  broadcast.6936 = pred[31,31]{1,0} broadcast(constant.6935), dimensions={}
  Arg_0.6934 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.6945 = pred[31,31]{1,0} select(compare.6944, broadcast.6936, Arg_0.6934), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu_3.6933

tril_4.6946 {
  iota.6952 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.6953 = s32[31,31]{1,0} broadcast(iota.6952), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.6950 = s32[] constant(4095)
  broadcast.6951 = s32[31,31]{1,0} broadcast(constant.6950), dimensions={}
  add.6954 = s32[31,31]{1,0} add(broadcast.6953, broadcast.6951), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.6955 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.6956 = s32[31,31]{1,0} broadcast(iota.6955), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.6957 = pred[31,31]{1,0} compare(add.6954, broadcast.6956), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.6947 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  constant.6948 = pred[] constant(false)
  broadcast.6949 = pred[31,31]{1,0} broadcast(constant.6948), dimensions={}
  ROOT select.6958 = pred[31,31]{1,0} select(compare.6957, Arg_0.6947, broadcast.6949), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril_4.6946

region_210.6959 {
  Arg_0.6960 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/reduce_max"}
  Arg_1.6961 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/reduce_max"}
  ROOT maximum.6962 = f32[] maximum(Arg_0.6960, Arg_1.6961), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_211.6963 {
  Arg_0.6964 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/reduce_sum"}
  Arg_1.6965 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/reduce_sum"}
  ROOT add.6966 = f32[] add(Arg_0.6964, Arg_1.6965), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_212.6967 {
  Arg_0.6968 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/reduce_and"}
  Arg_1.6969 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/reduce_and"}
  ROOT and.6970 = pred[] and(Arg_0.6968, Arg_1.6969), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.6971 {
  Arg_0.6972 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.6975 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.6972), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.6976 = pred[1,1]{1,0} reshape(broadcast.6975), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.6977 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.6976), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.6973 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.6974 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.6978 = f32[1,1,8,256]{3,2,1,0} select(broadcast.6977, Arg_1.6973, Arg_2.6974), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.6971

region_213.6979 {
  Arg_0.6980 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_attention_norm/reduce_sum"}
  Arg_1.6981 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_attention_norm/reduce_sum"}
  ROOT add.6982 = f32[] add(Arg_0.6980, Arg_1.6981), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_214.6983 {
  Arg_0.6984 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_ffw_norm/reduce_sum"}
  Arg_1.6985 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_ffw_norm/reduce_sum"}
  ROOT add.6986 = f32[] add(Arg_0.6984, Arg_1.6985), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_215.6987 {
  Arg_0.6988 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_ffw_norm/reduce_sum"}
  Arg_1.6989 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_ffw_norm/reduce_sum"}
  ROOT add.6990 = f32[] add(Arg_0.6988, Arg_1.6989), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_216.6991 {
  Arg_0.6992 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_attention_norm/reduce_sum"}
  Arg_1.6993 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_attention_norm/reduce_sum"}
  ROOT add.6994 = f32[] add(Arg_0.6992, Arg_1.6993), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_217.6995 {
  Arg_0.6996 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/reduce_max"}
  Arg_1.6997 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/reduce_max"}
  ROOT maximum.6998 = f32[] maximum(Arg_0.6996, Arg_1.6997), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_218.6999 {
  Arg_0.7000 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/reduce_sum"}
  Arg_1.7001 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/reduce_sum"}
  ROOT add.7002 = f32[] add(Arg_0.7000, Arg_1.7001), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_219.7003 {
  Arg_0.7004 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/reduce_and"}
  Arg_1.7005 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/reduce_and"}
  ROOT and.7006 = pred[] and(Arg_0.7004, Arg_1.7005), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7007 {
  Arg_0.7008 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7011 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7008), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7012 = pred[1,1]{1,0} reshape(broadcast.7011), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7013 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7012), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7009 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7010 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7014 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7013, Arg_1.7009, Arg_2.7010), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7007

region_220.7015 {
  Arg_0.7016 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_attention_norm/reduce_sum"}
  Arg_1.7017 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_attention_norm/reduce_sum"}
  ROOT add.7018 = f32[] add(Arg_0.7016, Arg_1.7017), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_221.7019 {
  Arg_0.7020 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_ffw_norm/reduce_sum"}
  Arg_1.7021 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_ffw_norm/reduce_sum"}
  ROOT add.7022 = f32[] add(Arg_0.7020, Arg_1.7021), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_222.7023 {
  Arg_0.7024 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_ffw_norm/reduce_sum"}
  Arg_1.7025 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_ffw_norm/reduce_sum"}
  ROOT add.7026 = f32[] add(Arg_0.7024, Arg_1.7025), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_223.7027 {
  Arg_0.7028 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_attention_norm/reduce_sum"}
  Arg_1.7029 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_attention_norm/reduce_sum"}
  ROOT add.7030 = f32[] add(Arg_0.7028, Arg_1.7029), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu_3.7031 {
  iota.7037 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7038 = s32[31,31]{1,0} broadcast(iota.7037), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7035 = s32[] constant(-4096)
  broadcast.7036 = s32[31,31]{1,0} broadcast(constant.7035), dimensions={}
  add.7039 = s32[31,31]{1,0} add(broadcast.7038, broadcast.7036), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.7040 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7041 = s32[31,31]{1,0} broadcast(iota.7040), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.7042 = pred[31,31]{1,0} compare(add.7039, broadcast.7041), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7033 = pred[] constant(false)
  broadcast.7034 = pred[31,31]{1,0} broadcast(constant.7033), dimensions={}
  Arg_0.7032 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7043 = pred[31,31]{1,0} select(compare.7042, broadcast.7034, Arg_0.7032), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu_3.7031

tril_4.7044 {
  iota.7050 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7051 = s32[31,31]{1,0} broadcast(iota.7050), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.7048 = s32[] constant(4095)
  broadcast.7049 = s32[31,31]{1,0} broadcast(constant.7048), dimensions={}
  add.7052 = s32[31,31]{1,0} add(broadcast.7051, broadcast.7049), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.7053 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7054 = s32[31,31]{1,0} broadcast(iota.7053), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.7055 = pred[31,31]{1,0} compare(add.7052, broadcast.7054), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.7045 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  constant.7046 = pred[] constant(false)
  broadcast.7047 = pred[31,31]{1,0} broadcast(constant.7046), dimensions={}
  ROOT select.7056 = pred[31,31]{1,0} select(compare.7055, Arg_0.7045, broadcast.7047), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril_4.7044

region_224.7057 {
  Arg_0.7058 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/reduce_max"}
  Arg_1.7059 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/reduce_max"}
  ROOT maximum.7060 = f32[] maximum(Arg_0.7058, Arg_1.7059), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_225.7061 {
  Arg_0.7062 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/reduce_sum"}
  Arg_1.7063 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/reduce_sum"}
  ROOT add.7064 = f32[] add(Arg_0.7062, Arg_1.7063), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_226.7065 {
  Arg_0.7066 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/reduce_and"}
  Arg_1.7067 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/reduce_and"}
  ROOT and.7068 = pred[] and(Arg_0.7066, Arg_1.7067), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7069 {
  Arg_0.7070 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7073 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7070), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7074 = pred[1,1]{1,0} reshape(broadcast.7073), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7075 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7074), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7071 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7072 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7076 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7075, Arg_1.7071, Arg_2.7072), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7069

region_227.7077 {
  Arg_0.7078 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_attention_norm/reduce_sum"}
  Arg_1.7079 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_attention_norm/reduce_sum"}
  ROOT add.7080 = f32[] add(Arg_0.7078, Arg_1.7079), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_228.7081 {
  Arg_0.7082 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_ffw_norm/reduce_sum"}
  Arg_1.7083 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_ffw_norm/reduce_sum"}
  ROOT add.7084 = f32[] add(Arg_0.7082, Arg_1.7083), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_229.7085 {
  Arg_0.7086 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_ffw_norm/reduce_sum"}
  Arg_1.7087 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_ffw_norm/reduce_sum"}
  ROOT add.7088 = f32[] add(Arg_0.7086, Arg_1.7087), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_230.7089 {
  Arg_0.7090 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_attention_norm/reduce_sum"}
  Arg_1.7091 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_attention_norm/reduce_sum"}
  ROOT add.7092 = f32[] add(Arg_0.7090, Arg_1.7091), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_231.7093 {
  Arg_0.7094 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/reduce_max"}
  Arg_1.7095 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/reduce_max"}
  ROOT maximum.7096 = f32[] maximum(Arg_0.7094, Arg_1.7095), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_232.7097 {
  Arg_0.7098 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/reduce_sum"}
  Arg_1.7099 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/reduce_sum"}
  ROOT add.7100 = f32[] add(Arg_0.7098, Arg_1.7099), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_233.7101 {
  Arg_0.7102 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/reduce_and"}
  Arg_1.7103 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/reduce_and"}
  ROOT and.7104 = pred[] and(Arg_0.7102, Arg_1.7103), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7105 {
  Arg_0.7106 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7109 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7106), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7110 = pred[1,1]{1,0} reshape(broadcast.7109), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7111 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7110), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7107 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7108 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7112 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7111, Arg_1.7107, Arg_2.7108), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7105

region_234.7113 {
  Arg_0.7114 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_attention_norm/reduce_sum"}
  Arg_1.7115 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_attention_norm/reduce_sum"}
  ROOT add.7116 = f32[] add(Arg_0.7114, Arg_1.7115), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_235.7117 {
  Arg_0.7118 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_ffw_norm/reduce_sum"}
  Arg_1.7119 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_ffw_norm/reduce_sum"}
  ROOT add.7120 = f32[] add(Arg_0.7118, Arg_1.7119), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_236.7121 {
  Arg_0.7122 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_ffw_norm/reduce_sum"}
  Arg_1.7123 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_ffw_norm/reduce_sum"}
  ROOT add.7124 = f32[] add(Arg_0.7122, Arg_1.7123), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_237.7125 {
  Arg_0.7126 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_attention_norm/reduce_sum"}
  Arg_1.7127 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_attention_norm/reduce_sum"}
  ROOT add.7128 = f32[] add(Arg_0.7126, Arg_1.7127), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu_3.7129 {
  iota.7135 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7136 = s32[31,31]{1,0} broadcast(iota.7135), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7133 = s32[] constant(-4096)
  broadcast.7134 = s32[31,31]{1,0} broadcast(constant.7133), dimensions={}
  add.7137 = s32[31,31]{1,0} add(broadcast.7136, broadcast.7134), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.7138 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7139 = s32[31,31]{1,0} broadcast(iota.7138), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.7140 = pred[31,31]{1,0} compare(add.7137, broadcast.7139), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7131 = pred[] constant(false)
  broadcast.7132 = pred[31,31]{1,0} broadcast(constant.7131), dimensions={}
  Arg_0.7130 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7141 = pred[31,31]{1,0} select(compare.7140, broadcast.7132, Arg_0.7130), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu_3.7129

tril_4.7142 {
  iota.7148 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7149 = s32[31,31]{1,0} broadcast(iota.7148), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.7146 = s32[] constant(4095)
  broadcast.7147 = s32[31,31]{1,0} broadcast(constant.7146), dimensions={}
  add.7150 = s32[31,31]{1,0} add(broadcast.7149, broadcast.7147), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.7151 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7152 = s32[31,31]{1,0} broadcast(iota.7151), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.7153 = pred[31,31]{1,0} compare(add.7150, broadcast.7152), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.7143 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  constant.7144 = pred[] constant(false)
  broadcast.7145 = pred[31,31]{1,0} broadcast(constant.7144), dimensions={}
  ROOT select.7154 = pred[31,31]{1,0} select(compare.7153, Arg_0.7143, broadcast.7145), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril_4.7142

region_238.7155 {
  Arg_0.7156 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/reduce_max"}
  Arg_1.7157 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/reduce_max"}
  ROOT maximum.7158 = f32[] maximum(Arg_0.7156, Arg_1.7157), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_239.7159 {
  Arg_0.7160 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/reduce_sum"}
  Arg_1.7161 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/reduce_sum"}
  ROOT add.7162 = f32[] add(Arg_0.7160, Arg_1.7161), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_240.7163 {
  Arg_0.7164 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/reduce_and"}
  Arg_1.7165 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/reduce_and"}
  ROOT and.7166 = pred[] and(Arg_0.7164, Arg_1.7165), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7167 {
  Arg_0.7168 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7171 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7168), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7172 = pred[1,1]{1,0} reshape(broadcast.7171), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7173 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7172), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7169 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7170 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7174 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7173, Arg_1.7169, Arg_2.7170), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7167

region_241.7175 {
  Arg_0.7176 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_attention_norm/reduce_sum"}
  Arg_1.7177 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_attention_norm/reduce_sum"}
  ROOT add.7178 = f32[] add(Arg_0.7176, Arg_1.7177), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_242.7179 {
  Arg_0.7180 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_ffw_norm/reduce_sum"}
  Arg_1.7181 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_ffw_norm/reduce_sum"}
  ROOT add.7182 = f32[] add(Arg_0.7180, Arg_1.7181), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_243.7183 {
  Arg_0.7184 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_ffw_norm/reduce_sum"}
  Arg_1.7185 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_ffw_norm/reduce_sum"}
  ROOT add.7186 = f32[] add(Arg_0.7184, Arg_1.7185), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_244.7187 {
  Arg_0.7188 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_attention_norm/reduce_sum"}
  Arg_1.7189 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_attention_norm/reduce_sum"}
  ROOT add.7190 = f32[] add(Arg_0.7188, Arg_1.7189), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_245.7191 {
  Arg_0.7192 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/reduce_max"}
  Arg_1.7193 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/reduce_max"}
  ROOT maximum.7194 = f32[] maximum(Arg_0.7192, Arg_1.7193), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_246.7195 {
  Arg_0.7196 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/reduce_sum"}
  Arg_1.7197 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/reduce_sum"}
  ROOT add.7198 = f32[] add(Arg_0.7196, Arg_1.7197), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_247.7199 {
  Arg_0.7200 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/reduce_and"}
  Arg_1.7201 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/reduce_and"}
  ROOT and.7202 = pred[] and(Arg_0.7200, Arg_1.7201), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7203 {
  Arg_0.7204 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7207 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7204), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7208 = pred[1,1]{1,0} reshape(broadcast.7207), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7209 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7208), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7205 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7206 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7210 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7209, Arg_1.7205, Arg_2.7206), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7203

region_248.7211 {
  Arg_0.7212 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_attention_norm/reduce_sum"}
  Arg_1.7213 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_attention_norm/reduce_sum"}
  ROOT add.7214 = f32[] add(Arg_0.7212, Arg_1.7213), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_249.7215 {
  Arg_0.7216 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_ffw_norm/reduce_sum"}
  Arg_1.7217 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_ffw_norm/reduce_sum"}
  ROOT add.7218 = f32[] add(Arg_0.7216, Arg_1.7217), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_250.7219 {
  Arg_0.7220 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_ffw_norm/reduce_sum"}
  Arg_1.7221 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_ffw_norm/reduce_sum"}
  ROOT add.7222 = f32[] add(Arg_0.7220, Arg_1.7221), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_251.7223 {
  Arg_0.7224 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_attention_norm/reduce_sum"}
  Arg_1.7225 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_attention_norm/reduce_sum"}
  ROOT add.7226 = f32[] add(Arg_0.7224, Arg_1.7225), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu_3.7227 {
  iota.7233 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7234 = s32[31,31]{1,0} broadcast(iota.7233), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7231 = s32[] constant(-4096)
  broadcast.7232 = s32[31,31]{1,0} broadcast(constant.7231), dimensions={}
  add.7235 = s32[31,31]{1,0} add(broadcast.7234, broadcast.7232), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.7236 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7237 = s32[31,31]{1,0} broadcast(iota.7236), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.7238 = pred[31,31]{1,0} compare(add.7235, broadcast.7237), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7229 = pred[] constant(false)
  broadcast.7230 = pred[31,31]{1,0} broadcast(constant.7229), dimensions={}
  Arg_0.7228 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7239 = pred[31,31]{1,0} select(compare.7238, broadcast.7230, Arg_0.7228), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu_3.7227

tril_4.7240 {
  iota.7246 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7247 = s32[31,31]{1,0} broadcast(iota.7246), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.7244 = s32[] constant(4095)
  broadcast.7245 = s32[31,31]{1,0} broadcast(constant.7244), dimensions={}
  add.7248 = s32[31,31]{1,0} add(broadcast.7247, broadcast.7245), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.7249 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7250 = s32[31,31]{1,0} broadcast(iota.7249), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.7251 = pred[31,31]{1,0} compare(add.7248, broadcast.7250), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.7241 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  constant.7242 = pred[] constant(false)
  broadcast.7243 = pred[31,31]{1,0} broadcast(constant.7242), dimensions={}
  ROOT select.7252 = pred[31,31]{1,0} select(compare.7251, Arg_0.7241, broadcast.7243), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril_4.7240

region_252.7253 {
  Arg_0.7254 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/reduce_max"}
  Arg_1.7255 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/reduce_max"}
  ROOT maximum.7256 = f32[] maximum(Arg_0.7254, Arg_1.7255), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_253.7257 {
  Arg_0.7258 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/reduce_sum"}
  Arg_1.7259 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/reduce_sum"}
  ROOT add.7260 = f32[] add(Arg_0.7258, Arg_1.7259), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_254.7261 {
  Arg_0.7262 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/reduce_and"}
  Arg_1.7263 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/reduce_and"}
  ROOT and.7264 = pred[] and(Arg_0.7262, Arg_1.7263), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7265 {
  Arg_0.7266 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7269 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7266), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7270 = pred[1,1]{1,0} reshape(broadcast.7269), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7271 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7270), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7267 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7268 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7272 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7271, Arg_1.7267, Arg_2.7268), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7265

region_255.7273 {
  Arg_0.7274 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_attention_norm/reduce_sum"}
  Arg_1.7275 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_attention_norm/reduce_sum"}
  ROOT add.7276 = f32[] add(Arg_0.7274, Arg_1.7275), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_256.7277 {
  Arg_0.7278 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_ffw_norm/reduce_sum"}
  Arg_1.7279 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_ffw_norm/reduce_sum"}
  ROOT add.7280 = f32[] add(Arg_0.7278, Arg_1.7279), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_257.7281 {
  Arg_0.7282 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_ffw_norm/reduce_sum"}
  Arg_1.7283 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_ffw_norm/reduce_sum"}
  ROOT add.7284 = f32[] add(Arg_0.7282, Arg_1.7283), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_258.7285 {
  Arg_0.7286 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_attention_norm/reduce_sum"}
  Arg_1.7287 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_attention_norm/reduce_sum"}
  ROOT add.7288 = f32[] add(Arg_0.7286, Arg_1.7287), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_259.7289 {
  Arg_0.7290 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/reduce_max"}
  Arg_1.7291 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/reduce_max"}
  ROOT maximum.7292 = f32[] maximum(Arg_0.7290, Arg_1.7291), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_260.7293 {
  Arg_0.7294 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/reduce_sum"}
  Arg_1.7295 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/reduce_sum"}
  ROOT add.7296 = f32[] add(Arg_0.7294, Arg_1.7295), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_261.7297 {
  Arg_0.7298 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/reduce_and"}
  Arg_1.7299 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/reduce_and"}
  ROOT and.7300 = pred[] and(Arg_0.7298, Arg_1.7299), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7301 {
  Arg_0.7302 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7305 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7302), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7306 = pred[1,1]{1,0} reshape(broadcast.7305), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7307 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7306), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7303 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7304 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7308 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7307, Arg_1.7303, Arg_2.7304), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7301

region_262.7309 {
  Arg_0.7310 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_attention_norm/reduce_sum"}
  Arg_1.7311 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_attention_norm/reduce_sum"}
  ROOT add.7312 = f32[] add(Arg_0.7310, Arg_1.7311), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_263.7313 {
  Arg_0.7314 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_ffw_norm/reduce_sum"}
  Arg_1.7315 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_ffw_norm/reduce_sum"}
  ROOT add.7316 = f32[] add(Arg_0.7314, Arg_1.7315), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_264.7317 {
  Arg_0.7318 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_ffw_norm/reduce_sum"}
  Arg_1.7319 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_ffw_norm/reduce_sum"}
  ROOT add.7320 = f32[] add(Arg_0.7318, Arg_1.7319), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_265.7321 {
  Arg_0.7322 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_attention_norm/reduce_sum"}
  Arg_1.7323 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_attention_norm/reduce_sum"}
  ROOT add.7324 = f32[] add(Arg_0.7322, Arg_1.7323), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu_3.7325 {
  iota.7331 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7332 = s32[31,31]{1,0} broadcast(iota.7331), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7329 = s32[] constant(-4096)
  broadcast.7330 = s32[31,31]{1,0} broadcast(constant.7329), dimensions={}
  add.7333 = s32[31,31]{1,0} add(broadcast.7332, broadcast.7330), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.7334 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7335 = s32[31,31]{1,0} broadcast(iota.7334), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.7336 = pred[31,31]{1,0} compare(add.7333, broadcast.7335), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7327 = pred[] constant(false)
  broadcast.7328 = pred[31,31]{1,0} broadcast(constant.7327), dimensions={}
  Arg_0.7326 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7337 = pred[31,31]{1,0} select(compare.7336, broadcast.7328, Arg_0.7326), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu_3.7325

tril_4.7338 {
  iota.7344 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7345 = s32[31,31]{1,0} broadcast(iota.7344), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.7342 = s32[] constant(4095)
  broadcast.7343 = s32[31,31]{1,0} broadcast(constant.7342), dimensions={}
  add.7346 = s32[31,31]{1,0} add(broadcast.7345, broadcast.7343), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.7347 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7348 = s32[31,31]{1,0} broadcast(iota.7347), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.7349 = pred[31,31]{1,0} compare(add.7346, broadcast.7348), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.7339 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  constant.7340 = pred[] constant(false)
  broadcast.7341 = pred[31,31]{1,0} broadcast(constant.7340), dimensions={}
  ROOT select.7350 = pred[31,31]{1,0} select(compare.7349, Arg_0.7339, broadcast.7341), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril_4.7338

region_266.7351 {
  Arg_0.7352 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/reduce_max"}
  Arg_1.7353 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/reduce_max"}
  ROOT maximum.7354 = f32[] maximum(Arg_0.7352, Arg_1.7353), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_267.7355 {
  Arg_0.7356 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/reduce_sum"}
  Arg_1.7357 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/reduce_sum"}
  ROOT add.7358 = f32[] add(Arg_0.7356, Arg_1.7357), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_268.7359 {
  Arg_0.7360 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/reduce_and"}
  Arg_1.7361 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/reduce_and"}
  ROOT and.7362 = pred[] and(Arg_0.7360, Arg_1.7361), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7363 {
  Arg_0.7364 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7367 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7364), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7368 = pred[1,1]{1,0} reshape(broadcast.7367), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7369 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7368), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7365 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7366 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7370 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7369, Arg_1.7365, Arg_2.7366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7363

region_269.7371 {
  Arg_0.7372 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_attention_norm/reduce_sum"}
  Arg_1.7373 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_attention_norm/reduce_sum"}
  ROOT add.7374 = f32[] add(Arg_0.7372, Arg_1.7373), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_270.7375 {
  Arg_0.7376 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_ffw_norm/reduce_sum"}
  Arg_1.7377 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_ffw_norm/reduce_sum"}
  ROOT add.7378 = f32[] add(Arg_0.7376, Arg_1.7377), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_271.7379 {
  Arg_0.7380 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_ffw_norm/reduce_sum"}
  Arg_1.7381 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_ffw_norm/reduce_sum"}
  ROOT add.7382 = f32[] add(Arg_0.7380, Arg_1.7381), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_272.7383 {
  Arg_0.7384 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_attention_norm/reduce_sum"}
  Arg_1.7385 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_attention_norm/reduce_sum"}
  ROOT add.7386 = f32[] add(Arg_0.7384, Arg_1.7385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_273.7387 {
  Arg_0.7388 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/reduce_max"}
  Arg_1.7389 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/reduce_max"}
  ROOT maximum.7390 = f32[] maximum(Arg_0.7388, Arg_1.7389), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_274.7391 {
  Arg_0.7392 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/reduce_sum"}
  Arg_1.7393 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/reduce_sum"}
  ROOT add.7394 = f32[] add(Arg_0.7392, Arg_1.7393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_275.7395 {
  Arg_0.7396 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/reduce_and"}
  Arg_1.7397 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/reduce_and"}
  ROOT and.7398 = pred[] and(Arg_0.7396, Arg_1.7397), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7399 {
  Arg_0.7400 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7403 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7400), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7404 = pred[1,1]{1,0} reshape(broadcast.7403), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7405 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7404), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7401 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7402 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7406 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7405, Arg_1.7401, Arg_2.7402), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7399

region_276.7407 {
  Arg_0.7408 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_attention_norm/reduce_sum"}
  Arg_1.7409 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_attention_norm/reduce_sum"}
  ROOT add.7410 = f32[] add(Arg_0.7408, Arg_1.7409), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_277.7411 {
  Arg_0.7412 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_ffw_norm/reduce_sum"}
  Arg_1.7413 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_ffw_norm/reduce_sum"}
  ROOT add.7414 = f32[] add(Arg_0.7412, Arg_1.7413), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_278.7415 {
  Arg_0.7416 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_ffw_norm/reduce_sum"}
  Arg_1.7417 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_ffw_norm/reduce_sum"}
  ROOT add.7418 = f32[] add(Arg_0.7416, Arg_1.7417), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_279.7419 {
  Arg_0.7420 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_attention_norm/reduce_sum"}
  Arg_1.7421 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_attention_norm/reduce_sum"}
  ROOT add.7422 = f32[] add(Arg_0.7420, Arg_1.7421), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu_3.7423 {
  iota.7429 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7430 = s32[31,31]{1,0} broadcast(iota.7429), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7427 = s32[] constant(-4096)
  broadcast.7428 = s32[31,31]{1,0} broadcast(constant.7427), dimensions={}
  add.7431 = s32[31,31]{1,0} add(broadcast.7430, broadcast.7428), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.7432 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7433 = s32[31,31]{1,0} broadcast(iota.7432), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.7434 = pred[31,31]{1,0} compare(add.7431, broadcast.7433), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7425 = pred[] constant(false)
  broadcast.7426 = pred[31,31]{1,0} broadcast(constant.7425), dimensions={}
  Arg_0.7424 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7435 = pred[31,31]{1,0} select(compare.7434, broadcast.7426, Arg_0.7424), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu_3.7423

tril_4.7436 {
  iota.7442 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7443 = s32[31,31]{1,0} broadcast(iota.7442), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.7440 = s32[] constant(4095)
  broadcast.7441 = s32[31,31]{1,0} broadcast(constant.7440), dimensions={}
  add.7444 = s32[31,31]{1,0} add(broadcast.7443, broadcast.7441), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.7445 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7446 = s32[31,31]{1,0} broadcast(iota.7445), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.7447 = pred[31,31]{1,0} compare(add.7444, broadcast.7446), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.7437 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  constant.7438 = pred[] constant(false)
  broadcast.7439 = pred[31,31]{1,0} broadcast(constant.7438), dimensions={}
  ROOT select.7448 = pred[31,31]{1,0} select(compare.7447, Arg_0.7437, broadcast.7439), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril_4.7436

region_280.7449 {
  Arg_0.7450 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/reduce_max"}
  Arg_1.7451 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/reduce_max"}
  ROOT maximum.7452 = f32[] maximum(Arg_0.7450, Arg_1.7451), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_281.7453 {
  Arg_0.7454 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/reduce_sum"}
  Arg_1.7455 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/reduce_sum"}
  ROOT add.7456 = f32[] add(Arg_0.7454, Arg_1.7455), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_282.7457 {
  Arg_0.7458 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/reduce_and"}
  Arg_1.7459 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/reduce_and"}
  ROOT and.7460 = pred[] and(Arg_0.7458, Arg_1.7459), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7461 {
  Arg_0.7462 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7465 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7462), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7466 = pred[1,1]{1,0} reshape(broadcast.7465), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7467 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7466), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7463 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7464 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7468 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7467, Arg_1.7463, Arg_2.7464), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7461

region_283.7469 {
  Arg_0.7470 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_attention_norm/reduce_sum"}
  Arg_1.7471 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_attention_norm/reduce_sum"}
  ROOT add.7472 = f32[] add(Arg_0.7470, Arg_1.7471), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_284.7473 {
  Arg_0.7474 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_ffw_norm/reduce_sum"}
  Arg_1.7475 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_ffw_norm/reduce_sum"}
  ROOT add.7476 = f32[] add(Arg_0.7474, Arg_1.7475), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_285.7477 {
  Arg_0.7478 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_ffw_norm/reduce_sum"}
  Arg_1.7479 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_ffw_norm/reduce_sum"}
  ROOT add.7480 = f32[] add(Arg_0.7478, Arg_1.7479), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_286.7481 {
  Arg_0.7482 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_attention_norm/reduce_sum"}
  Arg_1.7483 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_attention_norm/reduce_sum"}
  ROOT add.7484 = f32[] add(Arg_0.7482, Arg_1.7483), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_287.7485 {
  Arg_0.7486 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/reduce_max"}
  Arg_1.7487 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/reduce_max"}
  ROOT maximum.7488 = f32[] maximum(Arg_0.7486, Arg_1.7487), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_288.7489 {
  Arg_0.7490 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/reduce_sum"}
  Arg_1.7491 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/reduce_sum"}
  ROOT add.7492 = f32[] add(Arg_0.7490, Arg_1.7491), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_289.7493 {
  Arg_0.7494 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/reduce_and"}
  Arg_1.7495 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/reduce_and"}
  ROOT and.7496 = pred[] and(Arg_0.7494, Arg_1.7495), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7497 {
  Arg_0.7498 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7501 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7498), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7502 = pred[1,1]{1,0} reshape(broadcast.7501), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7503 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7502), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7499 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7500 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7504 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7503, Arg_1.7499, Arg_2.7500), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7497

region_290.7505 {
  Arg_0.7506 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_attention_norm/reduce_sum"}
  Arg_1.7507 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_attention_norm/reduce_sum"}
  ROOT add.7508 = f32[] add(Arg_0.7506, Arg_1.7507), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_291.7509 {
  Arg_0.7510 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_ffw_norm/reduce_sum"}
  Arg_1.7511 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_ffw_norm/reduce_sum"}
  ROOT add.7512 = f32[] add(Arg_0.7510, Arg_1.7511), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_292.7513 {
  Arg_0.7514 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_ffw_norm/reduce_sum"}
  Arg_1.7515 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_ffw_norm/reduce_sum"}
  ROOT add.7516 = f32[] add(Arg_0.7514, Arg_1.7515), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_293.7517 {
  Arg_0.7518 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_attention_norm/reduce_sum"}
  Arg_1.7519 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_attention_norm/reduce_sum"}
  ROOT add.7520 = f32[] add(Arg_0.7518, Arg_1.7519), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu_3.7521 {
  iota.7527 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7528 = s32[31,31]{1,0} broadcast(iota.7527), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7525 = s32[] constant(-4096)
  broadcast.7526 = s32[31,31]{1,0} broadcast(constant.7525), dimensions={}
  add.7529 = s32[31,31]{1,0} add(broadcast.7528, broadcast.7526), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.7530 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7531 = s32[31,31]{1,0} broadcast(iota.7530), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.7532 = pred[31,31]{1,0} compare(add.7529, broadcast.7531), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7523 = pred[] constant(false)
  broadcast.7524 = pred[31,31]{1,0} broadcast(constant.7523), dimensions={}
  Arg_0.7522 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7533 = pred[31,31]{1,0} select(compare.7532, broadcast.7524, Arg_0.7522), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu_3.7521

tril_4.7534 {
  iota.7540 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7541 = s32[31,31]{1,0} broadcast(iota.7540), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.7538 = s32[] constant(4095)
  broadcast.7539 = s32[31,31]{1,0} broadcast(constant.7538), dimensions={}
  add.7542 = s32[31,31]{1,0} add(broadcast.7541, broadcast.7539), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.7543 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7544 = s32[31,31]{1,0} broadcast(iota.7543), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.7545 = pred[31,31]{1,0} compare(add.7542, broadcast.7544), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.7535 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  constant.7536 = pred[] constant(false)
  broadcast.7537 = pred[31,31]{1,0} broadcast(constant.7536), dimensions={}
  ROOT select.7546 = pred[31,31]{1,0} select(compare.7545, Arg_0.7535, broadcast.7537), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril_4.7534

region_294.7547 {
  Arg_0.7548 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/reduce_max"}
  Arg_1.7549 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/reduce_max"}
  ROOT maximum.7550 = f32[] maximum(Arg_0.7548, Arg_1.7549), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_295.7551 {
  Arg_0.7552 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/reduce_sum"}
  Arg_1.7553 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/reduce_sum"}
  ROOT add.7554 = f32[] add(Arg_0.7552, Arg_1.7553), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_296.7555 {
  Arg_0.7556 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/reduce_and"}
  Arg_1.7557 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/reduce_and"}
  ROOT and.7558 = pred[] and(Arg_0.7556, Arg_1.7557), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7559 {
  Arg_0.7560 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7563 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7560), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7564 = pred[1,1]{1,0} reshape(broadcast.7563), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7565 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7564), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7561 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7562 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7566 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7565, Arg_1.7561, Arg_2.7562), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7559

region_297.7567 {
  Arg_0.7568 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_attention_norm/reduce_sum"}
  Arg_1.7569 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_attention_norm/reduce_sum"}
  ROOT add.7570 = f32[] add(Arg_0.7568, Arg_1.7569), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_298.7571 {
  Arg_0.7572 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_ffw_norm/reduce_sum"}
  Arg_1.7573 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_ffw_norm/reduce_sum"}
  ROOT add.7574 = f32[] add(Arg_0.7572, Arg_1.7573), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_299.7575 {
  Arg_0.7576 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_ffw_norm/reduce_sum"}
  Arg_1.7577 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_ffw_norm/reduce_sum"}
  ROOT add.7578 = f32[] add(Arg_0.7576, Arg_1.7577), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_300.7579 {
  Arg_0.7580 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_attention_norm/reduce_sum"}
  Arg_1.7581 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_attention_norm/reduce_sum"}
  ROOT add.7582 = f32[] add(Arg_0.7580, Arg_1.7581), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_301.7583 {
  Arg_0.7584 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/reduce_max"}
  Arg_1.7585 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/reduce_max"}
  ROOT maximum.7586 = f32[] maximum(Arg_0.7584, Arg_1.7585), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_302.7587 {
  Arg_0.7588 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/reduce_sum"}
  Arg_1.7589 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/reduce_sum"}
  ROOT add.7590 = f32[] add(Arg_0.7588, Arg_1.7589), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_303.7591 {
  Arg_0.7592 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/reduce_and"}
  Arg_1.7593 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/reduce_and"}
  ROOT and.7594 = pred[] and(Arg_0.7592, Arg_1.7593), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7595 {
  Arg_0.7596 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7599 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7596), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7600 = pred[1,1]{1,0} reshape(broadcast.7599), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7601 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7600), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7597 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7598 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7602 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7601, Arg_1.7597, Arg_2.7598), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7595

region_304.7603 {
  Arg_0.7604 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_attention_norm/reduce_sum"}
  Arg_1.7605 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_attention_norm/reduce_sum"}
  ROOT add.7606 = f32[] add(Arg_0.7604, Arg_1.7605), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_305.7607 {
  Arg_0.7608 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_ffw_norm/reduce_sum"}
  Arg_1.7609 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_ffw_norm/reduce_sum"}
  ROOT add.7610 = f32[] add(Arg_0.7608, Arg_1.7609), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_306.7611 {
  Arg_0.7612 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_ffw_norm/reduce_sum"}
  Arg_1.7613 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_ffw_norm/reduce_sum"}
  ROOT add.7614 = f32[] add(Arg_0.7612, Arg_1.7613), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_307.7615 {
  Arg_0.7616 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_attention_norm/reduce_sum"}
  Arg_1.7617 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_attention_norm/reduce_sum"}
  ROOT add.7618 = f32[] add(Arg_0.7616, Arg_1.7617), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu_3.7619 {
  iota.7625 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7626 = s32[31,31]{1,0} broadcast(iota.7625), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7623 = s32[] constant(-4096)
  broadcast.7624 = s32[31,31]{1,0} broadcast(constant.7623), dimensions={}
  add.7627 = s32[31,31]{1,0} add(broadcast.7626, broadcast.7624), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.7628 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7629 = s32[31,31]{1,0} broadcast(iota.7628), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.7630 = pred[31,31]{1,0} compare(add.7627, broadcast.7629), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7621 = pred[] constant(false)
  broadcast.7622 = pred[31,31]{1,0} broadcast(constant.7621), dimensions={}
  Arg_0.7620 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7631 = pred[31,31]{1,0} select(compare.7630, broadcast.7622, Arg_0.7620), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu_3.7619

tril_4.7632 {
  iota.7638 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7639 = s32[31,31]{1,0} broadcast(iota.7638), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.7636 = s32[] constant(4095)
  broadcast.7637 = s32[31,31]{1,0} broadcast(constant.7636), dimensions={}
  add.7640 = s32[31,31]{1,0} add(broadcast.7639, broadcast.7637), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.7641 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7642 = s32[31,31]{1,0} broadcast(iota.7641), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.7643 = pred[31,31]{1,0} compare(add.7640, broadcast.7642), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.7633 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  constant.7634 = pred[] constant(false)
  broadcast.7635 = pred[31,31]{1,0} broadcast(constant.7634), dimensions={}
  ROOT select.7644 = pred[31,31]{1,0} select(compare.7643, Arg_0.7633, broadcast.7635), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril_4.7632

region_308.7645 {
  Arg_0.7646 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/reduce_max"}
  Arg_1.7647 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/reduce_max"}
  ROOT maximum.7648 = f32[] maximum(Arg_0.7646, Arg_1.7647), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_309.7649 {
  Arg_0.7650 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/reduce_sum"}
  Arg_1.7651 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/reduce_sum"}
  ROOT add.7652 = f32[] add(Arg_0.7650, Arg_1.7651), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_310.7653 {
  Arg_0.7654 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/reduce_and"}
  Arg_1.7655 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/reduce_and"}
  ROOT and.7656 = pred[] and(Arg_0.7654, Arg_1.7655), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7657 {
  Arg_0.7658 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7661 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7658), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7662 = pred[1,1]{1,0} reshape(broadcast.7661), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7663 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7662), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7659 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7660 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7664 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7663, Arg_1.7659, Arg_2.7660), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7657

region_311.7665 {
  Arg_0.7666 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_attention_norm/reduce_sum"}
  Arg_1.7667 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_attention_norm/reduce_sum"}
  ROOT add.7668 = f32[] add(Arg_0.7666, Arg_1.7667), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_312.7669 {
  Arg_0.7670 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_ffw_norm/reduce_sum"}
  Arg_1.7671 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_ffw_norm/reduce_sum"}
  ROOT add.7672 = f32[] add(Arg_0.7670, Arg_1.7671), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_313.7673 {
  Arg_0.7674 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_ffw_norm/reduce_sum"}
  Arg_1.7675 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_ffw_norm/reduce_sum"}
  ROOT add.7676 = f32[] add(Arg_0.7674, Arg_1.7675), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_314.7677 {
  Arg_0.7678 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_attention_norm/reduce_sum"}
  Arg_1.7679 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_attention_norm/reduce_sum"}
  ROOT add.7680 = f32[] add(Arg_0.7678, Arg_1.7679), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_315.7681 {
  Arg_0.7682 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/reduce_max"}
  Arg_1.7683 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/reduce_max"}
  ROOT maximum.7684 = f32[] maximum(Arg_0.7682, Arg_1.7683), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_316.7685 {
  Arg_0.7686 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/reduce_sum"}
  Arg_1.7687 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/reduce_sum"}
  ROOT add.7688 = f32[] add(Arg_0.7686, Arg_1.7687), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_317.7689 {
  Arg_0.7690 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/reduce_and"}
  Arg_1.7691 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/reduce_and"}
  ROOT and.7692 = pred[] and(Arg_0.7690, Arg_1.7691), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7693 {
  Arg_0.7694 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7697 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7694), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7698 = pred[1,1]{1,0} reshape(broadcast.7697), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7699 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7698), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7695 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7696 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7700 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7699, Arg_1.7695, Arg_2.7696), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7693

region_318.7701 {
  Arg_0.7702 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_attention_norm/reduce_sum"}
  Arg_1.7703 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_attention_norm/reduce_sum"}
  ROOT add.7704 = f32[] add(Arg_0.7702, Arg_1.7703), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_319.7705 {
  Arg_0.7706 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_ffw_norm/reduce_sum"}
  Arg_1.7707 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_ffw_norm/reduce_sum"}
  ROOT add.7708 = f32[] add(Arg_0.7706, Arg_1.7707), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_320.7709 {
  Arg_0.7710 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_ffw_norm/reduce_sum"}
  Arg_1.7711 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_ffw_norm/reduce_sum"}
  ROOT add.7712 = f32[] add(Arg_0.7710, Arg_1.7711), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_321.7713 {
  Arg_0.7714 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_attention_norm/reduce_sum"}
  Arg_1.7715 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_attention_norm/reduce_sum"}
  ROOT add.7716 = f32[] add(Arg_0.7714, Arg_1.7715), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu_3.7717 {
  iota.7723 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7724 = s32[31,31]{1,0} broadcast(iota.7723), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7721 = s32[] constant(-4096)
  broadcast.7722 = s32[31,31]{1,0} broadcast(constant.7721), dimensions={}
  add.7725 = s32[31,31]{1,0} add(broadcast.7724, broadcast.7722), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.7726 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7727 = s32[31,31]{1,0} broadcast(iota.7726), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.7728 = pred[31,31]{1,0} compare(add.7725, broadcast.7727), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7719 = pred[] constant(false)
  broadcast.7720 = pred[31,31]{1,0} broadcast(constant.7719), dimensions={}
  Arg_0.7718 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7729 = pred[31,31]{1,0} select(compare.7728, broadcast.7720, Arg_0.7718), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu_3.7717

tril_4.7730 {
  iota.7736 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7737 = s32[31,31]{1,0} broadcast(iota.7736), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.7734 = s32[] constant(4095)
  broadcast.7735 = s32[31,31]{1,0} broadcast(constant.7734), dimensions={}
  add.7738 = s32[31,31]{1,0} add(broadcast.7737, broadcast.7735), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.7739 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7740 = s32[31,31]{1,0} broadcast(iota.7739), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.7741 = pred[31,31]{1,0} compare(add.7738, broadcast.7740), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.7731 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  constant.7732 = pred[] constant(false)
  broadcast.7733 = pred[31,31]{1,0} broadcast(constant.7732), dimensions={}
  ROOT select.7742 = pred[31,31]{1,0} select(compare.7741, Arg_0.7731, broadcast.7733), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril_4.7730

region_322.7743 {
  Arg_0.7744 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/reduce_max"}
  Arg_1.7745 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/reduce_max"}
  ROOT maximum.7746 = f32[] maximum(Arg_0.7744, Arg_1.7745), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_323.7747 {
  Arg_0.7748 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/reduce_sum"}
  Arg_1.7749 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/reduce_sum"}
  ROOT add.7750 = f32[] add(Arg_0.7748, Arg_1.7749), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_324.7751 {
  Arg_0.7752 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/reduce_and"}
  Arg_1.7753 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/reduce_and"}
  ROOT and.7754 = pred[] and(Arg_0.7752, Arg_1.7753), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7755 {
  Arg_0.7756 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7759 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7756), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7760 = pred[1,1]{1,0} reshape(broadcast.7759), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7761 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7760), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7757 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7758 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7762 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7761, Arg_1.7757, Arg_2.7758), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7755

region_325.7763 {
  Arg_0.7764 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_attention_norm/reduce_sum"}
  Arg_1.7765 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_attention_norm/reduce_sum"}
  ROOT add.7766 = f32[] add(Arg_0.7764, Arg_1.7765), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_326.7767 {
  Arg_0.7768 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_ffw_norm/reduce_sum"}
  Arg_1.7769 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_ffw_norm/reduce_sum"}
  ROOT add.7770 = f32[] add(Arg_0.7768, Arg_1.7769), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_327.7771 {
  Arg_0.7772 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_ffw_norm/reduce_sum"}
  Arg_1.7773 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_ffw_norm/reduce_sum"}
  ROOT add.7774 = f32[] add(Arg_0.7772, Arg_1.7773), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_328.7775 {
  Arg_0.7776 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_attention_norm/reduce_sum"}
  Arg_1.7777 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_attention_norm/reduce_sum"}
  ROOT add.7778 = f32[] add(Arg_0.7776, Arg_1.7777), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_329.7779 {
  Arg_0.7780 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/reduce_max"}
  Arg_1.7781 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/reduce_max"}
  ROOT maximum.7782 = f32[] maximum(Arg_0.7780, Arg_1.7781), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_330.7783 {
  Arg_0.7784 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/reduce_sum"}
  Arg_1.7785 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/reduce_sum"}
  ROOT add.7786 = f32[] add(Arg_0.7784, Arg_1.7785), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_331.7787 {
  Arg_0.7788 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/reduce_and"}
  Arg_1.7789 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/reduce_and"}
  ROOT and.7790 = pred[] and(Arg_0.7788, Arg_1.7789), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7791 {
  Arg_0.7792 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7795 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7792), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7796 = pred[1,1]{1,0} reshape(broadcast.7795), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7797 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7796), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7793 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7794 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7798 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7797, Arg_1.7793, Arg_2.7794), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7791

region_332.7799 {
  Arg_0.7800 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_attention_norm/reduce_sum"}
  Arg_1.7801 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_attention_norm/reduce_sum"}
  ROOT add.7802 = f32[] add(Arg_0.7800, Arg_1.7801), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_333.7803 {
  Arg_0.7804 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_ffw_norm/reduce_sum"}
  Arg_1.7805 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_ffw_norm/reduce_sum"}
  ROOT add.7806 = f32[] add(Arg_0.7804, Arg_1.7805), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_334.7807 {
  Arg_0.7808 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_ffw_norm/reduce_sum"}
  Arg_1.7809 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_ffw_norm/reduce_sum"}
  ROOT add.7810 = f32[] add(Arg_0.7808, Arg_1.7809), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_335.7811 {
  Arg_0.7812 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_attention_norm/reduce_sum"}
  Arg_1.7813 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_attention_norm/reduce_sum"}
  ROOT add.7814 = f32[] add(Arg_0.7812, Arg_1.7813), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu_3.7815 {
  iota.7821 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7822 = s32[31,31]{1,0} broadcast(iota.7821), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7819 = s32[] constant(-4096)
  broadcast.7820 = s32[31,31]{1,0} broadcast(constant.7819), dimensions={}
  add.7823 = s32[31,31]{1,0} add(broadcast.7822, broadcast.7820), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.7824 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7825 = s32[31,31]{1,0} broadcast(iota.7824), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.7826 = pred[31,31]{1,0} compare(add.7823, broadcast.7825), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7817 = pred[] constant(false)
  broadcast.7818 = pred[31,31]{1,0} broadcast(constant.7817), dimensions={}
  Arg_0.7816 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7827 = pred[31,31]{1,0} select(compare.7826, broadcast.7818, Arg_0.7816), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu_3.7815

tril_4.7828 {
  iota.7834 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7835 = s32[31,31]{1,0} broadcast(iota.7834), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.7832 = s32[] constant(4095)
  broadcast.7833 = s32[31,31]{1,0} broadcast(constant.7832), dimensions={}
  add.7836 = s32[31,31]{1,0} add(broadcast.7835, broadcast.7833), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.7837 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7838 = s32[31,31]{1,0} broadcast(iota.7837), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.7839 = pred[31,31]{1,0} compare(add.7836, broadcast.7838), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.7829 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  constant.7830 = pred[] constant(false)
  broadcast.7831 = pred[31,31]{1,0} broadcast(constant.7830), dimensions={}
  ROOT select.7840 = pred[31,31]{1,0} select(compare.7839, Arg_0.7829, broadcast.7831), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril_4.7828

region_336.7841 {
  Arg_0.7842 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/reduce_max"}
  Arg_1.7843 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/reduce_max"}
  ROOT maximum.7844 = f32[] maximum(Arg_0.7842, Arg_1.7843), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_337.7845 {
  Arg_0.7846 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/reduce_sum"}
  Arg_1.7847 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/reduce_sum"}
  ROOT add.7848 = f32[] add(Arg_0.7846, Arg_1.7847), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_338.7849 {
  Arg_0.7850 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/reduce_and"}
  Arg_1.7851 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/reduce_and"}
  ROOT and.7852 = pred[] and(Arg_0.7850, Arg_1.7851), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7853 {
  Arg_0.7854 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7857 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7854), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7858 = pred[1,1]{1,0} reshape(broadcast.7857), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7859 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7858), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7855 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7856 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7860 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7859, Arg_1.7855, Arg_2.7856), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7853

region_339.7861 {
  Arg_0.7862 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_attention_norm/reduce_sum"}
  Arg_1.7863 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_attention_norm/reduce_sum"}
  ROOT add.7864 = f32[] add(Arg_0.7862, Arg_1.7863), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_340.7865 {
  Arg_0.7866 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_ffw_norm/reduce_sum"}
  Arg_1.7867 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_ffw_norm/reduce_sum"}
  ROOT add.7868 = f32[] add(Arg_0.7866, Arg_1.7867), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_341.7869 {
  Arg_0.7870 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_ffw_norm/reduce_sum"}
  Arg_1.7871 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_ffw_norm/reduce_sum"}
  ROOT add.7872 = f32[] add(Arg_0.7870, Arg_1.7871), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_342.7873 {
  Arg_0.7874 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_attention_norm/reduce_sum"}
  Arg_1.7875 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_attention_norm/reduce_sum"}
  ROOT add.7876 = f32[] add(Arg_0.7874, Arg_1.7875), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_343.7877 {
  Arg_0.7878 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/reduce_max"}
  Arg_1.7879 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/reduce_max"}
  ROOT maximum.7880 = f32[] maximum(Arg_0.7878, Arg_1.7879), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_344.7881 {
  Arg_0.7882 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/reduce_sum"}
  Arg_1.7883 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/reduce_sum"}
  ROOT add.7884 = f32[] add(Arg_0.7882, Arg_1.7883), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_345.7885 {
  Arg_0.7886 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/reduce_and"}
  Arg_1.7887 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/reduce_and"}
  ROOT and.7888 = pred[] and(Arg_0.7886, Arg_1.7887), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7889 {
  Arg_0.7890 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7893 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7890), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7894 = pred[1,1]{1,0} reshape(broadcast.7893), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7895 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7894), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7891 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7892 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7896 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7895, Arg_1.7891, Arg_2.7892), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7889

region_346.7897 {
  Arg_0.7898 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_attention_norm/reduce_sum"}
  Arg_1.7899 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_attention_norm/reduce_sum"}
  ROOT add.7900 = f32[] add(Arg_0.7898, Arg_1.7899), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_347.7901 {
  Arg_0.7902 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_ffw_norm/reduce_sum"}
  Arg_1.7903 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_ffw_norm/reduce_sum"}
  ROOT add.7904 = f32[] add(Arg_0.7902, Arg_1.7903), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_348.7905 {
  Arg_0.7906 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_ffw_norm/reduce_sum"}
  Arg_1.7907 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_ffw_norm/reduce_sum"}
  ROOT add.7908 = f32[] add(Arg_0.7906, Arg_1.7907), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_349.7909 {
  Arg_0.7910 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_attention_norm/reduce_sum"}
  Arg_1.7911 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_attention_norm/reduce_sum"}
  ROOT add.7912 = f32[] add(Arg_0.7910, Arg_1.7911), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

triu_3.7913 {
  iota.7919 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7920 = s32[31,31]{1,0} broadcast(iota.7919), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7917 = s32[] constant(-4096)
  broadcast.7918 = s32[31,31]{1,0} broadcast(constant.7917), dimensions={}
  add.7921 = s32[31,31]{1,0} add(broadcast.7920, broadcast.7918), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  iota.7922 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  broadcast.7923 = s32[31,31]{1,0} broadcast(iota.7922), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  compare.7924 = pred[31,31]{1,0} compare(add.7921, broadcast.7923), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
  constant.7915 = pred[] constant(false)
  broadcast.7916 = pred[31,31]{1,0} broadcast(constant.7915), dimensions={}
  Arg_0.7914 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7925 = pred[31,31]{1,0} select(compare.7924, broadcast.7916, Arg_0.7914), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(triu)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1098}
} // triu_3.7913

tril_4.7926 {
  iota.7932 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7933 = s32[31,31]{1,0} broadcast(iota.7932), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  constant.7930 = s32[] constant(4095)
  broadcast.7931 = s32[31,31]{1,0} broadcast(constant.7930), dimensions={}
  add.7934 = s32[31,31]{1,0} add(broadcast.7933, broadcast.7931), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  iota.7935 = s32[31]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  broadcast.7936 = s32[31,31]{1,0} broadcast(iota.7935), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  compare.7937 = pred[31,31]{1,0} compare(add.7934, broadcast.7936), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
  Arg_0.7927 = pred[31,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  constant.7928 = pred[] constant(false)
  broadcast.7929 = pred[31,31]{1,0} broadcast(constant.7928), dimensions={}
  ROOT select.7938 = pred[31,31]{1,0} select(compare.7937, Arg_0.7927, broadcast.7929), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(tril)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1093}
} // tril_4.7926

region_350.7939 {
  Arg_0.7940 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/reduce_max"}
  Arg_1.7941 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/reduce_max"}
  ROOT maximum.7942 = f32[] maximum(Arg_0.7940, Arg_1.7941), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_351.7943 {
  Arg_0.7944 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/reduce_sum"}
  Arg_1.7945 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/reduce_sum"}
  ROOT add.7946 = f32[] add(Arg_0.7944, Arg_1.7945), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_352.7947 {
  Arg_0.7948 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/reduce_and"}
  Arg_1.7949 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/reduce_and"}
  ROOT and.7950 = pred[] and(Arg_0.7948, Arg_1.7949), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7951 {
  Arg_0.7952 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7955 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7952), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7956 = pred[1,1]{1,0} reshape(broadcast.7955), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7957 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7956), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7953 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7954 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7958 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7957, Arg_1.7953, Arg_2.7954), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7951

region_353.7959 {
  Arg_0.7960 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_attention_norm/reduce_sum"}
  Arg_1.7961 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_attention_norm/reduce_sum"}
  ROOT add.7962 = f32[] add(Arg_0.7960, Arg_1.7961), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_354.7963 {
  Arg_0.7964 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_ffw_norm/reduce_sum"}
  Arg_1.7965 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_ffw_norm/reduce_sum"}
  ROOT add.7966 = f32[] add(Arg_0.7964, Arg_1.7965), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_355.7967 {
  Arg_0.7968 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_ffw_norm/reduce_sum"}
  Arg_1.7969 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_ffw_norm/reduce_sum"}
  ROOT add.7970 = f32[] add(Arg_0.7968, Arg_1.7969), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_356.7971 {
  Arg_0.7972 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_attention_norm/reduce_sum"}
  Arg_1.7973 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_attention_norm/reduce_sum"}
  ROOT add.7974 = f32[] add(Arg_0.7972, Arg_1.7973), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_357.7975 {
  Arg_0.7976 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/reduce_max"}
  Arg_1.7977 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/reduce_max"}
  ROOT maximum.7978 = f32[] maximum(Arg_0.7976, Arg_1.7977), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_358.7979 {
  Arg_0.7980 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/reduce_sum"}
  Arg_1.7981 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/reduce_sum"}
  ROOT add.7982 = f32[] add(Arg_0.7980, Arg_1.7981), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_359.7983 {
  Arg_0.7984 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/reduce_and"}
  Arg_1.7985 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/reduce_and"}
  ROOT and.7986 = pred[] and(Arg_0.7984, Arg_1.7985), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

_where_5.7987 {
  Arg_0.7988 = pred[1,1,1,1]{3,2,1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  broadcast.7991 = pred[1,1,1,1]{3,2,1,0} broadcast(Arg_0.7988), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  reshape.7992 = pred[1,1]{1,0} reshape(broadcast.7991), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  broadcast.7993 = pred[1,1,8,256]{3,2,1,0} broadcast(reshape.7992), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
  Arg_1.7989 = f32[1,1,8,256]{3,2,1,0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  Arg_2.7990 = f32[1,1,8,256]{3,2,1,0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/pjit"}
  ROOT select.7994 = f32[1,1,8,256]{3,2,1,0} select(broadcast.7993, Arg_1.7989, Arg_2.7990), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
} // _where_5.7987

region_360.7995 {
  Arg_0.7996 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_attention_norm/reduce_sum"}
  Arg_1.7997 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_attention_norm/reduce_sum"}
  ROOT add.7998 = f32[] add(Arg_0.7996, Arg_1.7997), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_361.7999 {
  Arg_0.8000 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_ffw_norm/reduce_sum"}
  Arg_1.8001 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_ffw_norm/reduce_sum"}
  ROOT add.8002 = f32[] add(Arg_0.8000, Arg_1.8001), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_362.8003 {
  Arg_0.8004 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_ffw_norm/reduce_sum"}
  Arg_1.8005 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_ffw_norm/reduce_sum"}
  ROOT add.8006 = f32[] add(Arg_0.8004, Arg_1.8005), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_363.8007 {
  Arg_0.8008 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/final_normalization/reduce_sum"}
  Arg_1.8009 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/final_normalization/reduce_sum"}
  ROOT add.8010 = f32[] add(Arg_0.8008, Arg_1.8009), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/final_normalization/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
}

region_364.8011 {
  Arg_0.8012 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/reduce_max"}
  Arg_1.8013 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/reduce_max"}
  ROOT maximum.8014 = f32[] maximum(Arg_0.8012, Arg_1.8013), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_365.8015 {
  Arg_0.8016 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/reduce_sum"}
  Arg_1.8017 = f32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/reduce_sum"}
  ROOT add.8018 = f32[] add(Arg_0.8016, Arg_1.8017), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
}

region_366.8019 {
  Arg_0.8020 = f32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/reduce"}
  Arg_2.8022 = f32[] parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/reduce"}
  compare.8024 = pred[] compare(Arg_0.8020, Arg_2.8022), direction=GT, metadata={op_name="/gt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=341}
  compare.8025 = pred[] compare(Arg_0.8020, Arg_0.8020), direction=NE, metadata={op_name="/ne" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=341}
  or.8026 = pred[] or(compare.8024, compare.8025), metadata={op_name="/or" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=341}
  select.8031 = f32[] select(or.8026, Arg_0.8020, Arg_2.8022), metadata={op_name="/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=341}
  compare.8027 = pred[] compare(Arg_0.8020, Arg_2.8022), direction=EQ, metadata={op_name="/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=341}
  Arg_1.8021 = s32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/reduce"}
  Arg_3.8023 = s32[] parameter(3), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/reduce"}
  compare.8028 = pred[] compare(Arg_1.8021, Arg_3.8023), direction=LT, metadata={op_name="/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=341}
  and.8029 = pred[] and(compare.8027, compare.8028), metadata={op_name="/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=341}
  or.8030 = pred[] or(or.8026, and.8029), metadata={op_name="/or" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=341}
  select.8032 = s32[] select(or.8030, Arg_1.8021, Arg_3.8023), metadata={op_name="/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=341}
  ROOT tuple.8033 = (f32[], s32[]) tuple(select.8031, select.8032)
} // region_366.8019

argmax.8034 {
  Arg_0.8035 = f32[1,256000]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/argmax"}
  iota.8038 = s32[256000]{0} iota(), iota_dimension=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=341}
  reshape.8039 = s32[1,256000]{1,0} reshape(iota.8038), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/iota" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=341}
  constant.8037 = f32[] constant(-inf)
  constant.8036 = s32[] constant(0)
  reduce.8040 = (f32[1]{0}, s32[1]{0}) reduce(Arg_0.8035, reshape.8039, constant.8037, constant.8036), dimensions={1}, to_apply=region_366.8019, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/reduce" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=341}
  get-tuple-element.8041 = f32[1]{0} get-tuple-element(reduce.8040), index=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/reduce" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=341}
  ROOT get-tuple-element.8042 = s32[1]{0} get-tuple-element(reduce.8040), index=1, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/reduce" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=341}
} // argmax.8034

_where_6.8043 {
  Arg_0.8044 = pred[1]{0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/pjit"}
  Arg_1.8045 = s32[1]{0} parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/pjit"}
  Arg_2.8046 = s32[1]{0} parameter(2), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/pjit"}
  ROOT select.8047 = s32[1]{0} select(Arg_0.8044, Arg_1.8045, Arg_2.8046), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/jit(_where)/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1132}
}

region_179.8048 {
  arg_tuple.8049 = (s32[1,31]{1,0}, f32[1,26,2,31,4,256]{5,4,3,2,1,0}, s32[], s32[], pred[1,31]{1,0}, /*index=5*/s32[], f32[256000,2304]{1,0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=10*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=15*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=20*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=25*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=30*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=35*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=40*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=45*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=50*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=55*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=60*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=65*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=70*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=75*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=80*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=85*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=90*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=95*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=100*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=105*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=110*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=115*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=120*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=125*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=130*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=135*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=140*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=145*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=150*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=155*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=160*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=165*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=170*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=175*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=180*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=185*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=190*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=195*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=200*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=205*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=210*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=215*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=220*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=225*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=230*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=235*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=240*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=245*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=250*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=255*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=260*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=265*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=270*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=275*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=280*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=285*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=290*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}) parameter(0)
  get-tuple-element.8050 = s32[1,31]{1,0} get-tuple-element(arg_tuple.8049), index=0
  get-tuple-element.8054 = pred[1,31]{1,0} get-tuple-element(arg_tuple.8049), index=4
  constant.8391 = s32[] constant(0)
  get-tuple-element.8052 = s32[] get-tuple-element(arg_tuple.8049), index=2
  compare.13884 = pred[] compare(get-tuple-element.8052, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/samplers/sampler.py" source_line=111}
  constant.8390 = s32[] constant(31)
  add.13885 = s32[] add(get-tuple-element.8052, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/samplers/sampler.py" source_line=111}
  select.13886 = s32[] select(compare.13884, add.13885, get-tuple-element.8052), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/samplers/sampler.py" source_line=111}
  dynamic-slice.13887 = pred[1,1]{1,0} dynamic-slice(get-tuple-element.8054, constant.8391, select.13886), dynamic_slice_sizes={1,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/dynamic_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/samplers/sampler.py" source_line=111}
  reshape.13888 = pred[1]{0} reshape(dynamic-slice.13887), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/samplers/sampler.py" source_line=111}
  compare.13889 = pred[] compare(get-tuple-element.8052, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/samplers/sampler.py" source_line=111}
  add.13890 = s32[] add(get-tuple-element.8052, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/samplers/sampler.py" source_line=111}
  select.13891 = s32[] select(compare.13889, add.13890, get-tuple-element.8052), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/samplers/sampler.py" source_line=111}
  dynamic-slice.13892 = s32[1,1]{1,0} dynamic-slice(get-tuple-element.8050, constant.8391, select.13891), dynamic_slice_sizes={1,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/dynamic_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/samplers/sampler.py" source_line=111}
  reshape.13893 = s32[1]{0} reshape(dynamic-slice.13892), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/samplers/sampler.py" source_line=111}
  get-tuple-element.8056 = f32[256000,2304]{1,0} get-tuple-element(arg_tuple.8049), index=6
  constant.8392 = s32[] constant(1)
  subtract.8393 = s32[] subtract(get-tuple-element.8052, constant.8392), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=258}
  compare.8394 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  add.8395 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  select.8396 = s32[] select(compare.8394, add.8395, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  dynamic-slice.8397 = s32[1,1]{1,0} dynamic-slice(get-tuple-element.8050, constant.8391, select.8396), dynamic_slice_sizes={1,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/dynamic_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  call.8398 = f32[1,1,2304]{2,1,0} call(get-tuple-element.8056, dynamic-slice.8397), to_apply=_take_1.6712
  constant.8388 = f32[] constant(48)
  broadcast.8389 = f32[1,1,2304]{2,1,0} broadcast(constant.8388), dimensions={}
  multiply.8399 = f32[1,1,2304]{2,1,0} multiply(call.8398, broadcast.8389), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=200}
  convert.8416 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.8417 = f32[1,1]{1,0} reshape(convert.8416), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.8418 = f32[1,1]{1,0} broadcast(reshape.8417), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.8419 = f32[1]{0} reshape(broadcast.8418), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.8420 = f32[1,31]{1,0} broadcast(reshape.8419), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  constant.8381 = f32[1,31]{1,0} constant({...})
  compare.8421 = pred[1,31]{1,0} compare(broadcast.8420, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.8422 = pred[1,1,31]{2,1,0} reshape(compare.8421), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.8550 = s32[1,1,31]{2,1,0} convert(reshape.8422), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  constant.8360 = s32[] constant(0)
  broadcast.8361 = s32[1,1,31]{2,1,0} broadcast(constant.8360), dimensions={}
  compare.8551 = pred[1,1,31]{2,1,0} compare(convert.8550, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  constant.8359 = pred[] constant(true)
  reduce.8552 = pred[1,1]{1,0} reduce(compare.8551, constant.8359), dimensions={2}, to_apply=region_184.6771, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.8553 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.8552), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  constant.8357 = f32[] constant(0)
  broadcast.8358 = f32[1,1,8,256]{3,2,1,0} broadcast(constant.8357), dimensions={}
  get-tuple-element.8051 = f32[1,26,2,31,4,256]{5,4,3,2,1,0} get-tuple-element(arg_tuple.8049), index=1
  slice.8400 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [0:1], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.8401 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.8400), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.8460 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.8401), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.8461 = f32[1,31,4,256]{3,2,1,0} reshape(slice.8460), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  constant.8384 = f32[1,1,1]{2,1,0} constant({ { {1} } })
  multiply.8402 = f32[1,1,2304]{2,1,0} multiply(multiply.8399, multiply.8399), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  constant.8387 = f32[] constant(0)
  reduce.8403 = f32[1,1]{1,0} reduce(multiply.8402, constant.8387), dimensions={2}, to_apply=region_181.6733, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.8404 = f32[1,1,1]{2,1,0} reshape(reduce.8403), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  constant.8386 = f32[1,1,1]{2,1,0} constant({ { {2304} } })
  divide.8405 = f32[1,1,1]{2,1,0} divide(reshape.8404, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  constant.8385 = f32[1,1,1]{2,1,0} constant({ { {1e-06} } })
  add.8406 = f32[1,1,1]{2,1,0} add(divide.8405, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.8407 = f32[1,1,1]{2,1,0} sqrt(add.8406), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.8408 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.8407), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.8409 = f32[1,1,1]{2,1,0} broadcast(divide.8408), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.8410 = f32[1,1]{1,0} reshape(broadcast.8409), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.8411 = f32[1,1,2304]{2,1,0} broadcast(reshape.8410), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.8412 = f32[1,1,2304]{2,1,0} multiply(multiply.8399, broadcast.8411), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8057 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=7
  constant.8382 = f32[] constant(1)
  broadcast.8383 = f32[2304]{0} broadcast(constant.8382), dimensions={}
  add.8413 = f32[2304]{0} add(get-tuple-element.8057, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.8414 = f32[1,1,2304]{2,1,0} reshape(add.8413), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.8415 = f32[1,1,2304]{2,1,0} multiply(multiply.8412, reshape.8414), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8060 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=10
  dot.8497 = f32[1,1,4,256]{3,2,1,0} dot(multiply.8415, get-tuple-element.8060), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.8502 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.8503 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.8504 = s32[] select(compare.8502, add.8503, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.8505 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.8461, dot.8497, constant.8391, select.8504, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.8458 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.8401), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.8459 = f32[1,31,4,256]{3,2,1,0} reshape(slice.8458), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8059 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=9
  dot.8462 = f32[1,1,4,256]{3,2,1,0} dot(multiply.8415, get-tuple-element.8059), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.8465 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.8466 = f32[1]{0} reshape(convert.8465), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  constant.8375 = f32[1]{0} constant({1})
  divide.8467 = f32[1]{0} divide(reshape.8466, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  constant.8376 = f32[] constant(1)
  broadcast.8377 = f32[128]{0} broadcast(constant.8376), dimensions={}
  constant.8379 = f32[] constant(10000)
  broadcast.8380 = f32[128]{0} broadcast(constant.8379), dimensions={}
  constant.8378 = f32[128]{0} constant({...})
  power.8463 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.8464 = f32[128]{0} divide(broadcast.8377, power.8463), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.8468 = f32[1,128]{1,0} dot(divide.8467, divide.8464), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.8469 = f32[1,1,128]{2,1,0} reshape(dot.8468), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8470 = f32[1,1,128]{2,1,0} reshape(dot.8468), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8471 = f32[1,2,128]{2,1,0} concatenate(reshape.8469, reshape.8470), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8472 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.8471), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.8473 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.8472), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.8482 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.8473), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.8483 = f32[1,1,256]{2,1,0} reshape(broadcast.8482), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.8484 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.8483), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.8485 = f32[1,1,4,256]{3,2,1,0} multiply(dot.8462, broadcast.8484), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.8476 = f32[1,1,4,128]{3,2,1,0} slice(dot.8462), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.8477 = f32[1,1,4,128]{3,2,1,0} negate(slice.8476), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.8478 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.8477), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.8475 = f32[1,1,4,128]{3,2,1,0} slice(dot.8462), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.8479 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.8475), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8480 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.8478, reshape.8479), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8481 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.8480), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.8474 = f32[1,1,1,256]{3,2,1,0} sine(reshape.8472), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.8486 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.8474), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.8487 = f32[1,1,256]{2,1,0} reshape(broadcast.8486), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.8488 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.8487), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.8489 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.8481, broadcast.8488), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.8490 = f32[1,1,4,256]{3,2,1,0} add(multiply.8485, multiply.8489), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.8491 = f32[1,1,4,128]{3,2,1,0} slice(add.8490), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.8493 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.8491), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.8492 = f32[1,1,4,128]{3,2,1,0} slice(add.8490), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.8494 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.8492), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8495 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.8493, reshape.8494), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8496 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.8495), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.8498 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.8499 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.8500 = s32[] select(compare.8498, add.8499, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.8501 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.8459, reshape.8496, constant.8391, select.8500, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8058 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=8
  dot.8423 = f32[1,1,8,256]{3,2,1,0} dot(multiply.8415, get-tuple-element.8058), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.8426 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.8427 = f32[1]{0} reshape(convert.8426), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.8428 = f32[1]{0} divide(reshape.8427, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.8424 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.8425 = f32[128]{0} divide(broadcast.8377, power.8424), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.8429 = f32[1,128]{1,0} dot(divide.8428, divide.8425), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.8430 = f32[1,1,128]{2,1,0} reshape(dot.8429), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8431 = f32[1,1,128]{2,1,0} reshape(dot.8429), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8432 = f32[1,2,128]{2,1,0} concatenate(reshape.8430, reshape.8431), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8433 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.8432), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.8434 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.8433), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.8443 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.8434), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.8444 = f32[1,1,256]{2,1,0} reshape(broadcast.8443), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.8445 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.8444), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.8446 = f32[1,1,8,256]{3,2,1,0} multiply(dot.8423, broadcast.8445), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.8437 = f32[1,1,8,128]{3,2,1,0} slice(dot.8423), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.8438 = f32[1,1,8,128]{3,2,1,0} negate(slice.8437), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.8439 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.8438), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.8436 = f32[1,1,8,128]{3,2,1,0} slice(dot.8423), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.8440 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.8436), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8441 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.8439, reshape.8440), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8442 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.8441), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.8435 = f32[1,1,1,256]{3,2,1,0} sine(reshape.8433), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.8447 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.8435), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.8448 = f32[1,1,256]{2,1,0} reshape(broadcast.8447), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.8449 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.8448), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.8450 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.8442, broadcast.8449), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.8451 = f32[1,1,8,256]{3,2,1,0} add(multiply.8446, multiply.8450), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/rotary_embedding/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.8452 = f32[1,1,8,128]{3,2,1,0} slice(add.8451), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.8454 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.8452), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.8453 = f32[1,1,8,128]{3,2,1,0} slice(add.8451), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.8455 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.8453), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8456 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.8454, reshape.8455), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8457 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.8456), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  constant.8373 = f32[] constant(0.0625)
  broadcast.8374 = f32[1,1,8,256]{3,2,1,0} broadcast(constant.8373), dimensions={}
  multiply.8509 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.8457, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.8510 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.8509), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.8511 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.8501, reshape.8510), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.8512 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.8511), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  constant.8371 = f32[] constant(50)
  broadcast.8372 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(constant.8371), dimensions={}
  divide.8513 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.8512, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.8514 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.8513), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.8515 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.8514, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  constant.8367 = f32[] constant(1)
  broadcast.8368 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(constant.8367), dimensions={}
  constant.8369 = pred[] constant(true)
  broadcast.8370 = pred[31,31]{1,0} broadcast(constant.8369), dimensions={}
  call.8516 = pred[31,31]{1,0} call(broadcast.8370), to_apply=triu_3.6737
  call.8517 = pred[31,31]{1,0} call(broadcast.8370), to_apply=tril_4.6750
  and.8518 = pred[31,31]{1,0} and(call.8516, call.8517), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  compare.8519 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  add.8520 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  select.8521 = s32[] select(compare.8519, add.8520, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  dynamic-slice.8522 = pred[1,31]{1,0} dynamic-slice(and.8518, select.8521, constant.8391), dynamic_slice_sizes={1,31}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/dynamic_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  reshape.8523 = pred[1,1,31]{2,1,0} reshape(dynamic-slice.8522), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.8524 = pred[1,1,31]{2,1,0} and(reshape.8422, reshape.8523), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.8525 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(and.8524), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.8526 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.8525), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.8527 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.8526), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  constant.8365 = f32[] constant(-1e+09)
  broadcast.8366 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(constant.8365), dimensions={}
  multiply.8528 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.8527, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.8529 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.8528), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.8530 = f32[1,1,31]{2,1,0} reshape(broadcast.8529), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.8531 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.8530), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.8532 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.8515, broadcast.8531), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  constant.8364 = f32[] constant(-inf)
  reduce.8533 = f32[1,4,2,1]{3,2,1,0} reduce(add.8532, constant.8364), dimensions={4}, to_apply=region_182.6763, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  constant.8362 = f32[] constant(-inf)
  broadcast.8363 = f32[1,4,2,1]{3,2,1,0} broadcast(constant.8362), dimensions={}
  maximum.8534 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.8533, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.8535 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.8534), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.8536 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.8535), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.8537 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.8536), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.8538 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.8537), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.8539 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.8532, broadcast.8538), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.8540 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.8539), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.8541 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.8540, constant.8387), dimensions={4}, to_apply=region_183.6767, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.8542 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.8541), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.8543 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.8542), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.8544 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.8543), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.8545 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.8544), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.8546 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.8540, broadcast.8545), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/softmax/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.8547 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.8505, divide.8546), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.8548 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.8547), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.8549 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.8548), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.8554 = f32[1,1,8,256]{3,2,1,0} call(reshape.8553, broadcast.8358, reshape.8549), to_apply=_where_5.6775
  get-tuple-element.8061 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=11
  dot.8555 = f32[1,1,2304]{2,1,0} dot(call.8554, get-tuple-element.8061), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.8556 = f32[1,1,2304]{2,1,0} multiply(dot.8555, dot.8555), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.8557 = f32[1,1]{1,0} reduce(multiply.8556, constant.8387), dimensions={2}, to_apply=region_185.6783, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.8558 = f32[1,1,1]{2,1,0} reshape(reduce.8557), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.8559 = f32[1,1,1]{2,1,0} divide(reshape.8558, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.8560 = f32[1,1,1]{2,1,0} add(divide.8559, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.8561 = f32[1,1,1]{2,1,0} sqrt(add.8560), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.8562 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.8561), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.8563 = f32[1,1,1]{2,1,0} broadcast(divide.8562), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.8564 = f32[1,1]{1,0} reshape(broadcast.8563), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.8565 = f32[1,1,2304]{2,1,0} broadcast(reshape.8564), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.8566 = f32[1,1,2304]{2,1,0} multiply(dot.8555, broadcast.8565), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8062 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=12
  add.8567 = f32[2304]{0} add(get-tuple-element.8062, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.8568 = f32[1,1,2304]{2,1,0} reshape(add.8567), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.8569 = f32[1,1,2304]{2,1,0} multiply(multiply.8566, reshape.8568), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.8570 = f32[1,1,2304]{2,1,0} add(multiply.8399, multiply.8569), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.8571 = f32[1,1,2304]{2,1,0} multiply(add.8570, add.8570), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.8572 = f32[1,1]{1,0} reduce(multiply.8571, constant.8387), dimensions={2}, to_apply=region_186.6787, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.8573 = f32[1,1,1]{2,1,0} reshape(reduce.8572), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.8574 = f32[1,1,1]{2,1,0} divide(reshape.8573, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.8575 = f32[1,1,1]{2,1,0} add(divide.8574, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.8576 = f32[1,1,1]{2,1,0} sqrt(add.8575), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.8577 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.8576), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.8578 = f32[1,1,1]{2,1,0} broadcast(divide.8577), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.8579 = f32[1,1]{1,0} reshape(broadcast.8578), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.8580 = f32[1,1,2304]{2,1,0} broadcast(reshape.8579), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.8581 = f32[1,1,2304]{2,1,0} multiply(add.8570, broadcast.8580), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8063 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=13
  add.8582 = f32[2304]{0} add(get-tuple-element.8063, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.8583 = f32[1,1,2304]{2,1,0} reshape(add.8582), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.8584 = f32[1,1,2304]{2,1,0} multiply(multiply.8581, reshape.8583), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8064 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=14
  dot.8585 = f32[1,1,9216]{2,1,0} dot(multiply.8584, get-tuple-element.8064), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.8587 = f32[1,1,9216]{2,1,0} multiply(dot.8585, dot.8585), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.8588 = f32[1,1,9216]{2,1,0} multiply(multiply.8587, dot.8585), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  constant.8355 = f32[] constant(0.044715)
  broadcast.8356 = f32[1,1,9216]{2,1,0} broadcast(constant.8355), dimensions={}
  multiply.8589 = f32[1,1,9216]{2,1,0} multiply(multiply.8588, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.8590 = f32[1,1,9216]{2,1,0} add(dot.8585, multiply.8589), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  constant.8353 = f32[] constant(0.797884583)
  broadcast.8354 = f32[1,1,9216]{2,1,0} broadcast(constant.8353), dimensions={}
  multiply.8591 = f32[1,1,9216]{2,1,0} multiply(add.8590, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.8592 = f32[1,1,9216]{2,1,0} tanh(multiply.8591), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  constant.8351 = f32[] constant(1)
  broadcast.8352 = f32[1,1,9216]{2,1,0} broadcast(constant.8351), dimensions={}
  add.8593 = f32[1,1,9216]{2,1,0} add(tanh.8592, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  constant.8349 = f32[] constant(0.5)
  broadcast.8350 = f32[1,1,9216]{2,1,0} broadcast(constant.8349), dimensions={}
  multiply.8594 = f32[1,1,9216]{2,1,0} multiply(add.8593, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.8595 = f32[1,1,9216]{2,1,0} multiply(dot.8585, multiply.8594), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8065 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=15
  dot.8586 = f32[1,1,9216]{2,1,0} dot(multiply.8584, get-tuple-element.8065), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.8596 = f32[1,1,9216]{2,1,0} multiply(multiply.8595, dot.8586), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8066 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=16
  dot.8597 = f32[1,1,2304]{2,1,0} dot(multiply.8596, get-tuple-element.8066), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.8598 = f32[1,1,2304]{2,1,0} multiply(dot.8597, dot.8597), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.8599 = f32[1,1]{1,0} reduce(multiply.8598, constant.8387), dimensions={2}, to_apply=region_187.6791, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.8600 = f32[1,1,1]{2,1,0} reshape(reduce.8599), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.8601 = f32[1,1,1]{2,1,0} divide(reshape.8600, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.8602 = f32[1,1,1]{2,1,0} add(divide.8601, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.8603 = f32[1,1,1]{2,1,0} sqrt(add.8602), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.8604 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.8603), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.8605 = f32[1,1,1]{2,1,0} broadcast(divide.8604), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.8606 = f32[1,1]{1,0} reshape(broadcast.8605), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.8607 = f32[1,1,2304]{2,1,0} broadcast(reshape.8606), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.8608 = f32[1,1,2304]{2,1,0} multiply(dot.8597, broadcast.8607), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8067 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=17
  add.8609 = f32[2304]{0} add(get-tuple-element.8067, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.8610 = f32[1,1,2304]{2,1,0} reshape(add.8609), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.8611 = f32[1,1,2304]{2,1,0} multiply(multiply.8608, reshape.8610), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.8612 = f32[1,1,2304]{2,1,0} add(multiply.8611, add.8570), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.8629 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.8630 = f32[1,1]{1,0} reshape(convert.8629), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.8631 = f32[1,1]{1,0} broadcast(reshape.8630), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.8632 = f32[1]{0} reshape(broadcast.8631), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.8633 = f32[1,31]{1,0} broadcast(reshape.8632), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.8634 = pred[1,31]{1,0} compare(broadcast.8633, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.8635 = pred[1,1,31]{2,1,0} reshape(compare.8634), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.8754 = s32[1,1,31]{2,1,0} convert(reshape.8635), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.8755 = pred[1,1,31]{2,1,0} compare(convert.8754, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.8756 = pred[1,1]{1,0} reduce(compare.8755, constant.8359), dimensions={2}, to_apply=region_191.6807, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.8757 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.8756), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.8613 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [1:2], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.8614 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.8613), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.8673 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.8614), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.8674 = f32[1,31,4,256]{3,2,1,0} reshape(slice.8673), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.8615 = f32[1,1,2304]{2,1,0} multiply(add.8612, add.8612), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.8616 = f32[1,1]{1,0} reduce(multiply.8615, constant.8387), dimensions={2}, to_apply=region_188.6795, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.8617 = f32[1,1,1]{2,1,0} reshape(reduce.8616), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.8618 = f32[1,1,1]{2,1,0} divide(reshape.8617, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.8619 = f32[1,1,1]{2,1,0} add(divide.8618, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.8620 = f32[1,1,1]{2,1,0} sqrt(add.8619), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.8621 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.8620), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.8622 = f32[1,1,1]{2,1,0} broadcast(divide.8621), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.8623 = f32[1,1]{1,0} reshape(broadcast.8622), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.8624 = f32[1,1,2304]{2,1,0} broadcast(reshape.8623), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.8625 = f32[1,1,2304]{2,1,0} multiply(add.8612, broadcast.8624), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8068 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=18
  add.8626 = f32[2304]{0} add(get-tuple-element.8068, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.8627 = f32[1,1,2304]{2,1,0} reshape(add.8626), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.8628 = f32[1,1,2304]{2,1,0} multiply(multiply.8625, reshape.8627), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8071 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=21
  dot.8710 = f32[1,1,4,256]{3,2,1,0} dot(multiply.8628, get-tuple-element.8071), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.8715 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.8716 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.8717 = s32[] select(compare.8715, add.8716, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.8718 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.8674, dot.8710, constant.8391, select.8717, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.8671 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.8614), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.8672 = f32[1,31,4,256]{3,2,1,0} reshape(slice.8671), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8070 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=20
  dot.8675 = f32[1,1,4,256]{3,2,1,0} dot(multiply.8628, get-tuple-element.8070), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.8678 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.8679 = f32[1]{0} reshape(convert.8678), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.8680 = f32[1]{0} divide(reshape.8679, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.8676 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.8677 = f32[128]{0} divide(broadcast.8377, power.8676), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.8681 = f32[1,128]{1,0} dot(divide.8680, divide.8677), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.8682 = f32[1,1,128]{2,1,0} reshape(dot.8681), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8683 = f32[1,1,128]{2,1,0} reshape(dot.8681), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8684 = f32[1,2,128]{2,1,0} concatenate(reshape.8682, reshape.8683), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8685 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.8684), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.8686 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.8685), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.8695 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.8686), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.8696 = f32[1,1,256]{2,1,0} reshape(broadcast.8695), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.8697 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.8696), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.8698 = f32[1,1,4,256]{3,2,1,0} multiply(dot.8675, broadcast.8697), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.8689 = f32[1,1,4,128]{3,2,1,0} slice(dot.8675), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.8690 = f32[1,1,4,128]{3,2,1,0} negate(slice.8689), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.8691 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.8690), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.8688 = f32[1,1,4,128]{3,2,1,0} slice(dot.8675), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.8692 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.8688), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8693 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.8691, reshape.8692), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8694 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.8693), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.8687 = f32[1,1,1,256]{3,2,1,0} sine(reshape.8685), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.8699 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.8687), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.8700 = f32[1,1,256]{2,1,0} reshape(broadcast.8699), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.8701 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.8700), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.8702 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.8694, broadcast.8701), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.8703 = f32[1,1,4,256]{3,2,1,0} add(multiply.8698, multiply.8702), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.8704 = f32[1,1,4,128]{3,2,1,0} slice(add.8703), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.8706 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.8704), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.8705 = f32[1,1,4,128]{3,2,1,0} slice(add.8703), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.8707 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.8705), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8708 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.8706, reshape.8707), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8709 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.8708), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.8711 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.8712 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.8713 = s32[] select(compare.8711, add.8712, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.8714 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.8672, reshape.8709, constant.8391, select.8713, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8069 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=19
  dot.8636 = f32[1,1,8,256]{3,2,1,0} dot(multiply.8628, get-tuple-element.8069), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.8639 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.8640 = f32[1]{0} reshape(convert.8639), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.8641 = f32[1]{0} divide(reshape.8640, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.8637 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.8638 = f32[128]{0} divide(broadcast.8377, power.8637), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.8642 = f32[1,128]{1,0} dot(divide.8641, divide.8638), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.8643 = f32[1,1,128]{2,1,0} reshape(dot.8642), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8644 = f32[1,1,128]{2,1,0} reshape(dot.8642), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8645 = f32[1,2,128]{2,1,0} concatenate(reshape.8643, reshape.8644), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8646 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.8645), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.8647 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.8646), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.8656 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.8647), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.8657 = f32[1,1,256]{2,1,0} reshape(broadcast.8656), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.8658 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.8657), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.8659 = f32[1,1,8,256]{3,2,1,0} multiply(dot.8636, broadcast.8658), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.8650 = f32[1,1,8,128]{3,2,1,0} slice(dot.8636), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.8651 = f32[1,1,8,128]{3,2,1,0} negate(slice.8650), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.8652 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.8651), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.8649 = f32[1,1,8,128]{3,2,1,0} slice(dot.8636), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.8653 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.8649), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8654 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.8652, reshape.8653), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8655 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.8654), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.8648 = f32[1,1,1,256]{3,2,1,0} sine(reshape.8646), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.8660 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.8648), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.8661 = f32[1,1,256]{2,1,0} reshape(broadcast.8660), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.8662 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.8661), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.8663 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.8655, broadcast.8662), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.8664 = f32[1,1,8,256]{3,2,1,0} add(multiply.8659, multiply.8663), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/rotary_embedding_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.8665 = f32[1,1,8,128]{3,2,1,0} slice(add.8664), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.8667 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.8665), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.8666 = f32[1,1,8,128]{3,2,1,0} slice(add.8664), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.8668 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.8666), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8669 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.8667, reshape.8668), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8670 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.8669), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.8722 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.8670, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.8723 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.8722), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.8724 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.8714, reshape.8723), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.8725 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.8724), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.8726 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.8725, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.8727 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.8726), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.8728 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.8727, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.8729 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(compare.8634), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.8730 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.8729), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.8731 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.8730), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.8732 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.8731, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.8733 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.8732), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.8734 = f32[1,1,31]{2,1,0} reshape(broadcast.8733), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.8735 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.8734), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.8736 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.8728, broadcast.8735), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.8737 = f32[1,4,2,1]{3,2,1,0} reduce(add.8736, constant.8364), dimensions={4}, to_apply=region_189.6799, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.8738 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.8737, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.8739 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.8738), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.8740 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.8739), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.8741 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.8740), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.8742 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.8741), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.8743 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.8736, broadcast.8742), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.8744 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.8743), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.8745 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.8744, constant.8387), dimensions={4}, to_apply=region_190.6803, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.8746 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.8745), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.8747 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.8746), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.8748 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.8747), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.8749 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.8748), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.8750 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.8744, broadcast.8749), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/softmax_1/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.8751 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.8718, divide.8750), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.8752 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.8751), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.8753 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.8752), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.8758 = f32[1,1,8,256]{3,2,1,0} call(reshape.8757, broadcast.8358, reshape.8753), to_apply=_where_5.6811
  get-tuple-element.8072 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=22
  dot.8759 = f32[1,1,2304]{2,1,0} dot(call.8758, get-tuple-element.8072), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.8760 = f32[1,1,2304]{2,1,0} multiply(dot.8759, dot.8759), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.8761 = f32[1,1]{1,0} reduce(multiply.8760, constant.8387), dimensions={2}, to_apply=region_192.6819, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.8762 = f32[1,1,1]{2,1,0} reshape(reduce.8761), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.8763 = f32[1,1,1]{2,1,0} divide(reshape.8762, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.8764 = f32[1,1,1]{2,1,0} add(divide.8763, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.8765 = f32[1,1,1]{2,1,0} sqrt(add.8764), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.8766 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.8765), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.8767 = f32[1,1,1]{2,1,0} broadcast(divide.8766), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.8768 = f32[1,1]{1,0} reshape(broadcast.8767), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.8769 = f32[1,1,2304]{2,1,0} broadcast(reshape.8768), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.8770 = f32[1,1,2304]{2,1,0} multiply(dot.8759, broadcast.8769), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8073 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=23
  add.8771 = f32[2304]{0} add(get-tuple-element.8073, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.8772 = f32[1,1,2304]{2,1,0} reshape(add.8771), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.8773 = f32[1,1,2304]{2,1,0} multiply(multiply.8770, reshape.8772), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.8774 = f32[1,1,2304]{2,1,0} add(add.8612, multiply.8773), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.8775 = f32[1,1,2304]{2,1,0} multiply(add.8774, add.8774), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.8776 = f32[1,1]{1,0} reduce(multiply.8775, constant.8387), dimensions={2}, to_apply=region_193.6823, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.8777 = f32[1,1,1]{2,1,0} reshape(reduce.8776), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.8778 = f32[1,1,1]{2,1,0} divide(reshape.8777, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.8779 = f32[1,1,1]{2,1,0} add(divide.8778, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.8780 = f32[1,1,1]{2,1,0} sqrt(add.8779), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.8781 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.8780), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.8782 = f32[1,1,1]{2,1,0} broadcast(divide.8781), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.8783 = f32[1,1]{1,0} reshape(broadcast.8782), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.8784 = f32[1,1,2304]{2,1,0} broadcast(reshape.8783), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.8785 = f32[1,1,2304]{2,1,0} multiply(add.8774, broadcast.8784), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8074 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=24
  add.8786 = f32[2304]{0} add(get-tuple-element.8074, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.8787 = f32[1,1,2304]{2,1,0} reshape(add.8786), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.8788 = f32[1,1,2304]{2,1,0} multiply(multiply.8785, reshape.8787), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8075 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=25
  dot.8789 = f32[1,1,9216]{2,1,0} dot(multiply.8788, get-tuple-element.8075), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.8791 = f32[1,1,9216]{2,1,0} multiply(dot.8789, dot.8789), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.8792 = f32[1,1,9216]{2,1,0} multiply(multiply.8791, dot.8789), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.8793 = f32[1,1,9216]{2,1,0} multiply(multiply.8792, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.8794 = f32[1,1,9216]{2,1,0} add(dot.8789, multiply.8793), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.8795 = f32[1,1,9216]{2,1,0} multiply(add.8794, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.8796 = f32[1,1,9216]{2,1,0} tanh(multiply.8795), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.8797 = f32[1,1,9216]{2,1,0} add(tanh.8796, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.8798 = f32[1,1,9216]{2,1,0} multiply(add.8797, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.8799 = f32[1,1,9216]{2,1,0} multiply(dot.8789, multiply.8798), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8076 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=26
  dot.8790 = f32[1,1,9216]{2,1,0} dot(multiply.8788, get-tuple-element.8076), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.8800 = f32[1,1,9216]{2,1,0} multiply(multiply.8799, dot.8790), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8077 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=27
  dot.8801 = f32[1,1,2304]{2,1,0} dot(multiply.8800, get-tuple-element.8077), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.8802 = f32[1,1,2304]{2,1,0} multiply(dot.8801, dot.8801), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.8803 = f32[1,1]{1,0} reduce(multiply.8802, constant.8387), dimensions={2}, to_apply=region_194.6827, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.8804 = f32[1,1,1]{2,1,0} reshape(reduce.8803), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.8805 = f32[1,1,1]{2,1,0} divide(reshape.8804, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.8806 = f32[1,1,1]{2,1,0} add(divide.8805, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.8807 = f32[1,1,1]{2,1,0} sqrt(add.8806), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.8808 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.8807), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.8809 = f32[1,1,1]{2,1,0} broadcast(divide.8808), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.8810 = f32[1,1]{1,0} reshape(broadcast.8809), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.8811 = f32[1,1,2304]{2,1,0} broadcast(reshape.8810), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.8812 = f32[1,1,2304]{2,1,0} multiply(dot.8801, broadcast.8811), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8078 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=28
  add.8813 = f32[2304]{0} add(get-tuple-element.8078, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.8814 = f32[1,1,2304]{2,1,0} reshape(add.8813), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.8815 = f32[1,1,2304]{2,1,0} multiply(multiply.8812, reshape.8814), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.8816 = f32[1,1,2304]{2,1,0} add(multiply.8815, add.8774), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.8833 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.8834 = f32[1,1]{1,0} reshape(convert.8833), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.8835 = f32[1,1]{1,0} broadcast(reshape.8834), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.8836 = f32[1]{0} reshape(broadcast.8835), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.8837 = f32[1,31]{1,0} broadcast(reshape.8836), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.8838 = pred[1,31]{1,0} compare(broadcast.8837, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.8839 = pred[1,1,31]{2,1,0} reshape(compare.8838), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.8967 = s32[1,1,31]{2,1,0} convert(reshape.8839), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.8968 = pred[1,1,31]{2,1,0} compare(convert.8967, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.8969 = pred[1,1]{1,0} reduce(compare.8968, constant.8359), dimensions={2}, to_apply=region_198.6869, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.8970 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.8969), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.8817 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [2:3], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.8818 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.8817), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.8877 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.8818), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.8878 = f32[1,31,4,256]{3,2,1,0} reshape(slice.8877), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.8819 = f32[1,1,2304]{2,1,0} multiply(add.8816, add.8816), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.8820 = f32[1,1]{1,0} reduce(multiply.8819, constant.8387), dimensions={2}, to_apply=region_195.6831, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.8821 = f32[1,1,1]{2,1,0} reshape(reduce.8820), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.8822 = f32[1,1,1]{2,1,0} divide(reshape.8821, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.8823 = f32[1,1,1]{2,1,0} add(divide.8822, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.8824 = f32[1,1,1]{2,1,0} sqrt(add.8823), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.8825 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.8824), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.8826 = f32[1,1,1]{2,1,0} broadcast(divide.8825), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.8827 = f32[1,1]{1,0} reshape(broadcast.8826), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.8828 = f32[1,1,2304]{2,1,0} broadcast(reshape.8827), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.8829 = f32[1,1,2304]{2,1,0} multiply(add.8816, broadcast.8828), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8079 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=29
  add.8830 = f32[2304]{0} add(get-tuple-element.8079, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.8831 = f32[1,1,2304]{2,1,0} reshape(add.8830), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.8832 = f32[1,1,2304]{2,1,0} multiply(multiply.8829, reshape.8831), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8082 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=32
  dot.8914 = f32[1,1,4,256]{3,2,1,0} dot(multiply.8832, get-tuple-element.8082), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.8919 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.8920 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.8921 = s32[] select(compare.8919, add.8920, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.8922 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.8878, dot.8914, constant.8391, select.8921, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.8875 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.8818), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.8876 = f32[1,31,4,256]{3,2,1,0} reshape(slice.8875), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8081 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=31
  dot.8879 = f32[1,1,4,256]{3,2,1,0} dot(multiply.8832, get-tuple-element.8081), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.8882 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.8883 = f32[1]{0} reshape(convert.8882), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.8884 = f32[1]{0} divide(reshape.8883, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.8880 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.8881 = f32[128]{0} divide(broadcast.8377, power.8880), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.8885 = f32[1,128]{1,0} dot(divide.8884, divide.8881), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.8886 = f32[1,1,128]{2,1,0} reshape(dot.8885), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8887 = f32[1,1,128]{2,1,0} reshape(dot.8885), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8888 = f32[1,2,128]{2,1,0} concatenate(reshape.8886, reshape.8887), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8889 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.8888), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.8890 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.8889), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.8899 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.8890), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.8900 = f32[1,1,256]{2,1,0} reshape(broadcast.8899), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.8901 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.8900), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.8902 = f32[1,1,4,256]{3,2,1,0} multiply(dot.8879, broadcast.8901), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.8893 = f32[1,1,4,128]{3,2,1,0} slice(dot.8879), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.8894 = f32[1,1,4,128]{3,2,1,0} negate(slice.8893), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.8895 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.8894), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.8892 = f32[1,1,4,128]{3,2,1,0} slice(dot.8879), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.8896 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.8892), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8897 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.8895, reshape.8896), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8898 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.8897), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.8891 = f32[1,1,1,256]{3,2,1,0} sine(reshape.8889), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.8903 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.8891), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.8904 = f32[1,1,256]{2,1,0} reshape(broadcast.8903), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.8905 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.8904), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.8906 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.8898, broadcast.8905), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.8907 = f32[1,1,4,256]{3,2,1,0} add(multiply.8902, multiply.8906), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.8908 = f32[1,1,4,128]{3,2,1,0} slice(add.8907), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.8910 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.8908), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.8909 = f32[1,1,4,128]{3,2,1,0} slice(add.8907), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.8911 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.8909), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8912 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.8910, reshape.8911), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8913 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.8912), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.8915 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.8916 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.8917 = s32[] select(compare.8915, add.8916, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.8918 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.8876, reshape.8913, constant.8391, select.8917, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8080 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=30
  dot.8840 = f32[1,1,8,256]{3,2,1,0} dot(multiply.8832, get-tuple-element.8080), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.8843 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.8844 = f32[1]{0} reshape(convert.8843), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.8845 = f32[1]{0} divide(reshape.8844, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.8841 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.8842 = f32[128]{0} divide(broadcast.8377, power.8841), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.8846 = f32[1,128]{1,0} dot(divide.8845, divide.8842), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.8847 = f32[1,1,128]{2,1,0} reshape(dot.8846), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8848 = f32[1,1,128]{2,1,0} reshape(dot.8846), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8849 = f32[1,2,128]{2,1,0} concatenate(reshape.8847, reshape.8848), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8850 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.8849), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.8851 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.8850), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.8860 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.8851), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.8861 = f32[1,1,256]{2,1,0} reshape(broadcast.8860), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.8862 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.8861), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.8863 = f32[1,1,8,256]{3,2,1,0} multiply(dot.8840, broadcast.8862), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.8854 = f32[1,1,8,128]{3,2,1,0} slice(dot.8840), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.8855 = f32[1,1,8,128]{3,2,1,0} negate(slice.8854), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.8856 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.8855), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.8853 = f32[1,1,8,128]{3,2,1,0} slice(dot.8840), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.8857 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.8853), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8858 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.8856, reshape.8857), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8859 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.8858), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.8852 = f32[1,1,1,256]{3,2,1,0} sine(reshape.8850), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.8864 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.8852), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.8865 = f32[1,1,256]{2,1,0} reshape(broadcast.8864), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.8866 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.8865), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.8867 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.8859, broadcast.8866), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.8868 = f32[1,1,8,256]{3,2,1,0} add(multiply.8863, multiply.8867), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/rotary_embedding_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.8869 = f32[1,1,8,128]{3,2,1,0} slice(add.8868), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.8871 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.8869), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.8870 = f32[1,1,8,128]{3,2,1,0} slice(add.8868), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.8872 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.8870), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8873 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.8871, reshape.8872), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8874 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.8873), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.8926 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.8874, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.8927 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.8926), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.8928 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.8918, reshape.8927), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.8929 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.8928), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.8930 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.8929, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.8931 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.8930), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.8932 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.8931, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.8933 = pred[31,31]{1,0} call(broadcast.8370), to_apply=triu_3.6835
  call.8934 = pred[31,31]{1,0} call(broadcast.8370), to_apply=tril_4.6848
  and.8935 = pred[31,31]{1,0} and(call.8933, call.8934), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  compare.8936 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  add.8937 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  select.8938 = s32[] select(compare.8936, add.8937, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  dynamic-slice.8939 = pred[1,31]{1,0} dynamic-slice(and.8935, select.8938, constant.8391), dynamic_slice_sizes={1,31}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/dynamic_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  reshape.8940 = pred[1,1,31]{2,1,0} reshape(dynamic-slice.8939), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.8941 = pred[1,1,31]{2,1,0} and(reshape.8839, reshape.8940), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.8942 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(and.8941), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.8943 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.8942), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.8944 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.8943), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.8945 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.8944, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.8946 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.8945), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.8947 = f32[1,1,31]{2,1,0} reshape(broadcast.8946), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.8948 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.8947), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.8949 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.8932, broadcast.8948), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.8950 = f32[1,4,2,1]{3,2,1,0} reduce(add.8949, constant.8364), dimensions={4}, to_apply=region_196.6861, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.8951 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.8950, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.8952 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.8951), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.8953 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.8952), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.8954 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.8953), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.8955 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.8954), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.8956 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.8949, broadcast.8955), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.8957 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.8956), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.8958 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.8957, constant.8387), dimensions={4}, to_apply=region_197.6865, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.8959 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.8958), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.8960 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.8959), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.8961 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.8960), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.8962 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.8961), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.8963 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.8957, broadcast.8962), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/softmax_2/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.8964 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.8922, divide.8963), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.8965 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.8964), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.8966 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.8965), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.8971 = f32[1,1,8,256]{3,2,1,0} call(reshape.8970, broadcast.8358, reshape.8966), to_apply=_where_5.6873
  get-tuple-element.8083 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=33
  dot.8972 = f32[1,1,2304]{2,1,0} dot(call.8971, get-tuple-element.8083), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.8973 = f32[1,1,2304]{2,1,0} multiply(dot.8972, dot.8972), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.8974 = f32[1,1]{1,0} reduce(multiply.8973, constant.8387), dimensions={2}, to_apply=region_199.6881, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.8975 = f32[1,1,1]{2,1,0} reshape(reduce.8974), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.8976 = f32[1,1,1]{2,1,0} divide(reshape.8975, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.8977 = f32[1,1,1]{2,1,0} add(divide.8976, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.8978 = f32[1,1,1]{2,1,0} sqrt(add.8977), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.8979 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.8978), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.8980 = f32[1,1,1]{2,1,0} broadcast(divide.8979), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.8981 = f32[1,1]{1,0} reshape(broadcast.8980), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.8982 = f32[1,1,2304]{2,1,0} broadcast(reshape.8981), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.8983 = f32[1,1,2304]{2,1,0} multiply(dot.8972, broadcast.8982), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8084 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=34
  add.8984 = f32[2304]{0} add(get-tuple-element.8084, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.8985 = f32[1,1,2304]{2,1,0} reshape(add.8984), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.8986 = f32[1,1,2304]{2,1,0} multiply(multiply.8983, reshape.8985), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.8987 = f32[1,1,2304]{2,1,0} add(add.8816, multiply.8986), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.8988 = f32[1,1,2304]{2,1,0} multiply(add.8987, add.8987), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.8989 = f32[1,1]{1,0} reduce(multiply.8988, constant.8387), dimensions={2}, to_apply=region_200.6885, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.8990 = f32[1,1,1]{2,1,0} reshape(reduce.8989), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.8991 = f32[1,1,1]{2,1,0} divide(reshape.8990, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.8992 = f32[1,1,1]{2,1,0} add(divide.8991, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.8993 = f32[1,1,1]{2,1,0} sqrt(add.8992), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.8994 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.8993), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.8995 = f32[1,1,1]{2,1,0} broadcast(divide.8994), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.8996 = f32[1,1]{1,0} reshape(broadcast.8995), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.8997 = f32[1,1,2304]{2,1,0} broadcast(reshape.8996), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.8998 = f32[1,1,2304]{2,1,0} multiply(add.8987, broadcast.8997), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8085 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=35
  add.8999 = f32[2304]{0} add(get-tuple-element.8085, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.9000 = f32[1,1,2304]{2,1,0} reshape(add.8999), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.9001 = f32[1,1,2304]{2,1,0} multiply(multiply.8998, reshape.9000), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8086 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=36
  dot.9002 = f32[1,1,9216]{2,1,0} dot(multiply.9001, get-tuple-element.8086), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.9004 = f32[1,1,9216]{2,1,0} multiply(dot.9002, dot.9002), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9005 = f32[1,1,9216]{2,1,0} multiply(multiply.9004, dot.9002), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9006 = f32[1,1,9216]{2,1,0} multiply(multiply.9005, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.9007 = f32[1,1,9216]{2,1,0} add(dot.9002, multiply.9006), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9008 = f32[1,1,9216]{2,1,0} multiply(add.9007, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.9009 = f32[1,1,9216]{2,1,0} tanh(multiply.9008), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.9010 = f32[1,1,9216]{2,1,0} add(tanh.9009, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9011 = f32[1,1,9216]{2,1,0} multiply(add.9010, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9012 = f32[1,1,9216]{2,1,0} multiply(dot.9002, multiply.9011), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8087 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=37
  dot.9003 = f32[1,1,9216]{2,1,0} dot(multiply.9001, get-tuple-element.8087), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.9013 = f32[1,1,9216]{2,1,0} multiply(multiply.9012, dot.9003), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8088 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=38
  dot.9014 = f32[1,1,2304]{2,1,0} dot(multiply.9013, get-tuple-element.8088), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.9015 = f32[1,1,2304]{2,1,0} multiply(dot.9014, dot.9014), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.9016 = f32[1,1]{1,0} reduce(multiply.9015, constant.8387), dimensions={2}, to_apply=region_201.6889, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.9017 = f32[1,1,1]{2,1,0} reshape(reduce.9016), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.9018 = f32[1,1,1]{2,1,0} divide(reshape.9017, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.9019 = f32[1,1,1]{2,1,0} add(divide.9018, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.9020 = f32[1,1,1]{2,1,0} sqrt(add.9019), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.9021 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.9020), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.9022 = f32[1,1,1]{2,1,0} broadcast(divide.9021), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.9023 = f32[1,1]{1,0} reshape(broadcast.9022), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.9024 = f32[1,1,2304]{2,1,0} broadcast(reshape.9023), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.9025 = f32[1,1,2304]{2,1,0} multiply(dot.9014, broadcast.9024), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8089 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=39
  add.9026 = f32[2304]{0} add(get-tuple-element.8089, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.9027 = f32[1,1,2304]{2,1,0} reshape(add.9026), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.9028 = f32[1,1,2304]{2,1,0} multiply(multiply.9025, reshape.9027), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.9029 = f32[1,1,2304]{2,1,0} add(multiply.9028, add.8987), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.9046 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.9047 = f32[1,1]{1,0} reshape(convert.9046), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.9048 = f32[1,1]{1,0} broadcast(reshape.9047), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.9049 = f32[1]{0} reshape(broadcast.9048), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.9050 = f32[1,31]{1,0} broadcast(reshape.9049), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.9051 = pred[1,31]{1,0} compare(broadcast.9050, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.9052 = pred[1,1,31]{2,1,0} reshape(compare.9051), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.9171 = s32[1,1,31]{2,1,0} convert(reshape.9052), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.9172 = pred[1,1,31]{2,1,0} compare(convert.9171, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.9173 = pred[1,1]{1,0} reduce(compare.9172, constant.8359), dimensions={2}, to_apply=region_205.6905, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.9174 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.9173), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.9030 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [3:4], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.9031 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.9030), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.9090 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.9031), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.9091 = f32[1,31,4,256]{3,2,1,0} reshape(slice.9090), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.9032 = f32[1,1,2304]{2,1,0} multiply(add.9029, add.9029), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.9033 = f32[1,1]{1,0} reduce(multiply.9032, constant.8387), dimensions={2}, to_apply=region_202.6893, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.9034 = f32[1,1,1]{2,1,0} reshape(reduce.9033), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.9035 = f32[1,1,1]{2,1,0} divide(reshape.9034, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.9036 = f32[1,1,1]{2,1,0} add(divide.9035, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.9037 = f32[1,1,1]{2,1,0} sqrt(add.9036), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.9038 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.9037), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.9039 = f32[1,1,1]{2,1,0} broadcast(divide.9038), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.9040 = f32[1,1]{1,0} reshape(broadcast.9039), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.9041 = f32[1,1,2304]{2,1,0} broadcast(reshape.9040), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.9042 = f32[1,1,2304]{2,1,0} multiply(add.9029, broadcast.9041), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8090 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=40
  add.9043 = f32[2304]{0} add(get-tuple-element.8090, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.9044 = f32[1,1,2304]{2,1,0} reshape(add.9043), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.9045 = f32[1,1,2304]{2,1,0} multiply(multiply.9042, reshape.9044), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8093 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=43
  dot.9127 = f32[1,1,4,256]{3,2,1,0} dot(multiply.9045, get-tuple-element.8093), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.9132 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.9133 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.9134 = s32[] select(compare.9132, add.9133, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.9135 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.9091, dot.9127, constant.8391, select.9134, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.9088 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.9031), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.9089 = f32[1,31,4,256]{3,2,1,0} reshape(slice.9088), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8092 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=42
  dot.9092 = f32[1,1,4,256]{3,2,1,0} dot(multiply.9045, get-tuple-element.8092), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.9095 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.9096 = f32[1]{0} reshape(convert.9095), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.9097 = f32[1]{0} divide(reshape.9096, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.9093 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.9094 = f32[128]{0} divide(broadcast.8377, power.9093), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.9098 = f32[1,128]{1,0} dot(divide.9097, divide.9094), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.9099 = f32[1,1,128]{2,1,0} reshape(dot.9098), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9100 = f32[1,1,128]{2,1,0} reshape(dot.9098), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9101 = f32[1,2,128]{2,1,0} concatenate(reshape.9099, reshape.9100), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9102 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.9101), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.9103 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.9102), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.9112 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.9103), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9113 = f32[1,1,256]{2,1,0} reshape(broadcast.9112), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9114 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.9113), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9115 = f32[1,1,4,256]{3,2,1,0} multiply(dot.9092, broadcast.9114), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9106 = f32[1,1,4,128]{3,2,1,0} slice(dot.9092), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.9107 = f32[1,1,4,128]{3,2,1,0} negate(slice.9106), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.9108 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.9107), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9105 = f32[1,1,4,128]{3,2,1,0} slice(dot.9092), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9109 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.9105), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9110 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.9108, reshape.9109), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9111 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.9110), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.9104 = f32[1,1,1,256]{3,2,1,0} sine(reshape.9102), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.9116 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.9104), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9117 = f32[1,1,256]{2,1,0} reshape(broadcast.9116), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9118 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.9117), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9119 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.9111, broadcast.9118), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.9120 = f32[1,1,4,256]{3,2,1,0} add(multiply.9115, multiply.9119), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9121 = f32[1,1,4,128]{3,2,1,0} slice(add.9120), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9123 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.9121), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9122 = f32[1,1,4,128]{3,2,1,0} slice(add.9120), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9124 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.9122), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9125 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.9123, reshape.9124), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9126 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.9125), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.9128 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.9129 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.9130 = s32[] select(compare.9128, add.9129, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.9131 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.9089, reshape.9126, constant.8391, select.9130, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8091 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=41
  dot.9053 = f32[1,1,8,256]{3,2,1,0} dot(multiply.9045, get-tuple-element.8091), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.9056 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.9057 = f32[1]{0} reshape(convert.9056), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.9058 = f32[1]{0} divide(reshape.9057, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.9054 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.9055 = f32[128]{0} divide(broadcast.8377, power.9054), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.9059 = f32[1,128]{1,0} dot(divide.9058, divide.9055), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.9060 = f32[1,1,128]{2,1,0} reshape(dot.9059), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9061 = f32[1,1,128]{2,1,0} reshape(dot.9059), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9062 = f32[1,2,128]{2,1,0} concatenate(reshape.9060, reshape.9061), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9063 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.9062), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.9064 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.9063), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.9073 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.9064), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9074 = f32[1,1,256]{2,1,0} reshape(broadcast.9073), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9075 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.9074), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9076 = f32[1,1,8,256]{3,2,1,0} multiply(dot.9053, broadcast.9075), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9067 = f32[1,1,8,128]{3,2,1,0} slice(dot.9053), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.9068 = f32[1,1,8,128]{3,2,1,0} negate(slice.9067), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.9069 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.9068), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9066 = f32[1,1,8,128]{3,2,1,0} slice(dot.9053), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9070 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.9066), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9071 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.9069, reshape.9070), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9072 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.9071), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.9065 = f32[1,1,1,256]{3,2,1,0} sine(reshape.9063), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.9077 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.9065), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9078 = f32[1,1,256]{2,1,0} reshape(broadcast.9077), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9079 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.9078), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9080 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.9072, broadcast.9079), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.9081 = f32[1,1,8,256]{3,2,1,0} add(multiply.9076, multiply.9080), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/rotary_embedding_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9082 = f32[1,1,8,128]{3,2,1,0} slice(add.9081), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9084 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.9082), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9083 = f32[1,1,8,128]{3,2,1,0} slice(add.9081), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9085 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.9083), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9086 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.9084, reshape.9085), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9087 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.9086), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.9139 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.9087, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.9140 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.9139), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.9141 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.9131, reshape.9140), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.9142 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.9141), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.9143 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.9142, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.9144 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.9143), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.9145 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.9144, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.9146 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(compare.9051), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.9147 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.9146), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.9148 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.9147), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.9149 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.9148, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.9150 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.9149), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.9151 = f32[1,1,31]{2,1,0} reshape(broadcast.9150), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.9152 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.9151), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.9153 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.9145, broadcast.9152), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.9154 = f32[1,4,2,1]{3,2,1,0} reduce(add.9153, constant.8364), dimensions={4}, to_apply=region_203.6897, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.9155 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.9154, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9156 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.9155), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.9157 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.9156), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9158 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.9157), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.9159 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.9158), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.9160 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.9153, broadcast.9159), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.9161 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.9160), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.9162 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.9161, constant.8387), dimensions={4}, to_apply=region_204.6901, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9163 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.9162), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.9164 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.9163), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9165 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.9164), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.9166 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.9165), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.9167 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.9161, broadcast.9166), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/softmax_3/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.9168 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.9135, divide.9167), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.9169 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.9168), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.9170 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.9169), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.9175 = f32[1,1,8,256]{3,2,1,0} call(reshape.9174, broadcast.8358, reshape.9170), to_apply=_where_5.6909
  get-tuple-element.8094 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=44
  dot.9176 = f32[1,1,2304]{2,1,0} dot(call.9175, get-tuple-element.8094), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.9177 = f32[1,1,2304]{2,1,0} multiply(dot.9176, dot.9176), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.9178 = f32[1,1]{1,0} reduce(multiply.9177, constant.8387), dimensions={2}, to_apply=region_206.6917, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.9179 = f32[1,1,1]{2,1,0} reshape(reduce.9178), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.9180 = f32[1,1,1]{2,1,0} divide(reshape.9179, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.9181 = f32[1,1,1]{2,1,0} add(divide.9180, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.9182 = f32[1,1,1]{2,1,0} sqrt(add.9181), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.9183 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.9182), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.9184 = f32[1,1,1]{2,1,0} broadcast(divide.9183), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.9185 = f32[1,1]{1,0} reshape(broadcast.9184), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.9186 = f32[1,1,2304]{2,1,0} broadcast(reshape.9185), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.9187 = f32[1,1,2304]{2,1,0} multiply(dot.9176, broadcast.9186), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8095 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=45
  add.9188 = f32[2304]{0} add(get-tuple-element.8095, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.9189 = f32[1,1,2304]{2,1,0} reshape(add.9188), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.9190 = f32[1,1,2304]{2,1,0} multiply(multiply.9187, reshape.9189), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.9191 = f32[1,1,2304]{2,1,0} add(add.9029, multiply.9190), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.9192 = f32[1,1,2304]{2,1,0} multiply(add.9191, add.9191), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.9193 = f32[1,1]{1,0} reduce(multiply.9192, constant.8387), dimensions={2}, to_apply=region_207.6921, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.9194 = f32[1,1,1]{2,1,0} reshape(reduce.9193), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.9195 = f32[1,1,1]{2,1,0} divide(reshape.9194, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.9196 = f32[1,1,1]{2,1,0} add(divide.9195, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.9197 = f32[1,1,1]{2,1,0} sqrt(add.9196), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.9198 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.9197), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.9199 = f32[1,1,1]{2,1,0} broadcast(divide.9198), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.9200 = f32[1,1]{1,0} reshape(broadcast.9199), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.9201 = f32[1,1,2304]{2,1,0} broadcast(reshape.9200), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.9202 = f32[1,1,2304]{2,1,0} multiply(add.9191, broadcast.9201), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8096 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=46
  add.9203 = f32[2304]{0} add(get-tuple-element.8096, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.9204 = f32[1,1,2304]{2,1,0} reshape(add.9203), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.9205 = f32[1,1,2304]{2,1,0} multiply(multiply.9202, reshape.9204), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8097 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=47
  dot.9206 = f32[1,1,9216]{2,1,0} dot(multiply.9205, get-tuple-element.8097), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.9208 = f32[1,1,9216]{2,1,0} multiply(dot.9206, dot.9206), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9209 = f32[1,1,9216]{2,1,0} multiply(multiply.9208, dot.9206), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9210 = f32[1,1,9216]{2,1,0} multiply(multiply.9209, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.9211 = f32[1,1,9216]{2,1,0} add(dot.9206, multiply.9210), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9212 = f32[1,1,9216]{2,1,0} multiply(add.9211, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.9213 = f32[1,1,9216]{2,1,0} tanh(multiply.9212), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.9214 = f32[1,1,9216]{2,1,0} add(tanh.9213, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9215 = f32[1,1,9216]{2,1,0} multiply(add.9214, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9216 = f32[1,1,9216]{2,1,0} multiply(dot.9206, multiply.9215), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8098 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=48
  dot.9207 = f32[1,1,9216]{2,1,0} dot(multiply.9205, get-tuple-element.8098), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.9217 = f32[1,1,9216]{2,1,0} multiply(multiply.9216, dot.9207), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8099 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=49
  dot.9218 = f32[1,1,2304]{2,1,0} dot(multiply.9217, get-tuple-element.8099), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.9219 = f32[1,1,2304]{2,1,0} multiply(dot.9218, dot.9218), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.9220 = f32[1,1]{1,0} reduce(multiply.9219, constant.8387), dimensions={2}, to_apply=region_208.6925, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.9221 = f32[1,1,1]{2,1,0} reshape(reduce.9220), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.9222 = f32[1,1,1]{2,1,0} divide(reshape.9221, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.9223 = f32[1,1,1]{2,1,0} add(divide.9222, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.9224 = f32[1,1,1]{2,1,0} sqrt(add.9223), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.9225 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.9224), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.9226 = f32[1,1,1]{2,1,0} broadcast(divide.9225), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.9227 = f32[1,1]{1,0} reshape(broadcast.9226), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.9228 = f32[1,1,2304]{2,1,0} broadcast(reshape.9227), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.9229 = f32[1,1,2304]{2,1,0} multiply(dot.9218, broadcast.9228), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8100 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=50
  add.9230 = f32[2304]{0} add(get-tuple-element.8100, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.9231 = f32[1,1,2304]{2,1,0} reshape(add.9230), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.9232 = f32[1,1,2304]{2,1,0} multiply(multiply.9229, reshape.9231), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.9233 = f32[1,1,2304]{2,1,0} add(multiply.9232, add.9191), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.9250 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.9251 = f32[1,1]{1,0} reshape(convert.9250), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.9252 = f32[1,1]{1,0} broadcast(reshape.9251), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.9253 = f32[1]{0} reshape(broadcast.9252), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.9254 = f32[1,31]{1,0} broadcast(reshape.9253), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.9255 = pred[1,31]{1,0} compare(broadcast.9254, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.9256 = pred[1,1,31]{2,1,0} reshape(compare.9255), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.9384 = s32[1,1,31]{2,1,0} convert(reshape.9256), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.9385 = pred[1,1,31]{2,1,0} compare(convert.9384, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.9386 = pred[1,1]{1,0} reduce(compare.9385, constant.8359), dimensions={2}, to_apply=region_212.6967, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.9387 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.9386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.9234 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [4:5], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.9235 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.9234), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.9294 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.9235), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.9295 = f32[1,31,4,256]{3,2,1,0} reshape(slice.9294), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.9236 = f32[1,1,2304]{2,1,0} multiply(add.9233, add.9233), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.9237 = f32[1,1]{1,0} reduce(multiply.9236, constant.8387), dimensions={2}, to_apply=region_209.6929, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.9238 = f32[1,1,1]{2,1,0} reshape(reduce.9237), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.9239 = f32[1,1,1]{2,1,0} divide(reshape.9238, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.9240 = f32[1,1,1]{2,1,0} add(divide.9239, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.9241 = f32[1,1,1]{2,1,0} sqrt(add.9240), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.9242 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.9241), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.9243 = f32[1,1,1]{2,1,0} broadcast(divide.9242), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.9244 = f32[1,1]{1,0} reshape(broadcast.9243), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.9245 = f32[1,1,2304]{2,1,0} broadcast(reshape.9244), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.9246 = f32[1,1,2304]{2,1,0} multiply(add.9233, broadcast.9245), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8101 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=51
  add.9247 = f32[2304]{0} add(get-tuple-element.8101, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.9248 = f32[1,1,2304]{2,1,0} reshape(add.9247), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.9249 = f32[1,1,2304]{2,1,0} multiply(multiply.9246, reshape.9248), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8104 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=54
  dot.9331 = f32[1,1,4,256]{3,2,1,0} dot(multiply.9249, get-tuple-element.8104), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.9336 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.9337 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.9338 = s32[] select(compare.9336, add.9337, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.9339 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.9295, dot.9331, constant.8391, select.9338, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.9292 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.9235), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.9293 = f32[1,31,4,256]{3,2,1,0} reshape(slice.9292), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8103 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=53
  dot.9296 = f32[1,1,4,256]{3,2,1,0} dot(multiply.9249, get-tuple-element.8103), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.9299 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.9300 = f32[1]{0} reshape(convert.9299), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.9301 = f32[1]{0} divide(reshape.9300, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.9297 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.9298 = f32[128]{0} divide(broadcast.8377, power.9297), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.9302 = f32[1,128]{1,0} dot(divide.9301, divide.9298), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.9303 = f32[1,1,128]{2,1,0} reshape(dot.9302), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9304 = f32[1,1,128]{2,1,0} reshape(dot.9302), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9305 = f32[1,2,128]{2,1,0} concatenate(reshape.9303, reshape.9304), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9306 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.9305), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.9307 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.9306), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.9316 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.9307), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9317 = f32[1,1,256]{2,1,0} reshape(broadcast.9316), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9318 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.9317), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9319 = f32[1,1,4,256]{3,2,1,0} multiply(dot.9296, broadcast.9318), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9310 = f32[1,1,4,128]{3,2,1,0} slice(dot.9296), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.9311 = f32[1,1,4,128]{3,2,1,0} negate(slice.9310), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.9312 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.9311), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9309 = f32[1,1,4,128]{3,2,1,0} slice(dot.9296), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9313 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.9309), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9314 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.9312, reshape.9313), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9315 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.9314), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.9308 = f32[1,1,1,256]{3,2,1,0} sine(reshape.9306), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.9320 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.9308), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9321 = f32[1,1,256]{2,1,0} reshape(broadcast.9320), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9322 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.9321), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9323 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.9315, broadcast.9322), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.9324 = f32[1,1,4,256]{3,2,1,0} add(multiply.9319, multiply.9323), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9325 = f32[1,1,4,128]{3,2,1,0} slice(add.9324), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9327 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.9325), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9326 = f32[1,1,4,128]{3,2,1,0} slice(add.9324), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9328 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.9326), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9329 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.9327, reshape.9328), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9330 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.9329), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.9332 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.9333 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.9334 = s32[] select(compare.9332, add.9333, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.9335 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.9293, reshape.9330, constant.8391, select.9334, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8102 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=52
  dot.9257 = f32[1,1,8,256]{3,2,1,0} dot(multiply.9249, get-tuple-element.8102), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.9260 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.9261 = f32[1]{0} reshape(convert.9260), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.9262 = f32[1]{0} divide(reshape.9261, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.9258 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.9259 = f32[128]{0} divide(broadcast.8377, power.9258), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.9263 = f32[1,128]{1,0} dot(divide.9262, divide.9259), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.9264 = f32[1,1,128]{2,1,0} reshape(dot.9263), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9265 = f32[1,1,128]{2,1,0} reshape(dot.9263), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9266 = f32[1,2,128]{2,1,0} concatenate(reshape.9264, reshape.9265), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9267 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.9266), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.9268 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.9267), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.9277 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.9268), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9278 = f32[1,1,256]{2,1,0} reshape(broadcast.9277), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9279 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.9278), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9280 = f32[1,1,8,256]{3,2,1,0} multiply(dot.9257, broadcast.9279), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9271 = f32[1,1,8,128]{3,2,1,0} slice(dot.9257), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.9272 = f32[1,1,8,128]{3,2,1,0} negate(slice.9271), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.9273 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.9272), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9270 = f32[1,1,8,128]{3,2,1,0} slice(dot.9257), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9274 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.9270), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9275 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.9273, reshape.9274), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9276 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.9275), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.9269 = f32[1,1,1,256]{3,2,1,0} sine(reshape.9267), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.9281 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.9269), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9282 = f32[1,1,256]{2,1,0} reshape(broadcast.9281), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9283 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.9282), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9284 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.9276, broadcast.9283), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.9285 = f32[1,1,8,256]{3,2,1,0} add(multiply.9280, multiply.9284), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/rotary_embedding_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9286 = f32[1,1,8,128]{3,2,1,0} slice(add.9285), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9288 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.9286), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9287 = f32[1,1,8,128]{3,2,1,0} slice(add.9285), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9289 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.9287), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9290 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.9288, reshape.9289), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9291 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.9290), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.9343 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.9291, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.9344 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.9343), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.9345 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.9335, reshape.9344), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.9346 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.9345), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.9347 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.9346, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.9348 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.9347), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.9349 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.9348, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.9350 = pred[31,31]{1,0} call(broadcast.8370), to_apply=triu_3.6933
  call.9351 = pred[31,31]{1,0} call(broadcast.8370), to_apply=tril_4.6946
  and.9352 = pred[31,31]{1,0} and(call.9350, call.9351), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  compare.9353 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  add.9354 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  select.9355 = s32[] select(compare.9353, add.9354, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  dynamic-slice.9356 = pred[1,31]{1,0} dynamic-slice(and.9352, select.9355, constant.8391), dynamic_slice_sizes={1,31}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/dynamic_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  reshape.9357 = pred[1,1,31]{2,1,0} reshape(dynamic-slice.9356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.9358 = pred[1,1,31]{2,1,0} and(reshape.9256, reshape.9357), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.9359 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(and.9358), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.9360 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.9359), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.9361 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.9360), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.9362 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.9361, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.9363 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.9362), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.9364 = f32[1,1,31]{2,1,0} reshape(broadcast.9363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.9365 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.9364), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.9366 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.9349, broadcast.9365), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.9367 = f32[1,4,2,1]{3,2,1,0} reduce(add.9366, constant.8364), dimensions={4}, to_apply=region_210.6959, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.9368 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.9367, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9369 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.9368), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.9370 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.9369), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9371 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.9370), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.9372 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.9371), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.9373 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.9366, broadcast.9372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.9374 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.9373), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.9375 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.9374, constant.8387), dimensions={4}, to_apply=region_211.6963, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9376 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.9375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.9377 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.9376), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9378 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.9377), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.9379 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.9378), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.9380 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.9374, broadcast.9379), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/softmax_4/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.9381 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.9339, divide.9380), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.9382 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.9381), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.9383 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.9382), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.9388 = f32[1,1,8,256]{3,2,1,0} call(reshape.9387, broadcast.8358, reshape.9383), to_apply=_where_5.6971
  get-tuple-element.8105 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=55
  dot.9389 = f32[1,1,2304]{2,1,0} dot(call.9388, get-tuple-element.8105), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.9390 = f32[1,1,2304]{2,1,0} multiply(dot.9389, dot.9389), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.9391 = f32[1,1]{1,0} reduce(multiply.9390, constant.8387), dimensions={2}, to_apply=region_213.6979, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.9392 = f32[1,1,1]{2,1,0} reshape(reduce.9391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.9393 = f32[1,1,1]{2,1,0} divide(reshape.9392, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.9394 = f32[1,1,1]{2,1,0} add(divide.9393, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.9395 = f32[1,1,1]{2,1,0} sqrt(add.9394), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.9396 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.9395), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.9397 = f32[1,1,1]{2,1,0} broadcast(divide.9396), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.9398 = f32[1,1]{1,0} reshape(broadcast.9397), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.9399 = f32[1,1,2304]{2,1,0} broadcast(reshape.9398), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.9400 = f32[1,1,2304]{2,1,0} multiply(dot.9389, broadcast.9399), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8106 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=56
  add.9401 = f32[2304]{0} add(get-tuple-element.8106, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.9402 = f32[1,1,2304]{2,1,0} reshape(add.9401), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.9403 = f32[1,1,2304]{2,1,0} multiply(multiply.9400, reshape.9402), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.9404 = f32[1,1,2304]{2,1,0} add(add.9233, multiply.9403), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.9405 = f32[1,1,2304]{2,1,0} multiply(add.9404, add.9404), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.9406 = f32[1,1]{1,0} reduce(multiply.9405, constant.8387), dimensions={2}, to_apply=region_214.6983, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.9407 = f32[1,1,1]{2,1,0} reshape(reduce.9406), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.9408 = f32[1,1,1]{2,1,0} divide(reshape.9407, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.9409 = f32[1,1,1]{2,1,0} add(divide.9408, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.9410 = f32[1,1,1]{2,1,0} sqrt(add.9409), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.9411 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.9410), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.9412 = f32[1,1,1]{2,1,0} broadcast(divide.9411), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.9413 = f32[1,1]{1,0} reshape(broadcast.9412), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.9414 = f32[1,1,2304]{2,1,0} broadcast(reshape.9413), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.9415 = f32[1,1,2304]{2,1,0} multiply(add.9404, broadcast.9414), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8107 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=57
  add.9416 = f32[2304]{0} add(get-tuple-element.8107, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.9417 = f32[1,1,2304]{2,1,0} reshape(add.9416), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.9418 = f32[1,1,2304]{2,1,0} multiply(multiply.9415, reshape.9417), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8108 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=58
  dot.9419 = f32[1,1,9216]{2,1,0} dot(multiply.9418, get-tuple-element.8108), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.9421 = f32[1,1,9216]{2,1,0} multiply(dot.9419, dot.9419), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9422 = f32[1,1,9216]{2,1,0} multiply(multiply.9421, dot.9419), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9423 = f32[1,1,9216]{2,1,0} multiply(multiply.9422, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.9424 = f32[1,1,9216]{2,1,0} add(dot.9419, multiply.9423), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9425 = f32[1,1,9216]{2,1,0} multiply(add.9424, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.9426 = f32[1,1,9216]{2,1,0} tanh(multiply.9425), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.9427 = f32[1,1,9216]{2,1,0} add(tanh.9426, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9428 = f32[1,1,9216]{2,1,0} multiply(add.9427, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9429 = f32[1,1,9216]{2,1,0} multiply(dot.9419, multiply.9428), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8109 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=59
  dot.9420 = f32[1,1,9216]{2,1,0} dot(multiply.9418, get-tuple-element.8109), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.9430 = f32[1,1,9216]{2,1,0} multiply(multiply.9429, dot.9420), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8110 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=60
  dot.9431 = f32[1,1,2304]{2,1,0} dot(multiply.9430, get-tuple-element.8110), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.9432 = f32[1,1,2304]{2,1,0} multiply(dot.9431, dot.9431), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.9433 = f32[1,1]{1,0} reduce(multiply.9432, constant.8387), dimensions={2}, to_apply=region_215.6987, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.9434 = f32[1,1,1]{2,1,0} reshape(reduce.9433), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.9435 = f32[1,1,1]{2,1,0} divide(reshape.9434, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.9436 = f32[1,1,1]{2,1,0} add(divide.9435, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.9437 = f32[1,1,1]{2,1,0} sqrt(add.9436), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.9438 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.9437), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.9439 = f32[1,1,1]{2,1,0} broadcast(divide.9438), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.9440 = f32[1,1]{1,0} reshape(broadcast.9439), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.9441 = f32[1,1,2304]{2,1,0} broadcast(reshape.9440), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.9442 = f32[1,1,2304]{2,1,0} multiply(dot.9431, broadcast.9441), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8111 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=61
  add.9443 = f32[2304]{0} add(get-tuple-element.8111, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.9444 = f32[1,1,2304]{2,1,0} reshape(add.9443), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.9445 = f32[1,1,2304]{2,1,0} multiply(multiply.9442, reshape.9444), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.9446 = f32[1,1,2304]{2,1,0} add(multiply.9445, add.9404), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.9463 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.9464 = f32[1,1]{1,0} reshape(convert.9463), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.9465 = f32[1,1]{1,0} broadcast(reshape.9464), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.9466 = f32[1]{0} reshape(broadcast.9465), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.9467 = f32[1,31]{1,0} broadcast(reshape.9466), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.9468 = pred[1,31]{1,0} compare(broadcast.9467, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.9469 = pred[1,1,31]{2,1,0} reshape(compare.9468), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.9588 = s32[1,1,31]{2,1,0} convert(reshape.9469), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.9589 = pred[1,1,31]{2,1,0} compare(convert.9588, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.9590 = pred[1,1]{1,0} reduce(compare.9589, constant.8359), dimensions={2}, to_apply=region_219.7003, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.9591 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.9590), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.9447 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [5:6], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.9448 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.9447), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.9507 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.9448), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.9508 = f32[1,31,4,256]{3,2,1,0} reshape(slice.9507), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.9449 = f32[1,1,2304]{2,1,0} multiply(add.9446, add.9446), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.9450 = f32[1,1]{1,0} reduce(multiply.9449, constant.8387), dimensions={2}, to_apply=region_216.6991, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.9451 = f32[1,1,1]{2,1,0} reshape(reduce.9450), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.9452 = f32[1,1,1]{2,1,0} divide(reshape.9451, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.9453 = f32[1,1,1]{2,1,0} add(divide.9452, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.9454 = f32[1,1,1]{2,1,0} sqrt(add.9453), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.9455 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.9454), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.9456 = f32[1,1,1]{2,1,0} broadcast(divide.9455), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.9457 = f32[1,1]{1,0} reshape(broadcast.9456), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.9458 = f32[1,1,2304]{2,1,0} broadcast(reshape.9457), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.9459 = f32[1,1,2304]{2,1,0} multiply(add.9446, broadcast.9458), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8112 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=62
  add.9460 = f32[2304]{0} add(get-tuple-element.8112, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.9461 = f32[1,1,2304]{2,1,0} reshape(add.9460), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.9462 = f32[1,1,2304]{2,1,0} multiply(multiply.9459, reshape.9461), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8115 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=65
  dot.9544 = f32[1,1,4,256]{3,2,1,0} dot(multiply.9462, get-tuple-element.8115), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.9549 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.9550 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.9551 = s32[] select(compare.9549, add.9550, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.9552 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.9508, dot.9544, constant.8391, select.9551, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.9505 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.9448), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.9506 = f32[1,31,4,256]{3,2,1,0} reshape(slice.9505), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8114 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=64
  dot.9509 = f32[1,1,4,256]{3,2,1,0} dot(multiply.9462, get-tuple-element.8114), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.9512 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.9513 = f32[1]{0} reshape(convert.9512), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.9514 = f32[1]{0} divide(reshape.9513, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.9510 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.9511 = f32[128]{0} divide(broadcast.8377, power.9510), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.9515 = f32[1,128]{1,0} dot(divide.9514, divide.9511), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.9516 = f32[1,1,128]{2,1,0} reshape(dot.9515), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9517 = f32[1,1,128]{2,1,0} reshape(dot.9515), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9518 = f32[1,2,128]{2,1,0} concatenate(reshape.9516, reshape.9517), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9519 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.9518), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.9520 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.9519), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.9529 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.9520), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9530 = f32[1,1,256]{2,1,0} reshape(broadcast.9529), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9531 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.9530), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9532 = f32[1,1,4,256]{3,2,1,0} multiply(dot.9509, broadcast.9531), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9523 = f32[1,1,4,128]{3,2,1,0} slice(dot.9509), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.9524 = f32[1,1,4,128]{3,2,1,0} negate(slice.9523), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.9525 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.9524), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9522 = f32[1,1,4,128]{3,2,1,0} slice(dot.9509), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9526 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.9522), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9527 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.9525, reshape.9526), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9528 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.9527), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.9521 = f32[1,1,1,256]{3,2,1,0} sine(reshape.9519), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.9533 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.9521), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9534 = f32[1,1,256]{2,1,0} reshape(broadcast.9533), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9535 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.9534), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9536 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.9528, broadcast.9535), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.9537 = f32[1,1,4,256]{3,2,1,0} add(multiply.9532, multiply.9536), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9538 = f32[1,1,4,128]{3,2,1,0} slice(add.9537), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9540 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.9538), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9539 = f32[1,1,4,128]{3,2,1,0} slice(add.9537), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9541 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.9539), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9542 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.9540, reshape.9541), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9543 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.9542), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.9545 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.9546 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.9547 = s32[] select(compare.9545, add.9546, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.9548 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.9506, reshape.9543, constant.8391, select.9547, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8113 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=63
  dot.9470 = f32[1,1,8,256]{3,2,1,0} dot(multiply.9462, get-tuple-element.8113), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.9473 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.9474 = f32[1]{0} reshape(convert.9473), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.9475 = f32[1]{0} divide(reshape.9474, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.9471 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.9472 = f32[128]{0} divide(broadcast.8377, power.9471), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.9476 = f32[1,128]{1,0} dot(divide.9475, divide.9472), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.9477 = f32[1,1,128]{2,1,0} reshape(dot.9476), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9478 = f32[1,1,128]{2,1,0} reshape(dot.9476), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9479 = f32[1,2,128]{2,1,0} concatenate(reshape.9477, reshape.9478), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9480 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.9479), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.9481 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.9480), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.9490 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.9481), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9491 = f32[1,1,256]{2,1,0} reshape(broadcast.9490), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9492 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.9491), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9493 = f32[1,1,8,256]{3,2,1,0} multiply(dot.9470, broadcast.9492), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9484 = f32[1,1,8,128]{3,2,1,0} slice(dot.9470), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.9485 = f32[1,1,8,128]{3,2,1,0} negate(slice.9484), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.9486 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.9485), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9483 = f32[1,1,8,128]{3,2,1,0} slice(dot.9470), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9487 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.9483), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9488 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.9486, reshape.9487), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9489 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.9488), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.9482 = f32[1,1,1,256]{3,2,1,0} sine(reshape.9480), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.9494 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.9482), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9495 = f32[1,1,256]{2,1,0} reshape(broadcast.9494), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9496 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.9495), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9497 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.9489, broadcast.9496), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.9498 = f32[1,1,8,256]{3,2,1,0} add(multiply.9493, multiply.9497), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/rotary_embedding_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9499 = f32[1,1,8,128]{3,2,1,0} slice(add.9498), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9501 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.9499), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9500 = f32[1,1,8,128]{3,2,1,0} slice(add.9498), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9502 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.9500), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9503 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.9501, reshape.9502), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9504 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.9503), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.9556 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.9504, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.9557 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.9556), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.9558 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.9548, reshape.9557), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.9559 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.9558), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.9560 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.9559, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.9561 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.9560), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.9562 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.9561, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.9563 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(compare.9468), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.9564 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.9563), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.9565 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.9564), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.9566 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.9565, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.9567 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.9566), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.9568 = f32[1,1,31]{2,1,0} reshape(broadcast.9567), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.9569 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.9568), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.9570 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.9562, broadcast.9569), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.9571 = f32[1,4,2,1]{3,2,1,0} reduce(add.9570, constant.8364), dimensions={4}, to_apply=region_217.6995, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.9572 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.9571, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9573 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.9572), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.9574 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.9573), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9575 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.9574), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.9576 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.9575), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.9577 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.9570, broadcast.9576), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.9578 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.9577), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.9579 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.9578, constant.8387), dimensions={4}, to_apply=region_218.6999, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9580 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.9579), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.9581 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.9580), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9582 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.9581), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.9583 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.9582), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.9584 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.9578, broadcast.9583), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/softmax_5/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.9585 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.9552, divide.9584), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.9586 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.9585), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.9587 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.9586), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.9592 = f32[1,1,8,256]{3,2,1,0} call(reshape.9591, broadcast.8358, reshape.9587), to_apply=_where_5.7007
  get-tuple-element.8116 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=66
  dot.9593 = f32[1,1,2304]{2,1,0} dot(call.9592, get-tuple-element.8116), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.9594 = f32[1,1,2304]{2,1,0} multiply(dot.9593, dot.9593), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.9595 = f32[1,1]{1,0} reduce(multiply.9594, constant.8387), dimensions={2}, to_apply=region_220.7015, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.9596 = f32[1,1,1]{2,1,0} reshape(reduce.9595), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.9597 = f32[1,1,1]{2,1,0} divide(reshape.9596, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.9598 = f32[1,1,1]{2,1,0} add(divide.9597, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.9599 = f32[1,1,1]{2,1,0} sqrt(add.9598), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.9600 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.9599), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.9601 = f32[1,1,1]{2,1,0} broadcast(divide.9600), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.9602 = f32[1,1]{1,0} reshape(broadcast.9601), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.9603 = f32[1,1,2304]{2,1,0} broadcast(reshape.9602), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.9604 = f32[1,1,2304]{2,1,0} multiply(dot.9593, broadcast.9603), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8117 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=67
  add.9605 = f32[2304]{0} add(get-tuple-element.8117, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.9606 = f32[1,1,2304]{2,1,0} reshape(add.9605), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.9607 = f32[1,1,2304]{2,1,0} multiply(multiply.9604, reshape.9606), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.9608 = f32[1,1,2304]{2,1,0} add(add.9446, multiply.9607), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.9609 = f32[1,1,2304]{2,1,0} multiply(add.9608, add.9608), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.9610 = f32[1,1]{1,0} reduce(multiply.9609, constant.8387), dimensions={2}, to_apply=region_221.7019, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.9611 = f32[1,1,1]{2,1,0} reshape(reduce.9610), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.9612 = f32[1,1,1]{2,1,0} divide(reshape.9611, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.9613 = f32[1,1,1]{2,1,0} add(divide.9612, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.9614 = f32[1,1,1]{2,1,0} sqrt(add.9613), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.9615 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.9614), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.9616 = f32[1,1,1]{2,1,0} broadcast(divide.9615), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.9617 = f32[1,1]{1,0} reshape(broadcast.9616), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.9618 = f32[1,1,2304]{2,1,0} broadcast(reshape.9617), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.9619 = f32[1,1,2304]{2,1,0} multiply(add.9608, broadcast.9618), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8118 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=68
  add.9620 = f32[2304]{0} add(get-tuple-element.8118, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.9621 = f32[1,1,2304]{2,1,0} reshape(add.9620), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.9622 = f32[1,1,2304]{2,1,0} multiply(multiply.9619, reshape.9621), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8119 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=69
  dot.9623 = f32[1,1,9216]{2,1,0} dot(multiply.9622, get-tuple-element.8119), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.9625 = f32[1,1,9216]{2,1,0} multiply(dot.9623, dot.9623), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9626 = f32[1,1,9216]{2,1,0} multiply(multiply.9625, dot.9623), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9627 = f32[1,1,9216]{2,1,0} multiply(multiply.9626, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.9628 = f32[1,1,9216]{2,1,0} add(dot.9623, multiply.9627), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9629 = f32[1,1,9216]{2,1,0} multiply(add.9628, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.9630 = f32[1,1,9216]{2,1,0} tanh(multiply.9629), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.9631 = f32[1,1,9216]{2,1,0} add(tanh.9630, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9632 = f32[1,1,9216]{2,1,0} multiply(add.9631, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9633 = f32[1,1,9216]{2,1,0} multiply(dot.9623, multiply.9632), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8120 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=70
  dot.9624 = f32[1,1,9216]{2,1,0} dot(multiply.9622, get-tuple-element.8120), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.9634 = f32[1,1,9216]{2,1,0} multiply(multiply.9633, dot.9624), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8121 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=71
  dot.9635 = f32[1,1,2304]{2,1,0} dot(multiply.9634, get-tuple-element.8121), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.9636 = f32[1,1,2304]{2,1,0} multiply(dot.9635, dot.9635), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.9637 = f32[1,1]{1,0} reduce(multiply.9636, constant.8387), dimensions={2}, to_apply=region_222.7023, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.9638 = f32[1,1,1]{2,1,0} reshape(reduce.9637), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.9639 = f32[1,1,1]{2,1,0} divide(reshape.9638, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.9640 = f32[1,1,1]{2,1,0} add(divide.9639, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.9641 = f32[1,1,1]{2,1,0} sqrt(add.9640), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.9642 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.9641), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.9643 = f32[1,1,1]{2,1,0} broadcast(divide.9642), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.9644 = f32[1,1]{1,0} reshape(broadcast.9643), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.9645 = f32[1,1,2304]{2,1,0} broadcast(reshape.9644), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.9646 = f32[1,1,2304]{2,1,0} multiply(dot.9635, broadcast.9645), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8122 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=72
  add.9647 = f32[2304]{0} add(get-tuple-element.8122, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.9648 = f32[1,1,2304]{2,1,0} reshape(add.9647), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.9649 = f32[1,1,2304]{2,1,0} multiply(multiply.9646, reshape.9648), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.9650 = f32[1,1,2304]{2,1,0} add(multiply.9649, add.9608), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.9667 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.9668 = f32[1,1]{1,0} reshape(convert.9667), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.9669 = f32[1,1]{1,0} broadcast(reshape.9668), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.9670 = f32[1]{0} reshape(broadcast.9669), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.9671 = f32[1,31]{1,0} broadcast(reshape.9670), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.9672 = pred[1,31]{1,0} compare(broadcast.9671, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.9673 = pred[1,1,31]{2,1,0} reshape(compare.9672), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.9801 = s32[1,1,31]{2,1,0} convert(reshape.9673), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.9802 = pred[1,1,31]{2,1,0} compare(convert.9801, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.9803 = pred[1,1]{1,0} reduce(compare.9802, constant.8359), dimensions={2}, to_apply=region_226.7065, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.9804 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.9803), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.9651 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [6:7], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.9652 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.9651), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.9711 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.9652), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.9712 = f32[1,31,4,256]{3,2,1,0} reshape(slice.9711), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.9653 = f32[1,1,2304]{2,1,0} multiply(add.9650, add.9650), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.9654 = f32[1,1]{1,0} reduce(multiply.9653, constant.8387), dimensions={2}, to_apply=region_223.7027, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.9655 = f32[1,1,1]{2,1,0} reshape(reduce.9654), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.9656 = f32[1,1,1]{2,1,0} divide(reshape.9655, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.9657 = f32[1,1,1]{2,1,0} add(divide.9656, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.9658 = f32[1,1,1]{2,1,0} sqrt(add.9657), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.9659 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.9658), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.9660 = f32[1,1,1]{2,1,0} broadcast(divide.9659), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.9661 = f32[1,1]{1,0} reshape(broadcast.9660), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.9662 = f32[1,1,2304]{2,1,0} broadcast(reshape.9661), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.9663 = f32[1,1,2304]{2,1,0} multiply(add.9650, broadcast.9662), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8123 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=73
  add.9664 = f32[2304]{0} add(get-tuple-element.8123, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.9665 = f32[1,1,2304]{2,1,0} reshape(add.9664), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.9666 = f32[1,1,2304]{2,1,0} multiply(multiply.9663, reshape.9665), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8126 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=76
  dot.9748 = f32[1,1,4,256]{3,2,1,0} dot(multiply.9666, get-tuple-element.8126), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.9753 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.9754 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.9755 = s32[] select(compare.9753, add.9754, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.9756 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.9712, dot.9748, constant.8391, select.9755, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.9709 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.9652), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.9710 = f32[1,31,4,256]{3,2,1,0} reshape(slice.9709), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8125 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=75
  dot.9713 = f32[1,1,4,256]{3,2,1,0} dot(multiply.9666, get-tuple-element.8125), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.9716 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.9717 = f32[1]{0} reshape(convert.9716), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.9718 = f32[1]{0} divide(reshape.9717, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.9714 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.9715 = f32[128]{0} divide(broadcast.8377, power.9714), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.9719 = f32[1,128]{1,0} dot(divide.9718, divide.9715), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.9720 = f32[1,1,128]{2,1,0} reshape(dot.9719), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9721 = f32[1,1,128]{2,1,0} reshape(dot.9719), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9722 = f32[1,2,128]{2,1,0} concatenate(reshape.9720, reshape.9721), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9723 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.9722), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.9724 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.9723), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.9733 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.9724), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9734 = f32[1,1,256]{2,1,0} reshape(broadcast.9733), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9735 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.9734), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9736 = f32[1,1,4,256]{3,2,1,0} multiply(dot.9713, broadcast.9735), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9727 = f32[1,1,4,128]{3,2,1,0} slice(dot.9713), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.9728 = f32[1,1,4,128]{3,2,1,0} negate(slice.9727), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.9729 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.9728), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9726 = f32[1,1,4,128]{3,2,1,0} slice(dot.9713), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9730 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.9726), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9731 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.9729, reshape.9730), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9732 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.9731), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.9725 = f32[1,1,1,256]{3,2,1,0} sine(reshape.9723), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.9737 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.9725), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9738 = f32[1,1,256]{2,1,0} reshape(broadcast.9737), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9739 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.9738), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9740 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.9732, broadcast.9739), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.9741 = f32[1,1,4,256]{3,2,1,0} add(multiply.9736, multiply.9740), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9742 = f32[1,1,4,128]{3,2,1,0} slice(add.9741), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9744 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.9742), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9743 = f32[1,1,4,128]{3,2,1,0} slice(add.9741), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9745 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.9743), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9746 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.9744, reshape.9745), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9747 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.9746), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.9749 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.9750 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.9751 = s32[] select(compare.9749, add.9750, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.9752 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.9710, reshape.9747, constant.8391, select.9751, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8124 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=74
  dot.9674 = f32[1,1,8,256]{3,2,1,0} dot(multiply.9666, get-tuple-element.8124), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.9677 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.9678 = f32[1]{0} reshape(convert.9677), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.9679 = f32[1]{0} divide(reshape.9678, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.9675 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.9676 = f32[128]{0} divide(broadcast.8377, power.9675), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.9680 = f32[1,128]{1,0} dot(divide.9679, divide.9676), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.9681 = f32[1,1,128]{2,1,0} reshape(dot.9680), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9682 = f32[1,1,128]{2,1,0} reshape(dot.9680), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9683 = f32[1,2,128]{2,1,0} concatenate(reshape.9681, reshape.9682), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9684 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.9683), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.9685 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.9684), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.9694 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.9685), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9695 = f32[1,1,256]{2,1,0} reshape(broadcast.9694), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9696 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.9695), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9697 = f32[1,1,8,256]{3,2,1,0} multiply(dot.9674, broadcast.9696), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9688 = f32[1,1,8,128]{3,2,1,0} slice(dot.9674), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.9689 = f32[1,1,8,128]{3,2,1,0} negate(slice.9688), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.9690 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.9689), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9687 = f32[1,1,8,128]{3,2,1,0} slice(dot.9674), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9691 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.9687), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9692 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.9690, reshape.9691), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9693 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.9692), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.9686 = f32[1,1,1,256]{3,2,1,0} sine(reshape.9684), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.9698 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.9686), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9699 = f32[1,1,256]{2,1,0} reshape(broadcast.9698), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9700 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.9699), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9701 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.9693, broadcast.9700), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.9702 = f32[1,1,8,256]{3,2,1,0} add(multiply.9697, multiply.9701), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/rotary_embedding_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9703 = f32[1,1,8,128]{3,2,1,0} slice(add.9702), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9705 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.9703), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9704 = f32[1,1,8,128]{3,2,1,0} slice(add.9702), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9706 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.9704), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9707 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.9705, reshape.9706), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9708 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.9707), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.9760 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.9708, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.9761 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.9760), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.9762 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.9752, reshape.9761), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.9763 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.9762), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.9764 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.9763, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.9765 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.9764), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.9766 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.9765, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.9767 = pred[31,31]{1,0} call(broadcast.8370), to_apply=triu_3.7031
  call.9768 = pred[31,31]{1,0} call(broadcast.8370), to_apply=tril_4.7044
  and.9769 = pred[31,31]{1,0} and(call.9767, call.9768), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  compare.9770 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  add.9771 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  select.9772 = s32[] select(compare.9770, add.9771, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  dynamic-slice.9773 = pred[1,31]{1,0} dynamic-slice(and.9769, select.9772, constant.8391), dynamic_slice_sizes={1,31}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/dynamic_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  reshape.9774 = pred[1,1,31]{2,1,0} reshape(dynamic-slice.9773), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.9775 = pred[1,1,31]{2,1,0} and(reshape.9673, reshape.9774), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.9776 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(and.9775), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.9777 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.9776), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.9778 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.9777), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.9779 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.9778, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.9780 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.9779), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.9781 = f32[1,1,31]{2,1,0} reshape(broadcast.9780), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.9782 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.9781), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.9783 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.9766, broadcast.9782), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.9784 = f32[1,4,2,1]{3,2,1,0} reduce(add.9783, constant.8364), dimensions={4}, to_apply=region_224.7057, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.9785 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.9784, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9786 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.9785), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.9787 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.9786), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9788 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.9787), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.9789 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.9788), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.9790 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.9783, broadcast.9789), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.9791 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.9790), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.9792 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.9791, constant.8387), dimensions={4}, to_apply=region_225.7061, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9793 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.9792), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.9794 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.9793), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9795 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.9794), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.9796 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.9795), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.9797 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.9791, broadcast.9796), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/softmax_6/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.9798 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.9756, divide.9797), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.9799 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.9798), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.9800 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.9799), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.9805 = f32[1,1,8,256]{3,2,1,0} call(reshape.9804, broadcast.8358, reshape.9800), to_apply=_where_5.7069
  get-tuple-element.8127 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=77
  dot.9806 = f32[1,1,2304]{2,1,0} dot(call.9805, get-tuple-element.8127), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.9807 = f32[1,1,2304]{2,1,0} multiply(dot.9806, dot.9806), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.9808 = f32[1,1]{1,0} reduce(multiply.9807, constant.8387), dimensions={2}, to_apply=region_227.7077, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.9809 = f32[1,1,1]{2,1,0} reshape(reduce.9808), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.9810 = f32[1,1,1]{2,1,0} divide(reshape.9809, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.9811 = f32[1,1,1]{2,1,0} add(divide.9810, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.9812 = f32[1,1,1]{2,1,0} sqrt(add.9811), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.9813 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.9812), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.9814 = f32[1,1,1]{2,1,0} broadcast(divide.9813), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.9815 = f32[1,1]{1,0} reshape(broadcast.9814), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.9816 = f32[1,1,2304]{2,1,0} broadcast(reshape.9815), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.9817 = f32[1,1,2304]{2,1,0} multiply(dot.9806, broadcast.9816), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8128 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=78
  add.9818 = f32[2304]{0} add(get-tuple-element.8128, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.9819 = f32[1,1,2304]{2,1,0} reshape(add.9818), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.9820 = f32[1,1,2304]{2,1,0} multiply(multiply.9817, reshape.9819), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.9821 = f32[1,1,2304]{2,1,0} add(add.9650, multiply.9820), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.9822 = f32[1,1,2304]{2,1,0} multiply(add.9821, add.9821), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.9823 = f32[1,1]{1,0} reduce(multiply.9822, constant.8387), dimensions={2}, to_apply=region_228.7081, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.9824 = f32[1,1,1]{2,1,0} reshape(reduce.9823), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.9825 = f32[1,1,1]{2,1,0} divide(reshape.9824, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.9826 = f32[1,1,1]{2,1,0} add(divide.9825, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.9827 = f32[1,1,1]{2,1,0} sqrt(add.9826), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.9828 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.9827), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.9829 = f32[1,1,1]{2,1,0} broadcast(divide.9828), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.9830 = f32[1,1]{1,0} reshape(broadcast.9829), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.9831 = f32[1,1,2304]{2,1,0} broadcast(reshape.9830), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.9832 = f32[1,1,2304]{2,1,0} multiply(add.9821, broadcast.9831), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8129 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=79
  add.9833 = f32[2304]{0} add(get-tuple-element.8129, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.9834 = f32[1,1,2304]{2,1,0} reshape(add.9833), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.9835 = f32[1,1,2304]{2,1,0} multiply(multiply.9832, reshape.9834), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8130 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=80
  dot.9836 = f32[1,1,9216]{2,1,0} dot(multiply.9835, get-tuple-element.8130), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.9838 = f32[1,1,9216]{2,1,0} multiply(dot.9836, dot.9836), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9839 = f32[1,1,9216]{2,1,0} multiply(multiply.9838, dot.9836), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9840 = f32[1,1,9216]{2,1,0} multiply(multiply.9839, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.9841 = f32[1,1,9216]{2,1,0} add(dot.9836, multiply.9840), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9842 = f32[1,1,9216]{2,1,0} multiply(add.9841, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.9843 = f32[1,1,9216]{2,1,0} tanh(multiply.9842), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.9844 = f32[1,1,9216]{2,1,0} add(tanh.9843, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9845 = f32[1,1,9216]{2,1,0} multiply(add.9844, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.9846 = f32[1,1,9216]{2,1,0} multiply(dot.9836, multiply.9845), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8131 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=81
  dot.9837 = f32[1,1,9216]{2,1,0} dot(multiply.9835, get-tuple-element.8131), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.9847 = f32[1,1,9216]{2,1,0} multiply(multiply.9846, dot.9837), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8132 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=82
  dot.9848 = f32[1,1,2304]{2,1,0} dot(multiply.9847, get-tuple-element.8132), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.9849 = f32[1,1,2304]{2,1,0} multiply(dot.9848, dot.9848), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.9850 = f32[1,1]{1,0} reduce(multiply.9849, constant.8387), dimensions={2}, to_apply=region_229.7085, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.9851 = f32[1,1,1]{2,1,0} reshape(reduce.9850), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.9852 = f32[1,1,1]{2,1,0} divide(reshape.9851, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.9853 = f32[1,1,1]{2,1,0} add(divide.9852, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.9854 = f32[1,1,1]{2,1,0} sqrt(add.9853), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.9855 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.9854), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.9856 = f32[1,1,1]{2,1,0} broadcast(divide.9855), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.9857 = f32[1,1]{1,0} reshape(broadcast.9856), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.9858 = f32[1,1,2304]{2,1,0} broadcast(reshape.9857), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.9859 = f32[1,1,2304]{2,1,0} multiply(dot.9848, broadcast.9858), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8133 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=83
  add.9860 = f32[2304]{0} add(get-tuple-element.8133, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.9861 = f32[1,1,2304]{2,1,0} reshape(add.9860), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.9862 = f32[1,1,2304]{2,1,0} multiply(multiply.9859, reshape.9861), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.9863 = f32[1,1,2304]{2,1,0} add(multiply.9862, add.9821), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.9880 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.9881 = f32[1,1]{1,0} reshape(convert.9880), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.9882 = f32[1,1]{1,0} broadcast(reshape.9881), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.9883 = f32[1]{0} reshape(broadcast.9882), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.9884 = f32[1,31]{1,0} broadcast(reshape.9883), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.9885 = pred[1,31]{1,0} compare(broadcast.9884, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.9886 = pred[1,1,31]{2,1,0} reshape(compare.9885), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.10005 = s32[1,1,31]{2,1,0} convert(reshape.9886), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.10006 = pred[1,1,31]{2,1,0} compare(convert.10005, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.10007 = pred[1,1]{1,0} reduce(compare.10006, constant.8359), dimensions={2}, to_apply=region_233.7101, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.10008 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.10007), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.9864 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [7:8], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.9865 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.9864), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.9924 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.9865), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.9925 = f32[1,31,4,256]{3,2,1,0} reshape(slice.9924), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.9866 = f32[1,1,2304]{2,1,0} multiply(add.9863, add.9863), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.9867 = f32[1,1]{1,0} reduce(multiply.9866, constant.8387), dimensions={2}, to_apply=region_230.7089, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.9868 = f32[1,1,1]{2,1,0} reshape(reduce.9867), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.9869 = f32[1,1,1]{2,1,0} divide(reshape.9868, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.9870 = f32[1,1,1]{2,1,0} add(divide.9869, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.9871 = f32[1,1,1]{2,1,0} sqrt(add.9870), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.9872 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.9871), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.9873 = f32[1,1,1]{2,1,0} broadcast(divide.9872), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.9874 = f32[1,1]{1,0} reshape(broadcast.9873), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.9875 = f32[1,1,2304]{2,1,0} broadcast(reshape.9874), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.9876 = f32[1,1,2304]{2,1,0} multiply(add.9863, broadcast.9875), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8134 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=84
  add.9877 = f32[2304]{0} add(get-tuple-element.8134, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.9878 = f32[1,1,2304]{2,1,0} reshape(add.9877), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.9879 = f32[1,1,2304]{2,1,0} multiply(multiply.9876, reshape.9878), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8137 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=87
  dot.9961 = f32[1,1,4,256]{3,2,1,0} dot(multiply.9879, get-tuple-element.8137), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.9966 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.9967 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.9968 = s32[] select(compare.9966, add.9967, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.9969 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.9925, dot.9961, constant.8391, select.9968, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.9922 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.9865), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.9923 = f32[1,31,4,256]{3,2,1,0} reshape(slice.9922), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8136 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=86
  dot.9926 = f32[1,1,4,256]{3,2,1,0} dot(multiply.9879, get-tuple-element.8136), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.9929 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.9930 = f32[1]{0} reshape(convert.9929), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.9931 = f32[1]{0} divide(reshape.9930, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.9927 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.9928 = f32[128]{0} divide(broadcast.8377, power.9927), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.9932 = f32[1,128]{1,0} dot(divide.9931, divide.9928), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.9933 = f32[1,1,128]{2,1,0} reshape(dot.9932), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9934 = f32[1,1,128]{2,1,0} reshape(dot.9932), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9935 = f32[1,2,128]{2,1,0} concatenate(reshape.9933, reshape.9934), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9936 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.9935), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.9937 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.9936), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.9946 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.9937), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9947 = f32[1,1,256]{2,1,0} reshape(broadcast.9946), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9948 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.9947), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9949 = f32[1,1,4,256]{3,2,1,0} multiply(dot.9926, broadcast.9948), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9940 = f32[1,1,4,128]{3,2,1,0} slice(dot.9926), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.9941 = f32[1,1,4,128]{3,2,1,0} negate(slice.9940), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.9942 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.9941), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9939 = f32[1,1,4,128]{3,2,1,0} slice(dot.9926), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9943 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.9939), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9944 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.9942, reshape.9943), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9945 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.9944), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.9938 = f32[1,1,1,256]{3,2,1,0} sine(reshape.9936), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.9950 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.9938), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9951 = f32[1,1,256]{2,1,0} reshape(broadcast.9950), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9952 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.9951), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9953 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.9945, broadcast.9952), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.9954 = f32[1,1,4,256]{3,2,1,0} add(multiply.9949, multiply.9953), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9955 = f32[1,1,4,128]{3,2,1,0} slice(add.9954), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9957 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.9955), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9956 = f32[1,1,4,128]{3,2,1,0} slice(add.9954), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9958 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.9956), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9959 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.9957, reshape.9958), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9960 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.9959), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.9962 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.9963 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.9964 = s32[] select(compare.9962, add.9963, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.9965 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.9923, reshape.9960, constant.8391, select.9964, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8135 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=85
  dot.9887 = f32[1,1,8,256]{3,2,1,0} dot(multiply.9879, get-tuple-element.8135), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.9890 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.9891 = f32[1]{0} reshape(convert.9890), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.9892 = f32[1]{0} divide(reshape.9891, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.9888 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.9889 = f32[128]{0} divide(broadcast.8377, power.9888), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.9893 = f32[1,128]{1,0} dot(divide.9892, divide.9889), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.9894 = f32[1,1,128]{2,1,0} reshape(dot.9893), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9895 = f32[1,1,128]{2,1,0} reshape(dot.9893), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9896 = f32[1,2,128]{2,1,0} concatenate(reshape.9894, reshape.9895), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9897 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.9896), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.9898 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.9897), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.9907 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.9898), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9908 = f32[1,1,256]{2,1,0} reshape(broadcast.9907), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9909 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.9908), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9910 = f32[1,1,8,256]{3,2,1,0} multiply(dot.9887, broadcast.9909), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9901 = f32[1,1,8,128]{3,2,1,0} slice(dot.9887), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.9902 = f32[1,1,8,128]{3,2,1,0} negate(slice.9901), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.9903 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.9902), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9900 = f32[1,1,8,128]{3,2,1,0} slice(dot.9887), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9904 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.9900), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9905 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.9903, reshape.9904), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9906 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.9905), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.9899 = f32[1,1,1,256]{3,2,1,0} sine(reshape.9897), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.9911 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.9899), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.9912 = f32[1,1,256]{2,1,0} reshape(broadcast.9911), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.9913 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.9912), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.9914 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.9906, broadcast.9913), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.9915 = f32[1,1,8,256]{3,2,1,0} add(multiply.9910, multiply.9914), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/rotary_embedding_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.9916 = f32[1,1,8,128]{3,2,1,0} slice(add.9915), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9918 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.9916), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.9917 = f32[1,1,8,128]{3,2,1,0} slice(add.9915), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.9919 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.9917), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9920 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.9918, reshape.9919), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9921 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.9920), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.9973 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.9921, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.9974 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.9973), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.9975 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.9965, reshape.9974), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.9976 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.9975), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.9977 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.9976, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.9978 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.9977), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.9979 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.9978, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.9980 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(compare.9885), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.9981 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.9980), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.9982 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.9981), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.9983 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.9982, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.9984 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.9983), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.9985 = f32[1,1,31]{2,1,0} reshape(broadcast.9984), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.9986 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.9985), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.9987 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.9979, broadcast.9986), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.9988 = f32[1,4,2,1]{3,2,1,0} reduce(add.9987, constant.8364), dimensions={4}, to_apply=region_231.7093, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.9989 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.9988, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9990 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.9989), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.9991 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.9990), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9992 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.9991), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.9993 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.9992), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.9994 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.9987, broadcast.9993), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.9995 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.9994), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.9996 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.9995, constant.8387), dimensions={4}, to_apply=region_232.7097, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9997 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.9996), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.9998 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.9997), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.9999 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.9998), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.10000 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.9999), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.10001 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.9995, broadcast.10000), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/softmax_7/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.10002 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.9969, divide.10001), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.10003 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.10002), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.10004 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.10003), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.10009 = f32[1,1,8,256]{3,2,1,0} call(reshape.10008, broadcast.8358, reshape.10004), to_apply=_where_5.7105
  get-tuple-element.8138 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=88
  dot.10010 = f32[1,1,2304]{2,1,0} dot(call.10009, get-tuple-element.8138), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10011 = f32[1,1,2304]{2,1,0} multiply(dot.10010, dot.10010), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10012 = f32[1,1]{1,0} reduce(multiply.10011, constant.8387), dimensions={2}, to_apply=region_234.7113, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10013 = f32[1,1,1]{2,1,0} reshape(reduce.10012), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10014 = f32[1,1,1]{2,1,0} divide(reshape.10013, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10015 = f32[1,1,1]{2,1,0} add(divide.10014, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10016 = f32[1,1,1]{2,1,0} sqrt(add.10015), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10017 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10016), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10018 = f32[1,1,1]{2,1,0} broadcast(divide.10017), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10019 = f32[1,1]{1,0} reshape(broadcast.10018), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10020 = f32[1,1,2304]{2,1,0} broadcast(reshape.10019), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10021 = f32[1,1,2304]{2,1,0} multiply(dot.10010, broadcast.10020), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8139 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=89
  add.10022 = f32[2304]{0} add(get-tuple-element.8139, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10023 = f32[1,1,2304]{2,1,0} reshape(add.10022), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10024 = f32[1,1,2304]{2,1,0} multiply(multiply.10021, reshape.10023), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.10025 = f32[1,1,2304]{2,1,0} add(add.9863, multiply.10024), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.10026 = f32[1,1,2304]{2,1,0} multiply(add.10025, add.10025), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10027 = f32[1,1]{1,0} reduce(multiply.10026, constant.8387), dimensions={2}, to_apply=region_235.7117, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10028 = f32[1,1,1]{2,1,0} reshape(reduce.10027), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10029 = f32[1,1,1]{2,1,0} divide(reshape.10028, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10030 = f32[1,1,1]{2,1,0} add(divide.10029, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10031 = f32[1,1,1]{2,1,0} sqrt(add.10030), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10032 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10031), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10033 = f32[1,1,1]{2,1,0} broadcast(divide.10032), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10034 = f32[1,1]{1,0} reshape(broadcast.10033), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10035 = f32[1,1,2304]{2,1,0} broadcast(reshape.10034), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10036 = f32[1,1,2304]{2,1,0} multiply(add.10025, broadcast.10035), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8140 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=90
  add.10037 = f32[2304]{0} add(get-tuple-element.8140, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10038 = f32[1,1,2304]{2,1,0} reshape(add.10037), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10039 = f32[1,1,2304]{2,1,0} multiply(multiply.10036, reshape.10038), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8141 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=91
  dot.10040 = f32[1,1,9216]{2,1,0} dot(multiply.10039, get-tuple-element.8141), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10042 = f32[1,1,9216]{2,1,0} multiply(dot.10040, dot.10040), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10043 = f32[1,1,9216]{2,1,0} multiply(multiply.10042, dot.10040), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10044 = f32[1,1,9216]{2,1,0} multiply(multiply.10043, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.10045 = f32[1,1,9216]{2,1,0} add(dot.10040, multiply.10044), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10046 = f32[1,1,9216]{2,1,0} multiply(add.10045, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.10047 = f32[1,1,9216]{2,1,0} tanh(multiply.10046), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.10048 = f32[1,1,9216]{2,1,0} add(tanh.10047, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10049 = f32[1,1,9216]{2,1,0} multiply(add.10048, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10050 = f32[1,1,9216]{2,1,0} multiply(dot.10040, multiply.10049), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8142 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=92
  dot.10041 = f32[1,1,9216]{2,1,0} dot(multiply.10039, get-tuple-element.8142), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10051 = f32[1,1,9216]{2,1,0} multiply(multiply.10050, dot.10041), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8143 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=93
  dot.10052 = f32[1,1,2304]{2,1,0} dot(multiply.10051, get-tuple-element.8143), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10053 = f32[1,1,2304]{2,1,0} multiply(dot.10052, dot.10052), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10054 = f32[1,1]{1,0} reduce(multiply.10053, constant.8387), dimensions={2}, to_apply=region_236.7121, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10055 = f32[1,1,1]{2,1,0} reshape(reduce.10054), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10056 = f32[1,1,1]{2,1,0} divide(reshape.10055, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10057 = f32[1,1,1]{2,1,0} add(divide.10056, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10058 = f32[1,1,1]{2,1,0} sqrt(add.10057), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10059 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10058), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10060 = f32[1,1,1]{2,1,0} broadcast(divide.10059), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10061 = f32[1,1]{1,0} reshape(broadcast.10060), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10062 = f32[1,1,2304]{2,1,0} broadcast(reshape.10061), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10063 = f32[1,1,2304]{2,1,0} multiply(dot.10052, broadcast.10062), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8144 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=94
  add.10064 = f32[2304]{0} add(get-tuple-element.8144, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10065 = f32[1,1,2304]{2,1,0} reshape(add.10064), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10066 = f32[1,1,2304]{2,1,0} multiply(multiply.10063, reshape.10065), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.10067 = f32[1,1,2304]{2,1,0} add(multiply.10066, add.10025), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.10084 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.10085 = f32[1,1]{1,0} reshape(convert.10084), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.10086 = f32[1,1]{1,0} broadcast(reshape.10085), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.10087 = f32[1]{0} reshape(broadcast.10086), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.10088 = f32[1,31]{1,0} broadcast(reshape.10087), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.10089 = pred[1,31]{1,0} compare(broadcast.10088, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.10090 = pred[1,1,31]{2,1,0} reshape(compare.10089), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.10218 = s32[1,1,31]{2,1,0} convert(reshape.10090), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.10219 = pred[1,1,31]{2,1,0} compare(convert.10218, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.10220 = pred[1,1]{1,0} reduce(compare.10219, constant.8359), dimensions={2}, to_apply=region_240.7163, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.10221 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.10220), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.10068 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [8:9], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.10069 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.10068), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.10128 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.10069), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.10129 = f32[1,31,4,256]{3,2,1,0} reshape(slice.10128), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.10070 = f32[1,1,2304]{2,1,0} multiply(add.10067, add.10067), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10071 = f32[1,1]{1,0} reduce(multiply.10070, constant.8387), dimensions={2}, to_apply=region_237.7125, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10072 = f32[1,1,1]{2,1,0} reshape(reduce.10071), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10073 = f32[1,1,1]{2,1,0} divide(reshape.10072, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10074 = f32[1,1,1]{2,1,0} add(divide.10073, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10075 = f32[1,1,1]{2,1,0} sqrt(add.10074), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10076 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10075), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10077 = f32[1,1,1]{2,1,0} broadcast(divide.10076), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10078 = f32[1,1]{1,0} reshape(broadcast.10077), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10079 = f32[1,1,2304]{2,1,0} broadcast(reshape.10078), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10080 = f32[1,1,2304]{2,1,0} multiply(add.10067, broadcast.10079), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8145 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=95
  add.10081 = f32[2304]{0} add(get-tuple-element.8145, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10082 = f32[1,1,2304]{2,1,0} reshape(add.10081), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10083 = f32[1,1,2304]{2,1,0} multiply(multiply.10080, reshape.10082), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8148 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=98
  dot.10165 = f32[1,1,4,256]{3,2,1,0} dot(multiply.10083, get-tuple-element.8148), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.10170 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.10171 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.10172 = s32[] select(compare.10170, add.10171, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.10173 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.10129, dot.10165, constant.8391, select.10172, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.10126 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.10069), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.10127 = f32[1,31,4,256]{3,2,1,0} reshape(slice.10126), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8147 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=97
  dot.10130 = f32[1,1,4,256]{3,2,1,0} dot(multiply.10083, get-tuple-element.8147), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.10133 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.10134 = f32[1]{0} reshape(convert.10133), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.10135 = f32[1]{0} divide(reshape.10134, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.10131 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.10132 = f32[128]{0} divide(broadcast.8377, power.10131), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.10136 = f32[1,128]{1,0} dot(divide.10135, divide.10132), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.10137 = f32[1,1,128]{2,1,0} reshape(dot.10136), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10138 = f32[1,1,128]{2,1,0} reshape(dot.10136), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10139 = f32[1,2,128]{2,1,0} concatenate(reshape.10137, reshape.10138), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10140 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.10139), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.10141 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.10140), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.10150 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.10141), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10151 = f32[1,1,256]{2,1,0} reshape(broadcast.10150), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10152 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.10151), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10153 = f32[1,1,4,256]{3,2,1,0} multiply(dot.10130, broadcast.10152), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10144 = f32[1,1,4,128]{3,2,1,0} slice(dot.10130), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.10145 = f32[1,1,4,128]{3,2,1,0} negate(slice.10144), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.10146 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.10145), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10143 = f32[1,1,4,128]{3,2,1,0} slice(dot.10130), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10147 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.10143), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10148 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.10146, reshape.10147), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10149 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.10148), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.10142 = f32[1,1,1,256]{3,2,1,0} sine(reshape.10140), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.10154 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.10142), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10155 = f32[1,1,256]{2,1,0} reshape(broadcast.10154), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10156 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.10155), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10157 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.10149, broadcast.10156), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.10158 = f32[1,1,4,256]{3,2,1,0} add(multiply.10153, multiply.10157), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10159 = f32[1,1,4,128]{3,2,1,0} slice(add.10158), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10161 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.10159), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10160 = f32[1,1,4,128]{3,2,1,0} slice(add.10158), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10162 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.10160), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10163 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.10161, reshape.10162), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10164 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.10163), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.10166 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.10167 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.10168 = s32[] select(compare.10166, add.10167, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.10169 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.10127, reshape.10164, constant.8391, select.10168, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8146 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=96
  dot.10091 = f32[1,1,8,256]{3,2,1,0} dot(multiply.10083, get-tuple-element.8146), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.10094 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.10095 = f32[1]{0} reshape(convert.10094), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.10096 = f32[1]{0} divide(reshape.10095, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.10092 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.10093 = f32[128]{0} divide(broadcast.8377, power.10092), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.10097 = f32[1,128]{1,0} dot(divide.10096, divide.10093), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.10098 = f32[1,1,128]{2,1,0} reshape(dot.10097), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10099 = f32[1,1,128]{2,1,0} reshape(dot.10097), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10100 = f32[1,2,128]{2,1,0} concatenate(reshape.10098, reshape.10099), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10101 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.10100), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.10102 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.10101), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.10111 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.10102), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10112 = f32[1,1,256]{2,1,0} reshape(broadcast.10111), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10113 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.10112), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10114 = f32[1,1,8,256]{3,2,1,0} multiply(dot.10091, broadcast.10113), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10105 = f32[1,1,8,128]{3,2,1,0} slice(dot.10091), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.10106 = f32[1,1,8,128]{3,2,1,0} negate(slice.10105), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.10107 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.10106), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10104 = f32[1,1,8,128]{3,2,1,0} slice(dot.10091), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10108 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.10104), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10109 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.10107, reshape.10108), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10110 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.10109), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.10103 = f32[1,1,1,256]{3,2,1,0} sine(reshape.10101), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.10115 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.10103), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10116 = f32[1,1,256]{2,1,0} reshape(broadcast.10115), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10117 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.10116), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10118 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.10110, broadcast.10117), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.10119 = f32[1,1,8,256]{3,2,1,0} add(multiply.10114, multiply.10118), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/rotary_embedding_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10120 = f32[1,1,8,128]{3,2,1,0} slice(add.10119), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10122 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.10120), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10121 = f32[1,1,8,128]{3,2,1,0} slice(add.10119), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10123 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.10121), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10124 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.10122, reshape.10123), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10125 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.10124), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.10177 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.10125, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.10178 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.10177), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.10179 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.10169, reshape.10178), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.10180 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.10179), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.10181 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.10180, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.10182 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.10181), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.10183 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.10182, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.10184 = pred[31,31]{1,0} call(broadcast.8370), to_apply=triu_3.7129
  call.10185 = pred[31,31]{1,0} call(broadcast.8370), to_apply=tril_4.7142
  and.10186 = pred[31,31]{1,0} and(call.10184, call.10185), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  compare.10187 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  add.10188 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  select.10189 = s32[] select(compare.10187, add.10188, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  dynamic-slice.10190 = pred[1,31]{1,0} dynamic-slice(and.10186, select.10189, constant.8391), dynamic_slice_sizes={1,31}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/dynamic_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  reshape.10191 = pred[1,1,31]{2,1,0} reshape(dynamic-slice.10190), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.10192 = pred[1,1,31]{2,1,0} and(reshape.10090, reshape.10191), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.10193 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(and.10192), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.10194 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.10193), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.10195 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.10194), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.10196 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.10195, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.10197 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.10196), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.10198 = f32[1,1,31]{2,1,0} reshape(broadcast.10197), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.10199 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.10198), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.10200 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.10183, broadcast.10199), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.10201 = f32[1,4,2,1]{3,2,1,0} reduce(add.10200, constant.8364), dimensions={4}, to_apply=region_238.7155, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.10202 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.10201, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.10203 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.10202), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.10204 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.10203), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.10205 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.10204), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.10206 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.10205), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.10207 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.10200, broadcast.10206), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.10208 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.10207), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.10209 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.10208, constant.8387), dimensions={4}, to_apply=region_239.7159, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.10210 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.10209), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.10211 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.10210), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.10212 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.10211), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.10213 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.10212), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.10214 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.10208, broadcast.10213), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/softmax_8/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.10215 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.10173, divide.10214), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.10216 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.10215), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.10217 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.10216), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.10222 = f32[1,1,8,256]{3,2,1,0} call(reshape.10221, broadcast.8358, reshape.10217), to_apply=_where_5.7167
  get-tuple-element.8149 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=99
  dot.10223 = f32[1,1,2304]{2,1,0} dot(call.10222, get-tuple-element.8149), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10224 = f32[1,1,2304]{2,1,0} multiply(dot.10223, dot.10223), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10225 = f32[1,1]{1,0} reduce(multiply.10224, constant.8387), dimensions={2}, to_apply=region_241.7175, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10226 = f32[1,1,1]{2,1,0} reshape(reduce.10225), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10227 = f32[1,1,1]{2,1,0} divide(reshape.10226, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10228 = f32[1,1,1]{2,1,0} add(divide.10227, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10229 = f32[1,1,1]{2,1,0} sqrt(add.10228), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10230 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10229), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10231 = f32[1,1,1]{2,1,0} broadcast(divide.10230), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10232 = f32[1,1]{1,0} reshape(broadcast.10231), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10233 = f32[1,1,2304]{2,1,0} broadcast(reshape.10232), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10234 = f32[1,1,2304]{2,1,0} multiply(dot.10223, broadcast.10233), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8150 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=100
  add.10235 = f32[2304]{0} add(get-tuple-element.8150, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10236 = f32[1,1,2304]{2,1,0} reshape(add.10235), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10237 = f32[1,1,2304]{2,1,0} multiply(multiply.10234, reshape.10236), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.10238 = f32[1,1,2304]{2,1,0} add(add.10067, multiply.10237), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.10239 = f32[1,1,2304]{2,1,0} multiply(add.10238, add.10238), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10240 = f32[1,1]{1,0} reduce(multiply.10239, constant.8387), dimensions={2}, to_apply=region_242.7179, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10241 = f32[1,1,1]{2,1,0} reshape(reduce.10240), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10242 = f32[1,1,1]{2,1,0} divide(reshape.10241, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10243 = f32[1,1,1]{2,1,0} add(divide.10242, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10244 = f32[1,1,1]{2,1,0} sqrt(add.10243), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10245 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10244), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10246 = f32[1,1,1]{2,1,0} broadcast(divide.10245), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10247 = f32[1,1]{1,0} reshape(broadcast.10246), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10248 = f32[1,1,2304]{2,1,0} broadcast(reshape.10247), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10249 = f32[1,1,2304]{2,1,0} multiply(add.10238, broadcast.10248), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8151 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=101
  add.10250 = f32[2304]{0} add(get-tuple-element.8151, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10251 = f32[1,1,2304]{2,1,0} reshape(add.10250), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10252 = f32[1,1,2304]{2,1,0} multiply(multiply.10249, reshape.10251), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8152 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=102
  dot.10253 = f32[1,1,9216]{2,1,0} dot(multiply.10252, get-tuple-element.8152), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10255 = f32[1,1,9216]{2,1,0} multiply(dot.10253, dot.10253), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10256 = f32[1,1,9216]{2,1,0} multiply(multiply.10255, dot.10253), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10257 = f32[1,1,9216]{2,1,0} multiply(multiply.10256, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.10258 = f32[1,1,9216]{2,1,0} add(dot.10253, multiply.10257), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10259 = f32[1,1,9216]{2,1,0} multiply(add.10258, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.10260 = f32[1,1,9216]{2,1,0} tanh(multiply.10259), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.10261 = f32[1,1,9216]{2,1,0} add(tanh.10260, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10262 = f32[1,1,9216]{2,1,0} multiply(add.10261, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10263 = f32[1,1,9216]{2,1,0} multiply(dot.10253, multiply.10262), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8153 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=103
  dot.10254 = f32[1,1,9216]{2,1,0} dot(multiply.10252, get-tuple-element.8153), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10264 = f32[1,1,9216]{2,1,0} multiply(multiply.10263, dot.10254), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8154 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=104
  dot.10265 = f32[1,1,2304]{2,1,0} dot(multiply.10264, get-tuple-element.8154), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10266 = f32[1,1,2304]{2,1,0} multiply(dot.10265, dot.10265), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10267 = f32[1,1]{1,0} reduce(multiply.10266, constant.8387), dimensions={2}, to_apply=region_243.7183, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10268 = f32[1,1,1]{2,1,0} reshape(reduce.10267), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10269 = f32[1,1,1]{2,1,0} divide(reshape.10268, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10270 = f32[1,1,1]{2,1,0} add(divide.10269, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10271 = f32[1,1,1]{2,1,0} sqrt(add.10270), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10272 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10271), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10273 = f32[1,1,1]{2,1,0} broadcast(divide.10272), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10274 = f32[1,1]{1,0} reshape(broadcast.10273), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10275 = f32[1,1,2304]{2,1,0} broadcast(reshape.10274), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10276 = f32[1,1,2304]{2,1,0} multiply(dot.10265, broadcast.10275), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8155 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=105
  add.10277 = f32[2304]{0} add(get-tuple-element.8155, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10278 = f32[1,1,2304]{2,1,0} reshape(add.10277), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10279 = f32[1,1,2304]{2,1,0} multiply(multiply.10276, reshape.10278), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.10280 = f32[1,1,2304]{2,1,0} add(multiply.10279, add.10238), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.10297 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.10298 = f32[1,1]{1,0} reshape(convert.10297), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.10299 = f32[1,1]{1,0} broadcast(reshape.10298), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.10300 = f32[1]{0} reshape(broadcast.10299), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.10301 = f32[1,31]{1,0} broadcast(reshape.10300), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.10302 = pred[1,31]{1,0} compare(broadcast.10301, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.10303 = pred[1,1,31]{2,1,0} reshape(compare.10302), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.10422 = s32[1,1,31]{2,1,0} convert(reshape.10303), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.10423 = pred[1,1,31]{2,1,0} compare(convert.10422, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.10424 = pred[1,1]{1,0} reduce(compare.10423, constant.8359), dimensions={2}, to_apply=region_247.7199, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.10425 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.10424), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.10281 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [9:10], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.10282 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.10281), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.10341 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.10282), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.10342 = f32[1,31,4,256]{3,2,1,0} reshape(slice.10341), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.10283 = f32[1,1,2304]{2,1,0} multiply(add.10280, add.10280), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10284 = f32[1,1]{1,0} reduce(multiply.10283, constant.8387), dimensions={2}, to_apply=region_244.7187, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10285 = f32[1,1,1]{2,1,0} reshape(reduce.10284), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10286 = f32[1,1,1]{2,1,0} divide(reshape.10285, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10287 = f32[1,1,1]{2,1,0} add(divide.10286, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10288 = f32[1,1,1]{2,1,0} sqrt(add.10287), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10289 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10288), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10290 = f32[1,1,1]{2,1,0} broadcast(divide.10289), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10291 = f32[1,1]{1,0} reshape(broadcast.10290), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10292 = f32[1,1,2304]{2,1,0} broadcast(reshape.10291), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10293 = f32[1,1,2304]{2,1,0} multiply(add.10280, broadcast.10292), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8156 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=106
  add.10294 = f32[2304]{0} add(get-tuple-element.8156, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10295 = f32[1,1,2304]{2,1,0} reshape(add.10294), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10296 = f32[1,1,2304]{2,1,0} multiply(multiply.10293, reshape.10295), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8159 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=109
  dot.10378 = f32[1,1,4,256]{3,2,1,0} dot(multiply.10296, get-tuple-element.8159), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.10383 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.10384 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.10385 = s32[] select(compare.10383, add.10384, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.10386 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.10342, dot.10378, constant.8391, select.10385, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.10339 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.10282), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.10340 = f32[1,31,4,256]{3,2,1,0} reshape(slice.10339), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8158 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=108
  dot.10343 = f32[1,1,4,256]{3,2,1,0} dot(multiply.10296, get-tuple-element.8158), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.10346 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.10347 = f32[1]{0} reshape(convert.10346), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.10348 = f32[1]{0} divide(reshape.10347, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.10344 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.10345 = f32[128]{0} divide(broadcast.8377, power.10344), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.10349 = f32[1,128]{1,0} dot(divide.10348, divide.10345), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.10350 = f32[1,1,128]{2,1,0} reshape(dot.10349), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10351 = f32[1,1,128]{2,1,0} reshape(dot.10349), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10352 = f32[1,2,128]{2,1,0} concatenate(reshape.10350, reshape.10351), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10353 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.10352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.10354 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.10353), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.10363 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.10354), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10364 = f32[1,1,256]{2,1,0} reshape(broadcast.10363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10365 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.10364), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10366 = f32[1,1,4,256]{3,2,1,0} multiply(dot.10343, broadcast.10365), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10357 = f32[1,1,4,128]{3,2,1,0} slice(dot.10343), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.10358 = f32[1,1,4,128]{3,2,1,0} negate(slice.10357), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.10359 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.10358), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10356 = f32[1,1,4,128]{3,2,1,0} slice(dot.10343), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10360 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.10356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10361 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.10359, reshape.10360), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10362 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.10361), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.10355 = f32[1,1,1,256]{3,2,1,0} sine(reshape.10353), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.10367 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.10355), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10368 = f32[1,1,256]{2,1,0} reshape(broadcast.10367), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10369 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.10368), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10370 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.10362, broadcast.10369), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.10371 = f32[1,1,4,256]{3,2,1,0} add(multiply.10366, multiply.10370), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10372 = f32[1,1,4,128]{3,2,1,0} slice(add.10371), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10374 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.10372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10373 = f32[1,1,4,128]{3,2,1,0} slice(add.10371), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10375 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.10373), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10376 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.10374, reshape.10375), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10377 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.10376), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.10379 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.10380 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.10381 = s32[] select(compare.10379, add.10380, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.10382 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.10340, reshape.10377, constant.8391, select.10381, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8157 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=107
  dot.10304 = f32[1,1,8,256]{3,2,1,0} dot(multiply.10296, get-tuple-element.8157), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.10307 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.10308 = f32[1]{0} reshape(convert.10307), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.10309 = f32[1]{0} divide(reshape.10308, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.10305 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.10306 = f32[128]{0} divide(broadcast.8377, power.10305), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.10310 = f32[1,128]{1,0} dot(divide.10309, divide.10306), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.10311 = f32[1,1,128]{2,1,0} reshape(dot.10310), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10312 = f32[1,1,128]{2,1,0} reshape(dot.10310), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10313 = f32[1,2,128]{2,1,0} concatenate(reshape.10311, reshape.10312), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10314 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.10313), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.10315 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.10314), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.10324 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.10315), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10325 = f32[1,1,256]{2,1,0} reshape(broadcast.10324), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10326 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.10325), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10327 = f32[1,1,8,256]{3,2,1,0} multiply(dot.10304, broadcast.10326), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10318 = f32[1,1,8,128]{3,2,1,0} slice(dot.10304), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.10319 = f32[1,1,8,128]{3,2,1,0} negate(slice.10318), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.10320 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.10319), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10317 = f32[1,1,8,128]{3,2,1,0} slice(dot.10304), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10321 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.10317), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10322 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.10320, reshape.10321), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10323 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.10322), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.10316 = f32[1,1,1,256]{3,2,1,0} sine(reshape.10314), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.10328 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.10316), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10329 = f32[1,1,256]{2,1,0} reshape(broadcast.10328), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10330 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.10329), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10331 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.10323, broadcast.10330), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.10332 = f32[1,1,8,256]{3,2,1,0} add(multiply.10327, multiply.10331), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/rotary_embedding_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10333 = f32[1,1,8,128]{3,2,1,0} slice(add.10332), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10335 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.10333), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10334 = f32[1,1,8,128]{3,2,1,0} slice(add.10332), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10336 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.10334), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10337 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.10335, reshape.10336), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10338 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.10337), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.10390 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.10338, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.10391 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.10390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.10392 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.10382, reshape.10391), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.10393 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.10392), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.10394 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.10393, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.10395 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.10394), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.10396 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.10395, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.10397 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(compare.10302), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.10398 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.10397), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.10399 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.10398), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.10400 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.10399, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.10401 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.10400), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.10402 = f32[1,1,31]{2,1,0} reshape(broadcast.10401), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.10403 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.10402), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.10404 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.10396, broadcast.10403), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.10405 = f32[1,4,2,1]{3,2,1,0} reduce(add.10404, constant.8364), dimensions={4}, to_apply=region_245.7191, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.10406 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.10405, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.10407 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.10406), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.10408 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.10407), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.10409 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.10408), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.10410 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.10409), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.10411 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.10404, broadcast.10410), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.10412 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.10411), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.10413 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.10412, constant.8387), dimensions={4}, to_apply=region_246.7195, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.10414 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.10413), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.10415 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.10414), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.10416 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.10415), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.10417 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.10416), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.10418 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.10412, broadcast.10417), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/softmax_9/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.10419 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.10386, divide.10418), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.10420 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.10419), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.10421 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.10420), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.10426 = f32[1,1,8,256]{3,2,1,0} call(reshape.10425, broadcast.8358, reshape.10421), to_apply=_where_5.7203
  get-tuple-element.8160 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=110
  dot.10427 = f32[1,1,2304]{2,1,0} dot(call.10426, get-tuple-element.8160), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10428 = f32[1,1,2304]{2,1,0} multiply(dot.10427, dot.10427), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10429 = f32[1,1]{1,0} reduce(multiply.10428, constant.8387), dimensions={2}, to_apply=region_248.7211, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10430 = f32[1,1,1]{2,1,0} reshape(reduce.10429), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10431 = f32[1,1,1]{2,1,0} divide(reshape.10430, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10432 = f32[1,1,1]{2,1,0} add(divide.10431, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10433 = f32[1,1,1]{2,1,0} sqrt(add.10432), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10434 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10433), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10435 = f32[1,1,1]{2,1,0} broadcast(divide.10434), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10436 = f32[1,1]{1,0} reshape(broadcast.10435), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10437 = f32[1,1,2304]{2,1,0} broadcast(reshape.10436), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10438 = f32[1,1,2304]{2,1,0} multiply(dot.10427, broadcast.10437), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8161 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=111
  add.10439 = f32[2304]{0} add(get-tuple-element.8161, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10440 = f32[1,1,2304]{2,1,0} reshape(add.10439), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10441 = f32[1,1,2304]{2,1,0} multiply(multiply.10438, reshape.10440), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.10442 = f32[1,1,2304]{2,1,0} add(add.10280, multiply.10441), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.10443 = f32[1,1,2304]{2,1,0} multiply(add.10442, add.10442), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10444 = f32[1,1]{1,0} reduce(multiply.10443, constant.8387), dimensions={2}, to_apply=region_249.7215, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10445 = f32[1,1,1]{2,1,0} reshape(reduce.10444), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10446 = f32[1,1,1]{2,1,0} divide(reshape.10445, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10447 = f32[1,1,1]{2,1,0} add(divide.10446, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10448 = f32[1,1,1]{2,1,0} sqrt(add.10447), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10449 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10448), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10450 = f32[1,1,1]{2,1,0} broadcast(divide.10449), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10451 = f32[1,1]{1,0} reshape(broadcast.10450), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10452 = f32[1,1,2304]{2,1,0} broadcast(reshape.10451), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10453 = f32[1,1,2304]{2,1,0} multiply(add.10442, broadcast.10452), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8162 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=112
  add.10454 = f32[2304]{0} add(get-tuple-element.8162, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10455 = f32[1,1,2304]{2,1,0} reshape(add.10454), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10456 = f32[1,1,2304]{2,1,0} multiply(multiply.10453, reshape.10455), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8163 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=113
  dot.10457 = f32[1,1,9216]{2,1,0} dot(multiply.10456, get-tuple-element.8163), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10459 = f32[1,1,9216]{2,1,0} multiply(dot.10457, dot.10457), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10460 = f32[1,1,9216]{2,1,0} multiply(multiply.10459, dot.10457), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10461 = f32[1,1,9216]{2,1,0} multiply(multiply.10460, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.10462 = f32[1,1,9216]{2,1,0} add(dot.10457, multiply.10461), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10463 = f32[1,1,9216]{2,1,0} multiply(add.10462, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.10464 = f32[1,1,9216]{2,1,0} tanh(multiply.10463), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.10465 = f32[1,1,9216]{2,1,0} add(tanh.10464, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10466 = f32[1,1,9216]{2,1,0} multiply(add.10465, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10467 = f32[1,1,9216]{2,1,0} multiply(dot.10457, multiply.10466), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8164 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=114
  dot.10458 = f32[1,1,9216]{2,1,0} dot(multiply.10456, get-tuple-element.8164), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10468 = f32[1,1,9216]{2,1,0} multiply(multiply.10467, dot.10458), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8165 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=115
  dot.10469 = f32[1,1,2304]{2,1,0} dot(multiply.10468, get-tuple-element.8165), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10470 = f32[1,1,2304]{2,1,0} multiply(dot.10469, dot.10469), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10471 = f32[1,1]{1,0} reduce(multiply.10470, constant.8387), dimensions={2}, to_apply=region_250.7219, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10472 = f32[1,1,1]{2,1,0} reshape(reduce.10471), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10473 = f32[1,1,1]{2,1,0} divide(reshape.10472, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10474 = f32[1,1,1]{2,1,0} add(divide.10473, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10475 = f32[1,1,1]{2,1,0} sqrt(add.10474), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10476 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10475), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10477 = f32[1,1,1]{2,1,0} broadcast(divide.10476), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10478 = f32[1,1]{1,0} reshape(broadcast.10477), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10479 = f32[1,1,2304]{2,1,0} broadcast(reshape.10478), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10480 = f32[1,1,2304]{2,1,0} multiply(dot.10469, broadcast.10479), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8166 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=116
  add.10481 = f32[2304]{0} add(get-tuple-element.8166, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10482 = f32[1,1,2304]{2,1,0} reshape(add.10481), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10483 = f32[1,1,2304]{2,1,0} multiply(multiply.10480, reshape.10482), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.10484 = f32[1,1,2304]{2,1,0} add(multiply.10483, add.10442), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.10501 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.10502 = f32[1,1]{1,0} reshape(convert.10501), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.10503 = f32[1,1]{1,0} broadcast(reshape.10502), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.10504 = f32[1]{0} reshape(broadcast.10503), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.10505 = f32[1,31]{1,0} broadcast(reshape.10504), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.10506 = pred[1,31]{1,0} compare(broadcast.10505, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.10507 = pred[1,1,31]{2,1,0} reshape(compare.10506), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.10635 = s32[1,1,31]{2,1,0} convert(reshape.10507), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.10636 = pred[1,1,31]{2,1,0} compare(convert.10635, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.10637 = pred[1,1]{1,0} reduce(compare.10636, constant.8359), dimensions={2}, to_apply=region_254.7261, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.10638 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.10637), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.10485 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [10:11], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.10486 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.10485), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.10545 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.10486), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.10546 = f32[1,31,4,256]{3,2,1,0} reshape(slice.10545), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.10487 = f32[1,1,2304]{2,1,0} multiply(add.10484, add.10484), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10488 = f32[1,1]{1,0} reduce(multiply.10487, constant.8387), dimensions={2}, to_apply=region_251.7223, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10489 = f32[1,1,1]{2,1,0} reshape(reduce.10488), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10490 = f32[1,1,1]{2,1,0} divide(reshape.10489, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10491 = f32[1,1,1]{2,1,0} add(divide.10490, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10492 = f32[1,1,1]{2,1,0} sqrt(add.10491), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10493 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10492), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10494 = f32[1,1,1]{2,1,0} broadcast(divide.10493), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10495 = f32[1,1]{1,0} reshape(broadcast.10494), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10496 = f32[1,1,2304]{2,1,0} broadcast(reshape.10495), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10497 = f32[1,1,2304]{2,1,0} multiply(add.10484, broadcast.10496), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8167 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=117
  add.10498 = f32[2304]{0} add(get-tuple-element.8167, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10499 = f32[1,1,2304]{2,1,0} reshape(add.10498), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10500 = f32[1,1,2304]{2,1,0} multiply(multiply.10497, reshape.10499), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8170 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=120
  dot.10582 = f32[1,1,4,256]{3,2,1,0} dot(multiply.10500, get-tuple-element.8170), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.10587 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.10588 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.10589 = s32[] select(compare.10587, add.10588, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.10590 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.10546, dot.10582, constant.8391, select.10589, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.10543 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.10486), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.10544 = f32[1,31,4,256]{3,2,1,0} reshape(slice.10543), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8169 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=119
  dot.10547 = f32[1,1,4,256]{3,2,1,0} dot(multiply.10500, get-tuple-element.8169), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.10550 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.10551 = f32[1]{0} reshape(convert.10550), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.10552 = f32[1]{0} divide(reshape.10551, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.10548 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.10549 = f32[128]{0} divide(broadcast.8377, power.10548), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.10553 = f32[1,128]{1,0} dot(divide.10552, divide.10549), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.10554 = f32[1,1,128]{2,1,0} reshape(dot.10553), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10555 = f32[1,1,128]{2,1,0} reshape(dot.10553), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10556 = f32[1,2,128]{2,1,0} concatenate(reshape.10554, reshape.10555), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10557 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.10556), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.10558 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.10557), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.10567 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.10558), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10568 = f32[1,1,256]{2,1,0} reshape(broadcast.10567), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10569 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.10568), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10570 = f32[1,1,4,256]{3,2,1,0} multiply(dot.10547, broadcast.10569), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10561 = f32[1,1,4,128]{3,2,1,0} slice(dot.10547), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.10562 = f32[1,1,4,128]{3,2,1,0} negate(slice.10561), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.10563 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.10562), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10560 = f32[1,1,4,128]{3,2,1,0} slice(dot.10547), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10564 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.10560), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10565 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.10563, reshape.10564), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10566 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.10565), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.10559 = f32[1,1,1,256]{3,2,1,0} sine(reshape.10557), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.10571 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.10559), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10572 = f32[1,1,256]{2,1,0} reshape(broadcast.10571), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10573 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.10572), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10574 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.10566, broadcast.10573), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.10575 = f32[1,1,4,256]{3,2,1,0} add(multiply.10570, multiply.10574), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10576 = f32[1,1,4,128]{3,2,1,0} slice(add.10575), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10578 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.10576), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10577 = f32[1,1,4,128]{3,2,1,0} slice(add.10575), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10579 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.10577), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10580 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.10578, reshape.10579), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10581 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.10580), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.10583 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.10584 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.10585 = s32[] select(compare.10583, add.10584, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.10586 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.10544, reshape.10581, constant.8391, select.10585, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8168 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=118
  dot.10508 = f32[1,1,8,256]{3,2,1,0} dot(multiply.10500, get-tuple-element.8168), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.10511 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.10512 = f32[1]{0} reshape(convert.10511), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.10513 = f32[1]{0} divide(reshape.10512, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.10509 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.10510 = f32[128]{0} divide(broadcast.8377, power.10509), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.10514 = f32[1,128]{1,0} dot(divide.10513, divide.10510), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.10515 = f32[1,1,128]{2,1,0} reshape(dot.10514), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10516 = f32[1,1,128]{2,1,0} reshape(dot.10514), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10517 = f32[1,2,128]{2,1,0} concatenate(reshape.10515, reshape.10516), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10518 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.10517), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.10519 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.10518), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.10528 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.10519), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10529 = f32[1,1,256]{2,1,0} reshape(broadcast.10528), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10530 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.10529), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10531 = f32[1,1,8,256]{3,2,1,0} multiply(dot.10508, broadcast.10530), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10522 = f32[1,1,8,128]{3,2,1,0} slice(dot.10508), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.10523 = f32[1,1,8,128]{3,2,1,0} negate(slice.10522), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.10524 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.10523), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10521 = f32[1,1,8,128]{3,2,1,0} slice(dot.10508), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10525 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.10521), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10526 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.10524, reshape.10525), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10527 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.10526), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.10520 = f32[1,1,1,256]{3,2,1,0} sine(reshape.10518), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.10532 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.10520), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10533 = f32[1,1,256]{2,1,0} reshape(broadcast.10532), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10534 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.10533), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10535 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.10527, broadcast.10534), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.10536 = f32[1,1,8,256]{3,2,1,0} add(multiply.10531, multiply.10535), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/rotary_embedding_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10537 = f32[1,1,8,128]{3,2,1,0} slice(add.10536), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10539 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.10537), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10538 = f32[1,1,8,128]{3,2,1,0} slice(add.10536), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10540 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.10538), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10541 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.10539, reshape.10540), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10542 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.10541), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.10594 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.10542, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.10595 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.10594), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.10596 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.10586, reshape.10595), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.10597 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.10596), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.10598 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.10597, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.10599 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.10598), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.10600 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.10599, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.10601 = pred[31,31]{1,0} call(broadcast.8370), to_apply=triu_3.7227
  call.10602 = pred[31,31]{1,0} call(broadcast.8370), to_apply=tril_4.7240
  and.10603 = pred[31,31]{1,0} and(call.10601, call.10602), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  compare.10604 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  add.10605 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  select.10606 = s32[] select(compare.10604, add.10605, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  dynamic-slice.10607 = pred[1,31]{1,0} dynamic-slice(and.10603, select.10606, constant.8391), dynamic_slice_sizes={1,31}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/dynamic_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  reshape.10608 = pred[1,1,31]{2,1,0} reshape(dynamic-slice.10607), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.10609 = pred[1,1,31]{2,1,0} and(reshape.10507, reshape.10608), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.10610 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(and.10609), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.10611 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.10610), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.10612 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.10611), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.10613 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.10612, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.10614 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.10613), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.10615 = f32[1,1,31]{2,1,0} reshape(broadcast.10614), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.10616 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.10615), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.10617 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.10600, broadcast.10616), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.10618 = f32[1,4,2,1]{3,2,1,0} reduce(add.10617, constant.8364), dimensions={4}, to_apply=region_252.7253, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.10619 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.10618, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.10620 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.10619), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.10621 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.10620), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.10622 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.10621), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.10623 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.10622), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.10624 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.10617, broadcast.10623), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.10625 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.10624), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.10626 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.10625, constant.8387), dimensions={4}, to_apply=region_253.7257, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.10627 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.10626), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.10628 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.10627), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.10629 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.10628), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.10630 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.10629), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.10631 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.10625, broadcast.10630), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/softmax_10/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.10632 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.10590, divide.10631), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.10633 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.10632), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.10634 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.10633), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.10639 = f32[1,1,8,256]{3,2,1,0} call(reshape.10638, broadcast.8358, reshape.10634), to_apply=_where_5.7265
  get-tuple-element.8171 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=121
  dot.10640 = f32[1,1,2304]{2,1,0} dot(call.10639, get-tuple-element.8171), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10641 = f32[1,1,2304]{2,1,0} multiply(dot.10640, dot.10640), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10642 = f32[1,1]{1,0} reduce(multiply.10641, constant.8387), dimensions={2}, to_apply=region_255.7273, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10643 = f32[1,1,1]{2,1,0} reshape(reduce.10642), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10644 = f32[1,1,1]{2,1,0} divide(reshape.10643, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10645 = f32[1,1,1]{2,1,0} add(divide.10644, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10646 = f32[1,1,1]{2,1,0} sqrt(add.10645), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10647 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10646), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10648 = f32[1,1,1]{2,1,0} broadcast(divide.10647), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10649 = f32[1,1]{1,0} reshape(broadcast.10648), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10650 = f32[1,1,2304]{2,1,0} broadcast(reshape.10649), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10651 = f32[1,1,2304]{2,1,0} multiply(dot.10640, broadcast.10650), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8172 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=122
  add.10652 = f32[2304]{0} add(get-tuple-element.8172, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10653 = f32[1,1,2304]{2,1,0} reshape(add.10652), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10654 = f32[1,1,2304]{2,1,0} multiply(multiply.10651, reshape.10653), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.10655 = f32[1,1,2304]{2,1,0} add(add.10484, multiply.10654), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.10656 = f32[1,1,2304]{2,1,0} multiply(add.10655, add.10655), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10657 = f32[1,1]{1,0} reduce(multiply.10656, constant.8387), dimensions={2}, to_apply=region_256.7277, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10658 = f32[1,1,1]{2,1,0} reshape(reduce.10657), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10659 = f32[1,1,1]{2,1,0} divide(reshape.10658, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10660 = f32[1,1,1]{2,1,0} add(divide.10659, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10661 = f32[1,1,1]{2,1,0} sqrt(add.10660), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10662 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10661), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10663 = f32[1,1,1]{2,1,0} broadcast(divide.10662), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10664 = f32[1,1]{1,0} reshape(broadcast.10663), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10665 = f32[1,1,2304]{2,1,0} broadcast(reshape.10664), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10666 = f32[1,1,2304]{2,1,0} multiply(add.10655, broadcast.10665), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8173 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=123
  add.10667 = f32[2304]{0} add(get-tuple-element.8173, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10668 = f32[1,1,2304]{2,1,0} reshape(add.10667), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10669 = f32[1,1,2304]{2,1,0} multiply(multiply.10666, reshape.10668), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8174 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=124
  dot.10670 = f32[1,1,9216]{2,1,0} dot(multiply.10669, get-tuple-element.8174), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10672 = f32[1,1,9216]{2,1,0} multiply(dot.10670, dot.10670), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10673 = f32[1,1,9216]{2,1,0} multiply(multiply.10672, dot.10670), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10674 = f32[1,1,9216]{2,1,0} multiply(multiply.10673, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.10675 = f32[1,1,9216]{2,1,0} add(dot.10670, multiply.10674), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10676 = f32[1,1,9216]{2,1,0} multiply(add.10675, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.10677 = f32[1,1,9216]{2,1,0} tanh(multiply.10676), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.10678 = f32[1,1,9216]{2,1,0} add(tanh.10677, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10679 = f32[1,1,9216]{2,1,0} multiply(add.10678, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10680 = f32[1,1,9216]{2,1,0} multiply(dot.10670, multiply.10679), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8175 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=125
  dot.10671 = f32[1,1,9216]{2,1,0} dot(multiply.10669, get-tuple-element.8175), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10681 = f32[1,1,9216]{2,1,0} multiply(multiply.10680, dot.10671), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8176 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=126
  dot.10682 = f32[1,1,2304]{2,1,0} dot(multiply.10681, get-tuple-element.8176), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10683 = f32[1,1,2304]{2,1,0} multiply(dot.10682, dot.10682), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10684 = f32[1,1]{1,0} reduce(multiply.10683, constant.8387), dimensions={2}, to_apply=region_257.7281, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10685 = f32[1,1,1]{2,1,0} reshape(reduce.10684), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10686 = f32[1,1,1]{2,1,0} divide(reshape.10685, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10687 = f32[1,1,1]{2,1,0} add(divide.10686, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10688 = f32[1,1,1]{2,1,0} sqrt(add.10687), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10689 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10688), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10690 = f32[1,1,1]{2,1,0} broadcast(divide.10689), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10691 = f32[1,1]{1,0} reshape(broadcast.10690), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10692 = f32[1,1,2304]{2,1,0} broadcast(reshape.10691), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10693 = f32[1,1,2304]{2,1,0} multiply(dot.10682, broadcast.10692), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8177 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=127
  add.10694 = f32[2304]{0} add(get-tuple-element.8177, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10695 = f32[1,1,2304]{2,1,0} reshape(add.10694), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10696 = f32[1,1,2304]{2,1,0} multiply(multiply.10693, reshape.10695), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.10697 = f32[1,1,2304]{2,1,0} add(multiply.10696, add.10655), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.10714 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.10715 = f32[1,1]{1,0} reshape(convert.10714), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.10716 = f32[1,1]{1,0} broadcast(reshape.10715), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.10717 = f32[1]{0} reshape(broadcast.10716), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.10718 = f32[1,31]{1,0} broadcast(reshape.10717), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.10719 = pred[1,31]{1,0} compare(broadcast.10718, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.10720 = pred[1,1,31]{2,1,0} reshape(compare.10719), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.10839 = s32[1,1,31]{2,1,0} convert(reshape.10720), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.10840 = pred[1,1,31]{2,1,0} compare(convert.10839, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.10841 = pred[1,1]{1,0} reduce(compare.10840, constant.8359), dimensions={2}, to_apply=region_261.7297, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.10842 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.10841), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.10698 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [11:12], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.10699 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.10698), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.10758 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.10699), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.10759 = f32[1,31,4,256]{3,2,1,0} reshape(slice.10758), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.10700 = f32[1,1,2304]{2,1,0} multiply(add.10697, add.10697), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10701 = f32[1,1]{1,0} reduce(multiply.10700, constant.8387), dimensions={2}, to_apply=region_258.7285, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10702 = f32[1,1,1]{2,1,0} reshape(reduce.10701), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10703 = f32[1,1,1]{2,1,0} divide(reshape.10702, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10704 = f32[1,1,1]{2,1,0} add(divide.10703, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10705 = f32[1,1,1]{2,1,0} sqrt(add.10704), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10706 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10705), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10707 = f32[1,1,1]{2,1,0} broadcast(divide.10706), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10708 = f32[1,1]{1,0} reshape(broadcast.10707), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10709 = f32[1,1,2304]{2,1,0} broadcast(reshape.10708), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10710 = f32[1,1,2304]{2,1,0} multiply(add.10697, broadcast.10709), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8178 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=128
  add.10711 = f32[2304]{0} add(get-tuple-element.8178, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10712 = f32[1,1,2304]{2,1,0} reshape(add.10711), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10713 = f32[1,1,2304]{2,1,0} multiply(multiply.10710, reshape.10712), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8181 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=131
  dot.10795 = f32[1,1,4,256]{3,2,1,0} dot(multiply.10713, get-tuple-element.8181), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.10800 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.10801 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.10802 = s32[] select(compare.10800, add.10801, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.10803 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.10759, dot.10795, constant.8391, select.10802, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.10756 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.10699), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.10757 = f32[1,31,4,256]{3,2,1,0} reshape(slice.10756), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8180 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=130
  dot.10760 = f32[1,1,4,256]{3,2,1,0} dot(multiply.10713, get-tuple-element.8180), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.10763 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.10764 = f32[1]{0} reshape(convert.10763), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.10765 = f32[1]{0} divide(reshape.10764, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.10761 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.10762 = f32[128]{0} divide(broadcast.8377, power.10761), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.10766 = f32[1,128]{1,0} dot(divide.10765, divide.10762), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.10767 = f32[1,1,128]{2,1,0} reshape(dot.10766), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10768 = f32[1,1,128]{2,1,0} reshape(dot.10766), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10769 = f32[1,2,128]{2,1,0} concatenate(reshape.10767, reshape.10768), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10770 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.10769), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.10771 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.10770), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.10780 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.10771), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10781 = f32[1,1,256]{2,1,0} reshape(broadcast.10780), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10782 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.10781), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10783 = f32[1,1,4,256]{3,2,1,0} multiply(dot.10760, broadcast.10782), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10774 = f32[1,1,4,128]{3,2,1,0} slice(dot.10760), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.10775 = f32[1,1,4,128]{3,2,1,0} negate(slice.10774), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.10776 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.10775), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10773 = f32[1,1,4,128]{3,2,1,0} slice(dot.10760), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10777 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.10773), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10778 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.10776, reshape.10777), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10779 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.10778), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.10772 = f32[1,1,1,256]{3,2,1,0} sine(reshape.10770), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.10784 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.10772), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10785 = f32[1,1,256]{2,1,0} reshape(broadcast.10784), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10786 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.10785), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10787 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.10779, broadcast.10786), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.10788 = f32[1,1,4,256]{3,2,1,0} add(multiply.10783, multiply.10787), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10789 = f32[1,1,4,128]{3,2,1,0} slice(add.10788), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10791 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.10789), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10790 = f32[1,1,4,128]{3,2,1,0} slice(add.10788), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10792 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.10790), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10793 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.10791, reshape.10792), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10794 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.10793), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.10796 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.10797 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.10798 = s32[] select(compare.10796, add.10797, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.10799 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.10757, reshape.10794, constant.8391, select.10798, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8179 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=129
  dot.10721 = f32[1,1,8,256]{3,2,1,0} dot(multiply.10713, get-tuple-element.8179), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.10724 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.10725 = f32[1]{0} reshape(convert.10724), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.10726 = f32[1]{0} divide(reshape.10725, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.10722 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.10723 = f32[128]{0} divide(broadcast.8377, power.10722), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.10727 = f32[1,128]{1,0} dot(divide.10726, divide.10723), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.10728 = f32[1,1,128]{2,1,0} reshape(dot.10727), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10729 = f32[1,1,128]{2,1,0} reshape(dot.10727), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10730 = f32[1,2,128]{2,1,0} concatenate(reshape.10728, reshape.10729), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10731 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.10730), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.10732 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.10731), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.10741 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.10732), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10742 = f32[1,1,256]{2,1,0} reshape(broadcast.10741), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10743 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.10742), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10744 = f32[1,1,8,256]{3,2,1,0} multiply(dot.10721, broadcast.10743), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10735 = f32[1,1,8,128]{3,2,1,0} slice(dot.10721), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.10736 = f32[1,1,8,128]{3,2,1,0} negate(slice.10735), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.10737 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.10736), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10734 = f32[1,1,8,128]{3,2,1,0} slice(dot.10721), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10738 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.10734), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10739 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.10737, reshape.10738), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10740 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.10739), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.10733 = f32[1,1,1,256]{3,2,1,0} sine(reshape.10731), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.10745 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.10733), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10746 = f32[1,1,256]{2,1,0} reshape(broadcast.10745), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10747 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.10746), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10748 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.10740, broadcast.10747), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.10749 = f32[1,1,8,256]{3,2,1,0} add(multiply.10744, multiply.10748), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/rotary_embedding_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10750 = f32[1,1,8,128]{3,2,1,0} slice(add.10749), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10752 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.10750), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10751 = f32[1,1,8,128]{3,2,1,0} slice(add.10749), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10753 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.10751), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10754 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.10752, reshape.10753), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10755 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.10754), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.10807 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.10755, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.10808 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.10807), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.10809 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.10799, reshape.10808), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.10810 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.10809), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.10811 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.10810, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.10812 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.10811), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.10813 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.10812, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.10814 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(compare.10719), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.10815 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.10814), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.10816 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.10815), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.10817 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.10816, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.10818 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.10817), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.10819 = f32[1,1,31]{2,1,0} reshape(broadcast.10818), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.10820 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.10819), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.10821 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.10813, broadcast.10820), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.10822 = f32[1,4,2,1]{3,2,1,0} reduce(add.10821, constant.8364), dimensions={4}, to_apply=region_259.7289, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.10823 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.10822, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.10824 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.10823), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.10825 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.10824), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.10826 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.10825), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.10827 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.10826), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.10828 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.10821, broadcast.10827), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.10829 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.10828), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.10830 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.10829, constant.8387), dimensions={4}, to_apply=region_260.7293, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.10831 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.10830), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.10832 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.10831), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.10833 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.10832), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.10834 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.10833), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.10835 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.10829, broadcast.10834), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/softmax_11/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.10836 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.10803, divide.10835), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.10837 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.10836), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.10838 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.10837), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.10843 = f32[1,1,8,256]{3,2,1,0} call(reshape.10842, broadcast.8358, reshape.10838), to_apply=_where_5.7301
  get-tuple-element.8182 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=132
  dot.10844 = f32[1,1,2304]{2,1,0} dot(call.10843, get-tuple-element.8182), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10845 = f32[1,1,2304]{2,1,0} multiply(dot.10844, dot.10844), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10846 = f32[1,1]{1,0} reduce(multiply.10845, constant.8387), dimensions={2}, to_apply=region_262.7309, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10847 = f32[1,1,1]{2,1,0} reshape(reduce.10846), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10848 = f32[1,1,1]{2,1,0} divide(reshape.10847, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10849 = f32[1,1,1]{2,1,0} add(divide.10848, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10850 = f32[1,1,1]{2,1,0} sqrt(add.10849), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10851 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10850), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10852 = f32[1,1,1]{2,1,0} broadcast(divide.10851), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10853 = f32[1,1]{1,0} reshape(broadcast.10852), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10854 = f32[1,1,2304]{2,1,0} broadcast(reshape.10853), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10855 = f32[1,1,2304]{2,1,0} multiply(dot.10844, broadcast.10854), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8183 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=133
  add.10856 = f32[2304]{0} add(get-tuple-element.8183, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10857 = f32[1,1,2304]{2,1,0} reshape(add.10856), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10858 = f32[1,1,2304]{2,1,0} multiply(multiply.10855, reshape.10857), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.10859 = f32[1,1,2304]{2,1,0} add(add.10697, multiply.10858), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.10860 = f32[1,1,2304]{2,1,0} multiply(add.10859, add.10859), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10861 = f32[1,1]{1,0} reduce(multiply.10860, constant.8387), dimensions={2}, to_apply=region_263.7313, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10862 = f32[1,1,1]{2,1,0} reshape(reduce.10861), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10863 = f32[1,1,1]{2,1,0} divide(reshape.10862, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10864 = f32[1,1,1]{2,1,0} add(divide.10863, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10865 = f32[1,1,1]{2,1,0} sqrt(add.10864), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10866 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10865), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10867 = f32[1,1,1]{2,1,0} broadcast(divide.10866), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10868 = f32[1,1]{1,0} reshape(broadcast.10867), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10869 = f32[1,1,2304]{2,1,0} broadcast(reshape.10868), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10870 = f32[1,1,2304]{2,1,0} multiply(add.10859, broadcast.10869), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8184 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=134
  add.10871 = f32[2304]{0} add(get-tuple-element.8184, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10872 = f32[1,1,2304]{2,1,0} reshape(add.10871), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10873 = f32[1,1,2304]{2,1,0} multiply(multiply.10870, reshape.10872), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8185 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=135
  dot.10874 = f32[1,1,9216]{2,1,0} dot(multiply.10873, get-tuple-element.8185), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10876 = f32[1,1,9216]{2,1,0} multiply(dot.10874, dot.10874), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10877 = f32[1,1,9216]{2,1,0} multiply(multiply.10876, dot.10874), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10878 = f32[1,1,9216]{2,1,0} multiply(multiply.10877, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.10879 = f32[1,1,9216]{2,1,0} add(dot.10874, multiply.10878), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10880 = f32[1,1,9216]{2,1,0} multiply(add.10879, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.10881 = f32[1,1,9216]{2,1,0} tanh(multiply.10880), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.10882 = f32[1,1,9216]{2,1,0} add(tanh.10881, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10883 = f32[1,1,9216]{2,1,0} multiply(add.10882, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.10884 = f32[1,1,9216]{2,1,0} multiply(dot.10874, multiply.10883), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8186 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=136
  dot.10875 = f32[1,1,9216]{2,1,0} dot(multiply.10873, get-tuple-element.8186), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10885 = f32[1,1,9216]{2,1,0} multiply(multiply.10884, dot.10875), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8187 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=137
  dot.10886 = f32[1,1,2304]{2,1,0} dot(multiply.10885, get-tuple-element.8187), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.10887 = f32[1,1,2304]{2,1,0} multiply(dot.10886, dot.10886), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10888 = f32[1,1]{1,0} reduce(multiply.10887, constant.8387), dimensions={2}, to_apply=region_264.7317, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10889 = f32[1,1,1]{2,1,0} reshape(reduce.10888), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10890 = f32[1,1,1]{2,1,0} divide(reshape.10889, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10891 = f32[1,1,1]{2,1,0} add(divide.10890, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10892 = f32[1,1,1]{2,1,0} sqrt(add.10891), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10893 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10892), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10894 = f32[1,1,1]{2,1,0} broadcast(divide.10893), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10895 = f32[1,1]{1,0} reshape(broadcast.10894), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10896 = f32[1,1,2304]{2,1,0} broadcast(reshape.10895), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10897 = f32[1,1,2304]{2,1,0} multiply(dot.10886, broadcast.10896), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8188 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=138
  add.10898 = f32[2304]{0} add(get-tuple-element.8188, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10899 = f32[1,1,2304]{2,1,0} reshape(add.10898), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10900 = f32[1,1,2304]{2,1,0} multiply(multiply.10897, reshape.10899), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.10901 = f32[1,1,2304]{2,1,0} add(multiply.10900, add.10859), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.10918 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.10919 = f32[1,1]{1,0} reshape(convert.10918), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.10920 = f32[1,1]{1,0} broadcast(reshape.10919), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.10921 = f32[1]{0} reshape(broadcast.10920), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.10922 = f32[1,31]{1,0} broadcast(reshape.10921), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.10923 = pred[1,31]{1,0} compare(broadcast.10922, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.10924 = pred[1,1,31]{2,1,0} reshape(compare.10923), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.11052 = s32[1,1,31]{2,1,0} convert(reshape.10924), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.11053 = pred[1,1,31]{2,1,0} compare(convert.11052, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.11054 = pred[1,1]{1,0} reduce(compare.11053, constant.8359), dimensions={2}, to_apply=region_268.7359, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.11055 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.11054), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.10902 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [12:13], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.10903 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.10902), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.10962 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.10903), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.10963 = f32[1,31,4,256]{3,2,1,0} reshape(slice.10962), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.10904 = f32[1,1,2304]{2,1,0} multiply(add.10901, add.10901), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.10905 = f32[1,1]{1,0} reduce(multiply.10904, constant.8387), dimensions={2}, to_apply=region_265.7321, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.10906 = f32[1,1,1]{2,1,0} reshape(reduce.10905), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.10907 = f32[1,1,1]{2,1,0} divide(reshape.10906, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.10908 = f32[1,1,1]{2,1,0} add(divide.10907, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.10909 = f32[1,1,1]{2,1,0} sqrt(add.10908), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.10910 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.10909), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.10911 = f32[1,1,1]{2,1,0} broadcast(divide.10910), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.10912 = f32[1,1]{1,0} reshape(broadcast.10911), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.10913 = f32[1,1,2304]{2,1,0} broadcast(reshape.10912), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.10914 = f32[1,1,2304]{2,1,0} multiply(add.10901, broadcast.10913), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8189 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=139
  add.10915 = f32[2304]{0} add(get-tuple-element.8189, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.10916 = f32[1,1,2304]{2,1,0} reshape(add.10915), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.10917 = f32[1,1,2304]{2,1,0} multiply(multiply.10914, reshape.10916), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8192 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=142
  dot.10999 = f32[1,1,4,256]{3,2,1,0} dot(multiply.10917, get-tuple-element.8192), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.11004 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.11005 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.11006 = s32[] select(compare.11004, add.11005, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.11007 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.10963, dot.10999, constant.8391, select.11006, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.10960 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.10903), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.10961 = f32[1,31,4,256]{3,2,1,0} reshape(slice.10960), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8191 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=141
  dot.10964 = f32[1,1,4,256]{3,2,1,0} dot(multiply.10917, get-tuple-element.8191), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.10967 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.10968 = f32[1]{0} reshape(convert.10967), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.10969 = f32[1]{0} divide(reshape.10968, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.10965 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.10966 = f32[128]{0} divide(broadcast.8377, power.10965), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.10970 = f32[1,128]{1,0} dot(divide.10969, divide.10966), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.10971 = f32[1,1,128]{2,1,0} reshape(dot.10970), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10972 = f32[1,1,128]{2,1,0} reshape(dot.10970), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10973 = f32[1,2,128]{2,1,0} concatenate(reshape.10971, reshape.10972), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10974 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.10973), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.10975 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.10974), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.10984 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.10975), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10985 = f32[1,1,256]{2,1,0} reshape(broadcast.10984), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10986 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.10985), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10987 = f32[1,1,4,256]{3,2,1,0} multiply(dot.10964, broadcast.10986), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10978 = f32[1,1,4,128]{3,2,1,0} slice(dot.10964), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.10979 = f32[1,1,4,128]{3,2,1,0} negate(slice.10978), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.10980 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.10979), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10977 = f32[1,1,4,128]{3,2,1,0} slice(dot.10964), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10981 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.10977), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10982 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.10980, reshape.10981), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10983 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.10982), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.10976 = f32[1,1,1,256]{3,2,1,0} sine(reshape.10974), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.10988 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.10976), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10989 = f32[1,1,256]{2,1,0} reshape(broadcast.10988), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10990 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.10989), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10991 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.10983, broadcast.10990), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.10992 = f32[1,1,4,256]{3,2,1,0} add(multiply.10987, multiply.10991), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10993 = f32[1,1,4,128]{3,2,1,0} slice(add.10992), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10995 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.10993), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10994 = f32[1,1,4,128]{3,2,1,0} slice(add.10992), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10996 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.10994), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10997 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.10995, reshape.10996), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10998 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.10997), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.11000 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.11001 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.11002 = s32[] select(compare.11000, add.11001, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.11003 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.10961, reshape.10998, constant.8391, select.11002, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8190 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=140
  dot.10925 = f32[1,1,8,256]{3,2,1,0} dot(multiply.10917, get-tuple-element.8190), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.10928 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.10929 = f32[1]{0} reshape(convert.10928), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.10930 = f32[1]{0} divide(reshape.10929, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.10926 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.10927 = f32[128]{0} divide(broadcast.8377, power.10926), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.10931 = f32[1,128]{1,0} dot(divide.10930, divide.10927), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.10932 = f32[1,1,128]{2,1,0} reshape(dot.10931), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10933 = f32[1,1,128]{2,1,0} reshape(dot.10931), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10934 = f32[1,2,128]{2,1,0} concatenate(reshape.10932, reshape.10933), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10935 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.10934), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.10936 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.10935), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.10945 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.10936), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10946 = f32[1,1,256]{2,1,0} reshape(broadcast.10945), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10947 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.10946), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10948 = f32[1,1,8,256]{3,2,1,0} multiply(dot.10925, broadcast.10947), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10939 = f32[1,1,8,128]{3,2,1,0} slice(dot.10925), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.10940 = f32[1,1,8,128]{3,2,1,0} negate(slice.10939), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.10941 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.10940), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10938 = f32[1,1,8,128]{3,2,1,0} slice(dot.10925), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10942 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.10938), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10943 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.10941, reshape.10942), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10944 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.10943), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.10937 = f32[1,1,1,256]{3,2,1,0} sine(reshape.10935), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.10949 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.10937), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.10950 = f32[1,1,256]{2,1,0} reshape(broadcast.10949), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.10951 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.10950), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.10952 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.10944, broadcast.10951), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.10953 = f32[1,1,8,256]{3,2,1,0} add(multiply.10948, multiply.10952), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/rotary_embedding_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.10954 = f32[1,1,8,128]{3,2,1,0} slice(add.10953), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10956 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.10954), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.10955 = f32[1,1,8,128]{3,2,1,0} slice(add.10953), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.10957 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.10955), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10958 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.10956, reshape.10957), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10959 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.10958), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.11011 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.10959, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.11012 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.11011), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.11013 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.11003, reshape.11012), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.11014 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.11013), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.11015 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.11014, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.11016 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.11015), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.11017 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.11016, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.11018 = pred[31,31]{1,0} call(broadcast.8370), to_apply=triu_3.7325
  call.11019 = pred[31,31]{1,0} call(broadcast.8370), to_apply=tril_4.7338
  and.11020 = pred[31,31]{1,0} and(call.11018, call.11019), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  compare.11021 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  add.11022 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  select.11023 = s32[] select(compare.11021, add.11022, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  dynamic-slice.11024 = pred[1,31]{1,0} dynamic-slice(and.11020, select.11023, constant.8391), dynamic_slice_sizes={1,31}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/dynamic_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  reshape.11025 = pred[1,1,31]{2,1,0} reshape(dynamic-slice.11024), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.11026 = pred[1,1,31]{2,1,0} and(reshape.10924, reshape.11025), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.11027 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(and.11026), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.11028 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.11027), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.11029 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.11028), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.11030 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.11029, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.11031 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.11030), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.11032 = f32[1,1,31]{2,1,0} reshape(broadcast.11031), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.11033 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.11032), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.11034 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.11017, broadcast.11033), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.11035 = f32[1,4,2,1]{3,2,1,0} reduce(add.11034, constant.8364), dimensions={4}, to_apply=region_266.7351, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.11036 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.11035, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11037 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.11036), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11038 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.11037), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11039 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.11038), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11040 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.11039), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.11041 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.11034, broadcast.11040), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.11042 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.11041), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.11043 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.11042, constant.8387), dimensions={4}, to_apply=region_267.7355, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11044 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.11043), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11045 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.11044), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11046 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.11045), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11047 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.11046), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.11048 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.11042, broadcast.11047), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/softmax_12/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.11049 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.11007, divide.11048), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.11050 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.11049), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.11051 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.11050), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.11056 = f32[1,1,8,256]{3,2,1,0} call(reshape.11055, broadcast.8358, reshape.11051), to_apply=_where_5.7363
  get-tuple-element.8193 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=143
  dot.11057 = f32[1,1,2304]{2,1,0} dot(call.11056, get-tuple-element.8193), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11058 = f32[1,1,2304]{2,1,0} multiply(dot.11057, dot.11057), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11059 = f32[1,1]{1,0} reduce(multiply.11058, constant.8387), dimensions={2}, to_apply=region_269.7371, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11060 = f32[1,1,1]{2,1,0} reshape(reduce.11059), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11061 = f32[1,1,1]{2,1,0} divide(reshape.11060, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11062 = f32[1,1,1]{2,1,0} add(divide.11061, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11063 = f32[1,1,1]{2,1,0} sqrt(add.11062), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11064 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11063), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11065 = f32[1,1,1]{2,1,0} broadcast(divide.11064), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11066 = f32[1,1]{1,0} reshape(broadcast.11065), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11067 = f32[1,1,2304]{2,1,0} broadcast(reshape.11066), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11068 = f32[1,1,2304]{2,1,0} multiply(dot.11057, broadcast.11067), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8194 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=144
  add.11069 = f32[2304]{0} add(get-tuple-element.8194, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11070 = f32[1,1,2304]{2,1,0} reshape(add.11069), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11071 = f32[1,1,2304]{2,1,0} multiply(multiply.11068, reshape.11070), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.11072 = f32[1,1,2304]{2,1,0} add(add.10901, multiply.11071), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.11073 = f32[1,1,2304]{2,1,0} multiply(add.11072, add.11072), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11074 = f32[1,1]{1,0} reduce(multiply.11073, constant.8387), dimensions={2}, to_apply=region_270.7375, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11075 = f32[1,1,1]{2,1,0} reshape(reduce.11074), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11076 = f32[1,1,1]{2,1,0} divide(reshape.11075, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11077 = f32[1,1,1]{2,1,0} add(divide.11076, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11078 = f32[1,1,1]{2,1,0} sqrt(add.11077), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11079 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11078), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11080 = f32[1,1,1]{2,1,0} broadcast(divide.11079), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11081 = f32[1,1]{1,0} reshape(broadcast.11080), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11082 = f32[1,1,2304]{2,1,0} broadcast(reshape.11081), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11083 = f32[1,1,2304]{2,1,0} multiply(add.11072, broadcast.11082), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8195 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=145
  add.11084 = f32[2304]{0} add(get-tuple-element.8195, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11085 = f32[1,1,2304]{2,1,0} reshape(add.11084), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11086 = f32[1,1,2304]{2,1,0} multiply(multiply.11083, reshape.11085), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8196 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=146
  dot.11087 = f32[1,1,9216]{2,1,0} dot(multiply.11086, get-tuple-element.8196), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11089 = f32[1,1,9216]{2,1,0} multiply(dot.11087, dot.11087), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11090 = f32[1,1,9216]{2,1,0} multiply(multiply.11089, dot.11087), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11091 = f32[1,1,9216]{2,1,0} multiply(multiply.11090, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.11092 = f32[1,1,9216]{2,1,0} add(dot.11087, multiply.11091), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11093 = f32[1,1,9216]{2,1,0} multiply(add.11092, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.11094 = f32[1,1,9216]{2,1,0} tanh(multiply.11093), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.11095 = f32[1,1,9216]{2,1,0} add(tanh.11094, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11096 = f32[1,1,9216]{2,1,0} multiply(add.11095, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11097 = f32[1,1,9216]{2,1,0} multiply(dot.11087, multiply.11096), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8197 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=147
  dot.11088 = f32[1,1,9216]{2,1,0} dot(multiply.11086, get-tuple-element.8197), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11098 = f32[1,1,9216]{2,1,0} multiply(multiply.11097, dot.11088), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8198 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=148
  dot.11099 = f32[1,1,2304]{2,1,0} dot(multiply.11098, get-tuple-element.8198), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11100 = f32[1,1,2304]{2,1,0} multiply(dot.11099, dot.11099), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11101 = f32[1,1]{1,0} reduce(multiply.11100, constant.8387), dimensions={2}, to_apply=region_271.7379, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11102 = f32[1,1,1]{2,1,0} reshape(reduce.11101), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11103 = f32[1,1,1]{2,1,0} divide(reshape.11102, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11104 = f32[1,1,1]{2,1,0} add(divide.11103, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11105 = f32[1,1,1]{2,1,0} sqrt(add.11104), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11106 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11105), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11107 = f32[1,1,1]{2,1,0} broadcast(divide.11106), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11108 = f32[1,1]{1,0} reshape(broadcast.11107), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11109 = f32[1,1,2304]{2,1,0} broadcast(reshape.11108), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11110 = f32[1,1,2304]{2,1,0} multiply(dot.11099, broadcast.11109), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8199 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=149
  add.11111 = f32[2304]{0} add(get-tuple-element.8199, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11112 = f32[1,1,2304]{2,1,0} reshape(add.11111), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11113 = f32[1,1,2304]{2,1,0} multiply(multiply.11110, reshape.11112), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.11114 = f32[1,1,2304]{2,1,0} add(multiply.11113, add.11072), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.11131 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.11132 = f32[1,1]{1,0} reshape(convert.11131), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.11133 = f32[1,1]{1,0} broadcast(reshape.11132), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.11134 = f32[1]{0} reshape(broadcast.11133), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.11135 = f32[1,31]{1,0} broadcast(reshape.11134), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.11136 = pred[1,31]{1,0} compare(broadcast.11135, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.11137 = pred[1,1,31]{2,1,0} reshape(compare.11136), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.11256 = s32[1,1,31]{2,1,0} convert(reshape.11137), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.11257 = pred[1,1,31]{2,1,0} compare(convert.11256, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.11258 = pred[1,1]{1,0} reduce(compare.11257, constant.8359), dimensions={2}, to_apply=region_275.7395, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.11259 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.11258), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.11115 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [13:14], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.11116 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.11115), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.11175 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.11116), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.11176 = f32[1,31,4,256]{3,2,1,0} reshape(slice.11175), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.11117 = f32[1,1,2304]{2,1,0} multiply(add.11114, add.11114), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11118 = f32[1,1]{1,0} reduce(multiply.11117, constant.8387), dimensions={2}, to_apply=region_272.7383, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11119 = f32[1,1,1]{2,1,0} reshape(reduce.11118), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11120 = f32[1,1,1]{2,1,0} divide(reshape.11119, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11121 = f32[1,1,1]{2,1,0} add(divide.11120, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11122 = f32[1,1,1]{2,1,0} sqrt(add.11121), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11123 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11122), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11124 = f32[1,1,1]{2,1,0} broadcast(divide.11123), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11125 = f32[1,1]{1,0} reshape(broadcast.11124), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11126 = f32[1,1,2304]{2,1,0} broadcast(reshape.11125), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11127 = f32[1,1,2304]{2,1,0} multiply(add.11114, broadcast.11126), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8200 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=150
  add.11128 = f32[2304]{0} add(get-tuple-element.8200, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11129 = f32[1,1,2304]{2,1,0} reshape(add.11128), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11130 = f32[1,1,2304]{2,1,0} multiply(multiply.11127, reshape.11129), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8203 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=153
  dot.11212 = f32[1,1,4,256]{3,2,1,0} dot(multiply.11130, get-tuple-element.8203), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.11217 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.11218 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.11219 = s32[] select(compare.11217, add.11218, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.11220 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.11176, dot.11212, constant.8391, select.11219, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.11173 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.11116), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.11174 = f32[1,31,4,256]{3,2,1,0} reshape(slice.11173), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8202 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=152
  dot.11177 = f32[1,1,4,256]{3,2,1,0} dot(multiply.11130, get-tuple-element.8202), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.11180 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.11181 = f32[1]{0} reshape(convert.11180), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.11182 = f32[1]{0} divide(reshape.11181, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.11178 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.11179 = f32[128]{0} divide(broadcast.8377, power.11178), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.11183 = f32[1,128]{1,0} dot(divide.11182, divide.11179), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.11184 = f32[1,1,128]{2,1,0} reshape(dot.11183), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11185 = f32[1,1,128]{2,1,0} reshape(dot.11183), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11186 = f32[1,2,128]{2,1,0} concatenate(reshape.11184, reshape.11185), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11187 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.11186), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.11188 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.11187), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.11197 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.11188), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.11198 = f32[1,1,256]{2,1,0} reshape(broadcast.11197), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.11199 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.11198), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.11200 = f32[1,1,4,256]{3,2,1,0} multiply(dot.11177, broadcast.11199), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.11191 = f32[1,1,4,128]{3,2,1,0} slice(dot.11177), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.11192 = f32[1,1,4,128]{3,2,1,0} negate(slice.11191), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.11193 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.11192), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.11190 = f32[1,1,4,128]{3,2,1,0} slice(dot.11177), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11194 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.11190), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11195 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.11193, reshape.11194), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11196 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.11195), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.11189 = f32[1,1,1,256]{3,2,1,0} sine(reshape.11187), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.11201 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.11189), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.11202 = f32[1,1,256]{2,1,0} reshape(broadcast.11201), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.11203 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.11202), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.11204 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.11196, broadcast.11203), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.11205 = f32[1,1,4,256]{3,2,1,0} add(multiply.11200, multiply.11204), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.11206 = f32[1,1,4,128]{3,2,1,0} slice(add.11205), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11208 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.11206), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.11207 = f32[1,1,4,128]{3,2,1,0} slice(add.11205), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11209 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.11207), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11210 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.11208, reshape.11209), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11211 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.11210), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.11213 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.11214 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.11215 = s32[] select(compare.11213, add.11214, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.11216 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.11174, reshape.11211, constant.8391, select.11215, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8201 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=151
  dot.11138 = f32[1,1,8,256]{3,2,1,0} dot(multiply.11130, get-tuple-element.8201), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.11141 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.11142 = f32[1]{0} reshape(convert.11141), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.11143 = f32[1]{0} divide(reshape.11142, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.11139 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.11140 = f32[128]{0} divide(broadcast.8377, power.11139), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.11144 = f32[1,128]{1,0} dot(divide.11143, divide.11140), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.11145 = f32[1,1,128]{2,1,0} reshape(dot.11144), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11146 = f32[1,1,128]{2,1,0} reshape(dot.11144), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11147 = f32[1,2,128]{2,1,0} concatenate(reshape.11145, reshape.11146), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11148 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.11147), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.11149 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.11148), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.11158 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.11149), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.11159 = f32[1,1,256]{2,1,0} reshape(broadcast.11158), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.11160 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.11159), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.11161 = f32[1,1,8,256]{3,2,1,0} multiply(dot.11138, broadcast.11160), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.11152 = f32[1,1,8,128]{3,2,1,0} slice(dot.11138), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.11153 = f32[1,1,8,128]{3,2,1,0} negate(slice.11152), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.11154 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.11153), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.11151 = f32[1,1,8,128]{3,2,1,0} slice(dot.11138), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11155 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.11151), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11156 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.11154, reshape.11155), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11157 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.11156), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.11150 = f32[1,1,1,256]{3,2,1,0} sine(reshape.11148), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.11162 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.11150), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.11163 = f32[1,1,256]{2,1,0} reshape(broadcast.11162), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.11164 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.11163), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.11165 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.11157, broadcast.11164), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.11166 = f32[1,1,8,256]{3,2,1,0} add(multiply.11161, multiply.11165), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/rotary_embedding_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.11167 = f32[1,1,8,128]{3,2,1,0} slice(add.11166), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11169 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.11167), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.11168 = f32[1,1,8,128]{3,2,1,0} slice(add.11166), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11170 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.11168), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11171 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.11169, reshape.11170), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11172 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.11171), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.11224 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.11172, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.11225 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.11224), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.11226 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.11216, reshape.11225), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.11227 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.11226), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.11228 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.11227, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.11229 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.11228), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.11230 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.11229, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.11231 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(compare.11136), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.11232 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.11231), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.11233 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.11232), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.11234 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.11233, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.11235 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.11234), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.11236 = f32[1,1,31]{2,1,0} reshape(broadcast.11235), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.11237 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.11236), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.11238 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.11230, broadcast.11237), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.11239 = f32[1,4,2,1]{3,2,1,0} reduce(add.11238, constant.8364), dimensions={4}, to_apply=region_273.7387, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.11240 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.11239, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11241 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.11240), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11242 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.11241), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11243 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.11242), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11244 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.11243), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.11245 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.11238, broadcast.11244), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.11246 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.11245), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.11247 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.11246, constant.8387), dimensions={4}, to_apply=region_274.7391, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11248 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.11247), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11249 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.11248), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11250 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.11249), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11251 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.11250), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.11252 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.11246, broadcast.11251), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/softmax_13/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.11253 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.11220, divide.11252), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.11254 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.11253), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.11255 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.11254), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.11260 = f32[1,1,8,256]{3,2,1,0} call(reshape.11259, broadcast.8358, reshape.11255), to_apply=_where_5.7399
  get-tuple-element.8204 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=154
  dot.11261 = f32[1,1,2304]{2,1,0} dot(call.11260, get-tuple-element.8204), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11262 = f32[1,1,2304]{2,1,0} multiply(dot.11261, dot.11261), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11263 = f32[1,1]{1,0} reduce(multiply.11262, constant.8387), dimensions={2}, to_apply=region_276.7407, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11264 = f32[1,1,1]{2,1,0} reshape(reduce.11263), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11265 = f32[1,1,1]{2,1,0} divide(reshape.11264, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11266 = f32[1,1,1]{2,1,0} add(divide.11265, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11267 = f32[1,1,1]{2,1,0} sqrt(add.11266), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11268 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11267), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11269 = f32[1,1,1]{2,1,0} broadcast(divide.11268), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11270 = f32[1,1]{1,0} reshape(broadcast.11269), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11271 = f32[1,1,2304]{2,1,0} broadcast(reshape.11270), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11272 = f32[1,1,2304]{2,1,0} multiply(dot.11261, broadcast.11271), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8205 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=155
  add.11273 = f32[2304]{0} add(get-tuple-element.8205, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11274 = f32[1,1,2304]{2,1,0} reshape(add.11273), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11275 = f32[1,1,2304]{2,1,0} multiply(multiply.11272, reshape.11274), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.11276 = f32[1,1,2304]{2,1,0} add(add.11114, multiply.11275), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.11277 = f32[1,1,2304]{2,1,0} multiply(add.11276, add.11276), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11278 = f32[1,1]{1,0} reduce(multiply.11277, constant.8387), dimensions={2}, to_apply=region_277.7411, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11279 = f32[1,1,1]{2,1,0} reshape(reduce.11278), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11280 = f32[1,1,1]{2,1,0} divide(reshape.11279, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11281 = f32[1,1,1]{2,1,0} add(divide.11280, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11282 = f32[1,1,1]{2,1,0} sqrt(add.11281), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11283 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11282), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11284 = f32[1,1,1]{2,1,0} broadcast(divide.11283), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11285 = f32[1,1]{1,0} reshape(broadcast.11284), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11286 = f32[1,1,2304]{2,1,0} broadcast(reshape.11285), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11287 = f32[1,1,2304]{2,1,0} multiply(add.11276, broadcast.11286), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8206 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=156
  add.11288 = f32[2304]{0} add(get-tuple-element.8206, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11289 = f32[1,1,2304]{2,1,0} reshape(add.11288), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11290 = f32[1,1,2304]{2,1,0} multiply(multiply.11287, reshape.11289), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8207 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=157
  dot.11291 = f32[1,1,9216]{2,1,0} dot(multiply.11290, get-tuple-element.8207), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11293 = f32[1,1,9216]{2,1,0} multiply(dot.11291, dot.11291), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11294 = f32[1,1,9216]{2,1,0} multiply(multiply.11293, dot.11291), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11295 = f32[1,1,9216]{2,1,0} multiply(multiply.11294, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.11296 = f32[1,1,9216]{2,1,0} add(dot.11291, multiply.11295), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11297 = f32[1,1,9216]{2,1,0} multiply(add.11296, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.11298 = f32[1,1,9216]{2,1,0} tanh(multiply.11297), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.11299 = f32[1,1,9216]{2,1,0} add(tanh.11298, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11300 = f32[1,1,9216]{2,1,0} multiply(add.11299, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11301 = f32[1,1,9216]{2,1,0} multiply(dot.11291, multiply.11300), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8208 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=158
  dot.11292 = f32[1,1,9216]{2,1,0} dot(multiply.11290, get-tuple-element.8208), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11302 = f32[1,1,9216]{2,1,0} multiply(multiply.11301, dot.11292), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8209 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=159
  dot.11303 = f32[1,1,2304]{2,1,0} dot(multiply.11302, get-tuple-element.8209), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11304 = f32[1,1,2304]{2,1,0} multiply(dot.11303, dot.11303), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11305 = f32[1,1]{1,0} reduce(multiply.11304, constant.8387), dimensions={2}, to_apply=region_278.7415, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11306 = f32[1,1,1]{2,1,0} reshape(reduce.11305), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11307 = f32[1,1,1]{2,1,0} divide(reshape.11306, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11308 = f32[1,1,1]{2,1,0} add(divide.11307, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11309 = f32[1,1,1]{2,1,0} sqrt(add.11308), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11310 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11309), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11311 = f32[1,1,1]{2,1,0} broadcast(divide.11310), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11312 = f32[1,1]{1,0} reshape(broadcast.11311), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11313 = f32[1,1,2304]{2,1,0} broadcast(reshape.11312), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11314 = f32[1,1,2304]{2,1,0} multiply(dot.11303, broadcast.11313), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8210 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=160
  add.11315 = f32[2304]{0} add(get-tuple-element.8210, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11316 = f32[1,1,2304]{2,1,0} reshape(add.11315), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11317 = f32[1,1,2304]{2,1,0} multiply(multiply.11314, reshape.11316), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.11318 = f32[1,1,2304]{2,1,0} add(multiply.11317, add.11276), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.11335 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.11336 = f32[1,1]{1,0} reshape(convert.11335), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.11337 = f32[1,1]{1,0} broadcast(reshape.11336), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.11338 = f32[1]{0} reshape(broadcast.11337), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.11339 = f32[1,31]{1,0} broadcast(reshape.11338), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.11340 = pred[1,31]{1,0} compare(broadcast.11339, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.11341 = pred[1,1,31]{2,1,0} reshape(compare.11340), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.11469 = s32[1,1,31]{2,1,0} convert(reshape.11341), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.11470 = pred[1,1,31]{2,1,0} compare(convert.11469, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.11471 = pred[1,1]{1,0} reduce(compare.11470, constant.8359), dimensions={2}, to_apply=region_282.7457, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.11472 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.11471), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.11319 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [14:15], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.11320 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.11319), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.11379 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.11320), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.11380 = f32[1,31,4,256]{3,2,1,0} reshape(slice.11379), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.11321 = f32[1,1,2304]{2,1,0} multiply(add.11318, add.11318), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11322 = f32[1,1]{1,0} reduce(multiply.11321, constant.8387), dimensions={2}, to_apply=region_279.7419, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11323 = f32[1,1,1]{2,1,0} reshape(reduce.11322), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11324 = f32[1,1,1]{2,1,0} divide(reshape.11323, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11325 = f32[1,1,1]{2,1,0} add(divide.11324, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11326 = f32[1,1,1]{2,1,0} sqrt(add.11325), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11327 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11326), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11328 = f32[1,1,1]{2,1,0} broadcast(divide.11327), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11329 = f32[1,1]{1,0} reshape(broadcast.11328), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11330 = f32[1,1,2304]{2,1,0} broadcast(reshape.11329), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11331 = f32[1,1,2304]{2,1,0} multiply(add.11318, broadcast.11330), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8211 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=161
  add.11332 = f32[2304]{0} add(get-tuple-element.8211, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11333 = f32[1,1,2304]{2,1,0} reshape(add.11332), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11334 = f32[1,1,2304]{2,1,0} multiply(multiply.11331, reshape.11333), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8214 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=164
  dot.11416 = f32[1,1,4,256]{3,2,1,0} dot(multiply.11334, get-tuple-element.8214), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.11421 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.11422 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.11423 = s32[] select(compare.11421, add.11422, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.11424 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.11380, dot.11416, constant.8391, select.11423, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.11377 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.11320), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.11378 = f32[1,31,4,256]{3,2,1,0} reshape(slice.11377), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8213 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=163
  dot.11381 = f32[1,1,4,256]{3,2,1,0} dot(multiply.11334, get-tuple-element.8213), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.11384 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.11385 = f32[1]{0} reshape(convert.11384), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.11386 = f32[1]{0} divide(reshape.11385, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.11382 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.11383 = f32[128]{0} divide(broadcast.8377, power.11382), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.11387 = f32[1,128]{1,0} dot(divide.11386, divide.11383), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.11388 = f32[1,1,128]{2,1,0} reshape(dot.11387), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11389 = f32[1,1,128]{2,1,0} reshape(dot.11387), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11390 = f32[1,2,128]{2,1,0} concatenate(reshape.11388, reshape.11389), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11391 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.11390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.11392 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.11391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.11401 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.11392), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.11402 = f32[1,1,256]{2,1,0} reshape(broadcast.11401), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.11403 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.11402), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.11404 = f32[1,1,4,256]{3,2,1,0} multiply(dot.11381, broadcast.11403), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.11395 = f32[1,1,4,128]{3,2,1,0} slice(dot.11381), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.11396 = f32[1,1,4,128]{3,2,1,0} negate(slice.11395), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.11397 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.11396), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.11394 = f32[1,1,4,128]{3,2,1,0} slice(dot.11381), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11398 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.11394), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11399 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.11397, reshape.11398), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11400 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.11399), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.11393 = f32[1,1,1,256]{3,2,1,0} sine(reshape.11391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.11405 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.11393), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.11406 = f32[1,1,256]{2,1,0} reshape(broadcast.11405), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.11407 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.11406), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.11408 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.11400, broadcast.11407), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.11409 = f32[1,1,4,256]{3,2,1,0} add(multiply.11404, multiply.11408), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.11410 = f32[1,1,4,128]{3,2,1,0} slice(add.11409), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11412 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.11410), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.11411 = f32[1,1,4,128]{3,2,1,0} slice(add.11409), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11413 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.11411), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11414 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.11412, reshape.11413), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11415 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.11414), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.11417 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.11418 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.11419 = s32[] select(compare.11417, add.11418, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.11420 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.11378, reshape.11415, constant.8391, select.11419, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8212 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=162
  dot.11342 = f32[1,1,8,256]{3,2,1,0} dot(multiply.11334, get-tuple-element.8212), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.11345 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.11346 = f32[1]{0} reshape(convert.11345), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.11347 = f32[1]{0} divide(reshape.11346, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.11343 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.11344 = f32[128]{0} divide(broadcast.8377, power.11343), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.11348 = f32[1,128]{1,0} dot(divide.11347, divide.11344), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.11349 = f32[1,1,128]{2,1,0} reshape(dot.11348), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11350 = f32[1,1,128]{2,1,0} reshape(dot.11348), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11351 = f32[1,2,128]{2,1,0} concatenate(reshape.11349, reshape.11350), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11352 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.11351), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.11353 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.11352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.11362 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.11353), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.11363 = f32[1,1,256]{2,1,0} reshape(broadcast.11362), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.11364 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.11363), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.11365 = f32[1,1,8,256]{3,2,1,0} multiply(dot.11342, broadcast.11364), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.11356 = f32[1,1,8,128]{3,2,1,0} slice(dot.11342), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.11357 = f32[1,1,8,128]{3,2,1,0} negate(slice.11356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.11358 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.11357), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.11355 = f32[1,1,8,128]{3,2,1,0} slice(dot.11342), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11359 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.11355), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11360 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.11358, reshape.11359), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11361 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.11360), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.11354 = f32[1,1,1,256]{3,2,1,0} sine(reshape.11352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.11366 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.11354), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.11367 = f32[1,1,256]{2,1,0} reshape(broadcast.11366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.11368 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.11367), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.11369 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.11361, broadcast.11368), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.11370 = f32[1,1,8,256]{3,2,1,0} add(multiply.11365, multiply.11369), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/rotary_embedding_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.11371 = f32[1,1,8,128]{3,2,1,0} slice(add.11370), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11373 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.11371), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.11372 = f32[1,1,8,128]{3,2,1,0} slice(add.11370), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11374 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.11372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11375 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.11373, reshape.11374), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11376 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.11375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.11428 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.11376, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.11429 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.11428), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.11430 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.11420, reshape.11429), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.11431 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.11430), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.11432 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.11431, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.11433 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.11432), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.11434 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.11433, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.11435 = pred[31,31]{1,0} call(broadcast.8370), to_apply=triu_3.7423
  call.11436 = pred[31,31]{1,0} call(broadcast.8370), to_apply=tril_4.7436
  and.11437 = pred[31,31]{1,0} and(call.11435, call.11436), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  compare.11438 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  add.11439 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  select.11440 = s32[] select(compare.11438, add.11439, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  dynamic-slice.11441 = pred[1,31]{1,0} dynamic-slice(and.11437, select.11440, constant.8391), dynamic_slice_sizes={1,31}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/dynamic_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  reshape.11442 = pred[1,1,31]{2,1,0} reshape(dynamic-slice.11441), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.11443 = pred[1,1,31]{2,1,0} and(reshape.11341, reshape.11442), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.11444 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(and.11443), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.11445 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.11444), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.11446 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.11445), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.11447 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.11446, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.11448 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.11447), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.11449 = f32[1,1,31]{2,1,0} reshape(broadcast.11448), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.11450 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.11449), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.11451 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.11434, broadcast.11450), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.11452 = f32[1,4,2,1]{3,2,1,0} reduce(add.11451, constant.8364), dimensions={4}, to_apply=region_280.7449, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.11453 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.11452, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11454 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.11453), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11455 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.11454), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11456 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.11455), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11457 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.11456), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.11458 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.11451, broadcast.11457), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.11459 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.11458), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.11460 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.11459, constant.8387), dimensions={4}, to_apply=region_281.7453, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11461 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.11460), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11462 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.11461), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11463 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.11462), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11464 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.11463), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.11465 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.11459, broadcast.11464), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/softmax_14/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.11466 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.11424, divide.11465), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.11467 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.11466), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.11468 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.11467), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.11473 = f32[1,1,8,256]{3,2,1,0} call(reshape.11472, broadcast.8358, reshape.11468), to_apply=_where_5.7461
  get-tuple-element.8215 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=165
  dot.11474 = f32[1,1,2304]{2,1,0} dot(call.11473, get-tuple-element.8215), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11475 = f32[1,1,2304]{2,1,0} multiply(dot.11474, dot.11474), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11476 = f32[1,1]{1,0} reduce(multiply.11475, constant.8387), dimensions={2}, to_apply=region_283.7469, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11477 = f32[1,1,1]{2,1,0} reshape(reduce.11476), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11478 = f32[1,1,1]{2,1,0} divide(reshape.11477, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11479 = f32[1,1,1]{2,1,0} add(divide.11478, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11480 = f32[1,1,1]{2,1,0} sqrt(add.11479), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11481 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11480), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11482 = f32[1,1,1]{2,1,0} broadcast(divide.11481), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11483 = f32[1,1]{1,0} reshape(broadcast.11482), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11484 = f32[1,1,2304]{2,1,0} broadcast(reshape.11483), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11485 = f32[1,1,2304]{2,1,0} multiply(dot.11474, broadcast.11484), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8216 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=166
  add.11486 = f32[2304]{0} add(get-tuple-element.8216, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11487 = f32[1,1,2304]{2,1,0} reshape(add.11486), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11488 = f32[1,1,2304]{2,1,0} multiply(multiply.11485, reshape.11487), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.11489 = f32[1,1,2304]{2,1,0} add(add.11318, multiply.11488), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.11490 = f32[1,1,2304]{2,1,0} multiply(add.11489, add.11489), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11491 = f32[1,1]{1,0} reduce(multiply.11490, constant.8387), dimensions={2}, to_apply=region_284.7473, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11492 = f32[1,1,1]{2,1,0} reshape(reduce.11491), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11493 = f32[1,1,1]{2,1,0} divide(reshape.11492, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11494 = f32[1,1,1]{2,1,0} add(divide.11493, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11495 = f32[1,1,1]{2,1,0} sqrt(add.11494), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11496 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11495), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11497 = f32[1,1,1]{2,1,0} broadcast(divide.11496), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11498 = f32[1,1]{1,0} reshape(broadcast.11497), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11499 = f32[1,1,2304]{2,1,0} broadcast(reshape.11498), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11500 = f32[1,1,2304]{2,1,0} multiply(add.11489, broadcast.11499), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8217 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=167
  add.11501 = f32[2304]{0} add(get-tuple-element.8217, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11502 = f32[1,1,2304]{2,1,0} reshape(add.11501), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11503 = f32[1,1,2304]{2,1,0} multiply(multiply.11500, reshape.11502), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8218 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=168
  dot.11504 = f32[1,1,9216]{2,1,0} dot(multiply.11503, get-tuple-element.8218), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11506 = f32[1,1,9216]{2,1,0} multiply(dot.11504, dot.11504), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11507 = f32[1,1,9216]{2,1,0} multiply(multiply.11506, dot.11504), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11508 = f32[1,1,9216]{2,1,0} multiply(multiply.11507, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.11509 = f32[1,1,9216]{2,1,0} add(dot.11504, multiply.11508), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11510 = f32[1,1,9216]{2,1,0} multiply(add.11509, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.11511 = f32[1,1,9216]{2,1,0} tanh(multiply.11510), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.11512 = f32[1,1,9216]{2,1,0} add(tanh.11511, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11513 = f32[1,1,9216]{2,1,0} multiply(add.11512, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11514 = f32[1,1,9216]{2,1,0} multiply(dot.11504, multiply.11513), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8219 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=169
  dot.11505 = f32[1,1,9216]{2,1,0} dot(multiply.11503, get-tuple-element.8219), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11515 = f32[1,1,9216]{2,1,0} multiply(multiply.11514, dot.11505), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8220 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=170
  dot.11516 = f32[1,1,2304]{2,1,0} dot(multiply.11515, get-tuple-element.8220), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11517 = f32[1,1,2304]{2,1,0} multiply(dot.11516, dot.11516), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11518 = f32[1,1]{1,0} reduce(multiply.11517, constant.8387), dimensions={2}, to_apply=region_285.7477, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11519 = f32[1,1,1]{2,1,0} reshape(reduce.11518), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11520 = f32[1,1,1]{2,1,0} divide(reshape.11519, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11521 = f32[1,1,1]{2,1,0} add(divide.11520, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11522 = f32[1,1,1]{2,1,0} sqrt(add.11521), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11523 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11522), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11524 = f32[1,1,1]{2,1,0} broadcast(divide.11523), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11525 = f32[1,1]{1,0} reshape(broadcast.11524), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11526 = f32[1,1,2304]{2,1,0} broadcast(reshape.11525), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11527 = f32[1,1,2304]{2,1,0} multiply(dot.11516, broadcast.11526), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8221 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=171
  add.11528 = f32[2304]{0} add(get-tuple-element.8221, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11529 = f32[1,1,2304]{2,1,0} reshape(add.11528), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11530 = f32[1,1,2304]{2,1,0} multiply(multiply.11527, reshape.11529), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.11531 = f32[1,1,2304]{2,1,0} add(multiply.11530, add.11489), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.11548 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.11549 = f32[1,1]{1,0} reshape(convert.11548), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.11550 = f32[1,1]{1,0} broadcast(reshape.11549), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.11551 = f32[1]{0} reshape(broadcast.11550), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.11552 = f32[1,31]{1,0} broadcast(reshape.11551), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.11553 = pred[1,31]{1,0} compare(broadcast.11552, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.11554 = pred[1,1,31]{2,1,0} reshape(compare.11553), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.11673 = s32[1,1,31]{2,1,0} convert(reshape.11554), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.11674 = pred[1,1,31]{2,1,0} compare(convert.11673, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.11675 = pred[1,1]{1,0} reduce(compare.11674, constant.8359), dimensions={2}, to_apply=region_289.7493, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.11676 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.11675), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.11532 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [15:16], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.11533 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.11532), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.11592 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.11533), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.11593 = f32[1,31,4,256]{3,2,1,0} reshape(slice.11592), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.11534 = f32[1,1,2304]{2,1,0} multiply(add.11531, add.11531), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11535 = f32[1,1]{1,0} reduce(multiply.11534, constant.8387), dimensions={2}, to_apply=region_286.7481, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11536 = f32[1,1,1]{2,1,0} reshape(reduce.11535), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11537 = f32[1,1,1]{2,1,0} divide(reshape.11536, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11538 = f32[1,1,1]{2,1,0} add(divide.11537, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11539 = f32[1,1,1]{2,1,0} sqrt(add.11538), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11540 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11539), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11541 = f32[1,1,1]{2,1,0} broadcast(divide.11540), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11542 = f32[1,1]{1,0} reshape(broadcast.11541), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11543 = f32[1,1,2304]{2,1,0} broadcast(reshape.11542), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11544 = f32[1,1,2304]{2,1,0} multiply(add.11531, broadcast.11543), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8222 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=172
  add.11545 = f32[2304]{0} add(get-tuple-element.8222, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11546 = f32[1,1,2304]{2,1,0} reshape(add.11545), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11547 = f32[1,1,2304]{2,1,0} multiply(multiply.11544, reshape.11546), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8225 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=175
  dot.11629 = f32[1,1,4,256]{3,2,1,0} dot(multiply.11547, get-tuple-element.8225), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.11634 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.11635 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.11636 = s32[] select(compare.11634, add.11635, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.11637 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.11593, dot.11629, constant.8391, select.11636, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.11590 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.11533), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.11591 = f32[1,31,4,256]{3,2,1,0} reshape(slice.11590), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8224 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=174
  dot.11594 = f32[1,1,4,256]{3,2,1,0} dot(multiply.11547, get-tuple-element.8224), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.11597 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.11598 = f32[1]{0} reshape(convert.11597), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.11599 = f32[1]{0} divide(reshape.11598, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.11595 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.11596 = f32[128]{0} divide(broadcast.8377, power.11595), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.11600 = f32[1,128]{1,0} dot(divide.11599, divide.11596), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.11601 = f32[1,1,128]{2,1,0} reshape(dot.11600), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11602 = f32[1,1,128]{2,1,0} reshape(dot.11600), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11603 = f32[1,2,128]{2,1,0} concatenate(reshape.11601, reshape.11602), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11604 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.11603), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.11605 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.11604), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.11614 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.11605), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.11615 = f32[1,1,256]{2,1,0} reshape(broadcast.11614), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.11616 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.11615), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.11617 = f32[1,1,4,256]{3,2,1,0} multiply(dot.11594, broadcast.11616), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.11608 = f32[1,1,4,128]{3,2,1,0} slice(dot.11594), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.11609 = f32[1,1,4,128]{3,2,1,0} negate(slice.11608), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.11610 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.11609), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.11607 = f32[1,1,4,128]{3,2,1,0} slice(dot.11594), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11611 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.11607), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11612 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.11610, reshape.11611), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11613 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.11612), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.11606 = f32[1,1,1,256]{3,2,1,0} sine(reshape.11604), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.11618 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.11606), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.11619 = f32[1,1,256]{2,1,0} reshape(broadcast.11618), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.11620 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.11619), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.11621 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.11613, broadcast.11620), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.11622 = f32[1,1,4,256]{3,2,1,0} add(multiply.11617, multiply.11621), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.11623 = f32[1,1,4,128]{3,2,1,0} slice(add.11622), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11625 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.11623), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.11624 = f32[1,1,4,128]{3,2,1,0} slice(add.11622), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11626 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.11624), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11627 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.11625, reshape.11626), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11628 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.11627), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.11630 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.11631 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.11632 = s32[] select(compare.11630, add.11631, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.11633 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.11591, reshape.11628, constant.8391, select.11632, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8223 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=173
  dot.11555 = f32[1,1,8,256]{3,2,1,0} dot(multiply.11547, get-tuple-element.8223), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.11558 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.11559 = f32[1]{0} reshape(convert.11558), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.11560 = f32[1]{0} divide(reshape.11559, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.11556 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.11557 = f32[128]{0} divide(broadcast.8377, power.11556), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.11561 = f32[1,128]{1,0} dot(divide.11560, divide.11557), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.11562 = f32[1,1,128]{2,1,0} reshape(dot.11561), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11563 = f32[1,1,128]{2,1,0} reshape(dot.11561), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11564 = f32[1,2,128]{2,1,0} concatenate(reshape.11562, reshape.11563), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11565 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.11564), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.11566 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.11565), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.11575 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.11566), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.11576 = f32[1,1,256]{2,1,0} reshape(broadcast.11575), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.11577 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.11576), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.11578 = f32[1,1,8,256]{3,2,1,0} multiply(dot.11555, broadcast.11577), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.11569 = f32[1,1,8,128]{3,2,1,0} slice(dot.11555), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.11570 = f32[1,1,8,128]{3,2,1,0} negate(slice.11569), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.11571 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.11570), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.11568 = f32[1,1,8,128]{3,2,1,0} slice(dot.11555), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11572 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.11568), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11573 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.11571, reshape.11572), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11574 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.11573), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.11567 = f32[1,1,1,256]{3,2,1,0} sine(reshape.11565), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.11579 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.11567), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.11580 = f32[1,1,256]{2,1,0} reshape(broadcast.11579), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.11581 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.11580), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.11582 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.11574, broadcast.11581), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.11583 = f32[1,1,8,256]{3,2,1,0} add(multiply.11578, multiply.11582), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/rotary_embedding_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.11584 = f32[1,1,8,128]{3,2,1,0} slice(add.11583), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11586 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.11584), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.11585 = f32[1,1,8,128]{3,2,1,0} slice(add.11583), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11587 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.11585), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11588 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.11586, reshape.11587), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11589 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.11588), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.11641 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.11589, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.11642 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.11641), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.11643 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.11633, reshape.11642), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.11644 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.11643), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.11645 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.11644, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.11646 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.11645), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.11647 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.11646, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.11648 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(compare.11553), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.11649 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.11648), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.11650 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.11649), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.11651 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.11650, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.11652 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.11651), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.11653 = f32[1,1,31]{2,1,0} reshape(broadcast.11652), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.11654 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.11653), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.11655 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.11647, broadcast.11654), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.11656 = f32[1,4,2,1]{3,2,1,0} reduce(add.11655, constant.8364), dimensions={4}, to_apply=region_287.7485, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.11657 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.11656, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11658 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.11657), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11659 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.11658), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11660 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.11659), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11661 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.11660), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.11662 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.11655, broadcast.11661), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.11663 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.11662), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.11664 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.11663, constant.8387), dimensions={4}, to_apply=region_288.7489, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11665 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.11664), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11666 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.11665), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11667 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.11666), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11668 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.11667), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.11669 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.11663, broadcast.11668), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/softmax_15/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.11670 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.11637, divide.11669), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.11671 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.11670), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.11672 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.11671), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.11677 = f32[1,1,8,256]{3,2,1,0} call(reshape.11676, broadcast.8358, reshape.11672), to_apply=_where_5.7497
  get-tuple-element.8226 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=176
  dot.11678 = f32[1,1,2304]{2,1,0} dot(call.11677, get-tuple-element.8226), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11679 = f32[1,1,2304]{2,1,0} multiply(dot.11678, dot.11678), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11680 = f32[1,1]{1,0} reduce(multiply.11679, constant.8387), dimensions={2}, to_apply=region_290.7505, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11681 = f32[1,1,1]{2,1,0} reshape(reduce.11680), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11682 = f32[1,1,1]{2,1,0} divide(reshape.11681, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11683 = f32[1,1,1]{2,1,0} add(divide.11682, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11684 = f32[1,1,1]{2,1,0} sqrt(add.11683), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11685 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11684), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11686 = f32[1,1,1]{2,1,0} broadcast(divide.11685), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11687 = f32[1,1]{1,0} reshape(broadcast.11686), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11688 = f32[1,1,2304]{2,1,0} broadcast(reshape.11687), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11689 = f32[1,1,2304]{2,1,0} multiply(dot.11678, broadcast.11688), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8227 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=177
  add.11690 = f32[2304]{0} add(get-tuple-element.8227, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11691 = f32[1,1,2304]{2,1,0} reshape(add.11690), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11692 = f32[1,1,2304]{2,1,0} multiply(multiply.11689, reshape.11691), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.11693 = f32[1,1,2304]{2,1,0} add(add.11531, multiply.11692), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.11694 = f32[1,1,2304]{2,1,0} multiply(add.11693, add.11693), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11695 = f32[1,1]{1,0} reduce(multiply.11694, constant.8387), dimensions={2}, to_apply=region_291.7509, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11696 = f32[1,1,1]{2,1,0} reshape(reduce.11695), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11697 = f32[1,1,1]{2,1,0} divide(reshape.11696, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11698 = f32[1,1,1]{2,1,0} add(divide.11697, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11699 = f32[1,1,1]{2,1,0} sqrt(add.11698), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11700 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11699), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11701 = f32[1,1,1]{2,1,0} broadcast(divide.11700), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11702 = f32[1,1]{1,0} reshape(broadcast.11701), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11703 = f32[1,1,2304]{2,1,0} broadcast(reshape.11702), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11704 = f32[1,1,2304]{2,1,0} multiply(add.11693, broadcast.11703), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8228 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=178
  add.11705 = f32[2304]{0} add(get-tuple-element.8228, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11706 = f32[1,1,2304]{2,1,0} reshape(add.11705), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11707 = f32[1,1,2304]{2,1,0} multiply(multiply.11704, reshape.11706), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8229 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=179
  dot.11708 = f32[1,1,9216]{2,1,0} dot(multiply.11707, get-tuple-element.8229), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11710 = f32[1,1,9216]{2,1,0} multiply(dot.11708, dot.11708), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11711 = f32[1,1,9216]{2,1,0} multiply(multiply.11710, dot.11708), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11712 = f32[1,1,9216]{2,1,0} multiply(multiply.11711, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.11713 = f32[1,1,9216]{2,1,0} add(dot.11708, multiply.11712), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11714 = f32[1,1,9216]{2,1,0} multiply(add.11713, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.11715 = f32[1,1,9216]{2,1,0} tanh(multiply.11714), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.11716 = f32[1,1,9216]{2,1,0} add(tanh.11715, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11717 = f32[1,1,9216]{2,1,0} multiply(add.11716, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11718 = f32[1,1,9216]{2,1,0} multiply(dot.11708, multiply.11717), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8230 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=180
  dot.11709 = f32[1,1,9216]{2,1,0} dot(multiply.11707, get-tuple-element.8230), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11719 = f32[1,1,9216]{2,1,0} multiply(multiply.11718, dot.11709), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8231 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=181
  dot.11720 = f32[1,1,2304]{2,1,0} dot(multiply.11719, get-tuple-element.8231), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11721 = f32[1,1,2304]{2,1,0} multiply(dot.11720, dot.11720), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11722 = f32[1,1]{1,0} reduce(multiply.11721, constant.8387), dimensions={2}, to_apply=region_292.7513, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11723 = f32[1,1,1]{2,1,0} reshape(reduce.11722), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11724 = f32[1,1,1]{2,1,0} divide(reshape.11723, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11725 = f32[1,1,1]{2,1,0} add(divide.11724, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11726 = f32[1,1,1]{2,1,0} sqrt(add.11725), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11727 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11726), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11728 = f32[1,1,1]{2,1,0} broadcast(divide.11727), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11729 = f32[1,1]{1,0} reshape(broadcast.11728), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11730 = f32[1,1,2304]{2,1,0} broadcast(reshape.11729), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11731 = f32[1,1,2304]{2,1,0} multiply(dot.11720, broadcast.11730), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8232 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=182
  add.11732 = f32[2304]{0} add(get-tuple-element.8232, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11733 = f32[1,1,2304]{2,1,0} reshape(add.11732), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11734 = f32[1,1,2304]{2,1,0} multiply(multiply.11731, reshape.11733), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.11735 = f32[1,1,2304]{2,1,0} add(multiply.11734, add.11693), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.11752 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.11753 = f32[1,1]{1,0} reshape(convert.11752), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.11754 = f32[1,1]{1,0} broadcast(reshape.11753), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.11755 = f32[1]{0} reshape(broadcast.11754), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.11756 = f32[1,31]{1,0} broadcast(reshape.11755), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.11757 = pred[1,31]{1,0} compare(broadcast.11756, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.11758 = pred[1,1,31]{2,1,0} reshape(compare.11757), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.11886 = s32[1,1,31]{2,1,0} convert(reshape.11758), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.11887 = pred[1,1,31]{2,1,0} compare(convert.11886, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.11888 = pred[1,1]{1,0} reduce(compare.11887, constant.8359), dimensions={2}, to_apply=region_296.7555, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.11889 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.11888), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.11736 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [16:17], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.11737 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.11736), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.11796 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.11737), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.11797 = f32[1,31,4,256]{3,2,1,0} reshape(slice.11796), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.11738 = f32[1,1,2304]{2,1,0} multiply(add.11735, add.11735), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11739 = f32[1,1]{1,0} reduce(multiply.11738, constant.8387), dimensions={2}, to_apply=region_293.7517, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11740 = f32[1,1,1]{2,1,0} reshape(reduce.11739), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11741 = f32[1,1,1]{2,1,0} divide(reshape.11740, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11742 = f32[1,1,1]{2,1,0} add(divide.11741, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11743 = f32[1,1,1]{2,1,0} sqrt(add.11742), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11744 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11743), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11745 = f32[1,1,1]{2,1,0} broadcast(divide.11744), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11746 = f32[1,1]{1,0} reshape(broadcast.11745), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11747 = f32[1,1,2304]{2,1,0} broadcast(reshape.11746), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11748 = f32[1,1,2304]{2,1,0} multiply(add.11735, broadcast.11747), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8233 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=183
  add.11749 = f32[2304]{0} add(get-tuple-element.8233, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11750 = f32[1,1,2304]{2,1,0} reshape(add.11749), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11751 = f32[1,1,2304]{2,1,0} multiply(multiply.11748, reshape.11750), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8236 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=186
  dot.11833 = f32[1,1,4,256]{3,2,1,0} dot(multiply.11751, get-tuple-element.8236), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.11838 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.11839 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.11840 = s32[] select(compare.11838, add.11839, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.11841 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.11797, dot.11833, constant.8391, select.11840, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.11794 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.11737), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.11795 = f32[1,31,4,256]{3,2,1,0} reshape(slice.11794), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8235 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=185
  dot.11798 = f32[1,1,4,256]{3,2,1,0} dot(multiply.11751, get-tuple-element.8235), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.11801 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.11802 = f32[1]{0} reshape(convert.11801), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.11803 = f32[1]{0} divide(reshape.11802, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.11799 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.11800 = f32[128]{0} divide(broadcast.8377, power.11799), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.11804 = f32[1,128]{1,0} dot(divide.11803, divide.11800), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.11805 = f32[1,1,128]{2,1,0} reshape(dot.11804), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11806 = f32[1,1,128]{2,1,0} reshape(dot.11804), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11807 = f32[1,2,128]{2,1,0} concatenate(reshape.11805, reshape.11806), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11808 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.11807), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.11809 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.11808), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.11818 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.11809), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.11819 = f32[1,1,256]{2,1,0} reshape(broadcast.11818), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.11820 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.11819), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.11821 = f32[1,1,4,256]{3,2,1,0} multiply(dot.11798, broadcast.11820), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.11812 = f32[1,1,4,128]{3,2,1,0} slice(dot.11798), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.11813 = f32[1,1,4,128]{3,2,1,0} negate(slice.11812), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.11814 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.11813), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.11811 = f32[1,1,4,128]{3,2,1,0} slice(dot.11798), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11815 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.11811), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11816 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.11814, reshape.11815), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11817 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.11816), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.11810 = f32[1,1,1,256]{3,2,1,0} sine(reshape.11808), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.11822 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.11810), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.11823 = f32[1,1,256]{2,1,0} reshape(broadcast.11822), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.11824 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.11823), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.11825 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.11817, broadcast.11824), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.11826 = f32[1,1,4,256]{3,2,1,0} add(multiply.11821, multiply.11825), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.11827 = f32[1,1,4,128]{3,2,1,0} slice(add.11826), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11829 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.11827), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.11828 = f32[1,1,4,128]{3,2,1,0} slice(add.11826), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11830 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.11828), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11831 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.11829, reshape.11830), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11832 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.11831), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.11834 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.11835 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.11836 = s32[] select(compare.11834, add.11835, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.11837 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.11795, reshape.11832, constant.8391, select.11836, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8234 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=184
  dot.11759 = f32[1,1,8,256]{3,2,1,0} dot(multiply.11751, get-tuple-element.8234), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.11762 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.11763 = f32[1]{0} reshape(convert.11762), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.11764 = f32[1]{0} divide(reshape.11763, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.11760 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.11761 = f32[128]{0} divide(broadcast.8377, power.11760), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.11765 = f32[1,128]{1,0} dot(divide.11764, divide.11761), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.11766 = f32[1,1,128]{2,1,0} reshape(dot.11765), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11767 = f32[1,1,128]{2,1,0} reshape(dot.11765), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11768 = f32[1,2,128]{2,1,0} concatenate(reshape.11766, reshape.11767), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11769 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.11768), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.11770 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.11769), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.11779 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.11770), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.11780 = f32[1,1,256]{2,1,0} reshape(broadcast.11779), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.11781 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.11780), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.11782 = f32[1,1,8,256]{3,2,1,0} multiply(dot.11759, broadcast.11781), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.11773 = f32[1,1,8,128]{3,2,1,0} slice(dot.11759), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.11774 = f32[1,1,8,128]{3,2,1,0} negate(slice.11773), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.11775 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.11774), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.11772 = f32[1,1,8,128]{3,2,1,0} slice(dot.11759), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11776 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.11772), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11777 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.11775, reshape.11776), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11778 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.11777), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.11771 = f32[1,1,1,256]{3,2,1,0} sine(reshape.11769), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.11783 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.11771), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.11784 = f32[1,1,256]{2,1,0} reshape(broadcast.11783), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.11785 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.11784), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.11786 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.11778, broadcast.11785), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.11787 = f32[1,1,8,256]{3,2,1,0} add(multiply.11782, multiply.11786), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/rotary_embedding_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.11788 = f32[1,1,8,128]{3,2,1,0} slice(add.11787), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11790 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.11788), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.11789 = f32[1,1,8,128]{3,2,1,0} slice(add.11787), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11791 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.11789), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11792 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.11790, reshape.11791), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11793 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.11792), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.11845 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.11793, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.11846 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.11845), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.11847 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.11837, reshape.11846), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.11848 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.11847), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.11849 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.11848, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.11850 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.11849), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.11851 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.11850, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.11852 = pred[31,31]{1,0} call(broadcast.8370), to_apply=triu_3.7521
  call.11853 = pred[31,31]{1,0} call(broadcast.8370), to_apply=tril_4.7534
  and.11854 = pred[31,31]{1,0} and(call.11852, call.11853), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  compare.11855 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  add.11856 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  select.11857 = s32[] select(compare.11855, add.11856, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  dynamic-slice.11858 = pred[1,31]{1,0} dynamic-slice(and.11854, select.11857, constant.8391), dynamic_slice_sizes={1,31}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/dynamic_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  reshape.11859 = pred[1,1,31]{2,1,0} reshape(dynamic-slice.11858), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.11860 = pred[1,1,31]{2,1,0} and(reshape.11758, reshape.11859), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.11861 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(and.11860), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.11862 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.11861), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.11863 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.11862), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.11864 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.11863, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.11865 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.11864), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.11866 = f32[1,1,31]{2,1,0} reshape(broadcast.11865), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.11867 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.11866), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.11868 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.11851, broadcast.11867), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.11869 = f32[1,4,2,1]{3,2,1,0} reduce(add.11868, constant.8364), dimensions={4}, to_apply=region_294.7547, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.11870 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.11869, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11871 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.11870), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11872 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.11871), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11873 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.11872), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11874 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.11873), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.11875 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.11868, broadcast.11874), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.11876 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.11875), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.11877 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.11876, constant.8387), dimensions={4}, to_apply=region_295.7551, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11878 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.11877), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11879 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.11878), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.11880 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.11879), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.11881 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.11880), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.11882 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.11876, broadcast.11881), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/softmax_16/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.11883 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.11841, divide.11882), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.11884 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.11883), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.11885 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.11884), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.11890 = f32[1,1,8,256]{3,2,1,0} call(reshape.11889, broadcast.8358, reshape.11885), to_apply=_where_5.7559
  get-tuple-element.8237 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=187
  dot.11891 = f32[1,1,2304]{2,1,0} dot(call.11890, get-tuple-element.8237), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11892 = f32[1,1,2304]{2,1,0} multiply(dot.11891, dot.11891), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11893 = f32[1,1]{1,0} reduce(multiply.11892, constant.8387), dimensions={2}, to_apply=region_297.7567, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11894 = f32[1,1,1]{2,1,0} reshape(reduce.11893), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11895 = f32[1,1,1]{2,1,0} divide(reshape.11894, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11896 = f32[1,1,1]{2,1,0} add(divide.11895, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11897 = f32[1,1,1]{2,1,0} sqrt(add.11896), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11898 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11897), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11899 = f32[1,1,1]{2,1,0} broadcast(divide.11898), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11900 = f32[1,1]{1,0} reshape(broadcast.11899), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11901 = f32[1,1,2304]{2,1,0} broadcast(reshape.11900), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11902 = f32[1,1,2304]{2,1,0} multiply(dot.11891, broadcast.11901), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8238 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=188
  add.11903 = f32[2304]{0} add(get-tuple-element.8238, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11904 = f32[1,1,2304]{2,1,0} reshape(add.11903), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11905 = f32[1,1,2304]{2,1,0} multiply(multiply.11902, reshape.11904), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.11906 = f32[1,1,2304]{2,1,0} add(add.11735, multiply.11905), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.11907 = f32[1,1,2304]{2,1,0} multiply(add.11906, add.11906), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11908 = f32[1,1]{1,0} reduce(multiply.11907, constant.8387), dimensions={2}, to_apply=region_298.7571, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11909 = f32[1,1,1]{2,1,0} reshape(reduce.11908), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11910 = f32[1,1,1]{2,1,0} divide(reshape.11909, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11911 = f32[1,1,1]{2,1,0} add(divide.11910, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11912 = f32[1,1,1]{2,1,0} sqrt(add.11911), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11913 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11912), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11914 = f32[1,1,1]{2,1,0} broadcast(divide.11913), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11915 = f32[1,1]{1,0} reshape(broadcast.11914), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11916 = f32[1,1,2304]{2,1,0} broadcast(reshape.11915), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11917 = f32[1,1,2304]{2,1,0} multiply(add.11906, broadcast.11916), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8239 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=189
  add.11918 = f32[2304]{0} add(get-tuple-element.8239, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11919 = f32[1,1,2304]{2,1,0} reshape(add.11918), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11920 = f32[1,1,2304]{2,1,0} multiply(multiply.11917, reshape.11919), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8240 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=190
  dot.11921 = f32[1,1,9216]{2,1,0} dot(multiply.11920, get-tuple-element.8240), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11923 = f32[1,1,9216]{2,1,0} multiply(dot.11921, dot.11921), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11924 = f32[1,1,9216]{2,1,0} multiply(multiply.11923, dot.11921), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11925 = f32[1,1,9216]{2,1,0} multiply(multiply.11924, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.11926 = f32[1,1,9216]{2,1,0} add(dot.11921, multiply.11925), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11927 = f32[1,1,9216]{2,1,0} multiply(add.11926, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.11928 = f32[1,1,9216]{2,1,0} tanh(multiply.11927), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.11929 = f32[1,1,9216]{2,1,0} add(tanh.11928, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11930 = f32[1,1,9216]{2,1,0} multiply(add.11929, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.11931 = f32[1,1,9216]{2,1,0} multiply(dot.11921, multiply.11930), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8241 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=191
  dot.11922 = f32[1,1,9216]{2,1,0} dot(multiply.11920, get-tuple-element.8241), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11932 = f32[1,1,9216]{2,1,0} multiply(multiply.11931, dot.11922), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8242 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=192
  dot.11933 = f32[1,1,2304]{2,1,0} dot(multiply.11932, get-tuple-element.8242), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.11934 = f32[1,1,2304]{2,1,0} multiply(dot.11933, dot.11933), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11935 = f32[1,1]{1,0} reduce(multiply.11934, constant.8387), dimensions={2}, to_apply=region_299.7575, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11936 = f32[1,1,1]{2,1,0} reshape(reduce.11935), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11937 = f32[1,1,1]{2,1,0} divide(reshape.11936, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11938 = f32[1,1,1]{2,1,0} add(divide.11937, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11939 = f32[1,1,1]{2,1,0} sqrt(add.11938), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11940 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11939), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11941 = f32[1,1,1]{2,1,0} broadcast(divide.11940), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11942 = f32[1,1]{1,0} reshape(broadcast.11941), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11943 = f32[1,1,2304]{2,1,0} broadcast(reshape.11942), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11944 = f32[1,1,2304]{2,1,0} multiply(dot.11933, broadcast.11943), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8243 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=193
  add.11945 = f32[2304]{0} add(get-tuple-element.8243, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11946 = f32[1,1,2304]{2,1,0} reshape(add.11945), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11947 = f32[1,1,2304]{2,1,0} multiply(multiply.11944, reshape.11946), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.11948 = f32[1,1,2304]{2,1,0} add(multiply.11947, add.11906), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.11965 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.11966 = f32[1,1]{1,0} reshape(convert.11965), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.11967 = f32[1,1]{1,0} broadcast(reshape.11966), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.11968 = f32[1]{0} reshape(broadcast.11967), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.11969 = f32[1,31]{1,0} broadcast(reshape.11968), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.11970 = pred[1,31]{1,0} compare(broadcast.11969, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.11971 = pred[1,1,31]{2,1,0} reshape(compare.11970), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.12090 = s32[1,1,31]{2,1,0} convert(reshape.11971), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.12091 = pred[1,1,31]{2,1,0} compare(convert.12090, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.12092 = pred[1,1]{1,0} reduce(compare.12091, constant.8359), dimensions={2}, to_apply=region_303.7591, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.12093 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.12092), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.11949 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [17:18], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.11950 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.11949), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.12009 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.11950), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.12010 = f32[1,31,4,256]{3,2,1,0} reshape(slice.12009), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.11951 = f32[1,1,2304]{2,1,0} multiply(add.11948, add.11948), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.11952 = f32[1,1]{1,0} reduce(multiply.11951, constant.8387), dimensions={2}, to_apply=region_300.7579, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.11953 = f32[1,1,1]{2,1,0} reshape(reduce.11952), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.11954 = f32[1,1,1]{2,1,0} divide(reshape.11953, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.11955 = f32[1,1,1]{2,1,0} add(divide.11954, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.11956 = f32[1,1,1]{2,1,0} sqrt(add.11955), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.11957 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.11956), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.11958 = f32[1,1,1]{2,1,0} broadcast(divide.11957), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.11959 = f32[1,1]{1,0} reshape(broadcast.11958), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.11960 = f32[1,1,2304]{2,1,0} broadcast(reshape.11959), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.11961 = f32[1,1,2304]{2,1,0} multiply(add.11948, broadcast.11960), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8244 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=194
  add.11962 = f32[2304]{0} add(get-tuple-element.8244, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.11963 = f32[1,1,2304]{2,1,0} reshape(add.11962), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.11964 = f32[1,1,2304]{2,1,0} multiply(multiply.11961, reshape.11963), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8247 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=197
  dot.12046 = f32[1,1,4,256]{3,2,1,0} dot(multiply.11964, get-tuple-element.8247), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.12051 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.12052 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.12053 = s32[] select(compare.12051, add.12052, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.12054 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.12010, dot.12046, constant.8391, select.12053, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.12007 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.11950), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.12008 = f32[1,31,4,256]{3,2,1,0} reshape(slice.12007), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8246 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=196
  dot.12011 = f32[1,1,4,256]{3,2,1,0} dot(multiply.11964, get-tuple-element.8246), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.12014 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.12015 = f32[1]{0} reshape(convert.12014), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.12016 = f32[1]{0} divide(reshape.12015, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.12012 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.12013 = f32[128]{0} divide(broadcast.8377, power.12012), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.12017 = f32[1,128]{1,0} dot(divide.12016, divide.12013), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.12018 = f32[1,1,128]{2,1,0} reshape(dot.12017), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12019 = f32[1,1,128]{2,1,0} reshape(dot.12017), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12020 = f32[1,2,128]{2,1,0} concatenate(reshape.12018, reshape.12019), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12021 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.12020), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.12022 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.12021), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.12031 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.12022), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.12032 = f32[1,1,256]{2,1,0} reshape(broadcast.12031), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.12033 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.12032), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.12034 = f32[1,1,4,256]{3,2,1,0} multiply(dot.12011, broadcast.12033), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.12025 = f32[1,1,4,128]{3,2,1,0} slice(dot.12011), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.12026 = f32[1,1,4,128]{3,2,1,0} negate(slice.12025), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.12027 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.12026), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.12024 = f32[1,1,4,128]{3,2,1,0} slice(dot.12011), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12028 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.12024), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12029 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.12027, reshape.12028), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12030 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.12029), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.12023 = f32[1,1,1,256]{3,2,1,0} sine(reshape.12021), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.12035 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.12023), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.12036 = f32[1,1,256]{2,1,0} reshape(broadcast.12035), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.12037 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.12036), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.12038 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.12030, broadcast.12037), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.12039 = f32[1,1,4,256]{3,2,1,0} add(multiply.12034, multiply.12038), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.12040 = f32[1,1,4,128]{3,2,1,0} slice(add.12039), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12042 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.12040), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.12041 = f32[1,1,4,128]{3,2,1,0} slice(add.12039), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12043 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.12041), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12044 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.12042, reshape.12043), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12045 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.12044), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.12047 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.12048 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.12049 = s32[] select(compare.12047, add.12048, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.12050 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.12008, reshape.12045, constant.8391, select.12049, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8245 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=195
  dot.11972 = f32[1,1,8,256]{3,2,1,0} dot(multiply.11964, get-tuple-element.8245), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.11975 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.11976 = f32[1]{0} reshape(convert.11975), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.11977 = f32[1]{0} divide(reshape.11976, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.11973 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.11974 = f32[128]{0} divide(broadcast.8377, power.11973), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.11978 = f32[1,128]{1,0} dot(divide.11977, divide.11974), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.11979 = f32[1,1,128]{2,1,0} reshape(dot.11978), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11980 = f32[1,1,128]{2,1,0} reshape(dot.11978), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11981 = f32[1,2,128]{2,1,0} concatenate(reshape.11979, reshape.11980), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11982 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.11981), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.11983 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.11982), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.11992 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.11983), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.11993 = f32[1,1,256]{2,1,0} reshape(broadcast.11992), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.11994 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.11993), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.11995 = f32[1,1,8,256]{3,2,1,0} multiply(dot.11972, broadcast.11994), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.11986 = f32[1,1,8,128]{3,2,1,0} slice(dot.11972), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.11987 = f32[1,1,8,128]{3,2,1,0} negate(slice.11986), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.11988 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.11987), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.11985 = f32[1,1,8,128]{3,2,1,0} slice(dot.11972), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.11989 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.11985), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11990 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.11988, reshape.11989), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11991 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.11990), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.11984 = f32[1,1,1,256]{3,2,1,0} sine(reshape.11982), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.11996 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.11984), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.11997 = f32[1,1,256]{2,1,0} reshape(broadcast.11996), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.11998 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.11997), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.11999 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.11991, broadcast.11998), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.12000 = f32[1,1,8,256]{3,2,1,0} add(multiply.11995, multiply.11999), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/rotary_embedding_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.12001 = f32[1,1,8,128]{3,2,1,0} slice(add.12000), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12003 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.12001), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.12002 = f32[1,1,8,128]{3,2,1,0} slice(add.12000), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12004 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.12002), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12005 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.12003, reshape.12004), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12006 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.12005), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.12058 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.12006, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.12059 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.12058), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.12060 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.12050, reshape.12059), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.12061 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.12060), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.12062 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.12061, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.12063 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.12062), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.12064 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.12063, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.12065 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(compare.11970), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.12066 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.12065), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.12067 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.12066), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.12068 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.12067, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.12069 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.12068), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.12070 = f32[1,1,31]{2,1,0} reshape(broadcast.12069), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.12071 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.12070), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.12072 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.12064, broadcast.12071), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.12073 = f32[1,4,2,1]{3,2,1,0} reduce(add.12072, constant.8364), dimensions={4}, to_apply=region_301.7583, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.12074 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.12073, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12075 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.12074), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12076 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.12075), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12077 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.12076), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12078 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.12077), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.12079 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.12072, broadcast.12078), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.12080 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.12079), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.12081 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.12080, constant.8387), dimensions={4}, to_apply=region_302.7587, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12082 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.12081), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12083 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.12082), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12084 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.12083), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12085 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.12084), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.12086 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.12080, broadcast.12085), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/softmax_17/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.12087 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.12054, divide.12086), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.12088 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.12087), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.12089 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.12088), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.12094 = f32[1,1,8,256]{3,2,1,0} call(reshape.12093, broadcast.8358, reshape.12089), to_apply=_where_5.7595
  get-tuple-element.8248 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=198
  dot.12095 = f32[1,1,2304]{2,1,0} dot(call.12094, get-tuple-element.8248), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12096 = f32[1,1,2304]{2,1,0} multiply(dot.12095, dot.12095), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12097 = f32[1,1]{1,0} reduce(multiply.12096, constant.8387), dimensions={2}, to_apply=region_304.7603, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12098 = f32[1,1,1]{2,1,0} reshape(reduce.12097), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12099 = f32[1,1,1]{2,1,0} divide(reshape.12098, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12100 = f32[1,1,1]{2,1,0} add(divide.12099, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12101 = f32[1,1,1]{2,1,0} sqrt(add.12100), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12102 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12101), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12103 = f32[1,1,1]{2,1,0} broadcast(divide.12102), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12104 = f32[1,1]{1,0} reshape(broadcast.12103), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12105 = f32[1,1,2304]{2,1,0} broadcast(reshape.12104), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12106 = f32[1,1,2304]{2,1,0} multiply(dot.12095, broadcast.12105), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8249 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=199
  add.12107 = f32[2304]{0} add(get-tuple-element.8249, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.12108 = f32[1,1,2304]{2,1,0} reshape(add.12107), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.12109 = f32[1,1,2304]{2,1,0} multiply(multiply.12106, reshape.12108), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.12110 = f32[1,1,2304]{2,1,0} add(add.11948, multiply.12109), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.12111 = f32[1,1,2304]{2,1,0} multiply(add.12110, add.12110), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12112 = f32[1,1]{1,0} reduce(multiply.12111, constant.8387), dimensions={2}, to_apply=region_305.7607, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12113 = f32[1,1,1]{2,1,0} reshape(reduce.12112), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12114 = f32[1,1,1]{2,1,0} divide(reshape.12113, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12115 = f32[1,1,1]{2,1,0} add(divide.12114, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12116 = f32[1,1,1]{2,1,0} sqrt(add.12115), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12117 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12116), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12118 = f32[1,1,1]{2,1,0} broadcast(divide.12117), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12119 = f32[1,1]{1,0} reshape(broadcast.12118), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12120 = f32[1,1,2304]{2,1,0} broadcast(reshape.12119), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12121 = f32[1,1,2304]{2,1,0} multiply(add.12110, broadcast.12120), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8250 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=200
  add.12122 = f32[2304]{0} add(get-tuple-element.8250, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.12123 = f32[1,1,2304]{2,1,0} reshape(add.12122), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.12124 = f32[1,1,2304]{2,1,0} multiply(multiply.12121, reshape.12123), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8251 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=201
  dot.12125 = f32[1,1,9216]{2,1,0} dot(multiply.12124, get-tuple-element.8251), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12127 = f32[1,1,9216]{2,1,0} multiply(dot.12125, dot.12125), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12128 = f32[1,1,9216]{2,1,0} multiply(multiply.12127, dot.12125), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12129 = f32[1,1,9216]{2,1,0} multiply(multiply.12128, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.12130 = f32[1,1,9216]{2,1,0} add(dot.12125, multiply.12129), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12131 = f32[1,1,9216]{2,1,0} multiply(add.12130, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.12132 = f32[1,1,9216]{2,1,0} tanh(multiply.12131), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.12133 = f32[1,1,9216]{2,1,0} add(tanh.12132, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12134 = f32[1,1,9216]{2,1,0} multiply(add.12133, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12135 = f32[1,1,9216]{2,1,0} multiply(dot.12125, multiply.12134), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8252 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=202
  dot.12126 = f32[1,1,9216]{2,1,0} dot(multiply.12124, get-tuple-element.8252), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12136 = f32[1,1,9216]{2,1,0} multiply(multiply.12135, dot.12126), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8253 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=203
  dot.12137 = f32[1,1,2304]{2,1,0} dot(multiply.12136, get-tuple-element.8253), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12138 = f32[1,1,2304]{2,1,0} multiply(dot.12137, dot.12137), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12139 = f32[1,1]{1,0} reduce(multiply.12138, constant.8387), dimensions={2}, to_apply=region_306.7611, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12140 = f32[1,1,1]{2,1,0} reshape(reduce.12139), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12141 = f32[1,1,1]{2,1,0} divide(reshape.12140, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12142 = f32[1,1,1]{2,1,0} add(divide.12141, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12143 = f32[1,1,1]{2,1,0} sqrt(add.12142), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12144 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12143), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12145 = f32[1,1,1]{2,1,0} broadcast(divide.12144), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12146 = f32[1,1]{1,0} reshape(broadcast.12145), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12147 = f32[1,1,2304]{2,1,0} broadcast(reshape.12146), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12148 = f32[1,1,2304]{2,1,0} multiply(dot.12137, broadcast.12147), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8254 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=204
  add.12149 = f32[2304]{0} add(get-tuple-element.8254, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.12150 = f32[1,1,2304]{2,1,0} reshape(add.12149), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.12151 = f32[1,1,2304]{2,1,0} multiply(multiply.12148, reshape.12150), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.12152 = f32[1,1,2304]{2,1,0} add(multiply.12151, add.12110), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.12169 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.12170 = f32[1,1]{1,0} reshape(convert.12169), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.12171 = f32[1,1]{1,0} broadcast(reshape.12170), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.12172 = f32[1]{0} reshape(broadcast.12171), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.12173 = f32[1,31]{1,0} broadcast(reshape.12172), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.12174 = pred[1,31]{1,0} compare(broadcast.12173, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.12175 = pred[1,1,31]{2,1,0} reshape(compare.12174), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.12303 = s32[1,1,31]{2,1,0} convert(reshape.12175), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.12304 = pred[1,1,31]{2,1,0} compare(convert.12303, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.12305 = pred[1,1]{1,0} reduce(compare.12304, constant.8359), dimensions={2}, to_apply=region_310.7653, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.12306 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.12305), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.12153 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [18:19], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.12154 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.12153), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.12213 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.12154), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.12214 = f32[1,31,4,256]{3,2,1,0} reshape(slice.12213), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.12155 = f32[1,1,2304]{2,1,0} multiply(add.12152, add.12152), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12156 = f32[1,1]{1,0} reduce(multiply.12155, constant.8387), dimensions={2}, to_apply=region_307.7615, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12157 = f32[1,1,1]{2,1,0} reshape(reduce.12156), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12158 = f32[1,1,1]{2,1,0} divide(reshape.12157, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12159 = f32[1,1,1]{2,1,0} add(divide.12158, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12160 = f32[1,1,1]{2,1,0} sqrt(add.12159), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12161 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12160), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12162 = f32[1,1,1]{2,1,0} broadcast(divide.12161), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12163 = f32[1,1]{1,0} reshape(broadcast.12162), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12164 = f32[1,1,2304]{2,1,0} broadcast(reshape.12163), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12165 = f32[1,1,2304]{2,1,0} multiply(add.12152, broadcast.12164), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8255 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=205
  add.12166 = f32[2304]{0} add(get-tuple-element.8255, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.12167 = f32[1,1,2304]{2,1,0} reshape(add.12166), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.12168 = f32[1,1,2304]{2,1,0} multiply(multiply.12165, reshape.12167), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8258 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=208
  dot.12250 = f32[1,1,4,256]{3,2,1,0} dot(multiply.12168, get-tuple-element.8258), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.12255 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.12256 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.12257 = s32[] select(compare.12255, add.12256, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.12258 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.12214, dot.12250, constant.8391, select.12257, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.12211 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.12154), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.12212 = f32[1,31,4,256]{3,2,1,0} reshape(slice.12211), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8257 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=207
  dot.12215 = f32[1,1,4,256]{3,2,1,0} dot(multiply.12168, get-tuple-element.8257), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.12218 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.12219 = f32[1]{0} reshape(convert.12218), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.12220 = f32[1]{0} divide(reshape.12219, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.12216 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.12217 = f32[128]{0} divide(broadcast.8377, power.12216), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.12221 = f32[1,128]{1,0} dot(divide.12220, divide.12217), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.12222 = f32[1,1,128]{2,1,0} reshape(dot.12221), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12223 = f32[1,1,128]{2,1,0} reshape(dot.12221), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12224 = f32[1,2,128]{2,1,0} concatenate(reshape.12222, reshape.12223), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12225 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.12224), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.12226 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.12225), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.12235 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.12226), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.12236 = f32[1,1,256]{2,1,0} reshape(broadcast.12235), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.12237 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.12236), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.12238 = f32[1,1,4,256]{3,2,1,0} multiply(dot.12215, broadcast.12237), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.12229 = f32[1,1,4,128]{3,2,1,0} slice(dot.12215), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.12230 = f32[1,1,4,128]{3,2,1,0} negate(slice.12229), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.12231 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.12230), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.12228 = f32[1,1,4,128]{3,2,1,0} slice(dot.12215), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12232 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.12228), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12233 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.12231, reshape.12232), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12234 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.12233), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.12227 = f32[1,1,1,256]{3,2,1,0} sine(reshape.12225), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.12239 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.12227), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.12240 = f32[1,1,256]{2,1,0} reshape(broadcast.12239), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.12241 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.12240), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.12242 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.12234, broadcast.12241), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.12243 = f32[1,1,4,256]{3,2,1,0} add(multiply.12238, multiply.12242), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.12244 = f32[1,1,4,128]{3,2,1,0} slice(add.12243), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12246 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.12244), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.12245 = f32[1,1,4,128]{3,2,1,0} slice(add.12243), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12247 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.12245), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12248 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.12246, reshape.12247), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12249 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.12248), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.12251 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.12252 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.12253 = s32[] select(compare.12251, add.12252, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.12254 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.12212, reshape.12249, constant.8391, select.12253, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8256 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=206
  dot.12176 = f32[1,1,8,256]{3,2,1,0} dot(multiply.12168, get-tuple-element.8256), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.12179 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.12180 = f32[1]{0} reshape(convert.12179), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.12181 = f32[1]{0} divide(reshape.12180, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.12177 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.12178 = f32[128]{0} divide(broadcast.8377, power.12177), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.12182 = f32[1,128]{1,0} dot(divide.12181, divide.12178), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.12183 = f32[1,1,128]{2,1,0} reshape(dot.12182), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12184 = f32[1,1,128]{2,1,0} reshape(dot.12182), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12185 = f32[1,2,128]{2,1,0} concatenate(reshape.12183, reshape.12184), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12186 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.12185), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.12187 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.12186), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.12196 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.12187), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.12197 = f32[1,1,256]{2,1,0} reshape(broadcast.12196), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.12198 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.12197), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.12199 = f32[1,1,8,256]{3,2,1,0} multiply(dot.12176, broadcast.12198), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.12190 = f32[1,1,8,128]{3,2,1,0} slice(dot.12176), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.12191 = f32[1,1,8,128]{3,2,1,0} negate(slice.12190), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.12192 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.12191), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.12189 = f32[1,1,8,128]{3,2,1,0} slice(dot.12176), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12193 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.12189), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12194 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.12192, reshape.12193), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12195 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.12194), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.12188 = f32[1,1,1,256]{3,2,1,0} sine(reshape.12186), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.12200 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.12188), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.12201 = f32[1,1,256]{2,1,0} reshape(broadcast.12200), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.12202 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.12201), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.12203 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.12195, broadcast.12202), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.12204 = f32[1,1,8,256]{3,2,1,0} add(multiply.12199, multiply.12203), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/rotary_embedding_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.12205 = f32[1,1,8,128]{3,2,1,0} slice(add.12204), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12207 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.12205), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.12206 = f32[1,1,8,128]{3,2,1,0} slice(add.12204), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12208 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.12206), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12209 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.12207, reshape.12208), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12210 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.12209), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.12262 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.12210, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.12263 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.12262), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.12264 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.12254, reshape.12263), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.12265 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.12264), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.12266 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.12265, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.12267 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.12266), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.12268 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.12267, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.12269 = pred[31,31]{1,0} call(broadcast.8370), to_apply=triu_3.7619
  call.12270 = pred[31,31]{1,0} call(broadcast.8370), to_apply=tril_4.7632
  and.12271 = pred[31,31]{1,0} and(call.12269, call.12270), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  compare.12272 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  add.12273 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  select.12274 = s32[] select(compare.12272, add.12273, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  dynamic-slice.12275 = pred[1,31]{1,0} dynamic-slice(and.12271, select.12274, constant.8391), dynamic_slice_sizes={1,31}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/dynamic_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  reshape.12276 = pred[1,1,31]{2,1,0} reshape(dynamic-slice.12275), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.12277 = pred[1,1,31]{2,1,0} and(reshape.12175, reshape.12276), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.12278 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(and.12277), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.12279 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.12278), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.12280 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.12279), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.12281 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.12280, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.12282 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.12281), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.12283 = f32[1,1,31]{2,1,0} reshape(broadcast.12282), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.12284 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.12283), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.12285 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.12268, broadcast.12284), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.12286 = f32[1,4,2,1]{3,2,1,0} reduce(add.12285, constant.8364), dimensions={4}, to_apply=region_308.7645, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.12287 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.12286, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12288 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.12287), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12289 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.12288), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12290 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.12289), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12291 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.12290), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.12292 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.12285, broadcast.12291), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.12293 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.12292), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.12294 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.12293, constant.8387), dimensions={4}, to_apply=region_309.7649, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12295 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.12294), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12296 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.12295), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12297 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.12296), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12298 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.12297), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.12299 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.12293, broadcast.12298), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/softmax_18/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.12300 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.12258, divide.12299), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.12301 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.12300), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.12302 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.12301), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.12307 = f32[1,1,8,256]{3,2,1,0} call(reshape.12306, broadcast.8358, reshape.12302), to_apply=_where_5.7657
  get-tuple-element.8259 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=209
  dot.12308 = f32[1,1,2304]{2,1,0} dot(call.12307, get-tuple-element.8259), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12309 = f32[1,1,2304]{2,1,0} multiply(dot.12308, dot.12308), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12310 = f32[1,1]{1,0} reduce(multiply.12309, constant.8387), dimensions={2}, to_apply=region_311.7665, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12311 = f32[1,1,1]{2,1,0} reshape(reduce.12310), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12312 = f32[1,1,1]{2,1,0} divide(reshape.12311, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12313 = f32[1,1,1]{2,1,0} add(divide.12312, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12314 = f32[1,1,1]{2,1,0} sqrt(add.12313), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12315 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12314), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12316 = f32[1,1,1]{2,1,0} broadcast(divide.12315), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12317 = f32[1,1]{1,0} reshape(broadcast.12316), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12318 = f32[1,1,2304]{2,1,0} broadcast(reshape.12317), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12319 = f32[1,1,2304]{2,1,0} multiply(dot.12308, broadcast.12318), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8260 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=210
  add.12320 = f32[2304]{0} add(get-tuple-element.8260, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.12321 = f32[1,1,2304]{2,1,0} reshape(add.12320), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.12322 = f32[1,1,2304]{2,1,0} multiply(multiply.12319, reshape.12321), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.12323 = f32[1,1,2304]{2,1,0} add(add.12152, multiply.12322), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.12324 = f32[1,1,2304]{2,1,0} multiply(add.12323, add.12323), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12325 = f32[1,1]{1,0} reduce(multiply.12324, constant.8387), dimensions={2}, to_apply=region_312.7669, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12326 = f32[1,1,1]{2,1,0} reshape(reduce.12325), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12327 = f32[1,1,1]{2,1,0} divide(reshape.12326, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12328 = f32[1,1,1]{2,1,0} add(divide.12327, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12329 = f32[1,1,1]{2,1,0} sqrt(add.12328), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12330 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12329), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12331 = f32[1,1,1]{2,1,0} broadcast(divide.12330), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12332 = f32[1,1]{1,0} reshape(broadcast.12331), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12333 = f32[1,1,2304]{2,1,0} broadcast(reshape.12332), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12334 = f32[1,1,2304]{2,1,0} multiply(add.12323, broadcast.12333), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8261 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=211
  add.12335 = f32[2304]{0} add(get-tuple-element.8261, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.12336 = f32[1,1,2304]{2,1,0} reshape(add.12335), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.12337 = f32[1,1,2304]{2,1,0} multiply(multiply.12334, reshape.12336), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8262 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=212
  dot.12338 = f32[1,1,9216]{2,1,0} dot(multiply.12337, get-tuple-element.8262), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12340 = f32[1,1,9216]{2,1,0} multiply(dot.12338, dot.12338), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12341 = f32[1,1,9216]{2,1,0} multiply(multiply.12340, dot.12338), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12342 = f32[1,1,9216]{2,1,0} multiply(multiply.12341, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.12343 = f32[1,1,9216]{2,1,0} add(dot.12338, multiply.12342), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12344 = f32[1,1,9216]{2,1,0} multiply(add.12343, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.12345 = f32[1,1,9216]{2,1,0} tanh(multiply.12344), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.12346 = f32[1,1,9216]{2,1,0} add(tanh.12345, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12347 = f32[1,1,9216]{2,1,0} multiply(add.12346, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12348 = f32[1,1,9216]{2,1,0} multiply(dot.12338, multiply.12347), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8263 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=213
  dot.12339 = f32[1,1,9216]{2,1,0} dot(multiply.12337, get-tuple-element.8263), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12349 = f32[1,1,9216]{2,1,0} multiply(multiply.12348, dot.12339), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8264 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=214
  dot.12350 = f32[1,1,2304]{2,1,0} dot(multiply.12349, get-tuple-element.8264), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12351 = f32[1,1,2304]{2,1,0} multiply(dot.12350, dot.12350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12352 = f32[1,1]{1,0} reduce(multiply.12351, constant.8387), dimensions={2}, to_apply=region_313.7673, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12353 = f32[1,1,1]{2,1,0} reshape(reduce.12352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12354 = f32[1,1,1]{2,1,0} divide(reshape.12353, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12355 = f32[1,1,1]{2,1,0} add(divide.12354, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12356 = f32[1,1,1]{2,1,0} sqrt(add.12355), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12357 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12358 = f32[1,1,1]{2,1,0} broadcast(divide.12357), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12359 = f32[1,1]{1,0} reshape(broadcast.12358), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12360 = f32[1,1,2304]{2,1,0} broadcast(reshape.12359), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12361 = f32[1,1,2304]{2,1,0} multiply(dot.12350, broadcast.12360), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8265 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=215
  add.12362 = f32[2304]{0} add(get-tuple-element.8265, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.12363 = f32[1,1,2304]{2,1,0} reshape(add.12362), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.12364 = f32[1,1,2304]{2,1,0} multiply(multiply.12361, reshape.12363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.12365 = f32[1,1,2304]{2,1,0} add(multiply.12364, add.12323), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.12382 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.12383 = f32[1,1]{1,0} reshape(convert.12382), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.12384 = f32[1,1]{1,0} broadcast(reshape.12383), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.12385 = f32[1]{0} reshape(broadcast.12384), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.12386 = f32[1,31]{1,0} broadcast(reshape.12385), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.12387 = pred[1,31]{1,0} compare(broadcast.12386, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.12388 = pred[1,1,31]{2,1,0} reshape(compare.12387), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.12507 = s32[1,1,31]{2,1,0} convert(reshape.12388), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.12508 = pred[1,1,31]{2,1,0} compare(convert.12507, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.12509 = pred[1,1]{1,0} reduce(compare.12508, constant.8359), dimensions={2}, to_apply=region_317.7689, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.12510 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.12509), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.12366 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [19:20], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.12367 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.12366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.12426 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.12367), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.12427 = f32[1,31,4,256]{3,2,1,0} reshape(slice.12426), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.12368 = f32[1,1,2304]{2,1,0} multiply(add.12365, add.12365), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12369 = f32[1,1]{1,0} reduce(multiply.12368, constant.8387), dimensions={2}, to_apply=region_314.7677, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12370 = f32[1,1,1]{2,1,0} reshape(reduce.12369), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12371 = f32[1,1,1]{2,1,0} divide(reshape.12370, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12372 = f32[1,1,1]{2,1,0} add(divide.12371, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12373 = f32[1,1,1]{2,1,0} sqrt(add.12372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12374 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12373), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12375 = f32[1,1,1]{2,1,0} broadcast(divide.12374), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12376 = f32[1,1]{1,0} reshape(broadcast.12375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12377 = f32[1,1,2304]{2,1,0} broadcast(reshape.12376), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12378 = f32[1,1,2304]{2,1,0} multiply(add.12365, broadcast.12377), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8266 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=216
  add.12379 = f32[2304]{0} add(get-tuple-element.8266, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.12380 = f32[1,1,2304]{2,1,0} reshape(add.12379), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.12381 = f32[1,1,2304]{2,1,0} multiply(multiply.12378, reshape.12380), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8269 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=219
  dot.12463 = f32[1,1,4,256]{3,2,1,0} dot(multiply.12381, get-tuple-element.8269), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.12468 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.12469 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.12470 = s32[] select(compare.12468, add.12469, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.12471 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.12427, dot.12463, constant.8391, select.12470, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.12424 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.12367), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.12425 = f32[1,31,4,256]{3,2,1,0} reshape(slice.12424), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8268 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=218
  dot.12428 = f32[1,1,4,256]{3,2,1,0} dot(multiply.12381, get-tuple-element.8268), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.12431 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.12432 = f32[1]{0} reshape(convert.12431), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.12433 = f32[1]{0} divide(reshape.12432, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.12429 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.12430 = f32[128]{0} divide(broadcast.8377, power.12429), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.12434 = f32[1,128]{1,0} dot(divide.12433, divide.12430), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.12435 = f32[1,1,128]{2,1,0} reshape(dot.12434), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12436 = f32[1,1,128]{2,1,0} reshape(dot.12434), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12437 = f32[1,2,128]{2,1,0} concatenate(reshape.12435, reshape.12436), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12438 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.12437), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.12439 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.12438), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.12448 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.12439), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.12449 = f32[1,1,256]{2,1,0} reshape(broadcast.12448), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.12450 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.12449), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.12451 = f32[1,1,4,256]{3,2,1,0} multiply(dot.12428, broadcast.12450), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.12442 = f32[1,1,4,128]{3,2,1,0} slice(dot.12428), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.12443 = f32[1,1,4,128]{3,2,1,0} negate(slice.12442), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.12444 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.12443), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.12441 = f32[1,1,4,128]{3,2,1,0} slice(dot.12428), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12445 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.12441), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12446 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.12444, reshape.12445), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12447 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.12446), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.12440 = f32[1,1,1,256]{3,2,1,0} sine(reshape.12438), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.12452 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.12440), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.12453 = f32[1,1,256]{2,1,0} reshape(broadcast.12452), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.12454 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.12453), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.12455 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.12447, broadcast.12454), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.12456 = f32[1,1,4,256]{3,2,1,0} add(multiply.12451, multiply.12455), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.12457 = f32[1,1,4,128]{3,2,1,0} slice(add.12456), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12459 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.12457), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.12458 = f32[1,1,4,128]{3,2,1,0} slice(add.12456), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12460 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.12458), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12461 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.12459, reshape.12460), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12462 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.12461), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.12464 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.12465 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.12466 = s32[] select(compare.12464, add.12465, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.12467 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.12425, reshape.12462, constant.8391, select.12466, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8267 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=217
  dot.12389 = f32[1,1,8,256]{3,2,1,0} dot(multiply.12381, get-tuple-element.8267), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.12392 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.12393 = f32[1]{0} reshape(convert.12392), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.12394 = f32[1]{0} divide(reshape.12393, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.12390 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.12391 = f32[128]{0} divide(broadcast.8377, power.12390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.12395 = f32[1,128]{1,0} dot(divide.12394, divide.12391), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.12396 = f32[1,1,128]{2,1,0} reshape(dot.12395), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12397 = f32[1,1,128]{2,1,0} reshape(dot.12395), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12398 = f32[1,2,128]{2,1,0} concatenate(reshape.12396, reshape.12397), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12399 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.12398), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.12400 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.12399), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.12409 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.12400), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.12410 = f32[1,1,256]{2,1,0} reshape(broadcast.12409), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.12411 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.12410), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.12412 = f32[1,1,8,256]{3,2,1,0} multiply(dot.12389, broadcast.12411), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.12403 = f32[1,1,8,128]{3,2,1,0} slice(dot.12389), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.12404 = f32[1,1,8,128]{3,2,1,0} negate(slice.12403), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.12405 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.12404), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.12402 = f32[1,1,8,128]{3,2,1,0} slice(dot.12389), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12406 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.12402), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12407 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.12405, reshape.12406), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12408 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.12407), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.12401 = f32[1,1,1,256]{3,2,1,0} sine(reshape.12399), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.12413 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.12401), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.12414 = f32[1,1,256]{2,1,0} reshape(broadcast.12413), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.12415 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.12414), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.12416 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.12408, broadcast.12415), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.12417 = f32[1,1,8,256]{3,2,1,0} add(multiply.12412, multiply.12416), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/rotary_embedding_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.12418 = f32[1,1,8,128]{3,2,1,0} slice(add.12417), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12420 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.12418), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.12419 = f32[1,1,8,128]{3,2,1,0} slice(add.12417), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12421 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.12419), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12422 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.12420, reshape.12421), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12423 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.12422), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.12475 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.12423, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.12476 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.12475), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.12477 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.12467, reshape.12476), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.12478 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.12477), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.12479 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.12478, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.12480 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.12479), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.12481 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.12480, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.12482 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(compare.12387), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.12483 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.12482), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.12484 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.12483), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.12485 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.12484, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.12486 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.12485), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.12487 = f32[1,1,31]{2,1,0} reshape(broadcast.12486), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.12488 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.12487), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.12489 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.12481, broadcast.12488), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.12490 = f32[1,4,2,1]{3,2,1,0} reduce(add.12489, constant.8364), dimensions={4}, to_apply=region_315.7681, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.12491 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.12490, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12492 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.12491), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12493 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.12492), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12494 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.12493), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12495 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.12494), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.12496 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.12489, broadcast.12495), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.12497 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.12496), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.12498 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.12497, constant.8387), dimensions={4}, to_apply=region_316.7685, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12499 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.12498), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12500 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.12499), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12501 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.12500), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12502 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.12501), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.12503 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.12497, broadcast.12502), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/softmax_19/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.12504 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.12471, divide.12503), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.12505 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.12504), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.12506 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.12505), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.12511 = f32[1,1,8,256]{3,2,1,0} call(reshape.12510, broadcast.8358, reshape.12506), to_apply=_where_5.7693
  get-tuple-element.8270 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=220
  dot.12512 = f32[1,1,2304]{2,1,0} dot(call.12511, get-tuple-element.8270), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12513 = f32[1,1,2304]{2,1,0} multiply(dot.12512, dot.12512), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12514 = f32[1,1]{1,0} reduce(multiply.12513, constant.8387), dimensions={2}, to_apply=region_318.7701, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12515 = f32[1,1,1]{2,1,0} reshape(reduce.12514), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12516 = f32[1,1,1]{2,1,0} divide(reshape.12515, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12517 = f32[1,1,1]{2,1,0} add(divide.12516, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12518 = f32[1,1,1]{2,1,0} sqrt(add.12517), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12519 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12518), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12520 = f32[1,1,1]{2,1,0} broadcast(divide.12519), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12521 = f32[1,1]{1,0} reshape(broadcast.12520), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12522 = f32[1,1,2304]{2,1,0} broadcast(reshape.12521), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12523 = f32[1,1,2304]{2,1,0} multiply(dot.12512, broadcast.12522), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8271 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=221
  add.12524 = f32[2304]{0} add(get-tuple-element.8271, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.12525 = f32[1,1,2304]{2,1,0} reshape(add.12524), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.12526 = f32[1,1,2304]{2,1,0} multiply(multiply.12523, reshape.12525), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.12527 = f32[1,1,2304]{2,1,0} add(add.12365, multiply.12526), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.12528 = f32[1,1,2304]{2,1,0} multiply(add.12527, add.12527), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12529 = f32[1,1]{1,0} reduce(multiply.12528, constant.8387), dimensions={2}, to_apply=region_319.7705, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12530 = f32[1,1,1]{2,1,0} reshape(reduce.12529), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12531 = f32[1,1,1]{2,1,0} divide(reshape.12530, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12532 = f32[1,1,1]{2,1,0} add(divide.12531, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12533 = f32[1,1,1]{2,1,0} sqrt(add.12532), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12534 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12533), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12535 = f32[1,1,1]{2,1,0} broadcast(divide.12534), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12536 = f32[1,1]{1,0} reshape(broadcast.12535), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12537 = f32[1,1,2304]{2,1,0} broadcast(reshape.12536), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12538 = f32[1,1,2304]{2,1,0} multiply(add.12527, broadcast.12537), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8272 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=222
  add.12539 = f32[2304]{0} add(get-tuple-element.8272, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.12540 = f32[1,1,2304]{2,1,0} reshape(add.12539), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.12541 = f32[1,1,2304]{2,1,0} multiply(multiply.12538, reshape.12540), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8273 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=223
  dot.12542 = f32[1,1,9216]{2,1,0} dot(multiply.12541, get-tuple-element.8273), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12544 = f32[1,1,9216]{2,1,0} multiply(dot.12542, dot.12542), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12545 = f32[1,1,9216]{2,1,0} multiply(multiply.12544, dot.12542), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12546 = f32[1,1,9216]{2,1,0} multiply(multiply.12545, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.12547 = f32[1,1,9216]{2,1,0} add(dot.12542, multiply.12546), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12548 = f32[1,1,9216]{2,1,0} multiply(add.12547, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.12549 = f32[1,1,9216]{2,1,0} tanh(multiply.12548), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.12550 = f32[1,1,9216]{2,1,0} add(tanh.12549, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12551 = f32[1,1,9216]{2,1,0} multiply(add.12550, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12552 = f32[1,1,9216]{2,1,0} multiply(dot.12542, multiply.12551), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8274 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=224
  dot.12543 = f32[1,1,9216]{2,1,0} dot(multiply.12541, get-tuple-element.8274), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12553 = f32[1,1,9216]{2,1,0} multiply(multiply.12552, dot.12543), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8275 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=225
  dot.12554 = f32[1,1,2304]{2,1,0} dot(multiply.12553, get-tuple-element.8275), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12555 = f32[1,1,2304]{2,1,0} multiply(dot.12554, dot.12554), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12556 = f32[1,1]{1,0} reduce(multiply.12555, constant.8387), dimensions={2}, to_apply=region_320.7709, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12557 = f32[1,1,1]{2,1,0} reshape(reduce.12556), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12558 = f32[1,1,1]{2,1,0} divide(reshape.12557, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12559 = f32[1,1,1]{2,1,0} add(divide.12558, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12560 = f32[1,1,1]{2,1,0} sqrt(add.12559), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12561 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12560), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12562 = f32[1,1,1]{2,1,0} broadcast(divide.12561), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12563 = f32[1,1]{1,0} reshape(broadcast.12562), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12564 = f32[1,1,2304]{2,1,0} broadcast(reshape.12563), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12565 = f32[1,1,2304]{2,1,0} multiply(dot.12554, broadcast.12564), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8276 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=226
  add.12566 = f32[2304]{0} add(get-tuple-element.8276, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.12567 = f32[1,1,2304]{2,1,0} reshape(add.12566), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.12568 = f32[1,1,2304]{2,1,0} multiply(multiply.12565, reshape.12567), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.12569 = f32[1,1,2304]{2,1,0} add(multiply.12568, add.12527), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.12586 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.12587 = f32[1,1]{1,0} reshape(convert.12586), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.12588 = f32[1,1]{1,0} broadcast(reshape.12587), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.12589 = f32[1]{0} reshape(broadcast.12588), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.12590 = f32[1,31]{1,0} broadcast(reshape.12589), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.12591 = pred[1,31]{1,0} compare(broadcast.12590, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.12592 = pred[1,1,31]{2,1,0} reshape(compare.12591), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.12720 = s32[1,1,31]{2,1,0} convert(reshape.12592), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.12721 = pred[1,1,31]{2,1,0} compare(convert.12720, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.12722 = pred[1,1]{1,0} reduce(compare.12721, constant.8359), dimensions={2}, to_apply=region_324.7751, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.12723 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.12722), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.12570 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [20:21], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.12571 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.12570), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.12630 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.12571), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.12631 = f32[1,31,4,256]{3,2,1,0} reshape(slice.12630), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.12572 = f32[1,1,2304]{2,1,0} multiply(add.12569, add.12569), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12573 = f32[1,1]{1,0} reduce(multiply.12572, constant.8387), dimensions={2}, to_apply=region_321.7713, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12574 = f32[1,1,1]{2,1,0} reshape(reduce.12573), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12575 = f32[1,1,1]{2,1,0} divide(reshape.12574, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12576 = f32[1,1,1]{2,1,0} add(divide.12575, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12577 = f32[1,1,1]{2,1,0} sqrt(add.12576), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12578 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12577), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12579 = f32[1,1,1]{2,1,0} broadcast(divide.12578), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12580 = f32[1,1]{1,0} reshape(broadcast.12579), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12581 = f32[1,1,2304]{2,1,0} broadcast(reshape.12580), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12582 = f32[1,1,2304]{2,1,0} multiply(add.12569, broadcast.12581), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8277 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=227
  add.12583 = f32[2304]{0} add(get-tuple-element.8277, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.12584 = f32[1,1,2304]{2,1,0} reshape(add.12583), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.12585 = f32[1,1,2304]{2,1,0} multiply(multiply.12582, reshape.12584), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8280 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=230
  dot.12667 = f32[1,1,4,256]{3,2,1,0} dot(multiply.12585, get-tuple-element.8280), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.12672 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.12673 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.12674 = s32[] select(compare.12672, add.12673, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.12675 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.12631, dot.12667, constant.8391, select.12674, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.12628 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.12571), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.12629 = f32[1,31,4,256]{3,2,1,0} reshape(slice.12628), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8279 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=229
  dot.12632 = f32[1,1,4,256]{3,2,1,0} dot(multiply.12585, get-tuple-element.8279), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.12635 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.12636 = f32[1]{0} reshape(convert.12635), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.12637 = f32[1]{0} divide(reshape.12636, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.12633 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.12634 = f32[128]{0} divide(broadcast.8377, power.12633), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.12638 = f32[1,128]{1,0} dot(divide.12637, divide.12634), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.12639 = f32[1,1,128]{2,1,0} reshape(dot.12638), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12640 = f32[1,1,128]{2,1,0} reshape(dot.12638), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12641 = f32[1,2,128]{2,1,0} concatenate(reshape.12639, reshape.12640), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12642 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.12641), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.12643 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.12642), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.12652 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.12643), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.12653 = f32[1,1,256]{2,1,0} reshape(broadcast.12652), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.12654 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.12653), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.12655 = f32[1,1,4,256]{3,2,1,0} multiply(dot.12632, broadcast.12654), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.12646 = f32[1,1,4,128]{3,2,1,0} slice(dot.12632), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.12647 = f32[1,1,4,128]{3,2,1,0} negate(slice.12646), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.12648 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.12647), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.12645 = f32[1,1,4,128]{3,2,1,0} slice(dot.12632), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12649 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.12645), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12650 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.12648, reshape.12649), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12651 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.12650), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.12644 = f32[1,1,1,256]{3,2,1,0} sine(reshape.12642), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.12656 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.12644), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.12657 = f32[1,1,256]{2,1,0} reshape(broadcast.12656), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.12658 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.12657), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.12659 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.12651, broadcast.12658), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.12660 = f32[1,1,4,256]{3,2,1,0} add(multiply.12655, multiply.12659), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.12661 = f32[1,1,4,128]{3,2,1,0} slice(add.12660), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12663 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.12661), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.12662 = f32[1,1,4,128]{3,2,1,0} slice(add.12660), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12664 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.12662), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12665 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.12663, reshape.12664), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12666 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.12665), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.12668 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.12669 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.12670 = s32[] select(compare.12668, add.12669, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.12671 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.12629, reshape.12666, constant.8391, select.12670, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8278 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=228
  dot.12593 = f32[1,1,8,256]{3,2,1,0} dot(multiply.12585, get-tuple-element.8278), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.12596 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.12597 = f32[1]{0} reshape(convert.12596), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.12598 = f32[1]{0} divide(reshape.12597, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.12594 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.12595 = f32[128]{0} divide(broadcast.8377, power.12594), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.12599 = f32[1,128]{1,0} dot(divide.12598, divide.12595), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.12600 = f32[1,1,128]{2,1,0} reshape(dot.12599), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12601 = f32[1,1,128]{2,1,0} reshape(dot.12599), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12602 = f32[1,2,128]{2,1,0} concatenate(reshape.12600, reshape.12601), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12603 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.12602), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.12604 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.12603), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.12613 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.12604), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.12614 = f32[1,1,256]{2,1,0} reshape(broadcast.12613), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.12615 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.12614), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.12616 = f32[1,1,8,256]{3,2,1,0} multiply(dot.12593, broadcast.12615), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.12607 = f32[1,1,8,128]{3,2,1,0} slice(dot.12593), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.12608 = f32[1,1,8,128]{3,2,1,0} negate(slice.12607), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.12609 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.12608), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.12606 = f32[1,1,8,128]{3,2,1,0} slice(dot.12593), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12610 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.12606), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12611 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.12609, reshape.12610), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12612 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.12611), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.12605 = f32[1,1,1,256]{3,2,1,0} sine(reshape.12603), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.12617 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.12605), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.12618 = f32[1,1,256]{2,1,0} reshape(broadcast.12617), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.12619 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.12618), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.12620 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.12612, broadcast.12619), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.12621 = f32[1,1,8,256]{3,2,1,0} add(multiply.12616, multiply.12620), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/rotary_embedding_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.12622 = f32[1,1,8,128]{3,2,1,0} slice(add.12621), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12624 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.12622), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.12623 = f32[1,1,8,128]{3,2,1,0} slice(add.12621), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12625 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.12623), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12626 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.12624, reshape.12625), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12627 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.12626), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.12679 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.12627, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.12680 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.12679), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.12681 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.12671, reshape.12680), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.12682 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.12681), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.12683 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.12682, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.12684 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.12683), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.12685 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.12684, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.12686 = pred[31,31]{1,0} call(broadcast.8370), to_apply=triu_3.7717
  call.12687 = pred[31,31]{1,0} call(broadcast.8370), to_apply=tril_4.7730
  and.12688 = pred[31,31]{1,0} and(call.12686, call.12687), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  compare.12689 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  add.12690 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  select.12691 = s32[] select(compare.12689, add.12690, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  dynamic-slice.12692 = pred[1,31]{1,0} dynamic-slice(and.12688, select.12691, constant.8391), dynamic_slice_sizes={1,31}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/dynamic_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  reshape.12693 = pred[1,1,31]{2,1,0} reshape(dynamic-slice.12692), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.12694 = pred[1,1,31]{2,1,0} and(reshape.12592, reshape.12693), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.12695 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(and.12694), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.12696 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.12695), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.12697 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.12696), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.12698 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.12697, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.12699 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.12698), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.12700 = f32[1,1,31]{2,1,0} reshape(broadcast.12699), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.12701 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.12700), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.12702 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.12685, broadcast.12701), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.12703 = f32[1,4,2,1]{3,2,1,0} reduce(add.12702, constant.8364), dimensions={4}, to_apply=region_322.7743, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.12704 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.12703, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12705 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.12704), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12706 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.12705), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12707 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.12706), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12708 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.12707), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.12709 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.12702, broadcast.12708), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.12710 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.12709), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.12711 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.12710, constant.8387), dimensions={4}, to_apply=region_323.7747, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12712 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.12711), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12713 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.12712), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12714 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.12713), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12715 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.12714), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.12716 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.12710, broadcast.12715), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/softmax_20/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.12717 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.12675, divide.12716), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.12718 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.12717), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.12719 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.12718), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.12724 = f32[1,1,8,256]{3,2,1,0} call(reshape.12723, broadcast.8358, reshape.12719), to_apply=_where_5.7755
  get-tuple-element.8281 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=231
  dot.12725 = f32[1,1,2304]{2,1,0} dot(call.12724, get-tuple-element.8281), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12726 = f32[1,1,2304]{2,1,0} multiply(dot.12725, dot.12725), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12727 = f32[1,1]{1,0} reduce(multiply.12726, constant.8387), dimensions={2}, to_apply=region_325.7763, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12728 = f32[1,1,1]{2,1,0} reshape(reduce.12727), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12729 = f32[1,1,1]{2,1,0} divide(reshape.12728, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12730 = f32[1,1,1]{2,1,0} add(divide.12729, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12731 = f32[1,1,1]{2,1,0} sqrt(add.12730), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12732 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12731), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12733 = f32[1,1,1]{2,1,0} broadcast(divide.12732), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12734 = f32[1,1]{1,0} reshape(broadcast.12733), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12735 = f32[1,1,2304]{2,1,0} broadcast(reshape.12734), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12736 = f32[1,1,2304]{2,1,0} multiply(dot.12725, broadcast.12735), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8282 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=232
  add.12737 = f32[2304]{0} add(get-tuple-element.8282, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.12738 = f32[1,1,2304]{2,1,0} reshape(add.12737), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.12739 = f32[1,1,2304]{2,1,0} multiply(multiply.12736, reshape.12738), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.12740 = f32[1,1,2304]{2,1,0} add(add.12569, multiply.12739), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.12741 = f32[1,1,2304]{2,1,0} multiply(add.12740, add.12740), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12742 = f32[1,1]{1,0} reduce(multiply.12741, constant.8387), dimensions={2}, to_apply=region_326.7767, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12743 = f32[1,1,1]{2,1,0} reshape(reduce.12742), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12744 = f32[1,1,1]{2,1,0} divide(reshape.12743, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12745 = f32[1,1,1]{2,1,0} add(divide.12744, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12746 = f32[1,1,1]{2,1,0} sqrt(add.12745), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12747 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12746), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12748 = f32[1,1,1]{2,1,0} broadcast(divide.12747), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12749 = f32[1,1]{1,0} reshape(broadcast.12748), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12750 = f32[1,1,2304]{2,1,0} broadcast(reshape.12749), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12751 = f32[1,1,2304]{2,1,0} multiply(add.12740, broadcast.12750), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8283 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=233
  add.12752 = f32[2304]{0} add(get-tuple-element.8283, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.12753 = f32[1,1,2304]{2,1,0} reshape(add.12752), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.12754 = f32[1,1,2304]{2,1,0} multiply(multiply.12751, reshape.12753), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8284 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=234
  dot.12755 = f32[1,1,9216]{2,1,0} dot(multiply.12754, get-tuple-element.8284), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12757 = f32[1,1,9216]{2,1,0} multiply(dot.12755, dot.12755), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12758 = f32[1,1,9216]{2,1,0} multiply(multiply.12757, dot.12755), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12759 = f32[1,1,9216]{2,1,0} multiply(multiply.12758, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.12760 = f32[1,1,9216]{2,1,0} add(dot.12755, multiply.12759), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12761 = f32[1,1,9216]{2,1,0} multiply(add.12760, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.12762 = f32[1,1,9216]{2,1,0} tanh(multiply.12761), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.12763 = f32[1,1,9216]{2,1,0} add(tanh.12762, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12764 = f32[1,1,9216]{2,1,0} multiply(add.12763, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12765 = f32[1,1,9216]{2,1,0} multiply(dot.12755, multiply.12764), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8285 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=235
  dot.12756 = f32[1,1,9216]{2,1,0} dot(multiply.12754, get-tuple-element.8285), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12766 = f32[1,1,9216]{2,1,0} multiply(multiply.12765, dot.12756), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8286 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=236
  dot.12767 = f32[1,1,2304]{2,1,0} dot(multiply.12766, get-tuple-element.8286), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12768 = f32[1,1,2304]{2,1,0} multiply(dot.12767, dot.12767), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12769 = f32[1,1]{1,0} reduce(multiply.12768, constant.8387), dimensions={2}, to_apply=region_327.7771, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12770 = f32[1,1,1]{2,1,0} reshape(reduce.12769), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12771 = f32[1,1,1]{2,1,0} divide(reshape.12770, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12772 = f32[1,1,1]{2,1,0} add(divide.12771, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12773 = f32[1,1,1]{2,1,0} sqrt(add.12772), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12774 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12773), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12775 = f32[1,1,1]{2,1,0} broadcast(divide.12774), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12776 = f32[1,1]{1,0} reshape(broadcast.12775), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12777 = f32[1,1,2304]{2,1,0} broadcast(reshape.12776), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12778 = f32[1,1,2304]{2,1,0} multiply(dot.12767, broadcast.12777), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8287 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=237
  add.12779 = f32[2304]{0} add(get-tuple-element.8287, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.12780 = f32[1,1,2304]{2,1,0} reshape(add.12779), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.12781 = f32[1,1,2304]{2,1,0} multiply(multiply.12778, reshape.12780), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.12782 = f32[1,1,2304]{2,1,0} add(multiply.12781, add.12740), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.12799 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.12800 = f32[1,1]{1,0} reshape(convert.12799), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.12801 = f32[1,1]{1,0} broadcast(reshape.12800), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.12802 = f32[1]{0} reshape(broadcast.12801), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.12803 = f32[1,31]{1,0} broadcast(reshape.12802), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.12804 = pred[1,31]{1,0} compare(broadcast.12803, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.12805 = pred[1,1,31]{2,1,0} reshape(compare.12804), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.12924 = s32[1,1,31]{2,1,0} convert(reshape.12805), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.12925 = pred[1,1,31]{2,1,0} compare(convert.12924, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.12926 = pred[1,1]{1,0} reduce(compare.12925, constant.8359), dimensions={2}, to_apply=region_331.7787, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.12927 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.12926), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.12783 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [21:22], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.12784 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.12783), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.12843 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.12784), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.12844 = f32[1,31,4,256]{3,2,1,0} reshape(slice.12843), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.12785 = f32[1,1,2304]{2,1,0} multiply(add.12782, add.12782), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12786 = f32[1,1]{1,0} reduce(multiply.12785, constant.8387), dimensions={2}, to_apply=region_328.7775, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12787 = f32[1,1,1]{2,1,0} reshape(reduce.12786), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12788 = f32[1,1,1]{2,1,0} divide(reshape.12787, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12789 = f32[1,1,1]{2,1,0} add(divide.12788, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12790 = f32[1,1,1]{2,1,0} sqrt(add.12789), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12791 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12790), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12792 = f32[1,1,1]{2,1,0} broadcast(divide.12791), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12793 = f32[1,1]{1,0} reshape(broadcast.12792), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12794 = f32[1,1,2304]{2,1,0} broadcast(reshape.12793), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12795 = f32[1,1,2304]{2,1,0} multiply(add.12782, broadcast.12794), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8288 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=238
  add.12796 = f32[2304]{0} add(get-tuple-element.8288, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.12797 = f32[1,1,2304]{2,1,0} reshape(add.12796), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.12798 = f32[1,1,2304]{2,1,0} multiply(multiply.12795, reshape.12797), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8291 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=241
  dot.12880 = f32[1,1,4,256]{3,2,1,0} dot(multiply.12798, get-tuple-element.8291), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.12885 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.12886 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.12887 = s32[] select(compare.12885, add.12886, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.12888 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.12844, dot.12880, constant.8391, select.12887, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.12841 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.12784), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.12842 = f32[1,31,4,256]{3,2,1,0} reshape(slice.12841), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8290 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=240
  dot.12845 = f32[1,1,4,256]{3,2,1,0} dot(multiply.12798, get-tuple-element.8290), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.12848 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.12849 = f32[1]{0} reshape(convert.12848), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.12850 = f32[1]{0} divide(reshape.12849, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.12846 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.12847 = f32[128]{0} divide(broadcast.8377, power.12846), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.12851 = f32[1,128]{1,0} dot(divide.12850, divide.12847), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.12852 = f32[1,1,128]{2,1,0} reshape(dot.12851), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12853 = f32[1,1,128]{2,1,0} reshape(dot.12851), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12854 = f32[1,2,128]{2,1,0} concatenate(reshape.12852, reshape.12853), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12855 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.12854), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.12856 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.12855), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.12865 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.12856), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.12866 = f32[1,1,256]{2,1,0} reshape(broadcast.12865), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.12867 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.12866), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.12868 = f32[1,1,4,256]{3,2,1,0} multiply(dot.12845, broadcast.12867), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.12859 = f32[1,1,4,128]{3,2,1,0} slice(dot.12845), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.12860 = f32[1,1,4,128]{3,2,1,0} negate(slice.12859), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.12861 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.12860), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.12858 = f32[1,1,4,128]{3,2,1,0} slice(dot.12845), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12862 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.12858), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12863 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.12861, reshape.12862), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12864 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.12863), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.12857 = f32[1,1,1,256]{3,2,1,0} sine(reshape.12855), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.12869 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.12857), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.12870 = f32[1,1,256]{2,1,0} reshape(broadcast.12869), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.12871 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.12870), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.12872 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.12864, broadcast.12871), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.12873 = f32[1,1,4,256]{3,2,1,0} add(multiply.12868, multiply.12872), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.12874 = f32[1,1,4,128]{3,2,1,0} slice(add.12873), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12876 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.12874), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.12875 = f32[1,1,4,128]{3,2,1,0} slice(add.12873), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12877 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.12875), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12878 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.12876, reshape.12877), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12879 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.12878), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.12881 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.12882 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.12883 = s32[] select(compare.12881, add.12882, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.12884 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.12842, reshape.12879, constant.8391, select.12883, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8289 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=239
  dot.12806 = f32[1,1,8,256]{3,2,1,0} dot(multiply.12798, get-tuple-element.8289), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.12809 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.12810 = f32[1]{0} reshape(convert.12809), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.12811 = f32[1]{0} divide(reshape.12810, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.12807 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.12808 = f32[128]{0} divide(broadcast.8377, power.12807), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.12812 = f32[1,128]{1,0} dot(divide.12811, divide.12808), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.12813 = f32[1,1,128]{2,1,0} reshape(dot.12812), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12814 = f32[1,1,128]{2,1,0} reshape(dot.12812), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12815 = f32[1,2,128]{2,1,0} concatenate(reshape.12813, reshape.12814), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12816 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.12815), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.12817 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.12816), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.12826 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.12817), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.12827 = f32[1,1,256]{2,1,0} reshape(broadcast.12826), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.12828 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.12827), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.12829 = f32[1,1,8,256]{3,2,1,0} multiply(dot.12806, broadcast.12828), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.12820 = f32[1,1,8,128]{3,2,1,0} slice(dot.12806), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.12821 = f32[1,1,8,128]{3,2,1,0} negate(slice.12820), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.12822 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.12821), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.12819 = f32[1,1,8,128]{3,2,1,0} slice(dot.12806), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12823 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.12819), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12824 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.12822, reshape.12823), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12825 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.12824), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.12818 = f32[1,1,1,256]{3,2,1,0} sine(reshape.12816), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.12830 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.12818), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.12831 = f32[1,1,256]{2,1,0} reshape(broadcast.12830), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.12832 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.12831), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.12833 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.12825, broadcast.12832), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.12834 = f32[1,1,8,256]{3,2,1,0} add(multiply.12829, multiply.12833), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/rotary_embedding_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.12835 = f32[1,1,8,128]{3,2,1,0} slice(add.12834), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12837 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.12835), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.12836 = f32[1,1,8,128]{3,2,1,0} slice(add.12834), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.12838 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.12836), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12839 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.12837, reshape.12838), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12840 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.12839), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.12892 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.12840, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.12893 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.12892), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.12894 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.12884, reshape.12893), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.12895 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.12894), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.12896 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.12895, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.12897 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.12896), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.12898 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.12897, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.12899 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(compare.12804), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.12900 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.12899), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.12901 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.12900), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.12902 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.12901, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.12903 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.12902), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.12904 = f32[1,1,31]{2,1,0} reshape(broadcast.12903), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.12905 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.12904), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.12906 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.12898, broadcast.12905), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.12907 = f32[1,4,2,1]{3,2,1,0} reduce(add.12906, constant.8364), dimensions={4}, to_apply=region_329.7779, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.12908 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.12907, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12909 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.12908), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12910 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.12909), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12911 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.12910), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12912 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.12911), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.12913 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.12906, broadcast.12912), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.12914 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.12913), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.12915 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.12914, constant.8387), dimensions={4}, to_apply=region_330.7783, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12916 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.12915), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12917 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.12916), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.12918 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.12917), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.12919 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.12918), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.12920 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.12914, broadcast.12919), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/softmax_21/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.12921 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.12888, divide.12920), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.12922 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.12921), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.12923 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.12922), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.12928 = f32[1,1,8,256]{3,2,1,0} call(reshape.12927, broadcast.8358, reshape.12923), to_apply=_where_5.7791
  get-tuple-element.8292 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=242
  dot.12929 = f32[1,1,2304]{2,1,0} dot(call.12928, get-tuple-element.8292), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12930 = f32[1,1,2304]{2,1,0} multiply(dot.12929, dot.12929), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12931 = f32[1,1]{1,0} reduce(multiply.12930, constant.8387), dimensions={2}, to_apply=region_332.7799, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12932 = f32[1,1,1]{2,1,0} reshape(reduce.12931), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12933 = f32[1,1,1]{2,1,0} divide(reshape.12932, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12934 = f32[1,1,1]{2,1,0} add(divide.12933, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12935 = f32[1,1,1]{2,1,0} sqrt(add.12934), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12936 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12935), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12937 = f32[1,1,1]{2,1,0} broadcast(divide.12936), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12938 = f32[1,1]{1,0} reshape(broadcast.12937), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12939 = f32[1,1,2304]{2,1,0} broadcast(reshape.12938), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12940 = f32[1,1,2304]{2,1,0} multiply(dot.12929, broadcast.12939), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8293 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=243
  add.12941 = f32[2304]{0} add(get-tuple-element.8293, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.12942 = f32[1,1,2304]{2,1,0} reshape(add.12941), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.12943 = f32[1,1,2304]{2,1,0} multiply(multiply.12940, reshape.12942), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.12944 = f32[1,1,2304]{2,1,0} add(add.12782, multiply.12943), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.12945 = f32[1,1,2304]{2,1,0} multiply(add.12944, add.12944), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12946 = f32[1,1]{1,0} reduce(multiply.12945, constant.8387), dimensions={2}, to_apply=region_333.7803, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12947 = f32[1,1,1]{2,1,0} reshape(reduce.12946), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12948 = f32[1,1,1]{2,1,0} divide(reshape.12947, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12949 = f32[1,1,1]{2,1,0} add(divide.12948, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12950 = f32[1,1,1]{2,1,0} sqrt(add.12949), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12951 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12950), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12952 = f32[1,1,1]{2,1,0} broadcast(divide.12951), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12953 = f32[1,1]{1,0} reshape(broadcast.12952), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12954 = f32[1,1,2304]{2,1,0} broadcast(reshape.12953), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12955 = f32[1,1,2304]{2,1,0} multiply(add.12944, broadcast.12954), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8294 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=244
  add.12956 = f32[2304]{0} add(get-tuple-element.8294, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.12957 = f32[1,1,2304]{2,1,0} reshape(add.12956), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.12958 = f32[1,1,2304]{2,1,0} multiply(multiply.12955, reshape.12957), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8295 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=245
  dot.12959 = f32[1,1,9216]{2,1,0} dot(multiply.12958, get-tuple-element.8295), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12961 = f32[1,1,9216]{2,1,0} multiply(dot.12959, dot.12959), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12962 = f32[1,1,9216]{2,1,0} multiply(multiply.12961, dot.12959), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12963 = f32[1,1,9216]{2,1,0} multiply(multiply.12962, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.12964 = f32[1,1,9216]{2,1,0} add(dot.12959, multiply.12963), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12965 = f32[1,1,9216]{2,1,0} multiply(add.12964, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.12966 = f32[1,1,9216]{2,1,0} tanh(multiply.12965), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.12967 = f32[1,1,9216]{2,1,0} add(tanh.12966, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12968 = f32[1,1,9216]{2,1,0} multiply(add.12967, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.12969 = f32[1,1,9216]{2,1,0} multiply(dot.12959, multiply.12968), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8296 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=246
  dot.12960 = f32[1,1,9216]{2,1,0} dot(multiply.12958, get-tuple-element.8296), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12970 = f32[1,1,9216]{2,1,0} multiply(multiply.12969, dot.12960), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8297 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=247
  dot.12971 = f32[1,1,2304]{2,1,0} dot(multiply.12970, get-tuple-element.8297), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.12972 = f32[1,1,2304]{2,1,0} multiply(dot.12971, dot.12971), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12973 = f32[1,1]{1,0} reduce(multiply.12972, constant.8387), dimensions={2}, to_apply=region_334.7807, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12974 = f32[1,1,1]{2,1,0} reshape(reduce.12973), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12975 = f32[1,1,1]{2,1,0} divide(reshape.12974, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12976 = f32[1,1,1]{2,1,0} add(divide.12975, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12977 = f32[1,1,1]{2,1,0} sqrt(add.12976), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12978 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12977), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12979 = f32[1,1,1]{2,1,0} broadcast(divide.12978), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12980 = f32[1,1]{1,0} reshape(broadcast.12979), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12981 = f32[1,1,2304]{2,1,0} broadcast(reshape.12980), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12982 = f32[1,1,2304]{2,1,0} multiply(dot.12971, broadcast.12981), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8298 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=248
  add.12983 = f32[2304]{0} add(get-tuple-element.8298, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.12984 = f32[1,1,2304]{2,1,0} reshape(add.12983), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.12985 = f32[1,1,2304]{2,1,0} multiply(multiply.12982, reshape.12984), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.12986 = f32[1,1,2304]{2,1,0} add(multiply.12985, add.12944), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.13003 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.13004 = f32[1,1]{1,0} reshape(convert.13003), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.13005 = f32[1,1]{1,0} broadcast(reshape.13004), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.13006 = f32[1]{0} reshape(broadcast.13005), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.13007 = f32[1,31]{1,0} broadcast(reshape.13006), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.13008 = pred[1,31]{1,0} compare(broadcast.13007, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.13009 = pred[1,1,31]{2,1,0} reshape(compare.13008), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.13137 = s32[1,1,31]{2,1,0} convert(reshape.13009), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.13138 = pred[1,1,31]{2,1,0} compare(convert.13137, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.13139 = pred[1,1]{1,0} reduce(compare.13138, constant.8359), dimensions={2}, to_apply=region_338.7849, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.13140 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.13139), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.12987 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [22:23], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.12988 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.12987), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.13047 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.12988), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.13048 = f32[1,31,4,256]{3,2,1,0} reshape(slice.13047), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.12989 = f32[1,1,2304]{2,1,0} multiply(add.12986, add.12986), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.12990 = f32[1,1]{1,0} reduce(multiply.12989, constant.8387), dimensions={2}, to_apply=region_335.7811, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.12991 = f32[1,1,1]{2,1,0} reshape(reduce.12990), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.12992 = f32[1,1,1]{2,1,0} divide(reshape.12991, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.12993 = f32[1,1,1]{2,1,0} add(divide.12992, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.12994 = f32[1,1,1]{2,1,0} sqrt(add.12993), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.12995 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.12994), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.12996 = f32[1,1,1]{2,1,0} broadcast(divide.12995), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.12997 = f32[1,1]{1,0} reshape(broadcast.12996), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.12998 = f32[1,1,2304]{2,1,0} broadcast(reshape.12997), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.12999 = f32[1,1,2304]{2,1,0} multiply(add.12986, broadcast.12998), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8299 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=249
  add.13000 = f32[2304]{0} add(get-tuple-element.8299, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.13001 = f32[1,1,2304]{2,1,0} reshape(add.13000), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.13002 = f32[1,1,2304]{2,1,0} multiply(multiply.12999, reshape.13001), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8302 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=252
  dot.13084 = f32[1,1,4,256]{3,2,1,0} dot(multiply.13002, get-tuple-element.8302), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.13089 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.13090 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.13091 = s32[] select(compare.13089, add.13090, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.13092 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.13048, dot.13084, constant.8391, select.13091, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.13045 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.12988), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.13046 = f32[1,31,4,256]{3,2,1,0} reshape(slice.13045), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8301 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=251
  dot.13049 = f32[1,1,4,256]{3,2,1,0} dot(multiply.13002, get-tuple-element.8301), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.13052 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.13053 = f32[1]{0} reshape(convert.13052), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.13054 = f32[1]{0} divide(reshape.13053, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.13050 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.13051 = f32[128]{0} divide(broadcast.8377, power.13050), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.13055 = f32[1,128]{1,0} dot(divide.13054, divide.13051), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.13056 = f32[1,1,128]{2,1,0} reshape(dot.13055), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13057 = f32[1,1,128]{2,1,0} reshape(dot.13055), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13058 = f32[1,2,128]{2,1,0} concatenate(reshape.13056, reshape.13057), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13059 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.13058), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.13060 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.13059), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.13069 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.13060), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.13070 = f32[1,1,256]{2,1,0} reshape(broadcast.13069), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.13071 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.13070), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.13072 = f32[1,1,4,256]{3,2,1,0} multiply(dot.13049, broadcast.13071), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.13063 = f32[1,1,4,128]{3,2,1,0} slice(dot.13049), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.13064 = f32[1,1,4,128]{3,2,1,0} negate(slice.13063), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.13065 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.13064), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.13062 = f32[1,1,4,128]{3,2,1,0} slice(dot.13049), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13066 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.13062), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13067 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.13065, reshape.13066), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13068 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.13067), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.13061 = f32[1,1,1,256]{3,2,1,0} sine(reshape.13059), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.13073 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.13061), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.13074 = f32[1,1,256]{2,1,0} reshape(broadcast.13073), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.13075 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.13074), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.13076 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.13068, broadcast.13075), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.13077 = f32[1,1,4,256]{3,2,1,0} add(multiply.13072, multiply.13076), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.13078 = f32[1,1,4,128]{3,2,1,0} slice(add.13077), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13080 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.13078), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.13079 = f32[1,1,4,128]{3,2,1,0} slice(add.13077), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13081 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.13079), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13082 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.13080, reshape.13081), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13083 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.13082), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.13085 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.13086 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.13087 = s32[] select(compare.13085, add.13086, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.13088 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.13046, reshape.13083, constant.8391, select.13087, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8300 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=250
  dot.13010 = f32[1,1,8,256]{3,2,1,0} dot(multiply.13002, get-tuple-element.8300), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.13013 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.13014 = f32[1]{0} reshape(convert.13013), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.13015 = f32[1]{0} divide(reshape.13014, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.13011 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.13012 = f32[128]{0} divide(broadcast.8377, power.13011), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.13016 = f32[1,128]{1,0} dot(divide.13015, divide.13012), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.13017 = f32[1,1,128]{2,1,0} reshape(dot.13016), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13018 = f32[1,1,128]{2,1,0} reshape(dot.13016), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13019 = f32[1,2,128]{2,1,0} concatenate(reshape.13017, reshape.13018), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13020 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.13019), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.13021 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.13020), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.13030 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.13021), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.13031 = f32[1,1,256]{2,1,0} reshape(broadcast.13030), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.13032 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.13031), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.13033 = f32[1,1,8,256]{3,2,1,0} multiply(dot.13010, broadcast.13032), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.13024 = f32[1,1,8,128]{3,2,1,0} slice(dot.13010), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.13025 = f32[1,1,8,128]{3,2,1,0} negate(slice.13024), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.13026 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.13025), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.13023 = f32[1,1,8,128]{3,2,1,0} slice(dot.13010), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13027 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.13023), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13028 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.13026, reshape.13027), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13029 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.13028), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.13022 = f32[1,1,1,256]{3,2,1,0} sine(reshape.13020), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.13034 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.13022), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.13035 = f32[1,1,256]{2,1,0} reshape(broadcast.13034), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.13036 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.13035), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.13037 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.13029, broadcast.13036), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.13038 = f32[1,1,8,256]{3,2,1,0} add(multiply.13033, multiply.13037), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/rotary_embedding_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.13039 = f32[1,1,8,128]{3,2,1,0} slice(add.13038), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13041 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.13039), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.13040 = f32[1,1,8,128]{3,2,1,0} slice(add.13038), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13042 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.13040), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13043 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.13041, reshape.13042), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13044 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.13043), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.13096 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.13044, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.13097 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.13096), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.13098 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.13088, reshape.13097), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.13099 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.13098), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.13100 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.13099, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.13101 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.13100), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.13102 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.13101, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.13103 = pred[31,31]{1,0} call(broadcast.8370), to_apply=triu_3.7815
  call.13104 = pred[31,31]{1,0} call(broadcast.8370), to_apply=tril_4.7828
  and.13105 = pred[31,31]{1,0} and(call.13103, call.13104), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  compare.13106 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  add.13107 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  select.13108 = s32[] select(compare.13106, add.13107, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  dynamic-slice.13109 = pred[1,31]{1,0} dynamic-slice(and.13105, select.13108, constant.8391), dynamic_slice_sizes={1,31}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/dynamic_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  reshape.13110 = pred[1,1,31]{2,1,0} reshape(dynamic-slice.13109), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.13111 = pred[1,1,31]{2,1,0} and(reshape.13009, reshape.13110), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.13112 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(and.13111), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.13113 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.13112), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.13114 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.13113), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.13115 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.13114, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.13116 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.13115), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.13117 = f32[1,1,31]{2,1,0} reshape(broadcast.13116), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.13118 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.13117), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.13119 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.13102, broadcast.13118), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.13120 = f32[1,4,2,1]{3,2,1,0} reduce(add.13119, constant.8364), dimensions={4}, to_apply=region_336.7841, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.13121 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.13120, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13122 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.13121), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13123 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.13122), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13124 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.13123), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13125 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.13124), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.13126 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.13119, broadcast.13125), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.13127 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.13126), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.13128 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.13127, constant.8387), dimensions={4}, to_apply=region_337.7845, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13129 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.13128), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13130 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.13129), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13131 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.13130), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13132 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.13131), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.13133 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.13127, broadcast.13132), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/softmax_22/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.13134 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.13092, divide.13133), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.13135 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.13134), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.13136 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.13135), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.13141 = f32[1,1,8,256]{3,2,1,0} call(reshape.13140, broadcast.8358, reshape.13136), to_apply=_where_5.7853
  get-tuple-element.8303 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=253
  dot.13142 = f32[1,1,2304]{2,1,0} dot(call.13141, get-tuple-element.8303), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.13143 = f32[1,1,2304]{2,1,0} multiply(dot.13142, dot.13142), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.13144 = f32[1,1]{1,0} reduce(multiply.13143, constant.8387), dimensions={2}, to_apply=region_339.7861, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.13145 = f32[1,1,1]{2,1,0} reshape(reduce.13144), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.13146 = f32[1,1,1]{2,1,0} divide(reshape.13145, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.13147 = f32[1,1,1]{2,1,0} add(divide.13146, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.13148 = f32[1,1,1]{2,1,0} sqrt(add.13147), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.13149 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.13148), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.13150 = f32[1,1,1]{2,1,0} broadcast(divide.13149), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.13151 = f32[1,1]{1,0} reshape(broadcast.13150), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.13152 = f32[1,1,2304]{2,1,0} broadcast(reshape.13151), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.13153 = f32[1,1,2304]{2,1,0} multiply(dot.13142, broadcast.13152), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8304 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=254
  add.13154 = f32[2304]{0} add(get-tuple-element.8304, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.13155 = f32[1,1,2304]{2,1,0} reshape(add.13154), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.13156 = f32[1,1,2304]{2,1,0} multiply(multiply.13153, reshape.13155), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.13157 = f32[1,1,2304]{2,1,0} add(add.12986, multiply.13156), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.13158 = f32[1,1,2304]{2,1,0} multiply(add.13157, add.13157), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.13159 = f32[1,1]{1,0} reduce(multiply.13158, constant.8387), dimensions={2}, to_apply=region_340.7865, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.13160 = f32[1,1,1]{2,1,0} reshape(reduce.13159), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.13161 = f32[1,1,1]{2,1,0} divide(reshape.13160, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.13162 = f32[1,1,1]{2,1,0} add(divide.13161, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.13163 = f32[1,1,1]{2,1,0} sqrt(add.13162), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.13164 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.13163), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.13165 = f32[1,1,1]{2,1,0} broadcast(divide.13164), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.13166 = f32[1,1]{1,0} reshape(broadcast.13165), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.13167 = f32[1,1,2304]{2,1,0} broadcast(reshape.13166), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.13168 = f32[1,1,2304]{2,1,0} multiply(add.13157, broadcast.13167), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8305 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=255
  add.13169 = f32[2304]{0} add(get-tuple-element.8305, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.13170 = f32[1,1,2304]{2,1,0} reshape(add.13169), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.13171 = f32[1,1,2304]{2,1,0} multiply(multiply.13168, reshape.13170), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8306 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=256
  dot.13172 = f32[1,1,9216]{2,1,0} dot(multiply.13171, get-tuple-element.8306), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.13174 = f32[1,1,9216]{2,1,0} multiply(dot.13172, dot.13172), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13175 = f32[1,1,9216]{2,1,0} multiply(multiply.13174, dot.13172), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13176 = f32[1,1,9216]{2,1,0} multiply(multiply.13175, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.13177 = f32[1,1,9216]{2,1,0} add(dot.13172, multiply.13176), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13178 = f32[1,1,9216]{2,1,0} multiply(add.13177, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.13179 = f32[1,1,9216]{2,1,0} tanh(multiply.13178), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.13180 = f32[1,1,9216]{2,1,0} add(tanh.13179, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13181 = f32[1,1,9216]{2,1,0} multiply(add.13180, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13182 = f32[1,1,9216]{2,1,0} multiply(dot.13172, multiply.13181), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8307 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=257
  dot.13173 = f32[1,1,9216]{2,1,0} dot(multiply.13171, get-tuple-element.8307), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.13183 = f32[1,1,9216]{2,1,0} multiply(multiply.13182, dot.13173), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8308 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=258
  dot.13184 = f32[1,1,2304]{2,1,0} dot(multiply.13183, get-tuple-element.8308), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.13185 = f32[1,1,2304]{2,1,0} multiply(dot.13184, dot.13184), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.13186 = f32[1,1]{1,0} reduce(multiply.13185, constant.8387), dimensions={2}, to_apply=region_341.7869, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.13187 = f32[1,1,1]{2,1,0} reshape(reduce.13186), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.13188 = f32[1,1,1]{2,1,0} divide(reshape.13187, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.13189 = f32[1,1,1]{2,1,0} add(divide.13188, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.13190 = f32[1,1,1]{2,1,0} sqrt(add.13189), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.13191 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.13190), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.13192 = f32[1,1,1]{2,1,0} broadcast(divide.13191), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.13193 = f32[1,1]{1,0} reshape(broadcast.13192), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.13194 = f32[1,1,2304]{2,1,0} broadcast(reshape.13193), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.13195 = f32[1,1,2304]{2,1,0} multiply(dot.13184, broadcast.13194), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8309 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=259
  add.13196 = f32[2304]{0} add(get-tuple-element.8309, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.13197 = f32[1,1,2304]{2,1,0} reshape(add.13196), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.13198 = f32[1,1,2304]{2,1,0} multiply(multiply.13195, reshape.13197), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.13199 = f32[1,1,2304]{2,1,0} add(multiply.13198, add.13157), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.13216 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.13217 = f32[1,1]{1,0} reshape(convert.13216), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.13218 = f32[1,1]{1,0} broadcast(reshape.13217), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.13219 = f32[1]{0} reshape(broadcast.13218), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.13220 = f32[1,31]{1,0} broadcast(reshape.13219), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.13221 = pred[1,31]{1,0} compare(broadcast.13220, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.13222 = pred[1,1,31]{2,1,0} reshape(compare.13221), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.13341 = s32[1,1,31]{2,1,0} convert(reshape.13222), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.13342 = pred[1,1,31]{2,1,0} compare(convert.13341, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.13343 = pred[1,1]{1,0} reduce(compare.13342, constant.8359), dimensions={2}, to_apply=region_345.7885, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.13344 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.13343), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.13200 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [23:24], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.13201 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.13200), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.13260 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.13201), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.13261 = f32[1,31,4,256]{3,2,1,0} reshape(slice.13260), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.13202 = f32[1,1,2304]{2,1,0} multiply(add.13199, add.13199), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.13203 = f32[1,1]{1,0} reduce(multiply.13202, constant.8387), dimensions={2}, to_apply=region_342.7873, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.13204 = f32[1,1,1]{2,1,0} reshape(reduce.13203), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.13205 = f32[1,1,1]{2,1,0} divide(reshape.13204, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.13206 = f32[1,1,1]{2,1,0} add(divide.13205, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.13207 = f32[1,1,1]{2,1,0} sqrt(add.13206), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.13208 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.13207), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.13209 = f32[1,1,1]{2,1,0} broadcast(divide.13208), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.13210 = f32[1,1]{1,0} reshape(broadcast.13209), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.13211 = f32[1,1,2304]{2,1,0} broadcast(reshape.13210), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.13212 = f32[1,1,2304]{2,1,0} multiply(add.13199, broadcast.13211), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8310 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=260
  add.13213 = f32[2304]{0} add(get-tuple-element.8310, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.13214 = f32[1,1,2304]{2,1,0} reshape(add.13213), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.13215 = f32[1,1,2304]{2,1,0} multiply(multiply.13212, reshape.13214), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8313 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=263
  dot.13297 = f32[1,1,4,256]{3,2,1,0} dot(multiply.13215, get-tuple-element.8313), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.13302 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.13303 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.13304 = s32[] select(compare.13302, add.13303, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.13305 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.13261, dot.13297, constant.8391, select.13304, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.13258 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.13201), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.13259 = f32[1,31,4,256]{3,2,1,0} reshape(slice.13258), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8312 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=262
  dot.13262 = f32[1,1,4,256]{3,2,1,0} dot(multiply.13215, get-tuple-element.8312), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.13265 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.13266 = f32[1]{0} reshape(convert.13265), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.13267 = f32[1]{0} divide(reshape.13266, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.13263 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.13264 = f32[128]{0} divide(broadcast.8377, power.13263), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.13268 = f32[1,128]{1,0} dot(divide.13267, divide.13264), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.13269 = f32[1,1,128]{2,1,0} reshape(dot.13268), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13270 = f32[1,1,128]{2,1,0} reshape(dot.13268), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13271 = f32[1,2,128]{2,1,0} concatenate(reshape.13269, reshape.13270), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13272 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.13271), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.13273 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.13272), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.13282 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.13273), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.13283 = f32[1,1,256]{2,1,0} reshape(broadcast.13282), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.13284 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.13283), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.13285 = f32[1,1,4,256]{3,2,1,0} multiply(dot.13262, broadcast.13284), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.13276 = f32[1,1,4,128]{3,2,1,0} slice(dot.13262), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.13277 = f32[1,1,4,128]{3,2,1,0} negate(slice.13276), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.13278 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.13277), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.13275 = f32[1,1,4,128]{3,2,1,0} slice(dot.13262), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13279 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.13275), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13280 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.13278, reshape.13279), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13281 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.13280), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.13274 = f32[1,1,1,256]{3,2,1,0} sine(reshape.13272), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.13286 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.13274), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.13287 = f32[1,1,256]{2,1,0} reshape(broadcast.13286), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.13288 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.13287), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.13289 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.13281, broadcast.13288), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.13290 = f32[1,1,4,256]{3,2,1,0} add(multiply.13285, multiply.13289), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.13291 = f32[1,1,4,128]{3,2,1,0} slice(add.13290), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13293 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.13291), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.13292 = f32[1,1,4,128]{3,2,1,0} slice(add.13290), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13294 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.13292), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13295 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.13293, reshape.13294), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13296 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.13295), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.13298 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.13299 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.13300 = s32[] select(compare.13298, add.13299, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.13301 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.13259, reshape.13296, constant.8391, select.13300, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8311 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=261
  dot.13223 = f32[1,1,8,256]{3,2,1,0} dot(multiply.13215, get-tuple-element.8311), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.13226 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.13227 = f32[1]{0} reshape(convert.13226), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.13228 = f32[1]{0} divide(reshape.13227, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.13224 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.13225 = f32[128]{0} divide(broadcast.8377, power.13224), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.13229 = f32[1,128]{1,0} dot(divide.13228, divide.13225), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.13230 = f32[1,1,128]{2,1,0} reshape(dot.13229), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13231 = f32[1,1,128]{2,1,0} reshape(dot.13229), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13232 = f32[1,2,128]{2,1,0} concatenate(reshape.13230, reshape.13231), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13233 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.13232), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.13234 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.13233), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.13243 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.13234), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.13244 = f32[1,1,256]{2,1,0} reshape(broadcast.13243), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.13245 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.13244), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.13246 = f32[1,1,8,256]{3,2,1,0} multiply(dot.13223, broadcast.13245), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.13237 = f32[1,1,8,128]{3,2,1,0} slice(dot.13223), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.13238 = f32[1,1,8,128]{3,2,1,0} negate(slice.13237), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.13239 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.13238), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.13236 = f32[1,1,8,128]{3,2,1,0} slice(dot.13223), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13240 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.13236), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13241 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.13239, reshape.13240), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13242 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.13241), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.13235 = f32[1,1,1,256]{3,2,1,0} sine(reshape.13233), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.13247 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.13235), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.13248 = f32[1,1,256]{2,1,0} reshape(broadcast.13247), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.13249 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.13248), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.13250 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.13242, broadcast.13249), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.13251 = f32[1,1,8,256]{3,2,1,0} add(multiply.13246, multiply.13250), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/rotary_embedding_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.13252 = f32[1,1,8,128]{3,2,1,0} slice(add.13251), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13254 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.13252), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.13253 = f32[1,1,8,128]{3,2,1,0} slice(add.13251), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13255 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.13253), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13256 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.13254, reshape.13255), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13257 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.13256), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.13309 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.13257, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.13310 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.13309), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.13311 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.13301, reshape.13310), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.13312 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.13311), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.13313 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.13312, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.13314 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.13313), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.13315 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.13314, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.13316 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(compare.13221), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.13317 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.13316), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.13318 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.13317), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.13319 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.13318, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.13320 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.13319), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.13321 = f32[1,1,31]{2,1,0} reshape(broadcast.13320), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.13322 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.13321), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.13323 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.13315, broadcast.13322), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.13324 = f32[1,4,2,1]{3,2,1,0} reduce(add.13323, constant.8364), dimensions={4}, to_apply=region_343.7877, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.13325 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.13324, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13326 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.13325), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13327 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.13326), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13328 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.13327), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13329 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.13328), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.13330 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.13323, broadcast.13329), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.13331 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.13330), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.13332 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.13331, constant.8387), dimensions={4}, to_apply=region_344.7881, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13333 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.13332), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13334 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.13333), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13335 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.13334), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13336 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.13335), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.13337 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.13331, broadcast.13336), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/softmax_23/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.13338 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.13305, divide.13337), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.13339 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.13338), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.13340 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.13339), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.13345 = f32[1,1,8,256]{3,2,1,0} call(reshape.13344, broadcast.8358, reshape.13340), to_apply=_where_5.7889
  get-tuple-element.8314 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=264
  dot.13346 = f32[1,1,2304]{2,1,0} dot(call.13345, get-tuple-element.8314), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.13347 = f32[1,1,2304]{2,1,0} multiply(dot.13346, dot.13346), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.13348 = f32[1,1]{1,0} reduce(multiply.13347, constant.8387), dimensions={2}, to_apply=region_346.7897, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.13349 = f32[1,1,1]{2,1,0} reshape(reduce.13348), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.13350 = f32[1,1,1]{2,1,0} divide(reshape.13349, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.13351 = f32[1,1,1]{2,1,0} add(divide.13350, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.13352 = f32[1,1,1]{2,1,0} sqrt(add.13351), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.13353 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.13352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.13354 = f32[1,1,1]{2,1,0} broadcast(divide.13353), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.13355 = f32[1,1]{1,0} reshape(broadcast.13354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.13356 = f32[1,1,2304]{2,1,0} broadcast(reshape.13355), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.13357 = f32[1,1,2304]{2,1,0} multiply(dot.13346, broadcast.13356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8315 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=265
  add.13358 = f32[2304]{0} add(get-tuple-element.8315, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.13359 = f32[1,1,2304]{2,1,0} reshape(add.13358), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.13360 = f32[1,1,2304]{2,1,0} multiply(multiply.13357, reshape.13359), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.13361 = f32[1,1,2304]{2,1,0} add(add.13199, multiply.13360), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.13362 = f32[1,1,2304]{2,1,0} multiply(add.13361, add.13361), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.13363 = f32[1,1]{1,0} reduce(multiply.13362, constant.8387), dimensions={2}, to_apply=region_347.7901, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.13364 = f32[1,1,1]{2,1,0} reshape(reduce.13363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.13365 = f32[1,1,1]{2,1,0} divide(reshape.13364, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.13366 = f32[1,1,1]{2,1,0} add(divide.13365, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.13367 = f32[1,1,1]{2,1,0} sqrt(add.13366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.13368 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.13367), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.13369 = f32[1,1,1]{2,1,0} broadcast(divide.13368), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.13370 = f32[1,1]{1,0} reshape(broadcast.13369), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.13371 = f32[1,1,2304]{2,1,0} broadcast(reshape.13370), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.13372 = f32[1,1,2304]{2,1,0} multiply(add.13361, broadcast.13371), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8316 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=266
  add.13373 = f32[2304]{0} add(get-tuple-element.8316, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.13374 = f32[1,1,2304]{2,1,0} reshape(add.13373), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.13375 = f32[1,1,2304]{2,1,0} multiply(multiply.13372, reshape.13374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8317 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=267
  dot.13376 = f32[1,1,9216]{2,1,0} dot(multiply.13375, get-tuple-element.8317), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.13378 = f32[1,1,9216]{2,1,0} multiply(dot.13376, dot.13376), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13379 = f32[1,1,9216]{2,1,0} multiply(multiply.13378, dot.13376), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13380 = f32[1,1,9216]{2,1,0} multiply(multiply.13379, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.13381 = f32[1,1,9216]{2,1,0} add(dot.13376, multiply.13380), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13382 = f32[1,1,9216]{2,1,0} multiply(add.13381, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.13383 = f32[1,1,9216]{2,1,0} tanh(multiply.13382), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.13384 = f32[1,1,9216]{2,1,0} add(tanh.13383, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13385 = f32[1,1,9216]{2,1,0} multiply(add.13384, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13386 = f32[1,1,9216]{2,1,0} multiply(dot.13376, multiply.13385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8318 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=268
  dot.13377 = f32[1,1,9216]{2,1,0} dot(multiply.13375, get-tuple-element.8318), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.13387 = f32[1,1,9216]{2,1,0} multiply(multiply.13386, dot.13377), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8319 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=269
  dot.13388 = f32[1,1,2304]{2,1,0} dot(multiply.13387, get-tuple-element.8319), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.13389 = f32[1,1,2304]{2,1,0} multiply(dot.13388, dot.13388), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.13390 = f32[1,1]{1,0} reduce(multiply.13389, constant.8387), dimensions={2}, to_apply=region_348.7905, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.13391 = f32[1,1,1]{2,1,0} reshape(reduce.13390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.13392 = f32[1,1,1]{2,1,0} divide(reshape.13391, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.13393 = f32[1,1,1]{2,1,0} add(divide.13392, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.13394 = f32[1,1,1]{2,1,0} sqrt(add.13393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.13395 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.13394), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.13396 = f32[1,1,1]{2,1,0} broadcast(divide.13395), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.13397 = f32[1,1]{1,0} reshape(broadcast.13396), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.13398 = f32[1,1,2304]{2,1,0} broadcast(reshape.13397), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.13399 = f32[1,1,2304]{2,1,0} multiply(dot.13388, broadcast.13398), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8320 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=270
  add.13400 = f32[2304]{0} add(get-tuple-element.8320, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.13401 = f32[1,1,2304]{2,1,0} reshape(add.13400), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.13402 = f32[1,1,2304]{2,1,0} multiply(multiply.13399, reshape.13401), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.13403 = f32[1,1,2304]{2,1,0} add(multiply.13402, add.13361), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.13420 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.13421 = f32[1,1]{1,0} reshape(convert.13420), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.13422 = f32[1,1]{1,0} broadcast(reshape.13421), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.13423 = f32[1]{0} reshape(broadcast.13422), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.13424 = f32[1,31]{1,0} broadcast(reshape.13423), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.13425 = pred[1,31]{1,0} compare(broadcast.13424, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.13426 = pred[1,1,31]{2,1,0} reshape(compare.13425), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.13554 = s32[1,1,31]{2,1,0} convert(reshape.13426), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.13555 = pred[1,1,31]{2,1,0} compare(convert.13554, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.13556 = pred[1,1]{1,0} reduce(compare.13555, constant.8359), dimensions={2}, to_apply=region_352.7947, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.13557 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.13556), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.13404 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [24:25], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.13405 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.13404), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.13464 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.13405), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.13465 = f32[1,31,4,256]{3,2,1,0} reshape(slice.13464), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.13406 = f32[1,1,2304]{2,1,0} multiply(add.13403, add.13403), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.13407 = f32[1,1]{1,0} reduce(multiply.13406, constant.8387), dimensions={2}, to_apply=region_349.7909, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.13408 = f32[1,1,1]{2,1,0} reshape(reduce.13407), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.13409 = f32[1,1,1]{2,1,0} divide(reshape.13408, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.13410 = f32[1,1,1]{2,1,0} add(divide.13409, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.13411 = f32[1,1,1]{2,1,0} sqrt(add.13410), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.13412 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.13411), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.13413 = f32[1,1,1]{2,1,0} broadcast(divide.13412), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.13414 = f32[1,1]{1,0} reshape(broadcast.13413), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.13415 = f32[1,1,2304]{2,1,0} broadcast(reshape.13414), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.13416 = f32[1,1,2304]{2,1,0} multiply(add.13403, broadcast.13415), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8321 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=271
  add.13417 = f32[2304]{0} add(get-tuple-element.8321, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.13418 = f32[1,1,2304]{2,1,0} reshape(add.13417), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.13419 = f32[1,1,2304]{2,1,0} multiply(multiply.13416, reshape.13418), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8324 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=274
  dot.13501 = f32[1,1,4,256]{3,2,1,0} dot(multiply.13419, get-tuple-element.8324), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.13506 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.13507 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.13508 = s32[] select(compare.13506, add.13507, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.13509 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.13465, dot.13501, constant.8391, select.13508, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.13462 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.13405), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.13463 = f32[1,31,4,256]{3,2,1,0} reshape(slice.13462), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8323 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=273
  dot.13466 = f32[1,1,4,256]{3,2,1,0} dot(multiply.13419, get-tuple-element.8323), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.13469 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.13470 = f32[1]{0} reshape(convert.13469), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.13471 = f32[1]{0} divide(reshape.13470, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.13467 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.13468 = f32[128]{0} divide(broadcast.8377, power.13467), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.13472 = f32[1,128]{1,0} dot(divide.13471, divide.13468), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.13473 = f32[1,1,128]{2,1,0} reshape(dot.13472), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13474 = f32[1,1,128]{2,1,0} reshape(dot.13472), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13475 = f32[1,2,128]{2,1,0} concatenate(reshape.13473, reshape.13474), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13476 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.13475), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.13477 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.13476), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.13486 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.13477), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.13487 = f32[1,1,256]{2,1,0} reshape(broadcast.13486), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.13488 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.13487), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.13489 = f32[1,1,4,256]{3,2,1,0} multiply(dot.13466, broadcast.13488), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.13480 = f32[1,1,4,128]{3,2,1,0} slice(dot.13466), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.13481 = f32[1,1,4,128]{3,2,1,0} negate(slice.13480), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.13482 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.13481), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.13479 = f32[1,1,4,128]{3,2,1,0} slice(dot.13466), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13483 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.13479), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13484 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.13482, reshape.13483), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13485 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.13484), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.13478 = f32[1,1,1,256]{3,2,1,0} sine(reshape.13476), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.13490 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.13478), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.13491 = f32[1,1,256]{2,1,0} reshape(broadcast.13490), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.13492 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.13491), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.13493 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.13485, broadcast.13492), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.13494 = f32[1,1,4,256]{3,2,1,0} add(multiply.13489, multiply.13493), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.13495 = f32[1,1,4,128]{3,2,1,0} slice(add.13494), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13497 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.13495), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.13496 = f32[1,1,4,128]{3,2,1,0} slice(add.13494), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13498 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.13496), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13499 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.13497, reshape.13498), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13500 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.13499), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.13502 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.13503 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.13504 = s32[] select(compare.13502, add.13503, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.13505 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.13463, reshape.13500, constant.8391, select.13504, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8322 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=272
  dot.13427 = f32[1,1,8,256]{3,2,1,0} dot(multiply.13419, get-tuple-element.8322), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.13430 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.13431 = f32[1]{0} reshape(convert.13430), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.13432 = f32[1]{0} divide(reshape.13431, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.13428 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.13429 = f32[128]{0} divide(broadcast.8377, power.13428), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.13433 = f32[1,128]{1,0} dot(divide.13432, divide.13429), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.13434 = f32[1,1,128]{2,1,0} reshape(dot.13433), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13435 = f32[1,1,128]{2,1,0} reshape(dot.13433), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13436 = f32[1,2,128]{2,1,0} concatenate(reshape.13434, reshape.13435), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13437 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.13436), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.13438 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.13437), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.13447 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.13438), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.13448 = f32[1,1,256]{2,1,0} reshape(broadcast.13447), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.13449 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.13448), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.13450 = f32[1,1,8,256]{3,2,1,0} multiply(dot.13427, broadcast.13449), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.13441 = f32[1,1,8,128]{3,2,1,0} slice(dot.13427), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.13442 = f32[1,1,8,128]{3,2,1,0} negate(slice.13441), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.13443 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.13442), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.13440 = f32[1,1,8,128]{3,2,1,0} slice(dot.13427), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13444 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.13440), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13445 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.13443, reshape.13444), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13446 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.13445), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.13439 = f32[1,1,1,256]{3,2,1,0} sine(reshape.13437), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.13451 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.13439), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.13452 = f32[1,1,256]{2,1,0} reshape(broadcast.13451), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.13453 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.13452), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.13454 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.13446, broadcast.13453), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.13455 = f32[1,1,8,256]{3,2,1,0} add(multiply.13450, multiply.13454), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/rotary_embedding_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.13456 = f32[1,1,8,128]{3,2,1,0} slice(add.13455), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13458 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.13456), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.13457 = f32[1,1,8,128]{3,2,1,0} slice(add.13455), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13459 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.13457), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13460 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.13458, reshape.13459), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13461 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.13460), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.13513 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.13461, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.13514 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.13513), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.13515 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.13505, reshape.13514), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.13516 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.13515), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.13517 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.13516, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.13518 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.13517), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.13519 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.13518, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.13520 = pred[31,31]{1,0} call(broadcast.8370), to_apply=triu_3.7913
  call.13521 = pred[31,31]{1,0} call(broadcast.8370), to_apply=tril_4.7926
  and.13522 = pred[31,31]{1,0} and(call.13520, call.13521), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  compare.13523 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  add.13524 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  select.13525 = s32[] select(compare.13523, add.13524, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  dynamic-slice.13526 = pred[1,31]{1,0} dynamic-slice(and.13522, select.13525, constant.8391), dynamic_slice_sizes={1,31}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/dynamic_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=292}
  reshape.13527 = pred[1,1,31]{2,1,0} reshape(dynamic-slice.13526), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.13528 = pred[1,1,31]{2,1,0} and(reshape.13426, reshape.13527), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.13529 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(and.13528), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.13530 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.13529), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.13531 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.13530), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.13532 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.13531, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.13533 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.13532), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.13534 = f32[1,1,31]{2,1,0} reshape(broadcast.13533), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.13535 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.13534), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.13536 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.13519, broadcast.13535), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.13537 = f32[1,4,2,1]{3,2,1,0} reduce(add.13536, constant.8364), dimensions={4}, to_apply=region_350.7939, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.13538 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.13537, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13539 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.13538), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13540 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.13539), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13541 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.13540), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13542 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.13541), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.13543 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.13536, broadcast.13542), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.13544 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.13543), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.13545 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.13544, constant.8387), dimensions={4}, to_apply=region_351.7943, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13546 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.13545), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13547 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.13546), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13548 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.13547), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13549 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.13548), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.13550 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.13544, broadcast.13549), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/softmax_24/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.13551 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.13509, divide.13550), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.13552 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.13551), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.13553 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.13552), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.13558 = f32[1,1,8,256]{3,2,1,0} call(reshape.13557, broadcast.8358, reshape.13553), to_apply=_where_5.7951
  get-tuple-element.8325 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=275
  dot.13559 = f32[1,1,2304]{2,1,0} dot(call.13558, get-tuple-element.8325), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.13560 = f32[1,1,2304]{2,1,0} multiply(dot.13559, dot.13559), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.13561 = f32[1,1]{1,0} reduce(multiply.13560, constant.8387), dimensions={2}, to_apply=region_353.7959, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.13562 = f32[1,1,1]{2,1,0} reshape(reduce.13561), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.13563 = f32[1,1,1]{2,1,0} divide(reshape.13562, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.13564 = f32[1,1,1]{2,1,0} add(divide.13563, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.13565 = f32[1,1,1]{2,1,0} sqrt(add.13564), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.13566 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.13565), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.13567 = f32[1,1,1]{2,1,0} broadcast(divide.13566), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.13568 = f32[1,1]{1,0} reshape(broadcast.13567), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.13569 = f32[1,1,2304]{2,1,0} broadcast(reshape.13568), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.13570 = f32[1,1,2304]{2,1,0} multiply(dot.13559, broadcast.13569), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8326 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=276
  add.13571 = f32[2304]{0} add(get-tuple-element.8326, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.13572 = f32[1,1,2304]{2,1,0} reshape(add.13571), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.13573 = f32[1,1,2304]{2,1,0} multiply(multiply.13570, reshape.13572), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.13574 = f32[1,1,2304]{2,1,0} add(add.13403, multiply.13573), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.13575 = f32[1,1,2304]{2,1,0} multiply(add.13574, add.13574), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.13576 = f32[1,1]{1,0} reduce(multiply.13575, constant.8387), dimensions={2}, to_apply=region_354.7963, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.13577 = f32[1,1,1]{2,1,0} reshape(reduce.13576), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.13578 = f32[1,1,1]{2,1,0} divide(reshape.13577, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.13579 = f32[1,1,1]{2,1,0} add(divide.13578, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.13580 = f32[1,1,1]{2,1,0} sqrt(add.13579), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.13581 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.13580), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.13582 = f32[1,1,1]{2,1,0} broadcast(divide.13581), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.13583 = f32[1,1]{1,0} reshape(broadcast.13582), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.13584 = f32[1,1,2304]{2,1,0} broadcast(reshape.13583), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.13585 = f32[1,1,2304]{2,1,0} multiply(add.13574, broadcast.13584), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8327 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=277
  add.13586 = f32[2304]{0} add(get-tuple-element.8327, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.13587 = f32[1,1,2304]{2,1,0} reshape(add.13586), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.13588 = f32[1,1,2304]{2,1,0} multiply(multiply.13585, reshape.13587), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8328 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=278
  dot.13589 = f32[1,1,9216]{2,1,0} dot(multiply.13588, get-tuple-element.8328), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.13591 = f32[1,1,9216]{2,1,0} multiply(dot.13589, dot.13589), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13592 = f32[1,1,9216]{2,1,0} multiply(multiply.13591, dot.13589), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13593 = f32[1,1,9216]{2,1,0} multiply(multiply.13592, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.13594 = f32[1,1,9216]{2,1,0} add(dot.13589, multiply.13593), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13595 = f32[1,1,9216]{2,1,0} multiply(add.13594, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.13596 = f32[1,1,9216]{2,1,0} tanh(multiply.13595), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.13597 = f32[1,1,9216]{2,1,0} add(tanh.13596, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13598 = f32[1,1,9216]{2,1,0} multiply(add.13597, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13599 = f32[1,1,9216]{2,1,0} multiply(dot.13589, multiply.13598), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8329 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=279
  dot.13590 = f32[1,1,9216]{2,1,0} dot(multiply.13588, get-tuple-element.8329), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.13600 = f32[1,1,9216]{2,1,0} multiply(multiply.13599, dot.13590), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8330 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=280
  dot.13601 = f32[1,1,2304]{2,1,0} dot(multiply.13600, get-tuple-element.8330), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.13602 = f32[1,1,2304]{2,1,0} multiply(dot.13601, dot.13601), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.13603 = f32[1,1]{1,0} reduce(multiply.13602, constant.8387), dimensions={2}, to_apply=region_355.7967, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.13604 = f32[1,1,1]{2,1,0} reshape(reduce.13603), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.13605 = f32[1,1,1]{2,1,0} divide(reshape.13604, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.13606 = f32[1,1,1]{2,1,0} add(divide.13605, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.13607 = f32[1,1,1]{2,1,0} sqrt(add.13606), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.13608 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.13607), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.13609 = f32[1,1,1]{2,1,0} broadcast(divide.13608), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.13610 = f32[1,1]{1,0} reshape(broadcast.13609), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.13611 = f32[1,1,2304]{2,1,0} broadcast(reshape.13610), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.13612 = f32[1,1,2304]{2,1,0} multiply(dot.13601, broadcast.13611), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8331 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=281
  add.13613 = f32[2304]{0} add(get-tuple-element.8331, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.13614 = f32[1,1,2304]{2,1,0} reshape(add.13613), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.13615 = f32[1,1,2304]{2,1,0} multiply(multiply.13612, reshape.13614), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.13616 = f32[1,1,2304]{2,1,0} add(multiply.13615, add.13574), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  convert.13633 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.13634 = f32[1,1]{1,0} reshape(convert.13633), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  broadcast.13635 = f32[1,1]{1,0} broadcast(reshape.13634), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.13636 = f32[1]{0} reshape(broadcast.13635), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.13637 = f32[1,31]{1,0} broadcast(reshape.13636), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.13638 = pred[1,31]{1,0} compare(broadcast.13637, constant.8381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.13639 = pred[1,1,31]{2,1,0} reshape(compare.13638), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.13758 = s32[1,1,31]{2,1,0} convert(reshape.13639), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.13759 = pred[1,1,31]{2,1,0} compare(convert.13758, broadcast.8361), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.13760 = pred[1,1]{1,0} reduce(compare.13759, constant.8359), dimensions={2}, to_apply=region_359.7983, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.13761 = pred[1,1,1,1]{3,2,1,0} reshape(reduce.13760), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  slice.13617 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} slice(get-tuple-element.8051), slice={[0:1], [25:26], [0:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  reshape.13618 = f32[1,2,31,4,256]{4,3,2,1,0} reshape(slice.13617), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=204}
  slice.13677 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.13618), slice={[0:1], [1:2], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  reshape.13678 = f32[1,31,4,256]{3,2,1,0} reshape(slice.13677), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=200}
  multiply.13619 = f32[1,1,2304]{2,1,0} multiply(add.13616, add.13616), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.13620 = f32[1,1]{1,0} reduce(multiply.13619, constant.8387), dimensions={2}, to_apply=region_356.7971, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.13621 = f32[1,1,1]{2,1,0} reshape(reduce.13620), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.13622 = f32[1,1,1]{2,1,0} divide(reshape.13621, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.13623 = f32[1,1,1]{2,1,0} add(divide.13622, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.13624 = f32[1,1,1]{2,1,0} sqrt(add.13623), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.13625 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.13624), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.13626 = f32[1,1,1]{2,1,0} broadcast(divide.13625), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.13627 = f32[1,1]{1,0} reshape(broadcast.13626), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.13628 = f32[1,1,2304]{2,1,0} broadcast(reshape.13627), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.13629 = f32[1,1,2304]{2,1,0} multiply(add.13616, broadcast.13628), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8332 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=282
  add.13630 = f32[2304]{0} add(get-tuple-element.8332, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.13631 = f32[1,1,2304]{2,1,0} reshape(add.13630), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.13632 = f32[1,1,2304]{2,1,0} multiply(multiply.13629, reshape.13631), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8335 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=285
  dot.13714 = f32[1,1,4,256]{3,2,1,0} dot(multiply.13632, get-tuple-element.8335), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  compare.13719 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.13720 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.13721 = s32[] select(compare.13719, add.13720, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.13722 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.13678, dot.13714, constant.8391, select.13721, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  slice.13675 = f32[1,1,31,4,256]{4,3,2,1,0} slice(reshape.13618), slice={[0:1], [0:1], [0:31], [0:4], [0:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  reshape.13676 = f32[1,31,4,256]{3,2,1,0} reshape(slice.13675), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=199}
  get-tuple-element.8334 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=284
  dot.13679 = f32[1,1,4,256]{3,2,1,0} dot(multiply.13632, get-tuple-element.8334), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.13682 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.13683 = f32[1]{0} reshape(convert.13682), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.13684 = f32[1]{0} divide(reshape.13683, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.13680 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.13681 = f32[128]{0} divide(broadcast.8377, power.13680), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.13685 = f32[1,128]{1,0} dot(divide.13684, divide.13681), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.13686 = f32[1,1,128]{2,1,0} reshape(dot.13685), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13687 = f32[1,1,128]{2,1,0} reshape(dot.13685), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13688 = f32[1,2,128]{2,1,0} concatenate(reshape.13686, reshape.13687), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13689 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.13688), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.13690 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.13689), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.13699 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.13690), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.13700 = f32[1,1,256]{2,1,0} reshape(broadcast.13699), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.13701 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.13700), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.13702 = f32[1,1,4,256]{3,2,1,0} multiply(dot.13679, broadcast.13701), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.13693 = f32[1,1,4,128]{3,2,1,0} slice(dot.13679), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.13694 = f32[1,1,4,128]{3,2,1,0} negate(slice.13693), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.13695 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(negate.13694), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.13692 = f32[1,1,4,128]{3,2,1,0} slice(dot.13679), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13696 = f32[1,1,4,1,128]{4,3,2,1,0} reshape(slice.13692), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13697 = f32[1,1,4,2,128]{4,3,2,1,0} concatenate(reshape.13695, reshape.13696), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13698 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.13697), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.13691 = f32[1,1,1,256]{3,2,1,0} sine(reshape.13689), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.13703 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.13691), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.13704 = f32[1,1,256]{2,1,0} reshape(broadcast.13703), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.13705 = f32[1,1,4,256]{3,2,1,0} broadcast(reshape.13704), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.13706 = f32[1,1,4,256]{3,2,1,0} multiply(reshape.13698, broadcast.13705), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.13707 = f32[1,1,4,256]{3,2,1,0} add(multiply.13702, multiply.13706), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.13708 = f32[1,1,4,128]{3,2,1,0} slice(add.13707), slice={[0:1], [0:1], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13710 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.13708), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.13709 = f32[1,1,4,128]{3,2,1,0} slice(add.13707), slice={[0:1], [0:1], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13711 = f32[1,1,4,128,1]{4,3,2,1,0} reshape(slice.13709), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13712 = f32[1,1,4,128,2]{4,3,2,1,0} concatenate(reshape.13710, reshape.13711), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13713 = f32[1,1,4,256]{3,2,1,0} reshape(concatenate.13712), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  compare.13715 = pred[] compare(subtract.8393, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.13716 = s32[] add(subtract.8393, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.13717 = s32[] select(compare.13715, add.13716, subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.13718 = f32[1,31,4,256]{3,2,1,0} dynamic-update-slice(reshape.13676, reshape.13713, constant.8391, select.13717, constant.8391, /*index=5*/constant.8391), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  get-tuple-element.8333 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.8049), index=283
  dot.13640 = f32[1,1,8,256]{3,2,1,0} dot(multiply.13632, get-tuple-element.8333), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  convert.13643 = f32[] convert(subtract.8393), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  reshape.13644 = f32[1]{0} reshape(convert.13643), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=102}
  divide.13645 = f32[1]{0} divide(reshape.13644, constant.8375), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=116}
  power.13641 = f32[128]{0} power(broadcast.8380, constant.8378), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.13642 = f32[128]{0} divide(broadcast.8377, power.13641), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.13646 = f32[1,128]{1,0} dot(divide.13645, divide.13642), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.13647 = f32[1,1,128]{2,1,0} reshape(dot.13646), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13648 = f32[1,1,128]{2,1,0} reshape(dot.13646), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13649 = f32[1,2,128]{2,1,0} concatenate(reshape.13647, reshape.13648), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13650 = f32[1,1,1,256]{3,2,1,0} reshape(concatenate.13649), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.13651 = f32[1,1,1,256]{3,2,1,0} cosine(reshape.13650), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.13660 = f32[1,1,1,256]{3,2,1,0} broadcast(cosine.13651), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.13661 = f32[1,1,256]{2,1,0} reshape(broadcast.13660), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.13662 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.13661), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.13663 = f32[1,1,8,256]{3,2,1,0} multiply(dot.13640, broadcast.13662), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.13654 = f32[1,1,8,128]{3,2,1,0} slice(dot.13640), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.13655 = f32[1,1,8,128]{3,2,1,0} negate(slice.13654), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.13656 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(negate.13655), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.13653 = f32[1,1,8,128]{3,2,1,0} slice(dot.13640), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13657 = f32[1,1,8,1,128]{4,3,2,1,0} reshape(slice.13653), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13658 = f32[1,1,8,2,128]{4,3,2,1,0} concatenate(reshape.13656, reshape.13657), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13659 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.13658), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.13652 = f32[1,1,1,256]{3,2,1,0} sine(reshape.13650), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.13664 = f32[1,1,1,256]{3,2,1,0} broadcast(sine.13652), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.13665 = f32[1,1,256]{2,1,0} reshape(broadcast.13664), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.13666 = f32[1,1,8,256]{3,2,1,0} broadcast(reshape.13665), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.13667 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.13659, broadcast.13666), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.13668 = f32[1,1,8,256]{3,2,1,0} add(multiply.13663, multiply.13667), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/rotary_embedding_25/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.13669 = f32[1,1,8,128]{3,2,1,0} slice(add.13668), slice={[0:1], [0:1], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13671 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.13669), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.13670 = f32[1,1,8,128]{3,2,1,0} slice(add.13668), slice={[0:1], [0:1], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.13672 = f32[1,1,8,128,1]{4,3,2,1,0} reshape(slice.13670), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13673 = f32[1,1,8,128,2]{4,3,2,1,0} concatenate(reshape.13671, reshape.13672), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13674 = f32[1,1,8,256]{3,2,1,0} reshape(concatenate.13673), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.13726 = f32[1,1,8,256]{3,2,1,0} multiply(reshape.13674, broadcast.8374), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.13727 = f32[1,1,4,2,256]{4,3,2,1,0} reshape(multiply.13726), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.13728 = f32[1,4,31,1,2]{4,3,2,1,0} dot(dynamic-update-slice.13718, reshape.13727), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.13729 = f32[1,4,2,1,31]{2,3,4,1,0} transpose(dot.13728), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.13730 = f32[1,4,2,1,31]{2,3,4,1,0} divide(transpose.13729, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.13731 = f32[1,4,2,1,31]{2,3,4,1,0} tanh(divide.13730), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.13732 = f32[1,4,2,1,31]{2,3,4,1,0} multiply(tanh.13731, broadcast.8372), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.13733 = pred[1,1,1,1,31]{4,3,2,1,0} reshape(compare.13638), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.13734 = f32[1,1,1,1,31]{4,3,2,1,0} convert(reshape.13733), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.13735 = f32[1,1,1,1,31]{4,3,2,1,0} subtract(broadcast.8368, convert.13734), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.13736 = f32[1,1,1,1,31]{4,3,2,1,0} multiply(subtract.13735, broadcast.8366), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.13737 = f32[1,1,1,1,31]{4,3,2,1,0} broadcast(multiply.13736), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.13738 = f32[1,1,31]{2,1,0} reshape(broadcast.13737), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.13739 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.13738), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.13740 = f32[1,4,2,1,31]{2,3,4,1,0} add(multiply.13732, broadcast.13739), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.13741 = f32[1,4,2,1]{3,2,1,0} reduce(add.13740, constant.8364), dimensions={4}, to_apply=region_357.7975, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.13742 = f32[1,4,2,1]{3,2,1,0} maximum(reduce.13741, broadcast.8363), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13743 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(maximum.13742), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13744 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.13743), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13745 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.13744), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13746 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.13745), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.13747 = f32[1,4,2,1,31]{2,3,4,1,0} subtract(add.13740, broadcast.13746), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.13748 = f32[1,4,2,1,31]{2,3,4,1,0} exponential(subtract.13747), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.13749 = f32[1,4,2,1]{3,2,1,0} reduce(exponential.13748, constant.8387), dimensions={4}, to_apply=region_358.7979, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13750 = f32[1,4,2,1,1]{4,3,2,1,0} reshape(reduce.13749), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13751 = f32[1,4,2,1,1]{4,3,2,1,0} broadcast(reshape.13750), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13752 = f32[1,4,2,1]{3,2,1,0} reshape(broadcast.13751), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13753 = f32[1,4,2,1,31]{4,3,2,1,0} broadcast(reshape.13752), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.13754 = f32[1,4,2,1,31]{2,3,4,1,0} divide(exponential.13748, broadcast.13753), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/softmax_25/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.13755 = f32[1,4,256,2,1]{4,3,2,1,0} dot(dynamic-update-slice.13722, divide.13754), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.13756 = f32[1,1,4,2,256]{1,3,4,2,0} transpose(dot.13755), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.13757 = f32[1,1,8,256]{3,2,1,0} reshape(transpose.13756), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.13762 = f32[1,1,8,256]{3,2,1,0} call(reshape.13761, broadcast.8358, reshape.13757), to_apply=_where_5.7987
  get-tuple-element.8336 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.8049), index=286
  dot.13763 = f32[1,1,2304]{2,1,0} dot(call.13762, get-tuple-element.8336), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.13764 = f32[1,1,2304]{2,1,0} multiply(dot.13763, dot.13763), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.13765 = f32[1,1]{1,0} reduce(multiply.13764, constant.8387), dimensions={2}, to_apply=region_360.7995, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.13766 = f32[1,1,1]{2,1,0} reshape(reduce.13765), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.13767 = f32[1,1,1]{2,1,0} divide(reshape.13766, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.13768 = f32[1,1,1]{2,1,0} add(divide.13767, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.13769 = f32[1,1,1]{2,1,0} sqrt(add.13768), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.13770 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.13769), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.13771 = f32[1,1,1]{2,1,0} broadcast(divide.13770), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.13772 = f32[1,1]{1,0} reshape(broadcast.13771), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.13773 = f32[1,1,2304]{2,1,0} broadcast(reshape.13772), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.13774 = f32[1,1,2304]{2,1,0} multiply(dot.13763, broadcast.13773), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8337 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=287
  add.13775 = f32[2304]{0} add(get-tuple-element.8337, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.13776 = f32[1,1,2304]{2,1,0} reshape(add.13775), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.13777 = f32[1,1,2304]{2,1,0} multiply(multiply.13774, reshape.13776), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.13778 = f32[1,1,2304]{2,1,0} add(add.13616, multiply.13777), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.13779 = f32[1,1,2304]{2,1,0} multiply(add.13778, add.13778), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.13780 = f32[1,1]{1,0} reduce(multiply.13779, constant.8387), dimensions={2}, to_apply=region_361.7999, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.13781 = f32[1,1,1]{2,1,0} reshape(reduce.13780), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.13782 = f32[1,1,1]{2,1,0} divide(reshape.13781, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.13783 = f32[1,1,1]{2,1,0} add(divide.13782, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.13784 = f32[1,1,1]{2,1,0} sqrt(add.13783), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.13785 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.13784), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.13786 = f32[1,1,1]{2,1,0} broadcast(divide.13785), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.13787 = f32[1,1]{1,0} reshape(broadcast.13786), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.13788 = f32[1,1,2304]{2,1,0} broadcast(reshape.13787), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.13789 = f32[1,1,2304]{2,1,0} multiply(add.13778, broadcast.13788), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8338 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=288
  add.13790 = f32[2304]{0} add(get-tuple-element.8338, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.13791 = f32[1,1,2304]{2,1,0} reshape(add.13790), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.13792 = f32[1,1,2304]{2,1,0} multiply(multiply.13789, reshape.13791), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  get-tuple-element.8339 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=289
  dot.13793 = f32[1,1,9216]{2,1,0} dot(multiply.13792, get-tuple-element.8339), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.13795 = f32[1,1,9216]{2,1,0} multiply(dot.13793, dot.13793), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13796 = f32[1,1,9216]{2,1,0} multiply(multiply.13795, dot.13793), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13797 = f32[1,1,9216]{2,1,0} multiply(multiply.13796, broadcast.8356), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.13798 = f32[1,1,9216]{2,1,0} add(dot.13793, multiply.13797), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13799 = f32[1,1,9216]{2,1,0} multiply(add.13798, broadcast.8354), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.13800 = f32[1,1,9216]{2,1,0} tanh(multiply.13799), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.13801 = f32[1,1,9216]{2,1,0} add(tanh.13800, broadcast.8352), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13802 = f32[1,1,9216]{2,1,0} multiply(add.13801, broadcast.8350), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.13803 = f32[1,1,9216]{2,1,0} multiply(dot.13793, multiply.13802), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  get-tuple-element.8340 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.8049), index=290
  dot.13794 = f32[1,1,9216]{2,1,0} dot(multiply.13792, get-tuple-element.8340), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.13804 = f32[1,1,9216]{2,1,0} multiply(multiply.13803, dot.13794), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  get-tuple-element.8341 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.8049), index=291
  dot.13805 = f32[1,1,2304]{2,1,0} dot(multiply.13804, get-tuple-element.8341), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.13806 = f32[1,1,2304]{2,1,0} multiply(dot.13805, dot.13805), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.13807 = f32[1,1]{1,0} reduce(multiply.13806, constant.8387), dimensions={2}, to_apply=region_362.8003, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.13808 = f32[1,1,1]{2,1,0} reshape(reduce.13807), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.13809 = f32[1,1,1]{2,1,0} divide(reshape.13808, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.13810 = f32[1,1,1]{2,1,0} add(divide.13809, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.13811 = f32[1,1,1]{2,1,0} sqrt(add.13810), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.13812 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.13811), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.13813 = f32[1,1,1]{2,1,0} broadcast(divide.13812), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.13814 = f32[1,1]{1,0} reshape(broadcast.13813), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.13815 = f32[1,1,2304]{2,1,0} broadcast(reshape.13814), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.13816 = f32[1,1,2304]{2,1,0} multiply(dot.13805, broadcast.13815), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8342 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=292
  add.13817 = f32[2304]{0} add(get-tuple-element.8342, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.13818 = f32[1,1,2304]{2,1,0} reshape(add.13817), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.13819 = f32[1,1,2304]{2,1,0} multiply(multiply.13816, reshape.13818), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.13820 = f32[1,1,2304]{2,1,0} add(multiply.13819, add.13778), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.13848 = f32[1,1,2304]{2,1,0} multiply(add.13820, add.13820), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/final_normalization/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.13849 = f32[1,1]{1,0} reduce(multiply.13848, constant.8387), dimensions={2}, to_apply=region_363.8007, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/final_normalization/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.13850 = f32[1,1,1]{2,1,0} reshape(reduce.13849), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/final_normalization/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.13851 = f32[1,1,1]{2,1,0} divide(reshape.13850, constant.8386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/final_normalization/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.13852 = f32[1,1,1]{2,1,0} add(divide.13851, constant.8385), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/final_normalization/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.13853 = f32[1,1,1]{2,1,0} sqrt(add.13852), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/final_normalization/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.13854 = f32[1,1,1]{2,1,0} divide(constant.8384, sqrt.13853), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/final_normalization/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.13855 = f32[1,1,1]{2,1,0} broadcast(divide.13854), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/final_normalization/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.13856 = f32[1,1]{1,0} reshape(broadcast.13855), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/final_normalization/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.13857 = f32[1,1,2304]{2,1,0} broadcast(reshape.13856), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/final_normalization/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.13858 = f32[1,1,2304]{2,1,0} multiply(add.13820, broadcast.13857), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/final_normalization/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  get-tuple-element.8343 = f32[2304]{0} get-tuple-element(arg_tuple.8049), index=293
  add.13859 = f32[2304]{0} add(get-tuple-element.8343, broadcast.8383), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/final_normalization/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.13860 = f32[1,1,2304]{2,1,0} reshape(add.13859), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/final_normalization/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.13861 = f32[1,1,2304]{2,1,0} multiply(multiply.13858, reshape.13860), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/final_normalization/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  transpose.13862 = f32[2304,256000]{0,1} transpose(get-tuple-element.8056), dimensions={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1200}
  dot.13863 = f32[1,1,256000]{2,1,0} dot(multiply.13861, transpose.13862), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=121}
  constant.8347 = f32[] constant(30)
  broadcast.8348 = f32[1,1,256000]{2,1,0} broadcast(constant.8347), dimensions={}
  divide.13864 = f32[1,1,256000]{2,1,0} divide(dot.13863, broadcast.8348), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/reversible_embedding.py" source_line=128}
  tanh.13865 = f32[1,1,256000]{2,1,0} tanh(divide.13864), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.13866 = f32[1,1,256000]{2,1,0} multiply(tanh.13865, broadcast.8348), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/token_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/reversible_embedding.py" source_line=128}
  reshape.13867 = f32[1,256000]{1,0} reshape(multiply.13866), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/squeeze" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1185}
  constant.8345 = f32[] constant(1)
  broadcast.8346 = f32[1,256000]{1,0} broadcast(constant.8345), dimensions={}
  divide.13868 = f32[1,256000]{1,0} divide(reshape.13867, broadcast.8346), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/samplers/sampler.py" source_line=135}
  reduce.13869 = f32[1]{0} reduce(divide.13868, constant.8364), dimensions={1}, to_apply=region_364.8011, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  constant.8344 = f32[1]{0} constant({-inf})
  maximum.13870 = f32[1]{0} maximum(reduce.13869, constant.8344), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13871 = f32[1,1]{1,0} reshape(maximum.13870), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13872 = f32[1,1]{1,0} broadcast(reshape.13871), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13873 = f32[1]{0} reshape(broadcast.13872), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13874 = f32[1,256000]{1,0} broadcast(reshape.13873), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.13875 = f32[1,256000]{1,0} subtract(divide.13868, broadcast.13874), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.13876 = f32[1,256000]{1,0} exponential(subtract.13875), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.13877 = f32[1]{0} reduce(exponential.13876, constant.8387), dimensions={1}, to_apply=region_365.8015, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13878 = f32[1,1]{1,0} reshape(reduce.13877), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13879 = f32[1,1]{1,0} broadcast(reshape.13878), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.13880 = f32[1]{0} reshape(broadcast.13879), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.13881 = f32[1,256000]{1,0} broadcast(reshape.13880), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.13882 = f32[1,256000]{1,0} divide(exponential.13876, broadcast.13881), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  call.13883 = s32[1]{0} call(divide.13882), to_apply=argmax.8034
  call.13894 = s32[1]{0} call(reshape.13888, reshape.13893, call.13883), to_apply=_where_6.8043
  reshape.13895 = s32[1,1]{1,0} reshape(call.13894), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/samplers/sampler.py" source_line=113}
  compare.13896 = pred[] compare(get-tuple-element.8052, constant.8391), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  add.13897 = s32[] add(get-tuple-element.8052, constant.8390), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  select.13898 = s32[] select(compare.13896, add.13897, get-tuple-element.8052), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/select_n" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  dynamic-update-slice.13899 = s32[1,31]{1,0} dynamic-update-slice(get-tuple-element.8050, reshape.13895, constant.8391, select.13898), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/dynamic_update_slice" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=296}
  reshape.8506 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.8501), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8507 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.8505), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8508 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.8506, reshape.8507), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_0/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13821 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.8508), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8719 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.8714), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8720 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.8718), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8721 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.8719, reshape.8720), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_1/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13822 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.8721), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8923 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.8918), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.8924 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.8922), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.8925 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.8923, reshape.8924), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_2/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13823 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.8925), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9136 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.9131), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9137 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.9135), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9138 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.9136, reshape.9137), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_3/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13824 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.9138), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9340 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.9335), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9341 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.9339), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9342 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.9340, reshape.9341), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_4/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13825 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.9342), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9553 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.9548), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9554 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.9552), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9555 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.9553, reshape.9554), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_5/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13826 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.9555), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9757 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.9752), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9758 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.9756), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9759 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.9757, reshape.9758), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_6/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13827 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.9759), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9970 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.9965), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.9971 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.9969), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.9972 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.9970, reshape.9971), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_7/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13828 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.9972), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10174 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.10169), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10175 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.10173), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10176 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.10174, reshape.10175), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_8/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13829 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.10176), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10387 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.10382), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10388 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.10386), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10389 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.10387, reshape.10388), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_9/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13830 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.10389), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10591 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.10586), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10592 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.10590), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10593 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.10591, reshape.10592), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_10/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13831 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.10593), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10804 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.10799), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.10805 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.10803), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.10806 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.10804, reshape.10805), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_11/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13832 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.10806), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11008 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.11003), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11009 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.11007), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11010 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.11008, reshape.11009), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_12/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13833 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.11010), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11221 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.11216), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11222 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.11220), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11223 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.11221, reshape.11222), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_13/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13834 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.11223), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11425 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.11420), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11426 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.11424), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11427 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.11425, reshape.11426), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_14/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13835 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.11427), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11638 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.11633), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11639 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.11637), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11640 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.11638, reshape.11639), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_15/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13836 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.11640), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11842 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.11837), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.11843 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.11841), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.11844 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.11842, reshape.11843), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_16/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13837 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.11844), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12055 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.12050), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12056 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.12054), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12057 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.12055, reshape.12056), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_17/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13838 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.12057), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12259 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.12254), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12260 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.12258), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12261 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.12259, reshape.12260), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_18/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13839 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.12261), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12472 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.12467), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12473 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.12471), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12474 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.12472, reshape.12473), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_19/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13840 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.12474), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12676 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.12671), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12677 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.12675), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12678 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.12676, reshape.12677), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_20/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13841 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.12678), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12889 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.12884), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.12890 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.12888), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.12891 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.12889, reshape.12890), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_21/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13842 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.12891), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13093 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.13088), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13094 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.13092), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13095 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.13093, reshape.13094), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_22/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13843 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.13095), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13306 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.13301), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13307 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.13305), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13308 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.13306, reshape.13307), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_23/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13844 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.13308), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13510 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.13505), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13511 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.13509), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13512 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.13510, reshape.13511), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_24/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13845 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.13512), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13723 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.13718), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13724 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dynamic-update-slice.13722), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13725 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.13723, reshape.13724), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/decoder_block_25/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.13846 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.13725), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.13847 = f32[1,26,2,31,4,256]{5,4,3,2,1,0} concatenate(reshape.13821, reshape.13822, reshape.13823, reshape.13824, reshape.13825, /*index=5*/reshape.13826, reshape.13827, reshape.13828, reshape.13829, reshape.13830, /*index=10*/reshape.13831, reshape.13832, reshape.13833, reshape.13834, reshape.13835, /*index=15*/reshape.13836, reshape.13837, reshape.13838, reshape.13839, reshape.13840, /*index=20*/reshape.13841, reshape.13842, reshape.13843, reshape.13844, reshape.13845, /*index=25*/reshape.13846), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  add.13900 = s32[] add(get-tuple-element.8052, constant.8392), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/samplers/sampler.py" source_line=117}
  get-tuple-element.8053 = s32[] get-tuple-element(arg_tuple.8049), index=3
  add.13901 = s32[] add(get-tuple-element.8053, constant.8392), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/body/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=322}
  get-tuple-element.8055 = s32[] get-tuple-element(arg_tuple.8049), index=5
  ROOT tuple.13902 = (s32[1,31]{1,0}, f32[1,26,2,31,4,256]{5,4,3,2,1,0}, s32[], s32[], pred[1,31]{1,0}, /*index=5*/s32[], f32[256000,2304]{1,0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=10*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=15*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=20*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=25*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=30*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=35*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=40*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=45*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=50*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=55*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=60*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=65*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=70*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=75*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=80*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=85*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=90*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=95*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=100*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=105*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=110*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=115*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=120*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=125*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=130*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=135*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=140*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=145*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=150*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=155*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=160*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=165*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=170*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=175*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=180*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=185*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=190*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=195*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=200*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=205*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=210*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=215*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=220*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=225*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=230*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=235*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=240*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=245*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=250*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=255*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=260*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=265*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=270*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=275*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=280*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=285*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=290*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}) tuple(dynamic-update-slice.13899, concatenate.13847, add.13900, add.13901, get-tuple-element.8054, /*index=5*/get-tuple-element.8055, get-tuple-element.8056, get-tuple-element.8057, get-tuple-element.8058, get-tuple-element.8059, /*index=10*/get-tuple-element.8060, get-tuple-element.8061, get-tuple-element.8062, get-tuple-element.8063, get-tuple-element.8064, /*index=15*/get-tuple-element.8065, get-tuple-element.8066, get-tuple-element.8067, get-tuple-element.8068, get-tuple-element.8069, /*index=20*/get-tuple-element.8070, get-tuple-element.8071, get-tuple-element.8072, get-tuple-element.8073, get-tuple-element.8074, /*index=25*/get-tuple-element.8075, get-tuple-element.8076, get-tuple-element.8077, get-tuple-element.8078, get-tuple-element.8079, /*index=30*/get-tuple-element.8080, get-tuple-element.8081, get-tuple-element.8082, get-tuple-element.8083, get-tuple-element.8084, /*index=35*/get-tuple-element.8085, get-tuple-element.8086, get-tuple-element.8087, get-tuple-element.8088, get-tuple-element.8089, /*index=40*/get-tuple-element.8090, get-tuple-element.8091, get-tuple-element.8092, get-tuple-element.8093, get-tuple-element.8094, /*index=45*/get-tuple-element.8095, get-tuple-element.8096, get-tuple-element.8097, get-tuple-element.8098, get-tuple-element.8099, /*index=50*/get-tuple-element.8100, get-tuple-element.8101, get-tuple-element.8102, get-tuple-element.8103, get-tuple-element.8104, /*index=55*/get-tuple-element.8105, get-tuple-element.8106, get-tuple-element.8107, get-tuple-element.8108, get-tuple-element.8109, /*index=60*/get-tuple-element.8110, get-tuple-element.8111, get-tuple-element.8112, get-tuple-element.8113, get-tuple-element.8114, /*index=65*/get-tuple-element.8115, get-tuple-element.8116, get-tuple-element.8117, get-tuple-element.8118, get-tuple-element.8119, /*index=70*/get-tuple-element.8120, get-tuple-element.8121, get-tuple-element.8122, get-tuple-element.8123, get-tuple-element.8124, /*index=75*/get-tuple-element.8125, get-tuple-element.8126, get-tuple-element.8127, get-tuple-element.8128, get-tuple-element.8129, /*index=80*/get-tuple-element.8130, get-tuple-element.8131, get-tuple-element.8132, get-tuple-element.8133, get-tuple-element.8134, /*index=85*/get-tuple-element.8135, get-tuple-element.8136, get-tuple-element.8137, get-tuple-element.8138, get-tuple-element.8139, /*index=90*/get-tuple-element.8140, get-tuple-element.8141, get-tuple-element.8142, get-tuple-element.8143, get-tuple-element.8144, /*index=95*/get-tuple-element.8145, get-tuple-element.8146, get-tuple-element.8147, get-tuple-element.8148, get-tuple-element.8149, /*index=100*/get-tuple-element.8150, get-tuple-element.8151, get-tuple-element.8152, get-tuple-element.8153, get-tuple-element.8154, /*index=105*/get-tuple-element.8155, get-tuple-element.8156, get-tuple-element.8157, get-tuple-element.8158, get-tuple-element.8159, /*index=110*/get-tuple-element.8160, get-tuple-element.8161, get-tuple-element.8162, get-tuple-element.8163, get-tuple-element.8164, /*index=115*/get-tuple-element.8165, get-tuple-element.8166, get-tuple-element.8167, get-tuple-element.8168, get-tuple-element.8169, /*index=120*/get-tuple-element.8170, get-tuple-element.8171, get-tuple-element.8172, get-tuple-element.8173, get-tuple-element.8174, /*index=125*/get-tuple-element.8175, get-tuple-element.8176, get-tuple-element.8177, get-tuple-element.8178, get-tuple-element.8179, /*index=130*/get-tuple-element.8180, get-tuple-element.8181, get-tuple-element.8182, get-tuple-element.8183, get-tuple-element.8184, /*index=135*/get-tuple-element.8185, get-tuple-element.8186, get-tuple-element.8187, get-tuple-element.8188, get-tuple-element.8189, /*index=140*/get-tuple-element.8190, get-tuple-element.8191, get-tuple-element.8192, get-tuple-element.8193, get-tuple-element.8194, /*index=145*/get-tuple-element.8195, get-tuple-element.8196, get-tuple-element.8197, get-tuple-element.8198, get-tuple-element.8199, /*index=150*/get-tuple-element.8200, get-tuple-element.8201, get-tuple-element.8202, get-tuple-element.8203, get-tuple-element.8204, /*index=155*/get-tuple-element.8205, get-tuple-element.8206, get-tuple-element.8207, get-tuple-element.8208, get-tuple-element.8209, /*index=160*/get-tuple-element.8210, get-tuple-element.8211, get-tuple-element.8212, get-tuple-element.8213, get-tuple-element.8214, /*index=165*/get-tuple-element.8215, get-tuple-element.8216, get-tuple-element.8217, get-tuple-element.8218, get-tuple-element.8219, /*index=170*/get-tuple-element.8220, get-tuple-element.8221, get-tuple-element.8222, get-tuple-element.8223, get-tuple-element.8224, /*index=175*/get-tuple-element.8225, get-tuple-element.8226, get-tuple-element.8227, get-tuple-element.8228, get-tuple-element.8229, /*index=180*/get-tuple-element.8230, get-tuple-element.8231, get-tuple-element.8232, get-tuple-element.8233, get-tuple-element.8234, /*index=185*/get-tuple-element.8235, get-tuple-element.8236, get-tuple-element.8237, get-tuple-element.8238, get-tuple-element.8239, /*index=190*/get-tuple-element.8240, get-tuple-element.8241, get-tuple-element.8242, get-tuple-element.8243, get-tuple-element.8244, /*index=195*/get-tuple-element.8245, get-tuple-element.8246, get-tuple-element.8247, get-tuple-element.8248, get-tuple-element.8249, /*index=200*/get-tuple-element.8250, get-tuple-element.8251, get-tuple-element.8252, get-tuple-element.8253, get-tuple-element.8254, /*index=205*/get-tuple-element.8255, get-tuple-element.8256, get-tuple-element.8257, get-tuple-element.8258, get-tuple-element.8259, /*index=210*/get-tuple-element.8260, get-tuple-element.8261, get-tuple-element.8262, get-tuple-element.8263, get-tuple-element.8264, /*index=215*/get-tuple-element.8265, get-tuple-element.8266, get-tuple-element.8267, get-tuple-element.8268, get-tuple-element.8269, /*index=220*/get-tuple-element.8270, get-tuple-element.8271, get-tuple-element.8272, get-tuple-element.8273, get-tuple-element.8274, /*index=225*/get-tuple-element.8275, get-tuple-element.8276, get-tuple-element.8277, get-tuple-element.8278, get-tuple-element.8279, /*index=230*/get-tuple-element.8280, get-tuple-element.8281, get-tuple-element.8282, get-tuple-element.8283, get-tuple-element.8284, /*index=235*/get-tuple-element.8285, get-tuple-element.8286, get-tuple-element.8287, get-tuple-element.8288, get-tuple-element.8289, /*index=240*/get-tuple-element.8290, get-tuple-element.8291, get-tuple-element.8292, get-tuple-element.8293, get-tuple-element.8294, /*index=245*/get-tuple-element.8295, get-tuple-element.8296, get-tuple-element.8297, get-tuple-element.8298, get-tuple-element.8299, /*index=250*/get-tuple-element.8300, get-tuple-element.8301, get-tuple-element.8302, get-tuple-element.8303, get-tuple-element.8304, /*index=255*/get-tuple-element.8305, get-tuple-element.8306, get-tuple-element.8307, get-tuple-element.8308, get-tuple-element.8309, /*index=260*/get-tuple-element.8310, get-tuple-element.8311, get-tuple-element.8312, get-tuple-element.8313, get-tuple-element.8314, /*index=265*/get-tuple-element.8315, get-tuple-element.8316, get-tuple-element.8317, get-tuple-element.8318, get-tuple-element.8319, /*index=270*/get-tuple-element.8320, get-tuple-element.8321, get-tuple-element.8322, get-tuple-element.8323, get-tuple-element.8324, /*index=275*/get-tuple-element.8325, get-tuple-element.8326, get-tuple-element.8327, get-tuple-element.8328, get-tuple-element.8329, /*index=280*/get-tuple-element.8330, get-tuple-element.8331, get-tuple-element.8332, get-tuple-element.8333, get-tuple-element.8334, /*index=285*/get-tuple-element.8335, get-tuple-element.8336, get-tuple-element.8337, get-tuple-element.8338, get-tuple-element.8339, /*index=290*/get-tuple-element.8340, get-tuple-element.8341, get-tuple-element.8342, get-tuple-element.8343)
} // region_179.8048

region_368.13903 {
  Arg_0.13904 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/cond/reduce_or"}
  Arg_1.13905 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/cond/reduce_or"}
  ROOT or.13906 = pred[] or(Arg_0.13904, Arg_1.13905), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/cond/reduce_or" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=235}
}

region_369.13907 {
  Arg_0.13908 = pred[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/cond/reduce_and"}
  Arg_1.13909 = pred[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/cond/reduce_and"}
  ROOT and.13910 = pred[] and(Arg_0.13908, Arg_1.13909), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/cond/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
}

region_367.13911 {
  arg_tuple.13912 = (s32[1,31]{1,0}, f32[1,26,2,31,4,256]{5,4,3,2,1,0}, s32[], s32[], pred[1,31]{1,0}, /*index=5*/s32[], f32[256000,2304]{1,0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=10*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=15*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=20*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=25*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=30*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=35*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=40*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=45*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=50*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=55*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=60*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=65*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=70*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=75*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=80*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=85*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=90*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=95*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=100*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=105*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=110*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=115*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=120*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=125*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=130*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=135*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=140*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=145*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=150*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=155*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=160*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=165*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=170*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=175*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=180*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=185*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=190*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=195*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=200*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=205*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=210*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=215*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=220*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=225*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=230*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=235*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=240*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=245*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=250*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=255*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=260*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=265*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=270*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=275*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=280*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=285*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=290*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}) parameter(0)
  get-tuple-element.13914 = f32[1,26,2,31,4,256]{5,4,3,2,1,0} get-tuple-element(arg_tuple.13912), index=1
  get-tuple-element.13915 = s32[] get-tuple-element(arg_tuple.13912), index=2
  get-tuple-element.13919 = f32[256000,2304]{1,0} get-tuple-element(arg_tuple.13912), index=6
  get-tuple-element.13920 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=7
  get-tuple-element.13921 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=8
  get-tuple-element.13922 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=9
  get-tuple-element.13923 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=10
  get-tuple-element.13924 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=11
  get-tuple-element.13925 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=12
  get-tuple-element.13926 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=13
  get-tuple-element.13927 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=14
  get-tuple-element.13928 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=15
  get-tuple-element.13929 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=16
  get-tuple-element.13930 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=17
  get-tuple-element.13931 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=18
  get-tuple-element.13932 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=19
  get-tuple-element.13933 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=20
  get-tuple-element.13934 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=21
  get-tuple-element.13935 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=22
  get-tuple-element.13936 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=23
  get-tuple-element.13937 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=24
  get-tuple-element.13938 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=25
  get-tuple-element.13939 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=26
  get-tuple-element.13940 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=27
  get-tuple-element.13941 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=28
  get-tuple-element.13942 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=29
  get-tuple-element.13943 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=30
  get-tuple-element.13944 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=31
  get-tuple-element.13945 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=32
  get-tuple-element.13946 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=33
  get-tuple-element.13947 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=34
  get-tuple-element.13948 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=35
  get-tuple-element.13949 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=36
  get-tuple-element.13950 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=37
  get-tuple-element.13951 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=38
  get-tuple-element.13952 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=39
  get-tuple-element.13953 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=40
  get-tuple-element.13954 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=41
  get-tuple-element.13955 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=42
  get-tuple-element.13956 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=43
  get-tuple-element.13957 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=44
  get-tuple-element.13958 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=45
  get-tuple-element.13959 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=46
  get-tuple-element.13960 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=47
  get-tuple-element.13961 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=48
  get-tuple-element.13962 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=49
  get-tuple-element.13963 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=50
  get-tuple-element.13964 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=51
  get-tuple-element.13965 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=52
  get-tuple-element.13966 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=53
  get-tuple-element.13967 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=54
  get-tuple-element.13968 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=55
  get-tuple-element.13969 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=56
  get-tuple-element.13970 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=57
  get-tuple-element.13971 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=58
  get-tuple-element.13972 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=59
  get-tuple-element.13973 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=60
  get-tuple-element.13974 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=61
  get-tuple-element.13975 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=62
  get-tuple-element.13976 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=63
  get-tuple-element.13977 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=64
  get-tuple-element.13978 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=65
  get-tuple-element.13979 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=66
  get-tuple-element.13980 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=67
  get-tuple-element.13981 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=68
  get-tuple-element.13982 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=69
  get-tuple-element.13983 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=70
  get-tuple-element.13984 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=71
  get-tuple-element.13985 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=72
  get-tuple-element.13986 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=73
  get-tuple-element.13987 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=74
  get-tuple-element.13988 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=75
  get-tuple-element.13989 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=76
  get-tuple-element.13990 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=77
  get-tuple-element.13991 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=78
  get-tuple-element.13992 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=79
  get-tuple-element.13993 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=80
  get-tuple-element.13994 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=81
  get-tuple-element.13995 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=82
  get-tuple-element.13996 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=83
  get-tuple-element.13997 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=84
  get-tuple-element.13998 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=85
  get-tuple-element.13999 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=86
  get-tuple-element.14000 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=87
  get-tuple-element.14001 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=88
  get-tuple-element.14002 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=89
  get-tuple-element.14003 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=90
  get-tuple-element.14004 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=91
  get-tuple-element.14005 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=92
  get-tuple-element.14006 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=93
  get-tuple-element.14007 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=94
  get-tuple-element.14008 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=95
  get-tuple-element.14009 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=96
  get-tuple-element.14010 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=97
  get-tuple-element.14011 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=98
  get-tuple-element.14012 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=99
  get-tuple-element.14013 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=100
  get-tuple-element.14014 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=101
  get-tuple-element.14015 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=102
  get-tuple-element.14016 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=103
  get-tuple-element.14017 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=104
  get-tuple-element.14018 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=105
  get-tuple-element.14019 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=106
  get-tuple-element.14020 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=107
  get-tuple-element.14021 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=108
  get-tuple-element.14022 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=109
  get-tuple-element.14023 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=110
  get-tuple-element.14024 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=111
  get-tuple-element.14025 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=112
  get-tuple-element.14026 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=113
  get-tuple-element.14027 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=114
  get-tuple-element.14028 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=115
  get-tuple-element.14029 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=116
  get-tuple-element.14030 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=117
  get-tuple-element.14031 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=118
  get-tuple-element.14032 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=119
  get-tuple-element.14033 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=120
  get-tuple-element.14034 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=121
  get-tuple-element.14035 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=122
  get-tuple-element.14036 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=123
  get-tuple-element.14037 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=124
  get-tuple-element.14038 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=125
  get-tuple-element.14039 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=126
  get-tuple-element.14040 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=127
  get-tuple-element.14041 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=128
  get-tuple-element.14042 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=129
  get-tuple-element.14043 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=130
  get-tuple-element.14044 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=131
  get-tuple-element.14045 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=132
  get-tuple-element.14046 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=133
  get-tuple-element.14047 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=134
  get-tuple-element.14048 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=135
  get-tuple-element.14049 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=136
  get-tuple-element.14050 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=137
  get-tuple-element.14051 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=138
  get-tuple-element.14052 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=139
  get-tuple-element.14053 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=140
  get-tuple-element.14054 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=141
  get-tuple-element.14055 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=142
  get-tuple-element.14056 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=143
  get-tuple-element.14057 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=144
  get-tuple-element.14058 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=145
  get-tuple-element.14059 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=146
  get-tuple-element.14060 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=147
  get-tuple-element.14061 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=148
  get-tuple-element.14062 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=149
  get-tuple-element.14063 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=150
  get-tuple-element.14064 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=151
  get-tuple-element.14065 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=152
  get-tuple-element.14066 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=153
  get-tuple-element.14067 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=154
  get-tuple-element.14068 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=155
  get-tuple-element.14069 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=156
  get-tuple-element.14070 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=157
  get-tuple-element.14071 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=158
  get-tuple-element.14072 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=159
  get-tuple-element.14073 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=160
  get-tuple-element.14074 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=161
  get-tuple-element.14075 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=162
  get-tuple-element.14076 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=163
  get-tuple-element.14077 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=164
  get-tuple-element.14078 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=165
  get-tuple-element.14079 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=166
  get-tuple-element.14080 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=167
  get-tuple-element.14081 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=168
  get-tuple-element.14082 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=169
  get-tuple-element.14083 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=170
  get-tuple-element.14084 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=171
  get-tuple-element.14085 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=172
  get-tuple-element.14086 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=173
  get-tuple-element.14087 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=174
  get-tuple-element.14088 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=175
  get-tuple-element.14089 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=176
  get-tuple-element.14090 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=177
  get-tuple-element.14091 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=178
  get-tuple-element.14092 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=179
  get-tuple-element.14093 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=180
  get-tuple-element.14094 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=181
  get-tuple-element.14095 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=182
  get-tuple-element.14096 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=183
  get-tuple-element.14097 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=184
  get-tuple-element.14098 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=185
  get-tuple-element.14099 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=186
  get-tuple-element.14100 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=187
  get-tuple-element.14101 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=188
  get-tuple-element.14102 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=189
  get-tuple-element.14103 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=190
  get-tuple-element.14104 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=191
  get-tuple-element.14105 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=192
  get-tuple-element.14106 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=193
  get-tuple-element.14107 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=194
  get-tuple-element.14108 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=195
  get-tuple-element.14109 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=196
  get-tuple-element.14110 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=197
  get-tuple-element.14111 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=198
  get-tuple-element.14112 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=199
  get-tuple-element.14113 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=200
  get-tuple-element.14114 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=201
  get-tuple-element.14115 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=202
  get-tuple-element.14116 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=203
  get-tuple-element.14117 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=204
  get-tuple-element.14118 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=205
  get-tuple-element.14119 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=206
  get-tuple-element.14120 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=207
  get-tuple-element.14121 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=208
  get-tuple-element.14122 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=209
  get-tuple-element.14123 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=210
  get-tuple-element.14124 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=211
  get-tuple-element.14125 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=212
  get-tuple-element.14126 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=213
  get-tuple-element.14127 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=214
  get-tuple-element.14128 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=215
  get-tuple-element.14129 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=216
  get-tuple-element.14130 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=217
  get-tuple-element.14131 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=218
  get-tuple-element.14132 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=219
  get-tuple-element.14133 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=220
  get-tuple-element.14134 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=221
  get-tuple-element.14135 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=222
  get-tuple-element.14136 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=223
  get-tuple-element.14137 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=224
  get-tuple-element.14138 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=225
  get-tuple-element.14139 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=226
  get-tuple-element.14140 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=227
  get-tuple-element.14141 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=228
  get-tuple-element.14142 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=229
  get-tuple-element.14143 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=230
  get-tuple-element.14144 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=231
  get-tuple-element.14145 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=232
  get-tuple-element.14146 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=233
  get-tuple-element.14147 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=234
  get-tuple-element.14148 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=235
  get-tuple-element.14149 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=236
  get-tuple-element.14150 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=237
  get-tuple-element.14151 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=238
  get-tuple-element.14152 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=239
  get-tuple-element.14153 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=240
  get-tuple-element.14154 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=241
  get-tuple-element.14155 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=242
  get-tuple-element.14156 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=243
  get-tuple-element.14157 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=244
  get-tuple-element.14158 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=245
  get-tuple-element.14159 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=246
  get-tuple-element.14160 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=247
  get-tuple-element.14161 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=248
  get-tuple-element.14162 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=249
  get-tuple-element.14163 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=250
  get-tuple-element.14164 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=251
  get-tuple-element.14165 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=252
  get-tuple-element.14166 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=253
  get-tuple-element.14167 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=254
  get-tuple-element.14168 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=255
  get-tuple-element.14169 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=256
  get-tuple-element.14170 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=257
  get-tuple-element.14171 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=258
  get-tuple-element.14172 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=259
  get-tuple-element.14173 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=260
  get-tuple-element.14174 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=261
  get-tuple-element.14175 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=262
  get-tuple-element.14176 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=263
  get-tuple-element.14177 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=264
  get-tuple-element.14178 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=265
  get-tuple-element.14179 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=266
  get-tuple-element.14180 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=267
  get-tuple-element.14181 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=268
  get-tuple-element.14182 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=269
  get-tuple-element.14183 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=270
  get-tuple-element.14184 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=271
  get-tuple-element.14185 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=272
  get-tuple-element.14186 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=273
  get-tuple-element.14187 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=274
  get-tuple-element.14188 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=275
  get-tuple-element.14189 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=276
  get-tuple-element.14190 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=277
  get-tuple-element.14191 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=278
  get-tuple-element.14192 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=279
  get-tuple-element.14193 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=280
  get-tuple-element.14194 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=281
  get-tuple-element.14195 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=282
  get-tuple-element.14196 = f32[8,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=283
  get-tuple-element.14197 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=284
  get-tuple-element.14198 = f32[4,2304,256]{2,1,0} get-tuple-element(arg_tuple.13912), index=285
  get-tuple-element.14199 = f32[8,256,2304]{2,1,0} get-tuple-element(arg_tuple.13912), index=286
  get-tuple-element.14200 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=287
  get-tuple-element.14201 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=288
  get-tuple-element.14202 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=289
  get-tuple-element.14203 = f32[2304,9216]{1,0} get-tuple-element(arg_tuple.13912), index=290
  get-tuple-element.14204 = f32[9216,2304]{1,0} get-tuple-element(arg_tuple.13912), index=291
  get-tuple-element.14205 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=292
  get-tuple-element.14206 = f32[2304]{0} get-tuple-element(arg_tuple.13912), index=293
  get-tuple-element.13913 = s32[1,31]{1,0} get-tuple-element(arg_tuple.13912), index=0
  constant.14209 = s32[] constant(1)
  broadcast.14210 = s32[1,31]{1,0} broadcast(constant.14209), dimensions={}
  compare.14212 = pred[1,31]{1,0} compare(get-tuple-element.13913, broadcast.14210), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/cond/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  get-tuple-element.13917 = pred[1,31]{1,0} get-tuple-element(arg_tuple.13912), index=4
  not.14211 = pred[1,31]{1,0} not(get-tuple-element.13917), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/cond/not" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/samplers/sampler.py" source_line=99}
  and.14213 = pred[1,31]{1,0} and(compare.14212, not.14211), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/cond/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  constant.14208 = pred[] constant(false)
  reduce.14214 = pred[1]{0} reduce(and.14213, constant.14208), dimensions={1}, to_apply=region_368.13903, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/cond/reduce_or" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=235}
  constant.14207 = pred[] constant(true)
  reduce.14215 = pred[] reduce(reduce.14214, constant.14207), dimensions={0}, to_apply=region_369.13907, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/cond/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  not.14216 = pred[] not(reduce.14215), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/cond/not" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=765}
  get-tuple-element.13916 = s32[] get-tuple-element(arg_tuple.13912), index=3
  get-tuple-element.13918 = s32[] get-tuple-element(arg_tuple.13912), index=5
  compare.14217 = pred[] compare(get-tuple-element.13916, get-tuple-element.13918), direction=LT, metadata={op_name="jit(compiled_generate_function)/jit(main)/while/cond/lt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=317}
  ROOT and.14218 = pred[] and(not.14216, compare.14217), metadata={op_name="jit(compiled_generate_function)/jit(main)/while/cond/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=317}
} // region_367.13911

region_370.14228 {
  Arg_0.14229 = s32[] parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/jit(cumsum)/reduce_window_sum"}
  Arg_1.14230 = s32[] parameter(1), metadata={op_name="jit(compiled_generate_function)/jit(main)/jit(cumsum)/reduce_window_sum"}
  ROOT add.14231 = s32[] add(Arg_0.14229, Arg_1.14230), metadata={op_name="jit(compiled_generate_function)/jit(main)/jit(cumsum)/reduce_window_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=520}
}

cumsum_7.14232 {
  Arg_0.14233 = s32[1,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/jit(cumsum)/cumsum"}
  constant.14234 = s32[] constant(0)
  ROOT reduce-window.14235 = s32[1,31]{1,0} reduce-window(Arg_0.14233, constant.14234), window={size=1x31 pad=0_0x30_0}, to_apply=region_370.14228, metadata={op_name="jit(compiled_generate_function)/jit(main)/jit(cumsum)/reduce_window_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=520}
}

cumsum.14236 {
  Arg_0.14237 = s32[1,31]{1,0} parameter(0), metadata={op_name="jit(compiled_generate_function)/jit(main)/pjit"}
  ROOT call.14238 = s32[1,31]{1,0} call(Arg_0.14237), to_apply=cumsum_7.14232
}

ENTRY main.14244 {
  Arg_1.2 = s32[1,31]{1,0} parameter(1), metadata={op_name="inputs[\'token_ids\']"}
  Arg_2.3 = f32[256000,2304]{1,0} parameter(2), metadata={op_name="state[1][0]"}
  call.377 = f32[1,31,2304]{2,1,0} call(Arg_2.3, Arg_1.2), to_apply=_take.352
  constant.335 = f32[] constant(48)
  broadcast.336 = f32[1,31,2304]{2,1,0} broadcast(constant.335), dimensions={}
  multiply.378 = f32[1,31,2304]{2,1,0} multiply(call.377, broadcast.336), metadata={op_name="jit(compiled_generate_function)/jit(main)/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=200}
  constant.329 = f32[] constant(1)
  broadcast.330 = f32[1,31,1]{2,1,0} broadcast(constant.329), dimensions={}
  multiply.379 = f32[1,31,2304]{2,1,0} multiply(multiply.378, multiply.378), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  constant.342 = f32[] constant(0)
  reduce.384 = f32[1,31]{1,0} reduce(multiply.379, constant.342), dimensions={2}, to_apply=region_1.380, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.385 = f32[1,31,1]{2,1,0} reshape(reduce.384), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  constant.333 = f32[] constant(2304)
  broadcast.334 = f32[1,31,1]{2,1,0} broadcast(constant.333), dimensions={}
  divide.386 = f32[1,31,1]{2,1,0} divide(reshape.385, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  constant.331 = f32[] constant(1e-06)
  broadcast.332 = f32[1,31,1]{2,1,0} broadcast(constant.331), dimensions={}
  add.387 = f32[1,31,1]{2,1,0} add(divide.386, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.388 = f32[1,31,1]{2,1,0} sqrt(add.387), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.389 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.388), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.390 = f32[1,31,1]{2,1,0} broadcast(divide.389), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.391 = f32[1,31]{1,0} reshape(broadcast.390), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.392 = f32[1,31,2304]{2,1,0} broadcast(reshape.391), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.393 = f32[1,31,2304]{2,1,0} multiply(multiply.378, broadcast.392), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_3.4 = f32[2304]{0} parameter(3), metadata={op_name="state[1][1]"}
  constant.327 = f32[] constant(1)
  broadcast.328 = f32[2304]{0} broadcast(constant.327), dimensions={}
  add.394 = f32[2304]{0} add(Arg_3.4, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.395 = f32[1,1,2304]{2,1,0} reshape(add.394), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.396 = f32[1,1,2304]{2,1,0} broadcast(reshape.395), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.397 = f32[1,2304]{1,0} reshape(broadcast.396), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.398 = f32[1,31,2304]{2,1,0} broadcast(reshape.397), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.399 = f32[1,31,2304]{2,1,0} multiply(multiply.393, broadcast.398), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_6.7 = f32[4,2304,256]{2,1,0} parameter(6), metadata={op_name="state[1][4]"}
  dot.440 = f32[1,31,4,256]{3,2,1,0} dot(multiply.399, Arg_6.7), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  constant.319 = f32[31]{0} constant({...})
  constant.320 = f32[] constant(1)
  broadcast.321 = f32[128]{0} broadcast(constant.320), dimensions={}
  constant.322 = f32[] constant(10000)
  broadcast.323 = f32[128]{0} broadcast(constant.322), dimensions={}
  constant.324 = f32[128]{0} constant({...})
  power.441 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.442 = f32[128]{0} divide(broadcast.321, power.441), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.443 = f32[31,128]{1,0} dot(constant.319, divide.442), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.444 = f32[31,1,128]{2,1,0} reshape(dot.443), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.445 = f32[31,1,128]{2,1,0} reshape(dot.443), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.446 = f32[31,2,128]{2,1,0} concatenate(reshape.444, reshape.445), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.447 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.446), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.448 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.447), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.457 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.448), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.458 = f32[1,31,256]{2,1,0} reshape(broadcast.457), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.459 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.458), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.460 = f32[1,31,4,256]{3,2,1,0} multiply(dot.440, broadcast.459), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.451 = f32[1,31,4,128]{3,2,1,0} slice(dot.440), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.452 = f32[1,31,4,128]{3,2,1,0} negate(slice.451), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.453 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.452), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.450 = f32[1,31,4,128]{3,2,1,0} slice(dot.440), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.454 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.450), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.455 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.453, reshape.454), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.456 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.455), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.449 = f32[1,31,1,256]{3,2,1,0} sine(reshape.447), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.461 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.449), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.462 = f32[1,31,256]{2,1,0} reshape(broadcast.461), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.463 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.462), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.464 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.456, broadcast.463), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.465 = f32[1,31,4,256]{3,2,1,0} add(multiply.460, multiply.464), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.466 = f32[1,31,4,128]{3,2,1,0} slice(add.465), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.468 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.466), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.467 = f32[1,31,4,128]{3,2,1,0} slice(add.465), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.469 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.467), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.470 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.468, reshape.469), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.473 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.470), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_7.8 = f32[4,2304,256]{2,1,0} parameter(7), metadata={op_name="state[1][5]"}
  dot.472 = f32[1,31,4,256]{3,2,1,0} dot(multiply.399, Arg_7.8), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.474 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.472), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.475 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.473, reshape.474), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6663 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.475), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  constant.326 = f32[31,1]{1,0} constant({...})
  broadcast.400 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.401 = f32[31]{0} reshape(broadcast.400), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.402 = f32[31,31]{1,0} broadcast(reshape.401), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  constant.325 = f32[1,31]{1,0} constant({...})
  broadcast.403 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.404 = f32[31]{0} reshape(broadcast.403), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.405 = f32[31,31]{1,0} broadcast(reshape.404), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.406 = pred[31,31]{1,0} compare(broadcast.402, broadcast.405), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.407 = pred[1,31,31]{2,1,0} reshape(compare.406), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.547 = s32[1,31,31]{2,1,0} convert(reshape.407), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  constant.305 = s32[] constant(0)
  broadcast.306 = s32[1,31,31]{2,1,0} broadcast(constant.305), dimensions={}
  compare.548 = pred[1,31,31]{2,1,0} compare(convert.547, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  constant.340 = pred[] constant(true)
  reduce.553 = pred[1,31]{1,0} reduce(compare.548, constant.340), dimensions={2}, to_apply=region_4.549, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.554 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.553), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  constant.303 = f32[] constant(0)
  broadcast.304 = f32[1,31,8,256]{3,2,1,0} broadcast(constant.303), dimensions={}
  reshape.471 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.470), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_5.6 = f32[8,2304,256]{2,1,0} parameter(5), metadata={op_name="state[1][3]"}
  dot.408 = f32[1,31,8,256]{3,2,1,0} dot(multiply.399, Arg_5.6), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.409 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.410 = f32[128]{0} divide(broadcast.321, power.409), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.411 = f32[31,128]{1,0} dot(constant.319, divide.410), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.412 = f32[31,1,128]{2,1,0} reshape(dot.411), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.413 = f32[31,1,128]{2,1,0} reshape(dot.411), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.414 = f32[31,2,128]{2,1,0} concatenate(reshape.412, reshape.413), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.415 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.414), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.416 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.415), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.425 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.416), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.426 = f32[1,31,256]{2,1,0} reshape(broadcast.425), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.427 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.426), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.428 = f32[1,31,8,256]{3,2,1,0} multiply(dot.408, broadcast.427), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.419 = f32[1,31,8,128]{3,2,1,0} slice(dot.408), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.420 = f32[1,31,8,128]{3,2,1,0} negate(slice.419), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.421 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.420), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.418 = f32[1,31,8,128]{3,2,1,0} slice(dot.408), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.422 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.418), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.423 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.421, reshape.422), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.424 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.423), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.417 = f32[1,31,1,256]{3,2,1,0} sine(reshape.415), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.429 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.417), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.430 = f32[1,31,256]{2,1,0} reshape(broadcast.429), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.431 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.430), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.432 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.424, broadcast.431), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.433 = f32[1,31,8,256]{3,2,1,0} add(multiply.428, multiply.432), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/rotary_embedding/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.434 = f32[1,31,8,128]{3,2,1,0} slice(add.433), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.436 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.434), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.435 = f32[1,31,8,128]{3,2,1,0} slice(add.433), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.437 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.435), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.438 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.436, reshape.437), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.439 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.438), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  constant.317 = f32[] constant(0.0625)
  broadcast.318 = f32[1,31,8,256]{3,2,1,0} broadcast(constant.317), dimensions={}
  multiply.476 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.439, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.477 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.476), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.478 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.471, reshape.477), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.479 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.478), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  constant.315 = f32[] constant(50)
  broadcast.316 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(constant.315), dimensions={}
  divide.480 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.479, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.481 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.480), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.482 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.481, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  constant.311 = f32[] constant(1)
  broadcast.312 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(constant.311), dimensions={}
  constant.313 = pred[] constant(true)
  broadcast.314 = pred[31,31]{1,0} broadcast(constant.313), dimensions={}
  call.496 = pred[31,31]{1,0} call(broadcast.314), to_apply=triu.483
  call.510 = pred[31,31]{1,0} call(broadcast.314), to_apply=tril.497
  and.511 = pred[31,31]{1,0} and(call.496, call.510), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  reshape.512 = pred[1,31,31]{2,1,0} reshape(and.511), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.513 = pred[1,31,31]{2,1,0} and(reshape.407, reshape.512), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.514 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(and.513), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.515 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.514), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.516 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.515), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  constant.309 = f32[] constant(-1e+09)
  broadcast.310 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(constant.309), dimensions={}
  multiply.517 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.516, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.518 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.517), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.519 = f32[1,31,31]{2,1,0} reshape(broadcast.518), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.520 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.519), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.521 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.482, broadcast.520), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  constant.339 = f32[] constant(-inf)
  reduce.526 = f32[1,4,2,31]{3,2,1,0} reduce(add.521, constant.339), dimensions={4}, to_apply=region_2.522, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  constant.307 = f32[] constant(-inf)
  broadcast.308 = f32[1,4,2,31]{3,2,1,0} broadcast(constant.307), dimensions={}
  maximum.527 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.526, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.528 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.527), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.529 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.528), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.530 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.529), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.531 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.530), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.532 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.521, broadcast.531), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.533 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.532), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.538 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.533, constant.342), dimensions={4}, to_apply=region_3.534, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.539 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.538), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.540 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.539), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.541 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.540), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.542 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.541), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.543 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.533, broadcast.542), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/softmax/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.544 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.472, divide.543), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.545 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.544), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.546 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.545), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.563 = f32[1,31,8,256]{3,2,1,0} call(reshape.554, broadcast.304, reshape.546), to_apply=_where_0.555
  Arg_8.9 = f32[8,256,2304]{2,1,0} parameter(8), metadata={op_name="state[1][6]"}
  dot.564 = f32[1,31,2304]{2,1,0} dot(call.563, Arg_8.9), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.565 = f32[1,31,2304]{2,1,0} multiply(dot.564, dot.564), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.570 = f32[1,31]{1,0} reduce(multiply.565, constant.342), dimensions={2}, to_apply=region_5.566, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.571 = f32[1,31,1]{2,1,0} reshape(reduce.570), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.572 = f32[1,31,1]{2,1,0} divide(reshape.571, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.573 = f32[1,31,1]{2,1,0} add(divide.572, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.574 = f32[1,31,1]{2,1,0} sqrt(add.573), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.575 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.574), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.576 = f32[1,31,1]{2,1,0} broadcast(divide.575), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.577 = f32[1,31]{1,0} reshape(broadcast.576), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.578 = f32[1,31,2304]{2,1,0} broadcast(reshape.577), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.579 = f32[1,31,2304]{2,1,0} multiply(dot.564, broadcast.578), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_4.5 = f32[2304]{0} parameter(4), metadata={op_name="state[1][2]"}
  add.580 = f32[2304]{0} add(Arg_4.5, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.581 = f32[1,1,2304]{2,1,0} reshape(add.580), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.582 = f32[1,1,2304]{2,1,0} broadcast(reshape.581), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.583 = f32[1,2304]{1,0} reshape(broadcast.582), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.584 = f32[1,31,2304]{2,1,0} broadcast(reshape.583), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.585 = f32[1,31,2304]{2,1,0} multiply(multiply.579, broadcast.584), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.586 = f32[1,31,2304]{2,1,0} add(multiply.378, multiply.585), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.587 = f32[1,31,2304]{2,1,0} multiply(add.586, add.586), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.592 = f32[1,31]{1,0} reduce(multiply.587, constant.342), dimensions={2}, to_apply=region_6.588, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.593 = f32[1,31,1]{2,1,0} reshape(reduce.592), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.594 = f32[1,31,1]{2,1,0} divide(reshape.593, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.595 = f32[1,31,1]{2,1,0} add(divide.594, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.596 = f32[1,31,1]{2,1,0} sqrt(add.595), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.597 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.596), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.598 = f32[1,31,1]{2,1,0} broadcast(divide.597), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.599 = f32[1,31]{1,0} reshape(broadcast.598), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.600 = f32[1,31,2304]{2,1,0} broadcast(reshape.599), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.601 = f32[1,31,2304]{2,1,0} multiply(add.586, broadcast.600), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_9.10 = f32[2304]{0} parameter(9), metadata={op_name="state[1][7]"}
  add.602 = f32[2304]{0} add(Arg_9.10, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.603 = f32[1,1,2304]{2,1,0} reshape(add.602), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.604 = f32[1,1,2304]{2,1,0} broadcast(reshape.603), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.605 = f32[1,2304]{1,0} reshape(broadcast.604), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.606 = f32[1,31,2304]{2,1,0} broadcast(reshape.605), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.607 = f32[1,31,2304]{2,1,0} multiply(multiply.601, broadcast.606), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_11.12 = f32[2304,9216]{1,0} parameter(11), metadata={op_name="state[1][9]"}
  dot.608 = f32[1,31,9216]{2,1,0} dot(multiply.607, Arg_11.12), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.610 = f32[1,31,9216]{2,1,0} multiply(dot.608, dot.608), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.611 = f32[1,31,9216]{2,1,0} multiply(multiply.610, dot.608), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  constant.301 = f32[] constant(0.044715)
  broadcast.302 = f32[1,31,9216]{2,1,0} broadcast(constant.301), dimensions={}
  multiply.612 = f32[1,31,9216]{2,1,0} multiply(multiply.611, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.613 = f32[1,31,9216]{2,1,0} add(dot.608, multiply.612), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  constant.299 = f32[] constant(0.797884583)
  broadcast.300 = f32[1,31,9216]{2,1,0} broadcast(constant.299), dimensions={}
  multiply.614 = f32[1,31,9216]{2,1,0} multiply(add.613, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.615 = f32[1,31,9216]{2,1,0} tanh(multiply.614), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  constant.297 = f32[] constant(1)
  broadcast.298 = f32[1,31,9216]{2,1,0} broadcast(constant.297), dimensions={}
  add.616 = f32[1,31,9216]{2,1,0} add(tanh.615, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  constant.295 = f32[] constant(0.5)
  broadcast.296 = f32[1,31,9216]{2,1,0} broadcast(constant.295), dimensions={}
  multiply.617 = f32[1,31,9216]{2,1,0} multiply(add.616, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.618 = f32[1,31,9216]{2,1,0} multiply(dot.608, multiply.617), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_12.13 = f32[2304,9216]{1,0} parameter(12), metadata={op_name="state[1][10]"}
  dot.609 = f32[1,31,9216]{2,1,0} dot(multiply.607, Arg_12.13), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.619 = f32[1,31,9216]{2,1,0} multiply(multiply.618, dot.609), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_13.14 = f32[9216,2304]{1,0} parameter(13), metadata={op_name="state[1][11]"}
  dot.620 = f32[1,31,2304]{2,1,0} dot(multiply.619, Arg_13.14), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.621 = f32[1,31,2304]{2,1,0} multiply(dot.620, dot.620), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.626 = f32[1,31]{1,0} reduce(multiply.621, constant.342), dimensions={2}, to_apply=region_7.622, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.627 = f32[1,31,1]{2,1,0} reshape(reduce.626), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.628 = f32[1,31,1]{2,1,0} divide(reshape.627, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.629 = f32[1,31,1]{2,1,0} add(divide.628, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.630 = f32[1,31,1]{2,1,0} sqrt(add.629), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.631 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.630), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.632 = f32[1,31,1]{2,1,0} broadcast(divide.631), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.633 = f32[1,31]{1,0} reshape(broadcast.632), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.634 = f32[1,31,2304]{2,1,0} broadcast(reshape.633), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.635 = f32[1,31,2304]{2,1,0} multiply(dot.620, broadcast.634), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_10.11 = f32[2304]{0} parameter(10), metadata={op_name="state[1][8]"}
  add.636 = f32[2304]{0} add(Arg_10.11, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.637 = f32[1,1,2304]{2,1,0} reshape(add.636), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.638 = f32[1,1,2304]{2,1,0} broadcast(reshape.637), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.639 = f32[1,2304]{1,0} reshape(broadcast.638), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.640 = f32[1,31,2304]{2,1,0} broadcast(reshape.639), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.641 = f32[1,31,2304]{2,1,0} multiply(multiply.635, broadcast.640), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.642 = f32[1,31,2304]{2,1,0} add(multiply.641, add.586), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_0/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.643 = f32[1,31,2304]{2,1,0} multiply(add.642, add.642), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.648 = f32[1,31]{1,0} reduce(multiply.643, constant.342), dimensions={2}, to_apply=region_8.644, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.649 = f32[1,31,1]{2,1,0} reshape(reduce.648), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.650 = f32[1,31,1]{2,1,0} divide(reshape.649, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.651 = f32[1,31,1]{2,1,0} add(divide.650, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.652 = f32[1,31,1]{2,1,0} sqrt(add.651), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.653 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.652), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.654 = f32[1,31,1]{2,1,0} broadcast(divide.653), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.655 = f32[1,31]{1,0} reshape(broadcast.654), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.656 = f32[1,31,2304]{2,1,0} broadcast(reshape.655), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.657 = f32[1,31,2304]{2,1,0} multiply(add.642, broadcast.656), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_14.15 = f32[2304]{0} parameter(14), metadata={op_name="state[1][12]"}
  add.658 = f32[2304]{0} add(Arg_14.15, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.659 = f32[1,1,2304]{2,1,0} reshape(add.658), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.660 = f32[1,1,2304]{2,1,0} broadcast(reshape.659), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.661 = f32[1,2304]{1,0} reshape(broadcast.660), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.662 = f32[1,31,2304]{2,1,0} broadcast(reshape.661), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.663 = f32[1,31,2304]{2,1,0} multiply(multiply.657, broadcast.662), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_17.18 = f32[4,2304,256]{2,1,0} parameter(17), metadata={op_name="state[1][15]"}
  dot.704 = f32[1,31,4,256]{3,2,1,0} dot(multiply.663, Arg_17.18), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.705 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.706 = f32[128]{0} divide(broadcast.321, power.705), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.707 = f32[31,128]{1,0} dot(constant.319, divide.706), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.708 = f32[31,1,128]{2,1,0} reshape(dot.707), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.709 = f32[31,1,128]{2,1,0} reshape(dot.707), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.710 = f32[31,2,128]{2,1,0} concatenate(reshape.708, reshape.709), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.711 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.710), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.712 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.711), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.721 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.712), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.722 = f32[1,31,256]{2,1,0} reshape(broadcast.721), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.723 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.722), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.724 = f32[1,31,4,256]{3,2,1,0} multiply(dot.704, broadcast.723), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.715 = f32[1,31,4,128]{3,2,1,0} slice(dot.704), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.716 = f32[1,31,4,128]{3,2,1,0} negate(slice.715), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.717 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.716), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.714 = f32[1,31,4,128]{3,2,1,0} slice(dot.704), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.718 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.714), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.719 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.717, reshape.718), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.720 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.719), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.713 = f32[1,31,1,256]{3,2,1,0} sine(reshape.711), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.725 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.713), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.726 = f32[1,31,256]{2,1,0} reshape(broadcast.725), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.727 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.726), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.728 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.720, broadcast.727), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.729 = f32[1,31,4,256]{3,2,1,0} add(multiply.724, multiply.728), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.730 = f32[1,31,4,128]{3,2,1,0} slice(add.729), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.732 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.730), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.731 = f32[1,31,4,128]{3,2,1,0} slice(add.729), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.733 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.731), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.734 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.732, reshape.733), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.737 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.734), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_18.19 = f32[4,2304,256]{2,1,0} parameter(18), metadata={op_name="state[1][16]"}
  dot.736 = f32[1,31,4,256]{3,2,1,0} dot(multiply.663, Arg_18.19), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.738 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.736), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.739 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.737, reshape.738), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6664 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.739), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.664 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.665 = f32[31]{0} reshape(broadcast.664), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.666 = f32[31,31]{1,0} broadcast(reshape.665), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.667 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.668 = f32[31]{0} reshape(broadcast.667), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.669 = f32[31,31]{1,0} broadcast(reshape.668), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.670 = pred[31,31]{1,0} compare(broadcast.666, broadcast.669), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.671 = pred[1,31,31]{2,1,0} reshape(compare.670), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.780 = s32[1,31,31]{2,1,0} convert(reshape.671), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.781 = pred[1,31,31]{2,1,0} compare(convert.780, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.786 = pred[1,31]{1,0} reduce(compare.781, constant.340), dimensions={2}, to_apply=region_11.782, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.787 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.786), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.735 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.734), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_16.17 = f32[8,2304,256]{2,1,0} parameter(16), metadata={op_name="state[1][14]"}
  dot.672 = f32[1,31,8,256]{3,2,1,0} dot(multiply.663, Arg_16.17), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.673 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.674 = f32[128]{0} divide(broadcast.321, power.673), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.675 = f32[31,128]{1,0} dot(constant.319, divide.674), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.676 = f32[31,1,128]{2,1,0} reshape(dot.675), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.677 = f32[31,1,128]{2,1,0} reshape(dot.675), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.678 = f32[31,2,128]{2,1,0} concatenate(reshape.676, reshape.677), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.679 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.678), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.680 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.679), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.689 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.680), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.690 = f32[1,31,256]{2,1,0} reshape(broadcast.689), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.691 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.690), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.692 = f32[1,31,8,256]{3,2,1,0} multiply(dot.672, broadcast.691), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.683 = f32[1,31,8,128]{3,2,1,0} slice(dot.672), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.684 = f32[1,31,8,128]{3,2,1,0} negate(slice.683), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.685 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.684), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.682 = f32[1,31,8,128]{3,2,1,0} slice(dot.672), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.686 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.682), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.687 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.685, reshape.686), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.688 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.687), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.681 = f32[1,31,1,256]{3,2,1,0} sine(reshape.679), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.693 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.681), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.694 = f32[1,31,256]{2,1,0} reshape(broadcast.693), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.695 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.694), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.696 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.688, broadcast.695), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.697 = f32[1,31,8,256]{3,2,1,0} add(multiply.692, multiply.696), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/rotary_embedding_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.698 = f32[1,31,8,128]{3,2,1,0} slice(add.697), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.700 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.698), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.699 = f32[1,31,8,128]{3,2,1,0} slice(add.697), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.701 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.699), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.702 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.700, reshape.701), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.703 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.702), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.740 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.703, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.741 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.740), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.742 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.735, reshape.741), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.743 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.742), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.744 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.743, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.745 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.744), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.746 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.745, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.747 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(compare.670), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.748 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.747), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.749 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.748), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.750 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.749, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.751 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.750), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.752 = f32[1,31,31]{2,1,0} reshape(broadcast.751), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.753 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.752), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.754 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.746, broadcast.753), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.759 = f32[1,4,2,31]{3,2,1,0} reduce(add.754, constant.339), dimensions={4}, to_apply=region_9.755, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.760 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.759, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.761 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.760), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.762 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.761), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.763 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.762), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.764 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.763), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.765 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.754, broadcast.764), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.766 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.765), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.771 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.766, constant.342), dimensions={4}, to_apply=region_10.767, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.772 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.771), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.773 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.772), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.774 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.773), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.775 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.774), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.776 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.766, broadcast.775), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/softmax_1/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.777 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.736, divide.776), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.778 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.777), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.779 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.778), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.796 = f32[1,31,8,256]{3,2,1,0} call(reshape.787, broadcast.304, reshape.779), to_apply=_where_0.788
  Arg_19.20 = f32[8,256,2304]{2,1,0} parameter(19), metadata={op_name="state[1][17]"}
  dot.797 = f32[1,31,2304]{2,1,0} dot(call.796, Arg_19.20), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.798 = f32[1,31,2304]{2,1,0} multiply(dot.797, dot.797), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.803 = f32[1,31]{1,0} reduce(multiply.798, constant.342), dimensions={2}, to_apply=region_12.799, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.804 = f32[1,31,1]{2,1,0} reshape(reduce.803), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.805 = f32[1,31,1]{2,1,0} divide(reshape.804, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.806 = f32[1,31,1]{2,1,0} add(divide.805, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.807 = f32[1,31,1]{2,1,0} sqrt(add.806), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.808 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.807), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.809 = f32[1,31,1]{2,1,0} broadcast(divide.808), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.810 = f32[1,31]{1,0} reshape(broadcast.809), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.811 = f32[1,31,2304]{2,1,0} broadcast(reshape.810), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.812 = f32[1,31,2304]{2,1,0} multiply(dot.797, broadcast.811), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_15.16 = f32[2304]{0} parameter(15), metadata={op_name="state[1][13]"}
  add.813 = f32[2304]{0} add(Arg_15.16, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.814 = f32[1,1,2304]{2,1,0} reshape(add.813), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.815 = f32[1,1,2304]{2,1,0} broadcast(reshape.814), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.816 = f32[1,2304]{1,0} reshape(broadcast.815), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.817 = f32[1,31,2304]{2,1,0} broadcast(reshape.816), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.818 = f32[1,31,2304]{2,1,0} multiply(multiply.812, broadcast.817), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.819 = f32[1,31,2304]{2,1,0} add(add.642, multiply.818), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.820 = f32[1,31,2304]{2,1,0} multiply(add.819, add.819), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.825 = f32[1,31]{1,0} reduce(multiply.820, constant.342), dimensions={2}, to_apply=region_13.821, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.826 = f32[1,31,1]{2,1,0} reshape(reduce.825), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.827 = f32[1,31,1]{2,1,0} divide(reshape.826, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.828 = f32[1,31,1]{2,1,0} add(divide.827, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.829 = f32[1,31,1]{2,1,0} sqrt(add.828), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.830 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.829), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.831 = f32[1,31,1]{2,1,0} broadcast(divide.830), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.832 = f32[1,31]{1,0} reshape(broadcast.831), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.833 = f32[1,31,2304]{2,1,0} broadcast(reshape.832), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.834 = f32[1,31,2304]{2,1,0} multiply(add.819, broadcast.833), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_20.21 = f32[2304]{0} parameter(20), metadata={op_name="state[1][18]"}
  add.835 = f32[2304]{0} add(Arg_20.21, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.836 = f32[1,1,2304]{2,1,0} reshape(add.835), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.837 = f32[1,1,2304]{2,1,0} broadcast(reshape.836), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.838 = f32[1,2304]{1,0} reshape(broadcast.837), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.839 = f32[1,31,2304]{2,1,0} broadcast(reshape.838), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.840 = f32[1,31,2304]{2,1,0} multiply(multiply.834, broadcast.839), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_22.23 = f32[2304,9216]{1,0} parameter(22), metadata={op_name="state[1][20]"}
  dot.841 = f32[1,31,9216]{2,1,0} dot(multiply.840, Arg_22.23), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.843 = f32[1,31,9216]{2,1,0} multiply(dot.841, dot.841), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.844 = f32[1,31,9216]{2,1,0} multiply(multiply.843, dot.841), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.845 = f32[1,31,9216]{2,1,0} multiply(multiply.844, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.846 = f32[1,31,9216]{2,1,0} add(dot.841, multiply.845), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.847 = f32[1,31,9216]{2,1,0} multiply(add.846, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.848 = f32[1,31,9216]{2,1,0} tanh(multiply.847), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.849 = f32[1,31,9216]{2,1,0} add(tanh.848, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.850 = f32[1,31,9216]{2,1,0} multiply(add.849, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.851 = f32[1,31,9216]{2,1,0} multiply(dot.841, multiply.850), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_23.24 = f32[2304,9216]{1,0} parameter(23), metadata={op_name="state[1][21]"}
  dot.842 = f32[1,31,9216]{2,1,0} dot(multiply.840, Arg_23.24), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.852 = f32[1,31,9216]{2,1,0} multiply(multiply.851, dot.842), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_24.25 = f32[9216,2304]{1,0} parameter(24), metadata={op_name="state[1][22]"}
  dot.853 = f32[1,31,2304]{2,1,0} dot(multiply.852, Arg_24.25), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.854 = f32[1,31,2304]{2,1,0} multiply(dot.853, dot.853), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.859 = f32[1,31]{1,0} reduce(multiply.854, constant.342), dimensions={2}, to_apply=region_14.855, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.860 = f32[1,31,1]{2,1,0} reshape(reduce.859), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.861 = f32[1,31,1]{2,1,0} divide(reshape.860, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.862 = f32[1,31,1]{2,1,0} add(divide.861, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.863 = f32[1,31,1]{2,1,0} sqrt(add.862), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.864 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.863), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.865 = f32[1,31,1]{2,1,0} broadcast(divide.864), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.866 = f32[1,31]{1,0} reshape(broadcast.865), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.867 = f32[1,31,2304]{2,1,0} broadcast(reshape.866), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.868 = f32[1,31,2304]{2,1,0} multiply(dot.853, broadcast.867), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_21.22 = f32[2304]{0} parameter(21), metadata={op_name="state[1][19]"}
  add.869 = f32[2304]{0} add(Arg_21.22, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.870 = f32[1,1,2304]{2,1,0} reshape(add.869), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.871 = f32[1,1,2304]{2,1,0} broadcast(reshape.870), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.872 = f32[1,2304]{1,0} reshape(broadcast.871), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.873 = f32[1,31,2304]{2,1,0} broadcast(reshape.872), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.874 = f32[1,31,2304]{2,1,0} multiply(multiply.868, broadcast.873), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.875 = f32[1,31,2304]{2,1,0} add(multiply.874, add.819), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_1/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.876 = f32[1,31,2304]{2,1,0} multiply(add.875, add.875), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.881 = f32[1,31]{1,0} reduce(multiply.876, constant.342), dimensions={2}, to_apply=region_15.877, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.882 = f32[1,31,1]{2,1,0} reshape(reduce.881), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.883 = f32[1,31,1]{2,1,0} divide(reshape.882, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.884 = f32[1,31,1]{2,1,0} add(divide.883, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.885 = f32[1,31,1]{2,1,0} sqrt(add.884), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.886 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.885), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.887 = f32[1,31,1]{2,1,0} broadcast(divide.886), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.888 = f32[1,31]{1,0} reshape(broadcast.887), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.889 = f32[1,31,2304]{2,1,0} broadcast(reshape.888), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.890 = f32[1,31,2304]{2,1,0} multiply(add.875, broadcast.889), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_25.26 = f32[2304]{0} parameter(25), metadata={op_name="state[1][23]"}
  add.891 = f32[2304]{0} add(Arg_25.26, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.892 = f32[1,1,2304]{2,1,0} reshape(add.891), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.893 = f32[1,1,2304]{2,1,0} broadcast(reshape.892), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.894 = f32[1,2304]{1,0} reshape(broadcast.893), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.895 = f32[1,31,2304]{2,1,0} broadcast(reshape.894), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.896 = f32[1,31,2304]{2,1,0} multiply(multiply.890, broadcast.895), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_28.29 = f32[4,2304,256]{2,1,0} parameter(28), metadata={op_name="state[1][26]"}
  dot.937 = f32[1,31,4,256]{3,2,1,0} dot(multiply.896, Arg_28.29), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.938 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.939 = f32[128]{0} divide(broadcast.321, power.938), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.940 = f32[31,128]{1,0} dot(constant.319, divide.939), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.941 = f32[31,1,128]{2,1,0} reshape(dot.940), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.942 = f32[31,1,128]{2,1,0} reshape(dot.940), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.943 = f32[31,2,128]{2,1,0} concatenate(reshape.941, reshape.942), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.944 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.943), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.945 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.944), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.954 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.945), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.955 = f32[1,31,256]{2,1,0} reshape(broadcast.954), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.956 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.955), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.957 = f32[1,31,4,256]{3,2,1,0} multiply(dot.937, broadcast.956), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.948 = f32[1,31,4,128]{3,2,1,0} slice(dot.937), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.949 = f32[1,31,4,128]{3,2,1,0} negate(slice.948), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.950 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.949), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.947 = f32[1,31,4,128]{3,2,1,0} slice(dot.937), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.951 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.947), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.952 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.950, reshape.951), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.953 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.952), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.946 = f32[1,31,1,256]{3,2,1,0} sine(reshape.944), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.958 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.946), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.959 = f32[1,31,256]{2,1,0} reshape(broadcast.958), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.960 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.959), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.961 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.953, broadcast.960), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.962 = f32[1,31,4,256]{3,2,1,0} add(multiply.957, multiply.961), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.963 = f32[1,31,4,128]{3,2,1,0} slice(add.962), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.965 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.963), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.964 = f32[1,31,4,128]{3,2,1,0} slice(add.962), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.966 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.964), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.967 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.965, reshape.966), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.970 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.967), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_29.30 = f32[4,2304,256]{2,1,0} parameter(29), metadata={op_name="state[1][27]"}
  dot.969 = f32[1,31,4,256]{3,2,1,0} dot(multiply.896, Arg_29.30), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.971 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.969), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.972 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.970, reshape.971), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6665 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.972), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.897 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.898 = f32[31]{0} reshape(broadcast.897), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.899 = f32[31,31]{1,0} broadcast(reshape.898), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.900 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.901 = f32[31]{0} reshape(broadcast.900), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.902 = f32[31,31]{1,0} broadcast(reshape.901), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.903 = pred[31,31]{1,0} compare(broadcast.899, broadcast.902), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.904 = pred[1,31,31]{2,1,0} reshape(compare.903), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.1044 = s32[1,31,31]{2,1,0} convert(reshape.904), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.1045 = pred[1,31,31]{2,1,0} compare(convert.1044, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.1050 = pred[1,31]{1,0} reduce(compare.1045, constant.340), dimensions={2}, to_apply=region_18.1046, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.1051 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.1050), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.968 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.967), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_27.28 = f32[8,2304,256]{2,1,0} parameter(27), metadata={op_name="state[1][25]"}
  dot.905 = f32[1,31,8,256]{3,2,1,0} dot(multiply.896, Arg_27.28), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.906 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.907 = f32[128]{0} divide(broadcast.321, power.906), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.908 = f32[31,128]{1,0} dot(constant.319, divide.907), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.909 = f32[31,1,128]{2,1,0} reshape(dot.908), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.910 = f32[31,1,128]{2,1,0} reshape(dot.908), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.911 = f32[31,2,128]{2,1,0} concatenate(reshape.909, reshape.910), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.912 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.911), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.913 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.912), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.922 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.913), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.923 = f32[1,31,256]{2,1,0} reshape(broadcast.922), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.924 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.923), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.925 = f32[1,31,8,256]{3,2,1,0} multiply(dot.905, broadcast.924), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.916 = f32[1,31,8,128]{3,2,1,0} slice(dot.905), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.917 = f32[1,31,8,128]{3,2,1,0} negate(slice.916), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.918 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.917), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.915 = f32[1,31,8,128]{3,2,1,0} slice(dot.905), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.919 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.915), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.920 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.918, reshape.919), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.921 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.920), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.914 = f32[1,31,1,256]{3,2,1,0} sine(reshape.912), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.926 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.914), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.927 = f32[1,31,256]{2,1,0} reshape(broadcast.926), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.928 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.927), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.929 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.921, broadcast.928), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.930 = f32[1,31,8,256]{3,2,1,0} add(multiply.925, multiply.929), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/rotary_embedding_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.931 = f32[1,31,8,128]{3,2,1,0} slice(add.930), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.933 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.931), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.932 = f32[1,31,8,128]{3,2,1,0} slice(add.930), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.934 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.932), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.935 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.933, reshape.934), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.936 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.935), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.973 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.936, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.974 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.973), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.975 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.968, reshape.974), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.976 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.975), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.977 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.976, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.978 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.977), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.979 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.978, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.993 = pred[31,31]{1,0} call(broadcast.314), to_apply=triu.980
  call.1007 = pred[31,31]{1,0} call(broadcast.314), to_apply=tril.994
  and.1008 = pred[31,31]{1,0} and(call.993, call.1007), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  reshape.1009 = pred[1,31,31]{2,1,0} reshape(and.1008), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.1010 = pred[1,31,31]{2,1,0} and(reshape.904, reshape.1009), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.1011 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(and.1010), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.1012 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.1011), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.1013 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.1012), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.1014 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.1013, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.1015 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.1014), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.1016 = f32[1,31,31]{2,1,0} reshape(broadcast.1015), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.1017 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.1016), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.1018 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.979, broadcast.1017), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.1023 = f32[1,4,2,31]{3,2,1,0} reduce(add.1018, constant.339), dimensions={4}, to_apply=region_16.1019, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.1024 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.1023, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.1025 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.1024), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.1026 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.1025), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.1027 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.1026), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.1028 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.1027), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.1029 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.1018, broadcast.1028), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.1030 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.1029), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.1035 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.1030, constant.342), dimensions={4}, to_apply=region_17.1031, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.1036 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.1035), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.1037 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.1036), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.1038 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.1037), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.1039 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.1038), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.1040 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.1030, broadcast.1039), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/softmax_2/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.1041 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.969, divide.1040), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.1042 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.1041), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.1043 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.1042), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.1060 = f32[1,31,8,256]{3,2,1,0} call(reshape.1051, broadcast.304, reshape.1043), to_apply=_where_0.1052
  Arg_30.31 = f32[8,256,2304]{2,1,0} parameter(30), metadata={op_name="state[1][28]"}
  dot.1061 = f32[1,31,2304]{2,1,0} dot(call.1060, Arg_30.31), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.1062 = f32[1,31,2304]{2,1,0} multiply(dot.1061, dot.1061), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.1067 = f32[1,31]{1,0} reduce(multiply.1062, constant.342), dimensions={2}, to_apply=region_19.1063, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.1068 = f32[1,31,1]{2,1,0} reshape(reduce.1067), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.1069 = f32[1,31,1]{2,1,0} divide(reshape.1068, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.1070 = f32[1,31,1]{2,1,0} add(divide.1069, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.1071 = f32[1,31,1]{2,1,0} sqrt(add.1070), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.1072 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.1071), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.1073 = f32[1,31,1]{2,1,0} broadcast(divide.1072), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.1074 = f32[1,31]{1,0} reshape(broadcast.1073), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.1075 = f32[1,31,2304]{2,1,0} broadcast(reshape.1074), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.1076 = f32[1,31,2304]{2,1,0} multiply(dot.1061, broadcast.1075), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_26.27 = f32[2304]{0} parameter(26), metadata={op_name="state[1][24]"}
  add.1077 = f32[2304]{0} add(Arg_26.27, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1078 = f32[1,1,2304]{2,1,0} reshape(add.1077), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1079 = f32[1,1,2304]{2,1,0} broadcast(reshape.1078), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1080 = f32[1,2304]{1,0} reshape(broadcast.1079), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1081 = f32[1,31,2304]{2,1,0} broadcast(reshape.1080), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.1082 = f32[1,31,2304]{2,1,0} multiply(multiply.1076, broadcast.1081), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.1083 = f32[1,31,2304]{2,1,0} add(add.875, multiply.1082), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.1084 = f32[1,31,2304]{2,1,0} multiply(add.1083, add.1083), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.1089 = f32[1,31]{1,0} reduce(multiply.1084, constant.342), dimensions={2}, to_apply=region_20.1085, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.1090 = f32[1,31,1]{2,1,0} reshape(reduce.1089), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.1091 = f32[1,31,1]{2,1,0} divide(reshape.1090, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.1092 = f32[1,31,1]{2,1,0} add(divide.1091, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.1093 = f32[1,31,1]{2,1,0} sqrt(add.1092), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.1094 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.1093), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.1095 = f32[1,31,1]{2,1,0} broadcast(divide.1094), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.1096 = f32[1,31]{1,0} reshape(broadcast.1095), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.1097 = f32[1,31,2304]{2,1,0} broadcast(reshape.1096), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.1098 = f32[1,31,2304]{2,1,0} multiply(add.1083, broadcast.1097), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_31.32 = f32[2304]{0} parameter(31), metadata={op_name="state[1][29]"}
  add.1099 = f32[2304]{0} add(Arg_31.32, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1100 = f32[1,1,2304]{2,1,0} reshape(add.1099), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1101 = f32[1,1,2304]{2,1,0} broadcast(reshape.1100), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1102 = f32[1,2304]{1,0} reshape(broadcast.1101), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1103 = f32[1,31,2304]{2,1,0} broadcast(reshape.1102), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.1104 = f32[1,31,2304]{2,1,0} multiply(multiply.1098, broadcast.1103), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_33.34 = f32[2304,9216]{1,0} parameter(33), metadata={op_name="state[1][31]"}
  dot.1105 = f32[1,31,9216]{2,1,0} dot(multiply.1104, Arg_33.34), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.1107 = f32[1,31,9216]{2,1,0} multiply(dot.1105, dot.1105), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1108 = f32[1,31,9216]{2,1,0} multiply(multiply.1107, dot.1105), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1109 = f32[1,31,9216]{2,1,0} multiply(multiply.1108, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.1110 = f32[1,31,9216]{2,1,0} add(dot.1105, multiply.1109), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1111 = f32[1,31,9216]{2,1,0} multiply(add.1110, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.1112 = f32[1,31,9216]{2,1,0} tanh(multiply.1111), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.1113 = f32[1,31,9216]{2,1,0} add(tanh.1112, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1114 = f32[1,31,9216]{2,1,0} multiply(add.1113, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1115 = f32[1,31,9216]{2,1,0} multiply(dot.1105, multiply.1114), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_34.35 = f32[2304,9216]{1,0} parameter(34), metadata={op_name="state[1][32]"}
  dot.1106 = f32[1,31,9216]{2,1,0} dot(multiply.1104, Arg_34.35), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.1116 = f32[1,31,9216]{2,1,0} multiply(multiply.1115, dot.1106), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_35.36 = f32[9216,2304]{1,0} parameter(35), metadata={op_name="state[1][33]"}
  dot.1117 = f32[1,31,2304]{2,1,0} dot(multiply.1116, Arg_35.36), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.1118 = f32[1,31,2304]{2,1,0} multiply(dot.1117, dot.1117), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.1123 = f32[1,31]{1,0} reduce(multiply.1118, constant.342), dimensions={2}, to_apply=region_21.1119, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.1124 = f32[1,31,1]{2,1,0} reshape(reduce.1123), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.1125 = f32[1,31,1]{2,1,0} divide(reshape.1124, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.1126 = f32[1,31,1]{2,1,0} add(divide.1125, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.1127 = f32[1,31,1]{2,1,0} sqrt(add.1126), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.1128 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.1127), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.1129 = f32[1,31,1]{2,1,0} broadcast(divide.1128), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.1130 = f32[1,31]{1,0} reshape(broadcast.1129), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.1131 = f32[1,31,2304]{2,1,0} broadcast(reshape.1130), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.1132 = f32[1,31,2304]{2,1,0} multiply(dot.1117, broadcast.1131), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_32.33 = f32[2304]{0} parameter(32), metadata={op_name="state[1][30]"}
  add.1133 = f32[2304]{0} add(Arg_32.33, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1134 = f32[1,1,2304]{2,1,0} reshape(add.1133), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1135 = f32[1,1,2304]{2,1,0} broadcast(reshape.1134), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1136 = f32[1,2304]{1,0} reshape(broadcast.1135), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1137 = f32[1,31,2304]{2,1,0} broadcast(reshape.1136), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.1138 = f32[1,31,2304]{2,1,0} multiply(multiply.1132, broadcast.1137), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.1139 = f32[1,31,2304]{2,1,0} add(multiply.1138, add.1083), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_2/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.1140 = f32[1,31,2304]{2,1,0} multiply(add.1139, add.1139), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.1145 = f32[1,31]{1,0} reduce(multiply.1140, constant.342), dimensions={2}, to_apply=region_22.1141, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.1146 = f32[1,31,1]{2,1,0} reshape(reduce.1145), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.1147 = f32[1,31,1]{2,1,0} divide(reshape.1146, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.1148 = f32[1,31,1]{2,1,0} add(divide.1147, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.1149 = f32[1,31,1]{2,1,0} sqrt(add.1148), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.1150 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.1149), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.1151 = f32[1,31,1]{2,1,0} broadcast(divide.1150), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.1152 = f32[1,31]{1,0} reshape(broadcast.1151), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.1153 = f32[1,31,2304]{2,1,0} broadcast(reshape.1152), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.1154 = f32[1,31,2304]{2,1,0} multiply(add.1139, broadcast.1153), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_36.37 = f32[2304]{0} parameter(36), metadata={op_name="state[1][34]"}
  add.1155 = f32[2304]{0} add(Arg_36.37, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1156 = f32[1,1,2304]{2,1,0} reshape(add.1155), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1157 = f32[1,1,2304]{2,1,0} broadcast(reshape.1156), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1158 = f32[1,2304]{1,0} reshape(broadcast.1157), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1159 = f32[1,31,2304]{2,1,0} broadcast(reshape.1158), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.1160 = f32[1,31,2304]{2,1,0} multiply(multiply.1154, broadcast.1159), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_39.40 = f32[4,2304,256]{2,1,0} parameter(39), metadata={op_name="state[1][37]"}
  dot.1201 = f32[1,31,4,256]{3,2,1,0} dot(multiply.1160, Arg_39.40), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.1202 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.1203 = f32[128]{0} divide(broadcast.321, power.1202), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.1204 = f32[31,128]{1,0} dot(constant.319, divide.1203), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.1205 = f32[31,1,128]{2,1,0} reshape(dot.1204), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1206 = f32[31,1,128]{2,1,0} reshape(dot.1204), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1207 = f32[31,2,128]{2,1,0} concatenate(reshape.1205, reshape.1206), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1208 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.1207), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.1209 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.1208), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.1218 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.1209), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.1219 = f32[1,31,256]{2,1,0} reshape(broadcast.1218), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.1220 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.1219), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.1221 = f32[1,31,4,256]{3,2,1,0} multiply(dot.1201, broadcast.1220), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.1212 = f32[1,31,4,128]{3,2,1,0} slice(dot.1201), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.1213 = f32[1,31,4,128]{3,2,1,0} negate(slice.1212), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.1214 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.1213), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.1211 = f32[1,31,4,128]{3,2,1,0} slice(dot.1201), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1215 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.1211), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1216 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.1214, reshape.1215), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1217 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.1216), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.1210 = f32[1,31,1,256]{3,2,1,0} sine(reshape.1208), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.1222 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.1210), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.1223 = f32[1,31,256]{2,1,0} reshape(broadcast.1222), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.1224 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.1223), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.1225 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.1217, broadcast.1224), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.1226 = f32[1,31,4,256]{3,2,1,0} add(multiply.1221, multiply.1225), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.1227 = f32[1,31,4,128]{3,2,1,0} slice(add.1226), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1229 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.1227), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.1228 = f32[1,31,4,128]{3,2,1,0} slice(add.1226), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1230 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.1228), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1231 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.1229, reshape.1230), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1234 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.1231), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_40.41 = f32[4,2304,256]{2,1,0} parameter(40), metadata={op_name="state[1][38]"}
  dot.1233 = f32[1,31,4,256]{3,2,1,0} dot(multiply.1160, Arg_40.41), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.1235 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.1233), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1236 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.1234, reshape.1235), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6666 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.1236), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.1161 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.1162 = f32[31]{0} reshape(broadcast.1161), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.1163 = f32[31,31]{1,0} broadcast(reshape.1162), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.1164 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.1165 = f32[31]{0} reshape(broadcast.1164), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.1166 = f32[31,31]{1,0} broadcast(reshape.1165), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.1167 = pred[31,31]{1,0} compare(broadcast.1163, broadcast.1166), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.1168 = pred[1,31,31]{2,1,0} reshape(compare.1167), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.1277 = s32[1,31,31]{2,1,0} convert(reshape.1168), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.1278 = pred[1,31,31]{2,1,0} compare(convert.1277, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.1283 = pred[1,31]{1,0} reduce(compare.1278, constant.340), dimensions={2}, to_apply=region_25.1279, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.1284 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.1283), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.1232 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.1231), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_38.39 = f32[8,2304,256]{2,1,0} parameter(38), metadata={op_name="state[1][36]"}
  dot.1169 = f32[1,31,8,256]{3,2,1,0} dot(multiply.1160, Arg_38.39), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.1170 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.1171 = f32[128]{0} divide(broadcast.321, power.1170), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.1172 = f32[31,128]{1,0} dot(constant.319, divide.1171), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.1173 = f32[31,1,128]{2,1,0} reshape(dot.1172), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1174 = f32[31,1,128]{2,1,0} reshape(dot.1172), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1175 = f32[31,2,128]{2,1,0} concatenate(reshape.1173, reshape.1174), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1176 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.1175), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.1177 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.1176), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.1186 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.1177), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.1187 = f32[1,31,256]{2,1,0} reshape(broadcast.1186), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.1188 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.1187), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.1189 = f32[1,31,8,256]{3,2,1,0} multiply(dot.1169, broadcast.1188), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.1180 = f32[1,31,8,128]{3,2,1,0} slice(dot.1169), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.1181 = f32[1,31,8,128]{3,2,1,0} negate(slice.1180), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.1182 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.1181), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.1179 = f32[1,31,8,128]{3,2,1,0} slice(dot.1169), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1183 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.1179), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1184 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.1182, reshape.1183), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1185 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.1184), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.1178 = f32[1,31,1,256]{3,2,1,0} sine(reshape.1176), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.1190 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.1178), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.1191 = f32[1,31,256]{2,1,0} reshape(broadcast.1190), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.1192 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.1191), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.1193 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.1185, broadcast.1192), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.1194 = f32[1,31,8,256]{3,2,1,0} add(multiply.1189, multiply.1193), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/rotary_embedding_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.1195 = f32[1,31,8,128]{3,2,1,0} slice(add.1194), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1197 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.1195), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.1196 = f32[1,31,8,128]{3,2,1,0} slice(add.1194), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1198 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.1196), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1199 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.1197, reshape.1198), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1200 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.1199), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.1237 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.1200, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.1238 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.1237), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.1239 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.1232, reshape.1238), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.1240 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.1239), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.1241 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.1240, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.1242 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.1241), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.1243 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.1242, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.1244 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(compare.1167), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.1245 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.1244), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.1246 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.1245), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.1247 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.1246, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.1248 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.1247), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.1249 = f32[1,31,31]{2,1,0} reshape(broadcast.1248), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.1250 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.1249), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.1251 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.1243, broadcast.1250), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.1256 = f32[1,4,2,31]{3,2,1,0} reduce(add.1251, constant.339), dimensions={4}, to_apply=region_23.1252, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.1257 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.1256, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.1258 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.1257), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.1259 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.1258), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.1260 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.1259), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.1261 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.1260), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.1262 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.1251, broadcast.1261), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.1263 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.1262), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.1268 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.1263, constant.342), dimensions={4}, to_apply=region_24.1264, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.1269 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.1268), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.1270 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.1269), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.1271 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.1270), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.1272 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.1271), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.1273 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.1263, broadcast.1272), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/softmax_3/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.1274 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.1233, divide.1273), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.1275 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.1274), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.1276 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.1275), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.1293 = f32[1,31,8,256]{3,2,1,0} call(reshape.1284, broadcast.304, reshape.1276), to_apply=_where_0.1285
  Arg_41.42 = f32[8,256,2304]{2,1,0} parameter(41), metadata={op_name="state[1][39]"}
  dot.1294 = f32[1,31,2304]{2,1,0} dot(call.1293, Arg_41.42), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.1295 = f32[1,31,2304]{2,1,0} multiply(dot.1294, dot.1294), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.1300 = f32[1,31]{1,0} reduce(multiply.1295, constant.342), dimensions={2}, to_apply=region_26.1296, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.1301 = f32[1,31,1]{2,1,0} reshape(reduce.1300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.1302 = f32[1,31,1]{2,1,0} divide(reshape.1301, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.1303 = f32[1,31,1]{2,1,0} add(divide.1302, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.1304 = f32[1,31,1]{2,1,0} sqrt(add.1303), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.1305 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.1304), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.1306 = f32[1,31,1]{2,1,0} broadcast(divide.1305), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.1307 = f32[1,31]{1,0} reshape(broadcast.1306), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.1308 = f32[1,31,2304]{2,1,0} broadcast(reshape.1307), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.1309 = f32[1,31,2304]{2,1,0} multiply(dot.1294, broadcast.1308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_37.38 = f32[2304]{0} parameter(37), metadata={op_name="state[1][35]"}
  add.1310 = f32[2304]{0} add(Arg_37.38, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1311 = f32[1,1,2304]{2,1,0} reshape(add.1310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1312 = f32[1,1,2304]{2,1,0} broadcast(reshape.1311), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1313 = f32[1,2304]{1,0} reshape(broadcast.1312), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1314 = f32[1,31,2304]{2,1,0} broadcast(reshape.1313), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.1315 = f32[1,31,2304]{2,1,0} multiply(multiply.1309, broadcast.1314), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.1316 = f32[1,31,2304]{2,1,0} add(add.1139, multiply.1315), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.1317 = f32[1,31,2304]{2,1,0} multiply(add.1316, add.1316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.1322 = f32[1,31]{1,0} reduce(multiply.1317, constant.342), dimensions={2}, to_apply=region_27.1318, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.1323 = f32[1,31,1]{2,1,0} reshape(reduce.1322), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.1324 = f32[1,31,1]{2,1,0} divide(reshape.1323, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.1325 = f32[1,31,1]{2,1,0} add(divide.1324, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.1326 = f32[1,31,1]{2,1,0} sqrt(add.1325), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.1327 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.1326), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.1328 = f32[1,31,1]{2,1,0} broadcast(divide.1327), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.1329 = f32[1,31]{1,0} reshape(broadcast.1328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.1330 = f32[1,31,2304]{2,1,0} broadcast(reshape.1329), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.1331 = f32[1,31,2304]{2,1,0} multiply(add.1316, broadcast.1330), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_42.43 = f32[2304]{0} parameter(42), metadata={op_name="state[1][40]"}
  add.1332 = f32[2304]{0} add(Arg_42.43, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1333 = f32[1,1,2304]{2,1,0} reshape(add.1332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1334 = f32[1,1,2304]{2,1,0} broadcast(reshape.1333), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1335 = f32[1,2304]{1,0} reshape(broadcast.1334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1336 = f32[1,31,2304]{2,1,0} broadcast(reshape.1335), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.1337 = f32[1,31,2304]{2,1,0} multiply(multiply.1331, broadcast.1336), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_44.45 = f32[2304,9216]{1,0} parameter(44), metadata={op_name="state[1][42]"}
  dot.1338 = f32[1,31,9216]{2,1,0} dot(multiply.1337, Arg_44.45), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.1340 = f32[1,31,9216]{2,1,0} multiply(dot.1338, dot.1338), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1341 = f32[1,31,9216]{2,1,0} multiply(multiply.1340, dot.1338), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1342 = f32[1,31,9216]{2,1,0} multiply(multiply.1341, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.1343 = f32[1,31,9216]{2,1,0} add(dot.1338, multiply.1342), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1344 = f32[1,31,9216]{2,1,0} multiply(add.1343, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.1345 = f32[1,31,9216]{2,1,0} tanh(multiply.1344), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.1346 = f32[1,31,9216]{2,1,0} add(tanh.1345, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1347 = f32[1,31,9216]{2,1,0} multiply(add.1346, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1348 = f32[1,31,9216]{2,1,0} multiply(dot.1338, multiply.1347), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_45.46 = f32[2304,9216]{1,0} parameter(45), metadata={op_name="state[1][43]"}
  dot.1339 = f32[1,31,9216]{2,1,0} dot(multiply.1337, Arg_45.46), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.1349 = f32[1,31,9216]{2,1,0} multiply(multiply.1348, dot.1339), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_46.47 = f32[9216,2304]{1,0} parameter(46), metadata={op_name="state[1][44]"}
  dot.1350 = f32[1,31,2304]{2,1,0} dot(multiply.1349, Arg_46.47), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.1351 = f32[1,31,2304]{2,1,0} multiply(dot.1350, dot.1350), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.1356 = f32[1,31]{1,0} reduce(multiply.1351, constant.342), dimensions={2}, to_apply=region_28.1352, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.1357 = f32[1,31,1]{2,1,0} reshape(reduce.1356), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.1358 = f32[1,31,1]{2,1,0} divide(reshape.1357, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.1359 = f32[1,31,1]{2,1,0} add(divide.1358, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.1360 = f32[1,31,1]{2,1,0} sqrt(add.1359), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.1361 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.1360), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.1362 = f32[1,31,1]{2,1,0} broadcast(divide.1361), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.1363 = f32[1,31]{1,0} reshape(broadcast.1362), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.1364 = f32[1,31,2304]{2,1,0} broadcast(reshape.1363), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.1365 = f32[1,31,2304]{2,1,0} multiply(dot.1350, broadcast.1364), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_43.44 = f32[2304]{0} parameter(43), metadata={op_name="state[1][41]"}
  add.1366 = f32[2304]{0} add(Arg_43.44, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1367 = f32[1,1,2304]{2,1,0} reshape(add.1366), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1368 = f32[1,1,2304]{2,1,0} broadcast(reshape.1367), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1369 = f32[1,2304]{1,0} reshape(broadcast.1368), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1370 = f32[1,31,2304]{2,1,0} broadcast(reshape.1369), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.1371 = f32[1,31,2304]{2,1,0} multiply(multiply.1365, broadcast.1370), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.1372 = f32[1,31,2304]{2,1,0} add(multiply.1371, add.1316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_3/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.1373 = f32[1,31,2304]{2,1,0} multiply(add.1372, add.1372), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.1378 = f32[1,31]{1,0} reduce(multiply.1373, constant.342), dimensions={2}, to_apply=region_29.1374, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.1379 = f32[1,31,1]{2,1,0} reshape(reduce.1378), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.1380 = f32[1,31,1]{2,1,0} divide(reshape.1379, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.1381 = f32[1,31,1]{2,1,0} add(divide.1380, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.1382 = f32[1,31,1]{2,1,0} sqrt(add.1381), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.1383 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.1382), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.1384 = f32[1,31,1]{2,1,0} broadcast(divide.1383), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.1385 = f32[1,31]{1,0} reshape(broadcast.1384), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.1386 = f32[1,31,2304]{2,1,0} broadcast(reshape.1385), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.1387 = f32[1,31,2304]{2,1,0} multiply(add.1372, broadcast.1386), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_47.48 = f32[2304]{0} parameter(47), metadata={op_name="state[1][45]"}
  add.1388 = f32[2304]{0} add(Arg_47.48, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1389 = f32[1,1,2304]{2,1,0} reshape(add.1388), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1390 = f32[1,1,2304]{2,1,0} broadcast(reshape.1389), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1391 = f32[1,2304]{1,0} reshape(broadcast.1390), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1392 = f32[1,31,2304]{2,1,0} broadcast(reshape.1391), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.1393 = f32[1,31,2304]{2,1,0} multiply(multiply.1387, broadcast.1392), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_50.51 = f32[4,2304,256]{2,1,0} parameter(50), metadata={op_name="state[1][48]"}
  dot.1434 = f32[1,31,4,256]{3,2,1,0} dot(multiply.1393, Arg_50.51), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.1435 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.1436 = f32[128]{0} divide(broadcast.321, power.1435), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.1437 = f32[31,128]{1,0} dot(constant.319, divide.1436), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.1438 = f32[31,1,128]{2,1,0} reshape(dot.1437), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1439 = f32[31,1,128]{2,1,0} reshape(dot.1437), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1440 = f32[31,2,128]{2,1,0} concatenate(reshape.1438, reshape.1439), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1441 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.1440), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.1442 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.1441), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.1451 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.1442), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.1452 = f32[1,31,256]{2,1,0} reshape(broadcast.1451), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.1453 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.1452), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.1454 = f32[1,31,4,256]{3,2,1,0} multiply(dot.1434, broadcast.1453), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.1445 = f32[1,31,4,128]{3,2,1,0} slice(dot.1434), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.1446 = f32[1,31,4,128]{3,2,1,0} negate(slice.1445), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.1447 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.1446), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.1444 = f32[1,31,4,128]{3,2,1,0} slice(dot.1434), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1448 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.1444), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1449 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.1447, reshape.1448), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1450 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.1449), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.1443 = f32[1,31,1,256]{3,2,1,0} sine(reshape.1441), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.1455 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.1443), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.1456 = f32[1,31,256]{2,1,0} reshape(broadcast.1455), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.1457 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.1456), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.1458 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.1450, broadcast.1457), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.1459 = f32[1,31,4,256]{3,2,1,0} add(multiply.1454, multiply.1458), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.1460 = f32[1,31,4,128]{3,2,1,0} slice(add.1459), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1462 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.1460), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.1461 = f32[1,31,4,128]{3,2,1,0} slice(add.1459), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1463 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.1461), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1464 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.1462, reshape.1463), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1467 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.1464), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_51.52 = f32[4,2304,256]{2,1,0} parameter(51), metadata={op_name="state[1][49]"}
  dot.1466 = f32[1,31,4,256]{3,2,1,0} dot(multiply.1393, Arg_51.52), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.1468 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.1466), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1469 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.1467, reshape.1468), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6667 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.1469), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.1394 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.1395 = f32[31]{0} reshape(broadcast.1394), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.1396 = f32[31,31]{1,0} broadcast(reshape.1395), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.1397 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.1398 = f32[31]{0} reshape(broadcast.1397), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.1399 = f32[31,31]{1,0} broadcast(reshape.1398), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.1400 = pred[31,31]{1,0} compare(broadcast.1396, broadcast.1399), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.1401 = pred[1,31,31]{2,1,0} reshape(compare.1400), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.1541 = s32[1,31,31]{2,1,0} convert(reshape.1401), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.1542 = pred[1,31,31]{2,1,0} compare(convert.1541, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.1547 = pred[1,31]{1,0} reduce(compare.1542, constant.340), dimensions={2}, to_apply=region_32.1543, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.1548 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.1547), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.1465 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.1464), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_49.50 = f32[8,2304,256]{2,1,0} parameter(49), metadata={op_name="state[1][47]"}
  dot.1402 = f32[1,31,8,256]{3,2,1,0} dot(multiply.1393, Arg_49.50), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.1403 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.1404 = f32[128]{0} divide(broadcast.321, power.1403), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.1405 = f32[31,128]{1,0} dot(constant.319, divide.1404), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.1406 = f32[31,1,128]{2,1,0} reshape(dot.1405), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1407 = f32[31,1,128]{2,1,0} reshape(dot.1405), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1408 = f32[31,2,128]{2,1,0} concatenate(reshape.1406, reshape.1407), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1409 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.1408), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.1410 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.1409), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.1419 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.1410), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.1420 = f32[1,31,256]{2,1,0} reshape(broadcast.1419), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.1421 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.1420), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.1422 = f32[1,31,8,256]{3,2,1,0} multiply(dot.1402, broadcast.1421), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.1413 = f32[1,31,8,128]{3,2,1,0} slice(dot.1402), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.1414 = f32[1,31,8,128]{3,2,1,0} negate(slice.1413), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.1415 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.1414), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.1412 = f32[1,31,8,128]{3,2,1,0} slice(dot.1402), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1416 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.1412), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1417 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.1415, reshape.1416), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1418 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.1417), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.1411 = f32[1,31,1,256]{3,2,1,0} sine(reshape.1409), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.1423 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.1411), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.1424 = f32[1,31,256]{2,1,0} reshape(broadcast.1423), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.1425 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.1424), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.1426 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.1418, broadcast.1425), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.1427 = f32[1,31,8,256]{3,2,1,0} add(multiply.1422, multiply.1426), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/rotary_embedding_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.1428 = f32[1,31,8,128]{3,2,1,0} slice(add.1427), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1430 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.1428), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.1429 = f32[1,31,8,128]{3,2,1,0} slice(add.1427), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1431 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.1429), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1432 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.1430, reshape.1431), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1433 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.1432), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.1470 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.1433, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.1471 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.1470), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.1472 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.1465, reshape.1471), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.1473 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.1472), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.1474 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.1473, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.1475 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.1474), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.1476 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.1475, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.1490 = pred[31,31]{1,0} call(broadcast.314), to_apply=triu.1477
  call.1504 = pred[31,31]{1,0} call(broadcast.314), to_apply=tril.1491
  and.1505 = pred[31,31]{1,0} and(call.1490, call.1504), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  reshape.1506 = pred[1,31,31]{2,1,0} reshape(and.1505), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.1507 = pred[1,31,31]{2,1,0} and(reshape.1401, reshape.1506), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.1508 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(and.1507), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.1509 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.1508), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.1510 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.1509), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.1511 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.1510, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.1512 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.1511), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.1513 = f32[1,31,31]{2,1,0} reshape(broadcast.1512), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.1514 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.1513), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.1515 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.1476, broadcast.1514), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.1520 = f32[1,4,2,31]{3,2,1,0} reduce(add.1515, constant.339), dimensions={4}, to_apply=region_30.1516, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.1521 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.1520, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.1522 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.1521), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.1523 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.1522), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.1524 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.1523), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.1525 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.1524), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.1526 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.1515, broadcast.1525), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.1527 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.1526), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.1532 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.1527, constant.342), dimensions={4}, to_apply=region_31.1528, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.1533 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.1532), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.1534 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.1533), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.1535 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.1534), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.1536 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.1535), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.1537 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.1527, broadcast.1536), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/softmax_4/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.1538 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.1466, divide.1537), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.1539 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.1538), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.1540 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.1539), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.1557 = f32[1,31,8,256]{3,2,1,0} call(reshape.1548, broadcast.304, reshape.1540), to_apply=_where_0.1549
  Arg_52.53 = f32[8,256,2304]{2,1,0} parameter(52), metadata={op_name="state[1][50]"}
  dot.1558 = f32[1,31,2304]{2,1,0} dot(call.1557, Arg_52.53), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.1559 = f32[1,31,2304]{2,1,0} multiply(dot.1558, dot.1558), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.1564 = f32[1,31]{1,0} reduce(multiply.1559, constant.342), dimensions={2}, to_apply=region_33.1560, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.1565 = f32[1,31,1]{2,1,0} reshape(reduce.1564), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.1566 = f32[1,31,1]{2,1,0} divide(reshape.1565, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.1567 = f32[1,31,1]{2,1,0} add(divide.1566, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.1568 = f32[1,31,1]{2,1,0} sqrt(add.1567), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.1569 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.1568), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.1570 = f32[1,31,1]{2,1,0} broadcast(divide.1569), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.1571 = f32[1,31]{1,0} reshape(broadcast.1570), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.1572 = f32[1,31,2304]{2,1,0} broadcast(reshape.1571), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.1573 = f32[1,31,2304]{2,1,0} multiply(dot.1558, broadcast.1572), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_48.49 = f32[2304]{0} parameter(48), metadata={op_name="state[1][46]"}
  add.1574 = f32[2304]{0} add(Arg_48.49, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1575 = f32[1,1,2304]{2,1,0} reshape(add.1574), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1576 = f32[1,1,2304]{2,1,0} broadcast(reshape.1575), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1577 = f32[1,2304]{1,0} reshape(broadcast.1576), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1578 = f32[1,31,2304]{2,1,0} broadcast(reshape.1577), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.1579 = f32[1,31,2304]{2,1,0} multiply(multiply.1573, broadcast.1578), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.1580 = f32[1,31,2304]{2,1,0} add(add.1372, multiply.1579), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.1581 = f32[1,31,2304]{2,1,0} multiply(add.1580, add.1580), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.1586 = f32[1,31]{1,0} reduce(multiply.1581, constant.342), dimensions={2}, to_apply=region_34.1582, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.1587 = f32[1,31,1]{2,1,0} reshape(reduce.1586), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.1588 = f32[1,31,1]{2,1,0} divide(reshape.1587, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.1589 = f32[1,31,1]{2,1,0} add(divide.1588, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.1590 = f32[1,31,1]{2,1,0} sqrt(add.1589), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.1591 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.1590), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.1592 = f32[1,31,1]{2,1,0} broadcast(divide.1591), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.1593 = f32[1,31]{1,0} reshape(broadcast.1592), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.1594 = f32[1,31,2304]{2,1,0} broadcast(reshape.1593), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.1595 = f32[1,31,2304]{2,1,0} multiply(add.1580, broadcast.1594), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_53.54 = f32[2304]{0} parameter(53), metadata={op_name="state[1][51]"}
  add.1596 = f32[2304]{0} add(Arg_53.54, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1597 = f32[1,1,2304]{2,1,0} reshape(add.1596), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1598 = f32[1,1,2304]{2,1,0} broadcast(reshape.1597), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1599 = f32[1,2304]{1,0} reshape(broadcast.1598), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1600 = f32[1,31,2304]{2,1,0} broadcast(reshape.1599), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.1601 = f32[1,31,2304]{2,1,0} multiply(multiply.1595, broadcast.1600), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_55.56 = f32[2304,9216]{1,0} parameter(55), metadata={op_name="state[1][53]"}
  dot.1602 = f32[1,31,9216]{2,1,0} dot(multiply.1601, Arg_55.56), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.1604 = f32[1,31,9216]{2,1,0} multiply(dot.1602, dot.1602), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1605 = f32[1,31,9216]{2,1,0} multiply(multiply.1604, dot.1602), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1606 = f32[1,31,9216]{2,1,0} multiply(multiply.1605, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.1607 = f32[1,31,9216]{2,1,0} add(dot.1602, multiply.1606), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1608 = f32[1,31,9216]{2,1,0} multiply(add.1607, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.1609 = f32[1,31,9216]{2,1,0} tanh(multiply.1608), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.1610 = f32[1,31,9216]{2,1,0} add(tanh.1609, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1611 = f32[1,31,9216]{2,1,0} multiply(add.1610, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1612 = f32[1,31,9216]{2,1,0} multiply(dot.1602, multiply.1611), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_56.57 = f32[2304,9216]{1,0} parameter(56), metadata={op_name="state[1][54]"}
  dot.1603 = f32[1,31,9216]{2,1,0} dot(multiply.1601, Arg_56.57), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.1613 = f32[1,31,9216]{2,1,0} multiply(multiply.1612, dot.1603), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_57.58 = f32[9216,2304]{1,0} parameter(57), metadata={op_name="state[1][55]"}
  dot.1614 = f32[1,31,2304]{2,1,0} dot(multiply.1613, Arg_57.58), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.1615 = f32[1,31,2304]{2,1,0} multiply(dot.1614, dot.1614), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.1620 = f32[1,31]{1,0} reduce(multiply.1615, constant.342), dimensions={2}, to_apply=region_35.1616, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.1621 = f32[1,31,1]{2,1,0} reshape(reduce.1620), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.1622 = f32[1,31,1]{2,1,0} divide(reshape.1621, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.1623 = f32[1,31,1]{2,1,0} add(divide.1622, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.1624 = f32[1,31,1]{2,1,0} sqrt(add.1623), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.1625 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.1624), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.1626 = f32[1,31,1]{2,1,0} broadcast(divide.1625), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.1627 = f32[1,31]{1,0} reshape(broadcast.1626), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.1628 = f32[1,31,2304]{2,1,0} broadcast(reshape.1627), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.1629 = f32[1,31,2304]{2,1,0} multiply(dot.1614, broadcast.1628), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_54.55 = f32[2304]{0} parameter(54), metadata={op_name="state[1][52]"}
  add.1630 = f32[2304]{0} add(Arg_54.55, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1631 = f32[1,1,2304]{2,1,0} reshape(add.1630), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1632 = f32[1,1,2304]{2,1,0} broadcast(reshape.1631), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1633 = f32[1,2304]{1,0} reshape(broadcast.1632), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1634 = f32[1,31,2304]{2,1,0} broadcast(reshape.1633), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.1635 = f32[1,31,2304]{2,1,0} multiply(multiply.1629, broadcast.1634), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.1636 = f32[1,31,2304]{2,1,0} add(multiply.1635, add.1580), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_4/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.1637 = f32[1,31,2304]{2,1,0} multiply(add.1636, add.1636), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.1642 = f32[1,31]{1,0} reduce(multiply.1637, constant.342), dimensions={2}, to_apply=region_36.1638, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.1643 = f32[1,31,1]{2,1,0} reshape(reduce.1642), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.1644 = f32[1,31,1]{2,1,0} divide(reshape.1643, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.1645 = f32[1,31,1]{2,1,0} add(divide.1644, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.1646 = f32[1,31,1]{2,1,0} sqrt(add.1645), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.1647 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.1646), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.1648 = f32[1,31,1]{2,1,0} broadcast(divide.1647), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.1649 = f32[1,31]{1,0} reshape(broadcast.1648), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.1650 = f32[1,31,2304]{2,1,0} broadcast(reshape.1649), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.1651 = f32[1,31,2304]{2,1,0} multiply(add.1636, broadcast.1650), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_58.59 = f32[2304]{0} parameter(58), metadata={op_name="state[1][56]"}
  add.1652 = f32[2304]{0} add(Arg_58.59, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1653 = f32[1,1,2304]{2,1,0} reshape(add.1652), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1654 = f32[1,1,2304]{2,1,0} broadcast(reshape.1653), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1655 = f32[1,2304]{1,0} reshape(broadcast.1654), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1656 = f32[1,31,2304]{2,1,0} broadcast(reshape.1655), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.1657 = f32[1,31,2304]{2,1,0} multiply(multiply.1651, broadcast.1656), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_61.62 = f32[4,2304,256]{2,1,0} parameter(61), metadata={op_name="state[1][59]"}
  dot.1698 = f32[1,31,4,256]{3,2,1,0} dot(multiply.1657, Arg_61.62), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.1699 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.1700 = f32[128]{0} divide(broadcast.321, power.1699), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.1701 = f32[31,128]{1,0} dot(constant.319, divide.1700), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.1702 = f32[31,1,128]{2,1,0} reshape(dot.1701), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1703 = f32[31,1,128]{2,1,0} reshape(dot.1701), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1704 = f32[31,2,128]{2,1,0} concatenate(reshape.1702, reshape.1703), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1705 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.1704), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.1706 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.1705), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.1715 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.1706), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.1716 = f32[1,31,256]{2,1,0} reshape(broadcast.1715), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.1717 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.1716), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.1718 = f32[1,31,4,256]{3,2,1,0} multiply(dot.1698, broadcast.1717), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.1709 = f32[1,31,4,128]{3,2,1,0} slice(dot.1698), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.1710 = f32[1,31,4,128]{3,2,1,0} negate(slice.1709), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.1711 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.1710), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.1708 = f32[1,31,4,128]{3,2,1,0} slice(dot.1698), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1712 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.1708), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1713 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.1711, reshape.1712), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1714 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.1713), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.1707 = f32[1,31,1,256]{3,2,1,0} sine(reshape.1705), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.1719 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.1707), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.1720 = f32[1,31,256]{2,1,0} reshape(broadcast.1719), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.1721 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.1720), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.1722 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.1714, broadcast.1721), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.1723 = f32[1,31,4,256]{3,2,1,0} add(multiply.1718, multiply.1722), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.1724 = f32[1,31,4,128]{3,2,1,0} slice(add.1723), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1726 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.1724), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.1725 = f32[1,31,4,128]{3,2,1,0} slice(add.1723), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1727 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.1725), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1728 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.1726, reshape.1727), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1731 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.1728), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_62.63 = f32[4,2304,256]{2,1,0} parameter(62), metadata={op_name="state[1][60]"}
  dot.1730 = f32[1,31,4,256]{3,2,1,0} dot(multiply.1657, Arg_62.63), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.1732 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.1730), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1733 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.1731, reshape.1732), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6668 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.1733), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.1658 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.1659 = f32[31]{0} reshape(broadcast.1658), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.1660 = f32[31,31]{1,0} broadcast(reshape.1659), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.1661 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.1662 = f32[31]{0} reshape(broadcast.1661), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.1663 = f32[31,31]{1,0} broadcast(reshape.1662), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.1664 = pred[31,31]{1,0} compare(broadcast.1660, broadcast.1663), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.1665 = pred[1,31,31]{2,1,0} reshape(compare.1664), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.1774 = s32[1,31,31]{2,1,0} convert(reshape.1665), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.1775 = pred[1,31,31]{2,1,0} compare(convert.1774, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.1780 = pred[1,31]{1,0} reduce(compare.1775, constant.340), dimensions={2}, to_apply=region_39.1776, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.1781 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.1780), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.1729 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.1728), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_60.61 = f32[8,2304,256]{2,1,0} parameter(60), metadata={op_name="state[1][58]"}
  dot.1666 = f32[1,31,8,256]{3,2,1,0} dot(multiply.1657, Arg_60.61), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.1667 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.1668 = f32[128]{0} divide(broadcast.321, power.1667), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.1669 = f32[31,128]{1,0} dot(constant.319, divide.1668), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.1670 = f32[31,1,128]{2,1,0} reshape(dot.1669), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1671 = f32[31,1,128]{2,1,0} reshape(dot.1669), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1672 = f32[31,2,128]{2,1,0} concatenate(reshape.1670, reshape.1671), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1673 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.1672), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.1674 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.1673), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.1683 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.1674), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.1684 = f32[1,31,256]{2,1,0} reshape(broadcast.1683), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.1685 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.1684), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.1686 = f32[1,31,8,256]{3,2,1,0} multiply(dot.1666, broadcast.1685), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.1677 = f32[1,31,8,128]{3,2,1,0} slice(dot.1666), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.1678 = f32[1,31,8,128]{3,2,1,0} negate(slice.1677), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.1679 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.1678), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.1676 = f32[1,31,8,128]{3,2,1,0} slice(dot.1666), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1680 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.1676), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1681 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.1679, reshape.1680), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1682 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.1681), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.1675 = f32[1,31,1,256]{3,2,1,0} sine(reshape.1673), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.1687 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.1675), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.1688 = f32[1,31,256]{2,1,0} reshape(broadcast.1687), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.1689 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.1688), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.1690 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.1682, broadcast.1689), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.1691 = f32[1,31,8,256]{3,2,1,0} add(multiply.1686, multiply.1690), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/rotary_embedding_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.1692 = f32[1,31,8,128]{3,2,1,0} slice(add.1691), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1694 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.1692), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.1693 = f32[1,31,8,128]{3,2,1,0} slice(add.1691), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1695 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.1693), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1696 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.1694, reshape.1695), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1697 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.1696), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.1734 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.1697, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.1735 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.1734), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.1736 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.1729, reshape.1735), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.1737 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.1736), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.1738 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.1737, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.1739 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.1738), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.1740 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.1739, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.1741 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(compare.1664), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.1742 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.1741), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.1743 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.1742), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.1744 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.1743, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.1745 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.1744), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.1746 = f32[1,31,31]{2,1,0} reshape(broadcast.1745), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.1747 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.1746), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.1748 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.1740, broadcast.1747), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.1753 = f32[1,4,2,31]{3,2,1,0} reduce(add.1748, constant.339), dimensions={4}, to_apply=region_37.1749, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.1754 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.1753, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.1755 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.1754), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.1756 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.1755), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.1757 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.1756), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.1758 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.1757), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.1759 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.1748, broadcast.1758), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.1760 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.1759), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.1765 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.1760, constant.342), dimensions={4}, to_apply=region_38.1761, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.1766 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.1765), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.1767 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.1766), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.1768 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.1767), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.1769 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.1768), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.1770 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.1760, broadcast.1769), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/softmax_5/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.1771 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.1730, divide.1770), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.1772 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.1771), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.1773 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.1772), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.1790 = f32[1,31,8,256]{3,2,1,0} call(reshape.1781, broadcast.304, reshape.1773), to_apply=_where_0.1782
  Arg_63.64 = f32[8,256,2304]{2,1,0} parameter(63), metadata={op_name="state[1][61]"}
  dot.1791 = f32[1,31,2304]{2,1,0} dot(call.1790, Arg_63.64), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.1792 = f32[1,31,2304]{2,1,0} multiply(dot.1791, dot.1791), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.1797 = f32[1,31]{1,0} reduce(multiply.1792, constant.342), dimensions={2}, to_apply=region_40.1793, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.1798 = f32[1,31,1]{2,1,0} reshape(reduce.1797), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.1799 = f32[1,31,1]{2,1,0} divide(reshape.1798, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.1800 = f32[1,31,1]{2,1,0} add(divide.1799, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.1801 = f32[1,31,1]{2,1,0} sqrt(add.1800), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.1802 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.1801), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.1803 = f32[1,31,1]{2,1,0} broadcast(divide.1802), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.1804 = f32[1,31]{1,0} reshape(broadcast.1803), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.1805 = f32[1,31,2304]{2,1,0} broadcast(reshape.1804), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.1806 = f32[1,31,2304]{2,1,0} multiply(dot.1791, broadcast.1805), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_59.60 = f32[2304]{0} parameter(59), metadata={op_name="state[1][57]"}
  add.1807 = f32[2304]{0} add(Arg_59.60, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1808 = f32[1,1,2304]{2,1,0} reshape(add.1807), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1809 = f32[1,1,2304]{2,1,0} broadcast(reshape.1808), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1810 = f32[1,2304]{1,0} reshape(broadcast.1809), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1811 = f32[1,31,2304]{2,1,0} broadcast(reshape.1810), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.1812 = f32[1,31,2304]{2,1,0} multiply(multiply.1806, broadcast.1811), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.1813 = f32[1,31,2304]{2,1,0} add(add.1636, multiply.1812), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.1814 = f32[1,31,2304]{2,1,0} multiply(add.1813, add.1813), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.1819 = f32[1,31]{1,0} reduce(multiply.1814, constant.342), dimensions={2}, to_apply=region_41.1815, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.1820 = f32[1,31,1]{2,1,0} reshape(reduce.1819), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.1821 = f32[1,31,1]{2,1,0} divide(reshape.1820, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.1822 = f32[1,31,1]{2,1,0} add(divide.1821, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.1823 = f32[1,31,1]{2,1,0} sqrt(add.1822), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.1824 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.1823), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.1825 = f32[1,31,1]{2,1,0} broadcast(divide.1824), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.1826 = f32[1,31]{1,0} reshape(broadcast.1825), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.1827 = f32[1,31,2304]{2,1,0} broadcast(reshape.1826), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.1828 = f32[1,31,2304]{2,1,0} multiply(add.1813, broadcast.1827), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_64.65 = f32[2304]{0} parameter(64), metadata={op_name="state[1][62]"}
  add.1829 = f32[2304]{0} add(Arg_64.65, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1830 = f32[1,1,2304]{2,1,0} reshape(add.1829), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1831 = f32[1,1,2304]{2,1,0} broadcast(reshape.1830), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1832 = f32[1,2304]{1,0} reshape(broadcast.1831), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1833 = f32[1,31,2304]{2,1,0} broadcast(reshape.1832), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.1834 = f32[1,31,2304]{2,1,0} multiply(multiply.1828, broadcast.1833), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_66.67 = f32[2304,9216]{1,0} parameter(66), metadata={op_name="state[1][64]"}
  dot.1835 = f32[1,31,9216]{2,1,0} dot(multiply.1834, Arg_66.67), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.1837 = f32[1,31,9216]{2,1,0} multiply(dot.1835, dot.1835), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1838 = f32[1,31,9216]{2,1,0} multiply(multiply.1837, dot.1835), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1839 = f32[1,31,9216]{2,1,0} multiply(multiply.1838, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.1840 = f32[1,31,9216]{2,1,0} add(dot.1835, multiply.1839), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1841 = f32[1,31,9216]{2,1,0} multiply(add.1840, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.1842 = f32[1,31,9216]{2,1,0} tanh(multiply.1841), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.1843 = f32[1,31,9216]{2,1,0} add(tanh.1842, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1844 = f32[1,31,9216]{2,1,0} multiply(add.1843, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.1845 = f32[1,31,9216]{2,1,0} multiply(dot.1835, multiply.1844), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_67.68 = f32[2304,9216]{1,0} parameter(67), metadata={op_name="state[1][65]"}
  dot.1836 = f32[1,31,9216]{2,1,0} dot(multiply.1834, Arg_67.68), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.1846 = f32[1,31,9216]{2,1,0} multiply(multiply.1845, dot.1836), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_68.69 = f32[9216,2304]{1,0} parameter(68), metadata={op_name="state[1][66]"}
  dot.1847 = f32[1,31,2304]{2,1,0} dot(multiply.1846, Arg_68.69), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.1848 = f32[1,31,2304]{2,1,0} multiply(dot.1847, dot.1847), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.1853 = f32[1,31]{1,0} reduce(multiply.1848, constant.342), dimensions={2}, to_apply=region_42.1849, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.1854 = f32[1,31,1]{2,1,0} reshape(reduce.1853), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.1855 = f32[1,31,1]{2,1,0} divide(reshape.1854, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.1856 = f32[1,31,1]{2,1,0} add(divide.1855, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.1857 = f32[1,31,1]{2,1,0} sqrt(add.1856), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.1858 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.1857), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.1859 = f32[1,31,1]{2,1,0} broadcast(divide.1858), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.1860 = f32[1,31]{1,0} reshape(broadcast.1859), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.1861 = f32[1,31,2304]{2,1,0} broadcast(reshape.1860), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.1862 = f32[1,31,2304]{2,1,0} multiply(dot.1847, broadcast.1861), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_65.66 = f32[2304]{0} parameter(65), metadata={op_name="state[1][63]"}
  add.1863 = f32[2304]{0} add(Arg_65.66, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1864 = f32[1,1,2304]{2,1,0} reshape(add.1863), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1865 = f32[1,1,2304]{2,1,0} broadcast(reshape.1864), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1866 = f32[1,2304]{1,0} reshape(broadcast.1865), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1867 = f32[1,31,2304]{2,1,0} broadcast(reshape.1866), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.1868 = f32[1,31,2304]{2,1,0} multiply(multiply.1862, broadcast.1867), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.1869 = f32[1,31,2304]{2,1,0} add(multiply.1868, add.1813), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_5/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.1870 = f32[1,31,2304]{2,1,0} multiply(add.1869, add.1869), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.1875 = f32[1,31]{1,0} reduce(multiply.1870, constant.342), dimensions={2}, to_apply=region_43.1871, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.1876 = f32[1,31,1]{2,1,0} reshape(reduce.1875), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.1877 = f32[1,31,1]{2,1,0} divide(reshape.1876, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.1878 = f32[1,31,1]{2,1,0} add(divide.1877, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.1879 = f32[1,31,1]{2,1,0} sqrt(add.1878), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.1880 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.1879), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.1881 = f32[1,31,1]{2,1,0} broadcast(divide.1880), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.1882 = f32[1,31]{1,0} reshape(broadcast.1881), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.1883 = f32[1,31,2304]{2,1,0} broadcast(reshape.1882), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.1884 = f32[1,31,2304]{2,1,0} multiply(add.1869, broadcast.1883), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_69.70 = f32[2304]{0} parameter(69), metadata={op_name="state[1][67]"}
  add.1885 = f32[2304]{0} add(Arg_69.70, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1886 = f32[1,1,2304]{2,1,0} reshape(add.1885), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1887 = f32[1,1,2304]{2,1,0} broadcast(reshape.1886), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.1888 = f32[1,2304]{1,0} reshape(broadcast.1887), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.1889 = f32[1,31,2304]{2,1,0} broadcast(reshape.1888), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.1890 = f32[1,31,2304]{2,1,0} multiply(multiply.1884, broadcast.1889), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_72.73 = f32[4,2304,256]{2,1,0} parameter(72), metadata={op_name="state[1][70]"}
  dot.1931 = f32[1,31,4,256]{3,2,1,0} dot(multiply.1890, Arg_72.73), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.1932 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.1933 = f32[128]{0} divide(broadcast.321, power.1932), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.1934 = f32[31,128]{1,0} dot(constant.319, divide.1933), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.1935 = f32[31,1,128]{2,1,0} reshape(dot.1934), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1936 = f32[31,1,128]{2,1,0} reshape(dot.1934), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1937 = f32[31,2,128]{2,1,0} concatenate(reshape.1935, reshape.1936), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1938 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.1937), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.1939 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.1938), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.1948 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.1939), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.1949 = f32[1,31,256]{2,1,0} reshape(broadcast.1948), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.1950 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.1949), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.1951 = f32[1,31,4,256]{3,2,1,0} multiply(dot.1931, broadcast.1950), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.1942 = f32[1,31,4,128]{3,2,1,0} slice(dot.1931), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.1943 = f32[1,31,4,128]{3,2,1,0} negate(slice.1942), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.1944 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.1943), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.1941 = f32[1,31,4,128]{3,2,1,0} slice(dot.1931), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1945 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.1941), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1946 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.1944, reshape.1945), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1947 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.1946), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.1940 = f32[1,31,1,256]{3,2,1,0} sine(reshape.1938), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.1952 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.1940), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.1953 = f32[1,31,256]{2,1,0} reshape(broadcast.1952), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.1954 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.1953), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.1955 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.1947, broadcast.1954), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.1956 = f32[1,31,4,256]{3,2,1,0} add(multiply.1951, multiply.1955), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.1957 = f32[1,31,4,128]{3,2,1,0} slice(add.1956), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1959 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.1957), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.1958 = f32[1,31,4,128]{3,2,1,0} slice(add.1956), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1960 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.1958), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1961 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.1959, reshape.1960), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1964 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.1961), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_73.74 = f32[4,2304,256]{2,1,0} parameter(73), metadata={op_name="state[1][71]"}
  dot.1963 = f32[1,31,4,256]{3,2,1,0} dot(multiply.1890, Arg_73.74), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.1965 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.1963), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1966 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.1964, reshape.1965), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6669 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.1966), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.1891 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.1892 = f32[31]{0} reshape(broadcast.1891), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.1893 = f32[31,31]{1,0} broadcast(reshape.1892), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.1894 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.1895 = f32[31]{0} reshape(broadcast.1894), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.1896 = f32[31,31]{1,0} broadcast(reshape.1895), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.1897 = pred[31,31]{1,0} compare(broadcast.1893, broadcast.1896), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.1898 = pred[1,31,31]{2,1,0} reshape(compare.1897), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.2038 = s32[1,31,31]{2,1,0} convert(reshape.1898), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.2039 = pred[1,31,31]{2,1,0} compare(convert.2038, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.2044 = pred[1,31]{1,0} reduce(compare.2039, constant.340), dimensions={2}, to_apply=region_46.2040, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.2045 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.2044), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.1962 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.1961), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_71.72 = f32[8,2304,256]{2,1,0} parameter(71), metadata={op_name="state[1][69]"}
  dot.1899 = f32[1,31,8,256]{3,2,1,0} dot(multiply.1890, Arg_71.72), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.1900 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.1901 = f32[128]{0} divide(broadcast.321, power.1900), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.1902 = f32[31,128]{1,0} dot(constant.319, divide.1901), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.1903 = f32[31,1,128]{2,1,0} reshape(dot.1902), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1904 = f32[31,1,128]{2,1,0} reshape(dot.1902), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1905 = f32[31,2,128]{2,1,0} concatenate(reshape.1903, reshape.1904), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1906 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.1905), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.1907 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.1906), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.1916 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.1907), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.1917 = f32[1,31,256]{2,1,0} reshape(broadcast.1916), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.1918 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.1917), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.1919 = f32[1,31,8,256]{3,2,1,0} multiply(dot.1899, broadcast.1918), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.1910 = f32[1,31,8,128]{3,2,1,0} slice(dot.1899), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.1911 = f32[1,31,8,128]{3,2,1,0} negate(slice.1910), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.1912 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.1911), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.1909 = f32[1,31,8,128]{3,2,1,0} slice(dot.1899), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1913 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.1909), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1914 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.1912, reshape.1913), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1915 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.1914), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.1908 = f32[1,31,1,256]{3,2,1,0} sine(reshape.1906), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.1920 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.1908), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.1921 = f32[1,31,256]{2,1,0} reshape(broadcast.1920), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.1922 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.1921), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.1923 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.1915, broadcast.1922), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.1924 = f32[1,31,8,256]{3,2,1,0} add(multiply.1919, multiply.1923), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/rotary_embedding_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.1925 = f32[1,31,8,128]{3,2,1,0} slice(add.1924), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1927 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.1925), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.1926 = f32[1,31,8,128]{3,2,1,0} slice(add.1924), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.1928 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.1926), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.1929 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.1927, reshape.1928), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.1930 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.1929), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.1967 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.1930, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.1968 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.1967), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.1969 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.1962, reshape.1968), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.1970 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.1969), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.1971 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.1970, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.1972 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.1971), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.1973 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.1972, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.1987 = pred[31,31]{1,0} call(broadcast.314), to_apply=triu.1974
  call.2001 = pred[31,31]{1,0} call(broadcast.314), to_apply=tril.1988
  and.2002 = pred[31,31]{1,0} and(call.1987, call.2001), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  reshape.2003 = pred[1,31,31]{2,1,0} reshape(and.2002), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.2004 = pred[1,31,31]{2,1,0} and(reshape.1898, reshape.2003), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.2005 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(and.2004), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.2006 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.2005), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.2007 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.2006), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.2008 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.2007, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.2009 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.2008), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.2010 = f32[1,31,31]{2,1,0} reshape(broadcast.2009), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.2011 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.2010), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.2012 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.1973, broadcast.2011), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.2017 = f32[1,4,2,31]{3,2,1,0} reduce(add.2012, constant.339), dimensions={4}, to_apply=region_44.2013, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.2018 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.2017, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.2019 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.2018), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.2020 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.2019), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.2021 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.2020), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.2022 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.2021), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.2023 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.2012, broadcast.2022), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.2024 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.2023), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.2029 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.2024, constant.342), dimensions={4}, to_apply=region_45.2025, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.2030 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.2029), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.2031 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.2030), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.2032 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.2031), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.2033 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.2032), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.2034 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.2024, broadcast.2033), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/softmax_6/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.2035 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.1963, divide.2034), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.2036 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.2035), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.2037 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.2036), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.2054 = f32[1,31,8,256]{3,2,1,0} call(reshape.2045, broadcast.304, reshape.2037), to_apply=_where_0.2046
  Arg_74.75 = f32[8,256,2304]{2,1,0} parameter(74), metadata={op_name="state[1][72]"}
  dot.2055 = f32[1,31,2304]{2,1,0} dot(call.2054, Arg_74.75), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.2056 = f32[1,31,2304]{2,1,0} multiply(dot.2055, dot.2055), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.2061 = f32[1,31]{1,0} reduce(multiply.2056, constant.342), dimensions={2}, to_apply=region_47.2057, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.2062 = f32[1,31,1]{2,1,0} reshape(reduce.2061), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.2063 = f32[1,31,1]{2,1,0} divide(reshape.2062, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.2064 = f32[1,31,1]{2,1,0} add(divide.2063, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.2065 = f32[1,31,1]{2,1,0} sqrt(add.2064), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.2066 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.2065), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.2067 = f32[1,31,1]{2,1,0} broadcast(divide.2066), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.2068 = f32[1,31]{1,0} reshape(broadcast.2067), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.2069 = f32[1,31,2304]{2,1,0} broadcast(reshape.2068), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.2070 = f32[1,31,2304]{2,1,0} multiply(dot.2055, broadcast.2069), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_70.71 = f32[2304]{0} parameter(70), metadata={op_name="state[1][68]"}
  add.2071 = f32[2304]{0} add(Arg_70.71, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2072 = f32[1,1,2304]{2,1,0} reshape(add.2071), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2073 = f32[1,1,2304]{2,1,0} broadcast(reshape.2072), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2074 = f32[1,2304]{1,0} reshape(broadcast.2073), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2075 = f32[1,31,2304]{2,1,0} broadcast(reshape.2074), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.2076 = f32[1,31,2304]{2,1,0} multiply(multiply.2070, broadcast.2075), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.2077 = f32[1,31,2304]{2,1,0} add(add.1869, multiply.2076), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.2078 = f32[1,31,2304]{2,1,0} multiply(add.2077, add.2077), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.2083 = f32[1,31]{1,0} reduce(multiply.2078, constant.342), dimensions={2}, to_apply=region_48.2079, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.2084 = f32[1,31,1]{2,1,0} reshape(reduce.2083), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.2085 = f32[1,31,1]{2,1,0} divide(reshape.2084, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.2086 = f32[1,31,1]{2,1,0} add(divide.2085, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.2087 = f32[1,31,1]{2,1,0} sqrt(add.2086), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.2088 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.2087), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.2089 = f32[1,31,1]{2,1,0} broadcast(divide.2088), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.2090 = f32[1,31]{1,0} reshape(broadcast.2089), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.2091 = f32[1,31,2304]{2,1,0} broadcast(reshape.2090), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.2092 = f32[1,31,2304]{2,1,0} multiply(add.2077, broadcast.2091), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_75.76 = f32[2304]{0} parameter(75), metadata={op_name="state[1][73]"}
  add.2093 = f32[2304]{0} add(Arg_75.76, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2094 = f32[1,1,2304]{2,1,0} reshape(add.2093), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2095 = f32[1,1,2304]{2,1,0} broadcast(reshape.2094), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2096 = f32[1,2304]{1,0} reshape(broadcast.2095), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2097 = f32[1,31,2304]{2,1,0} broadcast(reshape.2096), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.2098 = f32[1,31,2304]{2,1,0} multiply(multiply.2092, broadcast.2097), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_77.78 = f32[2304,9216]{1,0} parameter(77), metadata={op_name="state[1][75]"}
  dot.2099 = f32[1,31,9216]{2,1,0} dot(multiply.2098, Arg_77.78), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.2101 = f32[1,31,9216]{2,1,0} multiply(dot.2099, dot.2099), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2102 = f32[1,31,9216]{2,1,0} multiply(multiply.2101, dot.2099), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2103 = f32[1,31,9216]{2,1,0} multiply(multiply.2102, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.2104 = f32[1,31,9216]{2,1,0} add(dot.2099, multiply.2103), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2105 = f32[1,31,9216]{2,1,0} multiply(add.2104, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.2106 = f32[1,31,9216]{2,1,0} tanh(multiply.2105), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.2107 = f32[1,31,9216]{2,1,0} add(tanh.2106, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2108 = f32[1,31,9216]{2,1,0} multiply(add.2107, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2109 = f32[1,31,9216]{2,1,0} multiply(dot.2099, multiply.2108), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_78.79 = f32[2304,9216]{1,0} parameter(78), metadata={op_name="state[1][76]"}
  dot.2100 = f32[1,31,9216]{2,1,0} dot(multiply.2098, Arg_78.79), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.2110 = f32[1,31,9216]{2,1,0} multiply(multiply.2109, dot.2100), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_79.80 = f32[9216,2304]{1,0} parameter(79), metadata={op_name="state[1][77]"}
  dot.2111 = f32[1,31,2304]{2,1,0} dot(multiply.2110, Arg_79.80), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.2112 = f32[1,31,2304]{2,1,0} multiply(dot.2111, dot.2111), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.2117 = f32[1,31]{1,0} reduce(multiply.2112, constant.342), dimensions={2}, to_apply=region_49.2113, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.2118 = f32[1,31,1]{2,1,0} reshape(reduce.2117), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.2119 = f32[1,31,1]{2,1,0} divide(reshape.2118, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.2120 = f32[1,31,1]{2,1,0} add(divide.2119, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.2121 = f32[1,31,1]{2,1,0} sqrt(add.2120), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.2122 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.2121), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.2123 = f32[1,31,1]{2,1,0} broadcast(divide.2122), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.2124 = f32[1,31]{1,0} reshape(broadcast.2123), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.2125 = f32[1,31,2304]{2,1,0} broadcast(reshape.2124), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.2126 = f32[1,31,2304]{2,1,0} multiply(dot.2111, broadcast.2125), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_76.77 = f32[2304]{0} parameter(76), metadata={op_name="state[1][74]"}
  add.2127 = f32[2304]{0} add(Arg_76.77, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2128 = f32[1,1,2304]{2,1,0} reshape(add.2127), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2129 = f32[1,1,2304]{2,1,0} broadcast(reshape.2128), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2130 = f32[1,2304]{1,0} reshape(broadcast.2129), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2131 = f32[1,31,2304]{2,1,0} broadcast(reshape.2130), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.2132 = f32[1,31,2304]{2,1,0} multiply(multiply.2126, broadcast.2131), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.2133 = f32[1,31,2304]{2,1,0} add(multiply.2132, add.2077), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_6/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.2134 = f32[1,31,2304]{2,1,0} multiply(add.2133, add.2133), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.2139 = f32[1,31]{1,0} reduce(multiply.2134, constant.342), dimensions={2}, to_apply=region_50.2135, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.2140 = f32[1,31,1]{2,1,0} reshape(reduce.2139), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.2141 = f32[1,31,1]{2,1,0} divide(reshape.2140, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.2142 = f32[1,31,1]{2,1,0} add(divide.2141, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.2143 = f32[1,31,1]{2,1,0} sqrt(add.2142), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.2144 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.2143), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.2145 = f32[1,31,1]{2,1,0} broadcast(divide.2144), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.2146 = f32[1,31]{1,0} reshape(broadcast.2145), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.2147 = f32[1,31,2304]{2,1,0} broadcast(reshape.2146), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.2148 = f32[1,31,2304]{2,1,0} multiply(add.2133, broadcast.2147), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_80.81 = f32[2304]{0} parameter(80), metadata={op_name="state[1][78]"}
  add.2149 = f32[2304]{0} add(Arg_80.81, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2150 = f32[1,1,2304]{2,1,0} reshape(add.2149), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2151 = f32[1,1,2304]{2,1,0} broadcast(reshape.2150), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2152 = f32[1,2304]{1,0} reshape(broadcast.2151), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2153 = f32[1,31,2304]{2,1,0} broadcast(reshape.2152), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.2154 = f32[1,31,2304]{2,1,0} multiply(multiply.2148, broadcast.2153), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_83.84 = f32[4,2304,256]{2,1,0} parameter(83), metadata={op_name="state[1][81]"}
  dot.2195 = f32[1,31,4,256]{3,2,1,0} dot(multiply.2154, Arg_83.84), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.2196 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.2197 = f32[128]{0} divide(broadcast.321, power.2196), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.2198 = f32[31,128]{1,0} dot(constant.319, divide.2197), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.2199 = f32[31,1,128]{2,1,0} reshape(dot.2198), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2200 = f32[31,1,128]{2,1,0} reshape(dot.2198), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2201 = f32[31,2,128]{2,1,0} concatenate(reshape.2199, reshape.2200), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2202 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.2201), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.2203 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.2202), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.2212 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.2203), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.2213 = f32[1,31,256]{2,1,0} reshape(broadcast.2212), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.2214 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.2213), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.2215 = f32[1,31,4,256]{3,2,1,0} multiply(dot.2195, broadcast.2214), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.2206 = f32[1,31,4,128]{3,2,1,0} slice(dot.2195), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.2207 = f32[1,31,4,128]{3,2,1,0} negate(slice.2206), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.2208 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.2207), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.2205 = f32[1,31,4,128]{3,2,1,0} slice(dot.2195), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2209 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.2205), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2210 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.2208, reshape.2209), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2211 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.2210), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.2204 = f32[1,31,1,256]{3,2,1,0} sine(reshape.2202), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.2216 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.2204), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.2217 = f32[1,31,256]{2,1,0} reshape(broadcast.2216), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.2218 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.2217), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.2219 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.2211, broadcast.2218), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.2220 = f32[1,31,4,256]{3,2,1,0} add(multiply.2215, multiply.2219), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.2221 = f32[1,31,4,128]{3,2,1,0} slice(add.2220), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2223 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.2221), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.2222 = f32[1,31,4,128]{3,2,1,0} slice(add.2220), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2224 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.2222), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2225 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.2223, reshape.2224), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2228 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.2225), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_84.85 = f32[4,2304,256]{2,1,0} parameter(84), metadata={op_name="state[1][82]"}
  dot.2227 = f32[1,31,4,256]{3,2,1,0} dot(multiply.2154, Arg_84.85), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.2229 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.2227), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2230 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.2228, reshape.2229), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6670 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.2230), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.2155 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.2156 = f32[31]{0} reshape(broadcast.2155), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.2157 = f32[31,31]{1,0} broadcast(reshape.2156), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.2158 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.2159 = f32[31]{0} reshape(broadcast.2158), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.2160 = f32[31,31]{1,0} broadcast(reshape.2159), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.2161 = pred[31,31]{1,0} compare(broadcast.2157, broadcast.2160), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.2162 = pred[1,31,31]{2,1,0} reshape(compare.2161), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.2271 = s32[1,31,31]{2,1,0} convert(reshape.2162), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.2272 = pred[1,31,31]{2,1,0} compare(convert.2271, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.2277 = pred[1,31]{1,0} reduce(compare.2272, constant.340), dimensions={2}, to_apply=region_53.2273, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.2278 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.2277), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.2226 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.2225), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_82.83 = f32[8,2304,256]{2,1,0} parameter(82), metadata={op_name="state[1][80]"}
  dot.2163 = f32[1,31,8,256]{3,2,1,0} dot(multiply.2154, Arg_82.83), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.2164 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.2165 = f32[128]{0} divide(broadcast.321, power.2164), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.2166 = f32[31,128]{1,0} dot(constant.319, divide.2165), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.2167 = f32[31,1,128]{2,1,0} reshape(dot.2166), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2168 = f32[31,1,128]{2,1,0} reshape(dot.2166), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2169 = f32[31,2,128]{2,1,0} concatenate(reshape.2167, reshape.2168), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2170 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.2169), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.2171 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.2170), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.2180 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.2171), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.2181 = f32[1,31,256]{2,1,0} reshape(broadcast.2180), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.2182 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.2181), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.2183 = f32[1,31,8,256]{3,2,1,0} multiply(dot.2163, broadcast.2182), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.2174 = f32[1,31,8,128]{3,2,1,0} slice(dot.2163), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.2175 = f32[1,31,8,128]{3,2,1,0} negate(slice.2174), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.2176 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.2175), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.2173 = f32[1,31,8,128]{3,2,1,0} slice(dot.2163), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2177 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.2173), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2178 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.2176, reshape.2177), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2179 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.2178), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.2172 = f32[1,31,1,256]{3,2,1,0} sine(reshape.2170), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.2184 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.2172), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.2185 = f32[1,31,256]{2,1,0} reshape(broadcast.2184), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.2186 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.2185), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.2187 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.2179, broadcast.2186), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.2188 = f32[1,31,8,256]{3,2,1,0} add(multiply.2183, multiply.2187), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/rotary_embedding_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.2189 = f32[1,31,8,128]{3,2,1,0} slice(add.2188), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2191 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.2189), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.2190 = f32[1,31,8,128]{3,2,1,0} slice(add.2188), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2192 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.2190), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2193 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.2191, reshape.2192), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2194 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.2193), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.2231 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.2194, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.2232 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.2231), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.2233 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.2226, reshape.2232), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.2234 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.2233), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.2235 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.2234, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.2236 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.2235), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.2237 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.2236, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.2238 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(compare.2161), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.2239 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.2238), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.2240 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.2239), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.2241 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.2240, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.2242 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.2241), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.2243 = f32[1,31,31]{2,1,0} reshape(broadcast.2242), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.2244 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.2243), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.2245 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.2237, broadcast.2244), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.2250 = f32[1,4,2,31]{3,2,1,0} reduce(add.2245, constant.339), dimensions={4}, to_apply=region_51.2246, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.2251 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.2250, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.2252 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.2251), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.2253 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.2252), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.2254 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.2253), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.2255 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.2254), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.2256 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.2245, broadcast.2255), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.2257 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.2256), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.2262 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.2257, constant.342), dimensions={4}, to_apply=region_52.2258, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.2263 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.2262), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.2264 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.2263), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.2265 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.2264), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.2266 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.2265), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.2267 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.2257, broadcast.2266), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/softmax_7/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.2268 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.2227, divide.2267), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.2269 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.2268), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.2270 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.2269), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.2287 = f32[1,31,8,256]{3,2,1,0} call(reshape.2278, broadcast.304, reshape.2270), to_apply=_where_0.2279
  Arg_85.86 = f32[8,256,2304]{2,1,0} parameter(85), metadata={op_name="state[1][83]"}
  dot.2288 = f32[1,31,2304]{2,1,0} dot(call.2287, Arg_85.86), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.2289 = f32[1,31,2304]{2,1,0} multiply(dot.2288, dot.2288), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.2294 = f32[1,31]{1,0} reduce(multiply.2289, constant.342), dimensions={2}, to_apply=region_54.2290, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.2295 = f32[1,31,1]{2,1,0} reshape(reduce.2294), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.2296 = f32[1,31,1]{2,1,0} divide(reshape.2295, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.2297 = f32[1,31,1]{2,1,0} add(divide.2296, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.2298 = f32[1,31,1]{2,1,0} sqrt(add.2297), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.2299 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.2298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.2300 = f32[1,31,1]{2,1,0} broadcast(divide.2299), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.2301 = f32[1,31]{1,0} reshape(broadcast.2300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.2302 = f32[1,31,2304]{2,1,0} broadcast(reshape.2301), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.2303 = f32[1,31,2304]{2,1,0} multiply(dot.2288, broadcast.2302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_81.82 = f32[2304]{0} parameter(81), metadata={op_name="state[1][79]"}
  add.2304 = f32[2304]{0} add(Arg_81.82, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2305 = f32[1,1,2304]{2,1,0} reshape(add.2304), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2306 = f32[1,1,2304]{2,1,0} broadcast(reshape.2305), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2307 = f32[1,2304]{1,0} reshape(broadcast.2306), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2308 = f32[1,31,2304]{2,1,0} broadcast(reshape.2307), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.2309 = f32[1,31,2304]{2,1,0} multiply(multiply.2303, broadcast.2308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.2310 = f32[1,31,2304]{2,1,0} add(add.2133, multiply.2309), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.2311 = f32[1,31,2304]{2,1,0} multiply(add.2310, add.2310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.2316 = f32[1,31]{1,0} reduce(multiply.2311, constant.342), dimensions={2}, to_apply=region_55.2312, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.2317 = f32[1,31,1]{2,1,0} reshape(reduce.2316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.2318 = f32[1,31,1]{2,1,0} divide(reshape.2317, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.2319 = f32[1,31,1]{2,1,0} add(divide.2318, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.2320 = f32[1,31,1]{2,1,0} sqrt(add.2319), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.2321 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.2320), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.2322 = f32[1,31,1]{2,1,0} broadcast(divide.2321), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.2323 = f32[1,31]{1,0} reshape(broadcast.2322), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.2324 = f32[1,31,2304]{2,1,0} broadcast(reshape.2323), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.2325 = f32[1,31,2304]{2,1,0} multiply(add.2310, broadcast.2324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_86.87 = f32[2304]{0} parameter(86), metadata={op_name="state[1][84]"}
  add.2326 = f32[2304]{0} add(Arg_86.87, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2327 = f32[1,1,2304]{2,1,0} reshape(add.2326), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2328 = f32[1,1,2304]{2,1,0} broadcast(reshape.2327), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2329 = f32[1,2304]{1,0} reshape(broadcast.2328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2330 = f32[1,31,2304]{2,1,0} broadcast(reshape.2329), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.2331 = f32[1,31,2304]{2,1,0} multiply(multiply.2325, broadcast.2330), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_88.89 = f32[2304,9216]{1,0} parameter(88), metadata={op_name="state[1][86]"}
  dot.2332 = f32[1,31,9216]{2,1,0} dot(multiply.2331, Arg_88.89), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.2334 = f32[1,31,9216]{2,1,0} multiply(dot.2332, dot.2332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2335 = f32[1,31,9216]{2,1,0} multiply(multiply.2334, dot.2332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2336 = f32[1,31,9216]{2,1,0} multiply(multiply.2335, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.2337 = f32[1,31,9216]{2,1,0} add(dot.2332, multiply.2336), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2338 = f32[1,31,9216]{2,1,0} multiply(add.2337, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.2339 = f32[1,31,9216]{2,1,0} tanh(multiply.2338), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.2340 = f32[1,31,9216]{2,1,0} add(tanh.2339, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2341 = f32[1,31,9216]{2,1,0} multiply(add.2340, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2342 = f32[1,31,9216]{2,1,0} multiply(dot.2332, multiply.2341), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_89.90 = f32[2304,9216]{1,0} parameter(89), metadata={op_name="state[1][87]"}
  dot.2333 = f32[1,31,9216]{2,1,0} dot(multiply.2331, Arg_89.90), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.2343 = f32[1,31,9216]{2,1,0} multiply(multiply.2342, dot.2333), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_90.91 = f32[9216,2304]{1,0} parameter(90), metadata={op_name="state[1][88]"}
  dot.2344 = f32[1,31,2304]{2,1,0} dot(multiply.2343, Arg_90.91), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.2345 = f32[1,31,2304]{2,1,0} multiply(dot.2344, dot.2344), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.2350 = f32[1,31]{1,0} reduce(multiply.2345, constant.342), dimensions={2}, to_apply=region_56.2346, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.2351 = f32[1,31,1]{2,1,0} reshape(reduce.2350), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.2352 = f32[1,31,1]{2,1,0} divide(reshape.2351, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.2353 = f32[1,31,1]{2,1,0} add(divide.2352, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.2354 = f32[1,31,1]{2,1,0} sqrt(add.2353), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.2355 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.2354), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.2356 = f32[1,31,1]{2,1,0} broadcast(divide.2355), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.2357 = f32[1,31]{1,0} reshape(broadcast.2356), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.2358 = f32[1,31,2304]{2,1,0} broadcast(reshape.2357), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.2359 = f32[1,31,2304]{2,1,0} multiply(dot.2344, broadcast.2358), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_87.88 = f32[2304]{0} parameter(87), metadata={op_name="state[1][85]"}
  add.2360 = f32[2304]{0} add(Arg_87.88, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2361 = f32[1,1,2304]{2,1,0} reshape(add.2360), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2362 = f32[1,1,2304]{2,1,0} broadcast(reshape.2361), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2363 = f32[1,2304]{1,0} reshape(broadcast.2362), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2364 = f32[1,31,2304]{2,1,0} broadcast(reshape.2363), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.2365 = f32[1,31,2304]{2,1,0} multiply(multiply.2359, broadcast.2364), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.2366 = f32[1,31,2304]{2,1,0} add(multiply.2365, add.2310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_7/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.2367 = f32[1,31,2304]{2,1,0} multiply(add.2366, add.2366), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.2372 = f32[1,31]{1,0} reduce(multiply.2367, constant.342), dimensions={2}, to_apply=region_57.2368, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.2373 = f32[1,31,1]{2,1,0} reshape(reduce.2372), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.2374 = f32[1,31,1]{2,1,0} divide(reshape.2373, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.2375 = f32[1,31,1]{2,1,0} add(divide.2374, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.2376 = f32[1,31,1]{2,1,0} sqrt(add.2375), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.2377 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.2376), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.2378 = f32[1,31,1]{2,1,0} broadcast(divide.2377), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.2379 = f32[1,31]{1,0} reshape(broadcast.2378), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.2380 = f32[1,31,2304]{2,1,0} broadcast(reshape.2379), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.2381 = f32[1,31,2304]{2,1,0} multiply(add.2366, broadcast.2380), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_91.92 = f32[2304]{0} parameter(91), metadata={op_name="state[1][89]"}
  add.2382 = f32[2304]{0} add(Arg_91.92, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2383 = f32[1,1,2304]{2,1,0} reshape(add.2382), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2384 = f32[1,1,2304]{2,1,0} broadcast(reshape.2383), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2385 = f32[1,2304]{1,0} reshape(broadcast.2384), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2386 = f32[1,31,2304]{2,1,0} broadcast(reshape.2385), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.2387 = f32[1,31,2304]{2,1,0} multiply(multiply.2381, broadcast.2386), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_94.95 = f32[4,2304,256]{2,1,0} parameter(94), metadata={op_name="state[1][92]"}
  dot.2428 = f32[1,31,4,256]{3,2,1,0} dot(multiply.2387, Arg_94.95), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.2429 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.2430 = f32[128]{0} divide(broadcast.321, power.2429), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.2431 = f32[31,128]{1,0} dot(constant.319, divide.2430), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.2432 = f32[31,1,128]{2,1,0} reshape(dot.2431), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2433 = f32[31,1,128]{2,1,0} reshape(dot.2431), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2434 = f32[31,2,128]{2,1,0} concatenate(reshape.2432, reshape.2433), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2435 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.2434), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.2436 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.2435), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.2445 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.2436), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.2446 = f32[1,31,256]{2,1,0} reshape(broadcast.2445), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.2447 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.2446), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.2448 = f32[1,31,4,256]{3,2,1,0} multiply(dot.2428, broadcast.2447), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.2439 = f32[1,31,4,128]{3,2,1,0} slice(dot.2428), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.2440 = f32[1,31,4,128]{3,2,1,0} negate(slice.2439), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.2441 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.2440), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.2438 = f32[1,31,4,128]{3,2,1,0} slice(dot.2428), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2442 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.2438), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2443 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.2441, reshape.2442), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2444 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.2443), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.2437 = f32[1,31,1,256]{3,2,1,0} sine(reshape.2435), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.2449 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.2437), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.2450 = f32[1,31,256]{2,1,0} reshape(broadcast.2449), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.2451 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.2450), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.2452 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.2444, broadcast.2451), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.2453 = f32[1,31,4,256]{3,2,1,0} add(multiply.2448, multiply.2452), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.2454 = f32[1,31,4,128]{3,2,1,0} slice(add.2453), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2456 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.2454), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.2455 = f32[1,31,4,128]{3,2,1,0} slice(add.2453), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2457 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.2455), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2458 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.2456, reshape.2457), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2461 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.2458), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_95.96 = f32[4,2304,256]{2,1,0} parameter(95), metadata={op_name="state[1][93]"}
  dot.2460 = f32[1,31,4,256]{3,2,1,0} dot(multiply.2387, Arg_95.96), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.2462 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.2460), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2463 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.2461, reshape.2462), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6671 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.2463), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.2388 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.2389 = f32[31]{0} reshape(broadcast.2388), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.2390 = f32[31,31]{1,0} broadcast(reshape.2389), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.2391 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.2392 = f32[31]{0} reshape(broadcast.2391), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.2393 = f32[31,31]{1,0} broadcast(reshape.2392), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.2394 = pred[31,31]{1,0} compare(broadcast.2390, broadcast.2393), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.2395 = pred[1,31,31]{2,1,0} reshape(compare.2394), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.2535 = s32[1,31,31]{2,1,0} convert(reshape.2395), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.2536 = pred[1,31,31]{2,1,0} compare(convert.2535, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.2541 = pred[1,31]{1,0} reduce(compare.2536, constant.340), dimensions={2}, to_apply=region_60.2537, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.2542 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.2541), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.2459 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.2458), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_93.94 = f32[8,2304,256]{2,1,0} parameter(93), metadata={op_name="state[1][91]"}
  dot.2396 = f32[1,31,8,256]{3,2,1,0} dot(multiply.2387, Arg_93.94), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.2397 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.2398 = f32[128]{0} divide(broadcast.321, power.2397), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.2399 = f32[31,128]{1,0} dot(constant.319, divide.2398), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.2400 = f32[31,1,128]{2,1,0} reshape(dot.2399), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2401 = f32[31,1,128]{2,1,0} reshape(dot.2399), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2402 = f32[31,2,128]{2,1,0} concatenate(reshape.2400, reshape.2401), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2403 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.2402), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.2404 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.2403), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.2413 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.2404), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.2414 = f32[1,31,256]{2,1,0} reshape(broadcast.2413), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.2415 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.2414), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.2416 = f32[1,31,8,256]{3,2,1,0} multiply(dot.2396, broadcast.2415), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.2407 = f32[1,31,8,128]{3,2,1,0} slice(dot.2396), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.2408 = f32[1,31,8,128]{3,2,1,0} negate(slice.2407), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.2409 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.2408), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.2406 = f32[1,31,8,128]{3,2,1,0} slice(dot.2396), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2410 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.2406), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2411 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.2409, reshape.2410), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2412 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.2411), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.2405 = f32[1,31,1,256]{3,2,1,0} sine(reshape.2403), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.2417 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.2405), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.2418 = f32[1,31,256]{2,1,0} reshape(broadcast.2417), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.2419 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.2418), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.2420 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.2412, broadcast.2419), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.2421 = f32[1,31,8,256]{3,2,1,0} add(multiply.2416, multiply.2420), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/rotary_embedding_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.2422 = f32[1,31,8,128]{3,2,1,0} slice(add.2421), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2424 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.2422), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.2423 = f32[1,31,8,128]{3,2,1,0} slice(add.2421), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2425 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.2423), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2426 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.2424, reshape.2425), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2427 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.2426), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.2464 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.2427, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.2465 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.2464), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.2466 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.2459, reshape.2465), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.2467 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.2466), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.2468 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.2467, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.2469 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.2468), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.2470 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.2469, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.2484 = pred[31,31]{1,0} call(broadcast.314), to_apply=triu.2471
  call.2498 = pred[31,31]{1,0} call(broadcast.314), to_apply=tril.2485
  and.2499 = pred[31,31]{1,0} and(call.2484, call.2498), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  reshape.2500 = pred[1,31,31]{2,1,0} reshape(and.2499), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.2501 = pred[1,31,31]{2,1,0} and(reshape.2395, reshape.2500), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.2502 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(and.2501), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.2503 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.2502), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.2504 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.2503), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.2505 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.2504, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.2506 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.2505), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.2507 = f32[1,31,31]{2,1,0} reshape(broadcast.2506), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.2508 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.2507), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.2509 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.2470, broadcast.2508), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.2514 = f32[1,4,2,31]{3,2,1,0} reduce(add.2509, constant.339), dimensions={4}, to_apply=region_58.2510, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.2515 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.2514, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.2516 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.2515), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.2517 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.2516), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.2518 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.2517), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.2519 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.2518), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.2520 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.2509, broadcast.2519), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.2521 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.2520), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.2526 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.2521, constant.342), dimensions={4}, to_apply=region_59.2522, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.2527 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.2526), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.2528 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.2527), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.2529 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.2528), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.2530 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.2529), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.2531 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.2521, broadcast.2530), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/softmax_8/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.2532 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.2460, divide.2531), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.2533 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.2532), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.2534 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.2533), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.2551 = f32[1,31,8,256]{3,2,1,0} call(reshape.2542, broadcast.304, reshape.2534), to_apply=_where_0.2543
  Arg_96.97 = f32[8,256,2304]{2,1,0} parameter(96), metadata={op_name="state[1][94]"}
  dot.2552 = f32[1,31,2304]{2,1,0} dot(call.2551, Arg_96.97), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.2553 = f32[1,31,2304]{2,1,0} multiply(dot.2552, dot.2552), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.2558 = f32[1,31]{1,0} reduce(multiply.2553, constant.342), dimensions={2}, to_apply=region_61.2554, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.2559 = f32[1,31,1]{2,1,0} reshape(reduce.2558), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.2560 = f32[1,31,1]{2,1,0} divide(reshape.2559, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.2561 = f32[1,31,1]{2,1,0} add(divide.2560, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.2562 = f32[1,31,1]{2,1,0} sqrt(add.2561), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.2563 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.2562), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.2564 = f32[1,31,1]{2,1,0} broadcast(divide.2563), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.2565 = f32[1,31]{1,0} reshape(broadcast.2564), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.2566 = f32[1,31,2304]{2,1,0} broadcast(reshape.2565), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.2567 = f32[1,31,2304]{2,1,0} multiply(dot.2552, broadcast.2566), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_92.93 = f32[2304]{0} parameter(92), metadata={op_name="state[1][90]"}
  add.2568 = f32[2304]{0} add(Arg_92.93, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2569 = f32[1,1,2304]{2,1,0} reshape(add.2568), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2570 = f32[1,1,2304]{2,1,0} broadcast(reshape.2569), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2571 = f32[1,2304]{1,0} reshape(broadcast.2570), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2572 = f32[1,31,2304]{2,1,0} broadcast(reshape.2571), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.2573 = f32[1,31,2304]{2,1,0} multiply(multiply.2567, broadcast.2572), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.2574 = f32[1,31,2304]{2,1,0} add(add.2366, multiply.2573), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.2575 = f32[1,31,2304]{2,1,0} multiply(add.2574, add.2574), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.2580 = f32[1,31]{1,0} reduce(multiply.2575, constant.342), dimensions={2}, to_apply=region_62.2576, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.2581 = f32[1,31,1]{2,1,0} reshape(reduce.2580), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.2582 = f32[1,31,1]{2,1,0} divide(reshape.2581, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.2583 = f32[1,31,1]{2,1,0} add(divide.2582, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.2584 = f32[1,31,1]{2,1,0} sqrt(add.2583), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.2585 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.2584), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.2586 = f32[1,31,1]{2,1,0} broadcast(divide.2585), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.2587 = f32[1,31]{1,0} reshape(broadcast.2586), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.2588 = f32[1,31,2304]{2,1,0} broadcast(reshape.2587), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.2589 = f32[1,31,2304]{2,1,0} multiply(add.2574, broadcast.2588), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_97.98 = f32[2304]{0} parameter(97), metadata={op_name="state[1][95]"}
  add.2590 = f32[2304]{0} add(Arg_97.98, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2591 = f32[1,1,2304]{2,1,0} reshape(add.2590), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2592 = f32[1,1,2304]{2,1,0} broadcast(reshape.2591), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2593 = f32[1,2304]{1,0} reshape(broadcast.2592), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2594 = f32[1,31,2304]{2,1,0} broadcast(reshape.2593), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.2595 = f32[1,31,2304]{2,1,0} multiply(multiply.2589, broadcast.2594), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_99.100 = f32[2304,9216]{1,0} parameter(99), metadata={op_name="state[1][97]"}
  dot.2596 = f32[1,31,9216]{2,1,0} dot(multiply.2595, Arg_99.100), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.2598 = f32[1,31,9216]{2,1,0} multiply(dot.2596, dot.2596), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2599 = f32[1,31,9216]{2,1,0} multiply(multiply.2598, dot.2596), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2600 = f32[1,31,9216]{2,1,0} multiply(multiply.2599, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.2601 = f32[1,31,9216]{2,1,0} add(dot.2596, multiply.2600), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2602 = f32[1,31,9216]{2,1,0} multiply(add.2601, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.2603 = f32[1,31,9216]{2,1,0} tanh(multiply.2602), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.2604 = f32[1,31,9216]{2,1,0} add(tanh.2603, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2605 = f32[1,31,9216]{2,1,0} multiply(add.2604, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2606 = f32[1,31,9216]{2,1,0} multiply(dot.2596, multiply.2605), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_100.101 = f32[2304,9216]{1,0} parameter(100), metadata={op_name="state[1][98]"}
  dot.2597 = f32[1,31,9216]{2,1,0} dot(multiply.2595, Arg_100.101), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.2607 = f32[1,31,9216]{2,1,0} multiply(multiply.2606, dot.2597), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_101.102 = f32[9216,2304]{1,0} parameter(101), metadata={op_name="state[1][99]"}
  dot.2608 = f32[1,31,2304]{2,1,0} dot(multiply.2607, Arg_101.102), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.2609 = f32[1,31,2304]{2,1,0} multiply(dot.2608, dot.2608), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.2614 = f32[1,31]{1,0} reduce(multiply.2609, constant.342), dimensions={2}, to_apply=region_63.2610, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.2615 = f32[1,31,1]{2,1,0} reshape(reduce.2614), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.2616 = f32[1,31,1]{2,1,0} divide(reshape.2615, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.2617 = f32[1,31,1]{2,1,0} add(divide.2616, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.2618 = f32[1,31,1]{2,1,0} sqrt(add.2617), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.2619 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.2618), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.2620 = f32[1,31,1]{2,1,0} broadcast(divide.2619), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.2621 = f32[1,31]{1,0} reshape(broadcast.2620), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.2622 = f32[1,31,2304]{2,1,0} broadcast(reshape.2621), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.2623 = f32[1,31,2304]{2,1,0} multiply(dot.2608, broadcast.2622), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_98.99 = f32[2304]{0} parameter(98), metadata={op_name="state[1][96]"}
  add.2624 = f32[2304]{0} add(Arg_98.99, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2625 = f32[1,1,2304]{2,1,0} reshape(add.2624), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2626 = f32[1,1,2304]{2,1,0} broadcast(reshape.2625), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2627 = f32[1,2304]{1,0} reshape(broadcast.2626), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2628 = f32[1,31,2304]{2,1,0} broadcast(reshape.2627), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.2629 = f32[1,31,2304]{2,1,0} multiply(multiply.2623, broadcast.2628), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.2630 = f32[1,31,2304]{2,1,0} add(multiply.2629, add.2574), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_8/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.2631 = f32[1,31,2304]{2,1,0} multiply(add.2630, add.2630), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.2636 = f32[1,31]{1,0} reduce(multiply.2631, constant.342), dimensions={2}, to_apply=region_64.2632, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.2637 = f32[1,31,1]{2,1,0} reshape(reduce.2636), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.2638 = f32[1,31,1]{2,1,0} divide(reshape.2637, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.2639 = f32[1,31,1]{2,1,0} add(divide.2638, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.2640 = f32[1,31,1]{2,1,0} sqrt(add.2639), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.2641 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.2640), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.2642 = f32[1,31,1]{2,1,0} broadcast(divide.2641), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.2643 = f32[1,31]{1,0} reshape(broadcast.2642), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.2644 = f32[1,31,2304]{2,1,0} broadcast(reshape.2643), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.2645 = f32[1,31,2304]{2,1,0} multiply(add.2630, broadcast.2644), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_102.103 = f32[2304]{0} parameter(102), metadata={op_name="state[1][100]"}
  add.2646 = f32[2304]{0} add(Arg_102.103, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2647 = f32[1,1,2304]{2,1,0} reshape(add.2646), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2648 = f32[1,1,2304]{2,1,0} broadcast(reshape.2647), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2649 = f32[1,2304]{1,0} reshape(broadcast.2648), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2650 = f32[1,31,2304]{2,1,0} broadcast(reshape.2649), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.2651 = f32[1,31,2304]{2,1,0} multiply(multiply.2645, broadcast.2650), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_105.106 = f32[4,2304,256]{2,1,0} parameter(105), metadata={op_name="state[1][103]"}
  dot.2692 = f32[1,31,4,256]{3,2,1,0} dot(multiply.2651, Arg_105.106), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.2693 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.2694 = f32[128]{0} divide(broadcast.321, power.2693), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.2695 = f32[31,128]{1,0} dot(constant.319, divide.2694), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.2696 = f32[31,1,128]{2,1,0} reshape(dot.2695), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2697 = f32[31,1,128]{2,1,0} reshape(dot.2695), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2698 = f32[31,2,128]{2,1,0} concatenate(reshape.2696, reshape.2697), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2699 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.2698), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.2700 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.2699), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.2709 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.2700), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.2710 = f32[1,31,256]{2,1,0} reshape(broadcast.2709), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.2711 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.2710), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.2712 = f32[1,31,4,256]{3,2,1,0} multiply(dot.2692, broadcast.2711), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.2703 = f32[1,31,4,128]{3,2,1,0} slice(dot.2692), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.2704 = f32[1,31,4,128]{3,2,1,0} negate(slice.2703), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.2705 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.2704), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.2702 = f32[1,31,4,128]{3,2,1,0} slice(dot.2692), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2706 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.2702), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2707 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.2705, reshape.2706), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2708 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.2707), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.2701 = f32[1,31,1,256]{3,2,1,0} sine(reshape.2699), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.2713 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.2701), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.2714 = f32[1,31,256]{2,1,0} reshape(broadcast.2713), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.2715 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.2714), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.2716 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.2708, broadcast.2715), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.2717 = f32[1,31,4,256]{3,2,1,0} add(multiply.2712, multiply.2716), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.2718 = f32[1,31,4,128]{3,2,1,0} slice(add.2717), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2720 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.2718), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.2719 = f32[1,31,4,128]{3,2,1,0} slice(add.2717), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2721 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.2719), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2722 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.2720, reshape.2721), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2725 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.2722), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_106.107 = f32[4,2304,256]{2,1,0} parameter(106), metadata={op_name="state[1][104]"}
  dot.2724 = f32[1,31,4,256]{3,2,1,0} dot(multiply.2651, Arg_106.107), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.2726 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.2724), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2727 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.2725, reshape.2726), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6672 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.2727), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.2652 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.2653 = f32[31]{0} reshape(broadcast.2652), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.2654 = f32[31,31]{1,0} broadcast(reshape.2653), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.2655 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.2656 = f32[31]{0} reshape(broadcast.2655), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.2657 = f32[31,31]{1,0} broadcast(reshape.2656), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.2658 = pred[31,31]{1,0} compare(broadcast.2654, broadcast.2657), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.2659 = pred[1,31,31]{2,1,0} reshape(compare.2658), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.2768 = s32[1,31,31]{2,1,0} convert(reshape.2659), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.2769 = pred[1,31,31]{2,1,0} compare(convert.2768, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.2774 = pred[1,31]{1,0} reduce(compare.2769, constant.340), dimensions={2}, to_apply=region_67.2770, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.2775 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.2774), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.2723 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.2722), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_104.105 = f32[8,2304,256]{2,1,0} parameter(104), metadata={op_name="state[1][102]"}
  dot.2660 = f32[1,31,8,256]{3,2,1,0} dot(multiply.2651, Arg_104.105), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.2661 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.2662 = f32[128]{0} divide(broadcast.321, power.2661), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.2663 = f32[31,128]{1,0} dot(constant.319, divide.2662), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.2664 = f32[31,1,128]{2,1,0} reshape(dot.2663), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2665 = f32[31,1,128]{2,1,0} reshape(dot.2663), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2666 = f32[31,2,128]{2,1,0} concatenate(reshape.2664, reshape.2665), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2667 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.2666), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.2668 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.2667), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.2677 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.2668), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.2678 = f32[1,31,256]{2,1,0} reshape(broadcast.2677), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.2679 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.2678), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.2680 = f32[1,31,8,256]{3,2,1,0} multiply(dot.2660, broadcast.2679), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.2671 = f32[1,31,8,128]{3,2,1,0} slice(dot.2660), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.2672 = f32[1,31,8,128]{3,2,1,0} negate(slice.2671), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.2673 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.2672), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.2670 = f32[1,31,8,128]{3,2,1,0} slice(dot.2660), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2674 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.2670), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2675 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.2673, reshape.2674), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2676 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.2675), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.2669 = f32[1,31,1,256]{3,2,1,0} sine(reshape.2667), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.2681 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.2669), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.2682 = f32[1,31,256]{2,1,0} reshape(broadcast.2681), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.2683 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.2682), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.2684 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.2676, broadcast.2683), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.2685 = f32[1,31,8,256]{3,2,1,0} add(multiply.2680, multiply.2684), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/rotary_embedding_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.2686 = f32[1,31,8,128]{3,2,1,0} slice(add.2685), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2688 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.2686), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.2687 = f32[1,31,8,128]{3,2,1,0} slice(add.2685), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2689 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.2687), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2690 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.2688, reshape.2689), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2691 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.2690), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.2728 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.2691, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.2729 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.2728), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.2730 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.2723, reshape.2729), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.2731 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.2730), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.2732 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.2731, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.2733 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.2732), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.2734 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.2733, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.2735 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(compare.2658), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.2736 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.2735), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.2737 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.2736), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.2738 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.2737, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.2739 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.2738), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.2740 = f32[1,31,31]{2,1,0} reshape(broadcast.2739), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.2741 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.2740), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.2742 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.2734, broadcast.2741), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.2747 = f32[1,4,2,31]{3,2,1,0} reduce(add.2742, constant.339), dimensions={4}, to_apply=region_65.2743, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.2748 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.2747, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.2749 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.2748), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.2750 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.2749), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.2751 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.2750), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.2752 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.2751), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.2753 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.2742, broadcast.2752), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.2754 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.2753), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.2759 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.2754, constant.342), dimensions={4}, to_apply=region_66.2755, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.2760 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.2759), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.2761 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.2760), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.2762 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.2761), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.2763 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.2762), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.2764 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.2754, broadcast.2763), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/softmax_9/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.2765 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.2724, divide.2764), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.2766 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.2765), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.2767 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.2766), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.2784 = f32[1,31,8,256]{3,2,1,0} call(reshape.2775, broadcast.304, reshape.2767), to_apply=_where_0.2776
  Arg_107.108 = f32[8,256,2304]{2,1,0} parameter(107), metadata={op_name="state[1][105]"}
  dot.2785 = f32[1,31,2304]{2,1,0} dot(call.2784, Arg_107.108), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.2786 = f32[1,31,2304]{2,1,0} multiply(dot.2785, dot.2785), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.2791 = f32[1,31]{1,0} reduce(multiply.2786, constant.342), dimensions={2}, to_apply=region_68.2787, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.2792 = f32[1,31,1]{2,1,0} reshape(reduce.2791), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.2793 = f32[1,31,1]{2,1,0} divide(reshape.2792, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.2794 = f32[1,31,1]{2,1,0} add(divide.2793, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.2795 = f32[1,31,1]{2,1,0} sqrt(add.2794), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.2796 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.2795), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.2797 = f32[1,31,1]{2,1,0} broadcast(divide.2796), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.2798 = f32[1,31]{1,0} reshape(broadcast.2797), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.2799 = f32[1,31,2304]{2,1,0} broadcast(reshape.2798), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.2800 = f32[1,31,2304]{2,1,0} multiply(dot.2785, broadcast.2799), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_103.104 = f32[2304]{0} parameter(103), metadata={op_name="state[1][101]"}
  add.2801 = f32[2304]{0} add(Arg_103.104, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2802 = f32[1,1,2304]{2,1,0} reshape(add.2801), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2803 = f32[1,1,2304]{2,1,0} broadcast(reshape.2802), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2804 = f32[1,2304]{1,0} reshape(broadcast.2803), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2805 = f32[1,31,2304]{2,1,0} broadcast(reshape.2804), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.2806 = f32[1,31,2304]{2,1,0} multiply(multiply.2800, broadcast.2805), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.2807 = f32[1,31,2304]{2,1,0} add(add.2630, multiply.2806), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.2808 = f32[1,31,2304]{2,1,0} multiply(add.2807, add.2807), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.2813 = f32[1,31]{1,0} reduce(multiply.2808, constant.342), dimensions={2}, to_apply=region_69.2809, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.2814 = f32[1,31,1]{2,1,0} reshape(reduce.2813), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.2815 = f32[1,31,1]{2,1,0} divide(reshape.2814, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.2816 = f32[1,31,1]{2,1,0} add(divide.2815, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.2817 = f32[1,31,1]{2,1,0} sqrt(add.2816), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.2818 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.2817), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.2819 = f32[1,31,1]{2,1,0} broadcast(divide.2818), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.2820 = f32[1,31]{1,0} reshape(broadcast.2819), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.2821 = f32[1,31,2304]{2,1,0} broadcast(reshape.2820), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.2822 = f32[1,31,2304]{2,1,0} multiply(add.2807, broadcast.2821), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_108.109 = f32[2304]{0} parameter(108), metadata={op_name="state[1][106]"}
  add.2823 = f32[2304]{0} add(Arg_108.109, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2824 = f32[1,1,2304]{2,1,0} reshape(add.2823), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2825 = f32[1,1,2304]{2,1,0} broadcast(reshape.2824), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2826 = f32[1,2304]{1,0} reshape(broadcast.2825), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2827 = f32[1,31,2304]{2,1,0} broadcast(reshape.2826), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.2828 = f32[1,31,2304]{2,1,0} multiply(multiply.2822, broadcast.2827), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_110.111 = f32[2304,9216]{1,0} parameter(110), metadata={op_name="state[1][108]"}
  dot.2829 = f32[1,31,9216]{2,1,0} dot(multiply.2828, Arg_110.111), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.2831 = f32[1,31,9216]{2,1,0} multiply(dot.2829, dot.2829), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2832 = f32[1,31,9216]{2,1,0} multiply(multiply.2831, dot.2829), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2833 = f32[1,31,9216]{2,1,0} multiply(multiply.2832, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.2834 = f32[1,31,9216]{2,1,0} add(dot.2829, multiply.2833), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2835 = f32[1,31,9216]{2,1,0} multiply(add.2834, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.2836 = f32[1,31,9216]{2,1,0} tanh(multiply.2835), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.2837 = f32[1,31,9216]{2,1,0} add(tanh.2836, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2838 = f32[1,31,9216]{2,1,0} multiply(add.2837, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.2839 = f32[1,31,9216]{2,1,0} multiply(dot.2829, multiply.2838), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_111.112 = f32[2304,9216]{1,0} parameter(111), metadata={op_name="state[1][109]"}
  dot.2830 = f32[1,31,9216]{2,1,0} dot(multiply.2828, Arg_111.112), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.2840 = f32[1,31,9216]{2,1,0} multiply(multiply.2839, dot.2830), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_112.113 = f32[9216,2304]{1,0} parameter(112), metadata={op_name="state[1][110]"}
  dot.2841 = f32[1,31,2304]{2,1,0} dot(multiply.2840, Arg_112.113), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.2842 = f32[1,31,2304]{2,1,0} multiply(dot.2841, dot.2841), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.2847 = f32[1,31]{1,0} reduce(multiply.2842, constant.342), dimensions={2}, to_apply=region_70.2843, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.2848 = f32[1,31,1]{2,1,0} reshape(reduce.2847), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.2849 = f32[1,31,1]{2,1,0} divide(reshape.2848, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.2850 = f32[1,31,1]{2,1,0} add(divide.2849, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.2851 = f32[1,31,1]{2,1,0} sqrt(add.2850), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.2852 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.2851), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.2853 = f32[1,31,1]{2,1,0} broadcast(divide.2852), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.2854 = f32[1,31]{1,0} reshape(broadcast.2853), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.2855 = f32[1,31,2304]{2,1,0} broadcast(reshape.2854), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.2856 = f32[1,31,2304]{2,1,0} multiply(dot.2841, broadcast.2855), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_109.110 = f32[2304]{0} parameter(109), metadata={op_name="state[1][107]"}
  add.2857 = f32[2304]{0} add(Arg_109.110, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2858 = f32[1,1,2304]{2,1,0} reshape(add.2857), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2859 = f32[1,1,2304]{2,1,0} broadcast(reshape.2858), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2860 = f32[1,2304]{1,0} reshape(broadcast.2859), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2861 = f32[1,31,2304]{2,1,0} broadcast(reshape.2860), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.2862 = f32[1,31,2304]{2,1,0} multiply(multiply.2856, broadcast.2861), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.2863 = f32[1,31,2304]{2,1,0} add(multiply.2862, add.2807), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_9/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.2864 = f32[1,31,2304]{2,1,0} multiply(add.2863, add.2863), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.2869 = f32[1,31]{1,0} reduce(multiply.2864, constant.342), dimensions={2}, to_apply=region_71.2865, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.2870 = f32[1,31,1]{2,1,0} reshape(reduce.2869), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.2871 = f32[1,31,1]{2,1,0} divide(reshape.2870, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.2872 = f32[1,31,1]{2,1,0} add(divide.2871, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.2873 = f32[1,31,1]{2,1,0} sqrt(add.2872), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.2874 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.2873), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.2875 = f32[1,31,1]{2,1,0} broadcast(divide.2874), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.2876 = f32[1,31]{1,0} reshape(broadcast.2875), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.2877 = f32[1,31,2304]{2,1,0} broadcast(reshape.2876), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.2878 = f32[1,31,2304]{2,1,0} multiply(add.2863, broadcast.2877), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_113.114 = f32[2304]{0} parameter(113), metadata={op_name="state[1][111]"}
  add.2879 = f32[2304]{0} add(Arg_113.114, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2880 = f32[1,1,2304]{2,1,0} reshape(add.2879), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2881 = f32[1,1,2304]{2,1,0} broadcast(reshape.2880), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.2882 = f32[1,2304]{1,0} reshape(broadcast.2881), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.2883 = f32[1,31,2304]{2,1,0} broadcast(reshape.2882), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.2884 = f32[1,31,2304]{2,1,0} multiply(multiply.2878, broadcast.2883), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_116.117 = f32[4,2304,256]{2,1,0} parameter(116), metadata={op_name="state[1][114]"}
  dot.2925 = f32[1,31,4,256]{3,2,1,0} dot(multiply.2884, Arg_116.117), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.2926 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.2927 = f32[128]{0} divide(broadcast.321, power.2926), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.2928 = f32[31,128]{1,0} dot(constant.319, divide.2927), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.2929 = f32[31,1,128]{2,1,0} reshape(dot.2928), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2930 = f32[31,1,128]{2,1,0} reshape(dot.2928), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2931 = f32[31,2,128]{2,1,0} concatenate(reshape.2929, reshape.2930), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2932 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.2931), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.2933 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.2932), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.2942 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.2933), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.2943 = f32[1,31,256]{2,1,0} reshape(broadcast.2942), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.2944 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.2943), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.2945 = f32[1,31,4,256]{3,2,1,0} multiply(dot.2925, broadcast.2944), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.2936 = f32[1,31,4,128]{3,2,1,0} slice(dot.2925), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.2937 = f32[1,31,4,128]{3,2,1,0} negate(slice.2936), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.2938 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.2937), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.2935 = f32[1,31,4,128]{3,2,1,0} slice(dot.2925), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2939 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.2935), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2940 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.2938, reshape.2939), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2941 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.2940), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.2934 = f32[1,31,1,256]{3,2,1,0} sine(reshape.2932), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.2946 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.2934), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.2947 = f32[1,31,256]{2,1,0} reshape(broadcast.2946), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.2948 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.2947), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.2949 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.2941, broadcast.2948), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.2950 = f32[1,31,4,256]{3,2,1,0} add(multiply.2945, multiply.2949), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.2951 = f32[1,31,4,128]{3,2,1,0} slice(add.2950), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2953 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.2951), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.2952 = f32[1,31,4,128]{3,2,1,0} slice(add.2950), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2954 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.2952), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2955 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.2953, reshape.2954), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2958 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.2955), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_117.118 = f32[4,2304,256]{2,1,0} parameter(117), metadata={op_name="state[1][115]"}
  dot.2957 = f32[1,31,4,256]{3,2,1,0} dot(multiply.2884, Arg_117.118), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.2959 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.2957), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2960 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.2958, reshape.2959), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6673 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.2960), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.2885 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.2886 = f32[31]{0} reshape(broadcast.2885), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.2887 = f32[31,31]{1,0} broadcast(reshape.2886), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.2888 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.2889 = f32[31]{0} reshape(broadcast.2888), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.2890 = f32[31,31]{1,0} broadcast(reshape.2889), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.2891 = pred[31,31]{1,0} compare(broadcast.2887, broadcast.2890), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.2892 = pred[1,31,31]{2,1,0} reshape(compare.2891), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.3032 = s32[1,31,31]{2,1,0} convert(reshape.2892), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.3033 = pred[1,31,31]{2,1,0} compare(convert.3032, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.3038 = pred[1,31]{1,0} reduce(compare.3033, constant.340), dimensions={2}, to_apply=region_74.3034, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.3039 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.3038), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.2956 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.2955), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_115.116 = f32[8,2304,256]{2,1,0} parameter(115), metadata={op_name="state[1][113]"}
  dot.2893 = f32[1,31,8,256]{3,2,1,0} dot(multiply.2884, Arg_115.116), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.2894 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.2895 = f32[128]{0} divide(broadcast.321, power.2894), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.2896 = f32[31,128]{1,0} dot(constant.319, divide.2895), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.2897 = f32[31,1,128]{2,1,0} reshape(dot.2896), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2898 = f32[31,1,128]{2,1,0} reshape(dot.2896), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2899 = f32[31,2,128]{2,1,0} concatenate(reshape.2897, reshape.2898), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2900 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.2899), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.2901 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.2900), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.2910 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.2901), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.2911 = f32[1,31,256]{2,1,0} reshape(broadcast.2910), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.2912 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.2911), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.2913 = f32[1,31,8,256]{3,2,1,0} multiply(dot.2893, broadcast.2912), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.2904 = f32[1,31,8,128]{3,2,1,0} slice(dot.2893), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.2905 = f32[1,31,8,128]{3,2,1,0} negate(slice.2904), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.2906 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.2905), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.2903 = f32[1,31,8,128]{3,2,1,0} slice(dot.2893), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2907 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.2903), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2908 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.2906, reshape.2907), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2909 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.2908), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.2902 = f32[1,31,1,256]{3,2,1,0} sine(reshape.2900), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.2914 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.2902), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.2915 = f32[1,31,256]{2,1,0} reshape(broadcast.2914), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.2916 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.2915), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.2917 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.2909, broadcast.2916), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.2918 = f32[1,31,8,256]{3,2,1,0} add(multiply.2913, multiply.2917), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/rotary_embedding_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.2919 = f32[1,31,8,128]{3,2,1,0} slice(add.2918), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2921 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.2919), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.2920 = f32[1,31,8,128]{3,2,1,0} slice(add.2918), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.2922 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.2920), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.2923 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.2921, reshape.2922), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.2924 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.2923), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.2961 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.2924, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.2962 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.2961), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.2963 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.2956, reshape.2962), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.2964 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.2963), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.2965 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.2964, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.2966 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.2965), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.2967 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.2966, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.2981 = pred[31,31]{1,0} call(broadcast.314), to_apply=triu.2968
  call.2995 = pred[31,31]{1,0} call(broadcast.314), to_apply=tril.2982
  and.2996 = pred[31,31]{1,0} and(call.2981, call.2995), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  reshape.2997 = pred[1,31,31]{2,1,0} reshape(and.2996), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.2998 = pred[1,31,31]{2,1,0} and(reshape.2892, reshape.2997), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.2999 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(and.2998), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.3000 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.2999), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.3001 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.3000), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.3002 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.3001, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.3003 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.3002), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.3004 = f32[1,31,31]{2,1,0} reshape(broadcast.3003), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.3005 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.3004), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.3006 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.2967, broadcast.3005), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.3011 = f32[1,4,2,31]{3,2,1,0} reduce(add.3006, constant.339), dimensions={4}, to_apply=region_72.3007, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.3012 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.3011, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.3013 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.3012), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.3014 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.3013), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.3015 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.3014), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.3016 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.3015), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.3017 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.3006, broadcast.3016), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.3018 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.3017), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.3023 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.3018, constant.342), dimensions={4}, to_apply=region_73.3019, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.3024 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.3023), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.3025 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.3024), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.3026 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.3025), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.3027 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.3026), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.3028 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.3018, broadcast.3027), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/softmax_10/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.3029 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.2957, divide.3028), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.3030 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.3029), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.3031 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.3030), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.3048 = f32[1,31,8,256]{3,2,1,0} call(reshape.3039, broadcast.304, reshape.3031), to_apply=_where_0.3040
  Arg_118.119 = f32[8,256,2304]{2,1,0} parameter(118), metadata={op_name="state[1][116]"}
  dot.3049 = f32[1,31,2304]{2,1,0} dot(call.3048, Arg_118.119), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.3050 = f32[1,31,2304]{2,1,0} multiply(dot.3049, dot.3049), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.3055 = f32[1,31]{1,0} reduce(multiply.3050, constant.342), dimensions={2}, to_apply=region_75.3051, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.3056 = f32[1,31,1]{2,1,0} reshape(reduce.3055), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.3057 = f32[1,31,1]{2,1,0} divide(reshape.3056, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.3058 = f32[1,31,1]{2,1,0} add(divide.3057, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.3059 = f32[1,31,1]{2,1,0} sqrt(add.3058), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.3060 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.3059), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.3061 = f32[1,31,1]{2,1,0} broadcast(divide.3060), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.3062 = f32[1,31]{1,0} reshape(broadcast.3061), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.3063 = f32[1,31,2304]{2,1,0} broadcast(reshape.3062), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.3064 = f32[1,31,2304]{2,1,0} multiply(dot.3049, broadcast.3063), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_114.115 = f32[2304]{0} parameter(114), metadata={op_name="state[1][112]"}
  add.3065 = f32[2304]{0} add(Arg_114.115, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3066 = f32[1,1,2304]{2,1,0} reshape(add.3065), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3067 = f32[1,1,2304]{2,1,0} broadcast(reshape.3066), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3068 = f32[1,2304]{1,0} reshape(broadcast.3067), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3069 = f32[1,31,2304]{2,1,0} broadcast(reshape.3068), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.3070 = f32[1,31,2304]{2,1,0} multiply(multiply.3064, broadcast.3069), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.3071 = f32[1,31,2304]{2,1,0} add(add.2863, multiply.3070), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.3072 = f32[1,31,2304]{2,1,0} multiply(add.3071, add.3071), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.3077 = f32[1,31]{1,0} reduce(multiply.3072, constant.342), dimensions={2}, to_apply=region_76.3073, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.3078 = f32[1,31,1]{2,1,0} reshape(reduce.3077), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.3079 = f32[1,31,1]{2,1,0} divide(reshape.3078, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.3080 = f32[1,31,1]{2,1,0} add(divide.3079, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.3081 = f32[1,31,1]{2,1,0} sqrt(add.3080), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.3082 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.3081), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.3083 = f32[1,31,1]{2,1,0} broadcast(divide.3082), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.3084 = f32[1,31]{1,0} reshape(broadcast.3083), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.3085 = f32[1,31,2304]{2,1,0} broadcast(reshape.3084), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.3086 = f32[1,31,2304]{2,1,0} multiply(add.3071, broadcast.3085), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_119.120 = f32[2304]{0} parameter(119), metadata={op_name="state[1][117]"}
  add.3087 = f32[2304]{0} add(Arg_119.120, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3088 = f32[1,1,2304]{2,1,0} reshape(add.3087), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3089 = f32[1,1,2304]{2,1,0} broadcast(reshape.3088), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3090 = f32[1,2304]{1,0} reshape(broadcast.3089), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3091 = f32[1,31,2304]{2,1,0} broadcast(reshape.3090), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.3092 = f32[1,31,2304]{2,1,0} multiply(multiply.3086, broadcast.3091), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_121.122 = f32[2304,9216]{1,0} parameter(121), metadata={op_name="state[1][119]"}
  dot.3093 = f32[1,31,9216]{2,1,0} dot(multiply.3092, Arg_121.122), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.3095 = f32[1,31,9216]{2,1,0} multiply(dot.3093, dot.3093), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3096 = f32[1,31,9216]{2,1,0} multiply(multiply.3095, dot.3093), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3097 = f32[1,31,9216]{2,1,0} multiply(multiply.3096, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.3098 = f32[1,31,9216]{2,1,0} add(dot.3093, multiply.3097), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3099 = f32[1,31,9216]{2,1,0} multiply(add.3098, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.3100 = f32[1,31,9216]{2,1,0} tanh(multiply.3099), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.3101 = f32[1,31,9216]{2,1,0} add(tanh.3100, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3102 = f32[1,31,9216]{2,1,0} multiply(add.3101, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3103 = f32[1,31,9216]{2,1,0} multiply(dot.3093, multiply.3102), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_122.123 = f32[2304,9216]{1,0} parameter(122), metadata={op_name="state[1][120]"}
  dot.3094 = f32[1,31,9216]{2,1,0} dot(multiply.3092, Arg_122.123), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.3104 = f32[1,31,9216]{2,1,0} multiply(multiply.3103, dot.3094), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_123.124 = f32[9216,2304]{1,0} parameter(123), metadata={op_name="state[1][121]"}
  dot.3105 = f32[1,31,2304]{2,1,0} dot(multiply.3104, Arg_123.124), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.3106 = f32[1,31,2304]{2,1,0} multiply(dot.3105, dot.3105), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.3111 = f32[1,31]{1,0} reduce(multiply.3106, constant.342), dimensions={2}, to_apply=region_77.3107, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.3112 = f32[1,31,1]{2,1,0} reshape(reduce.3111), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.3113 = f32[1,31,1]{2,1,0} divide(reshape.3112, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.3114 = f32[1,31,1]{2,1,0} add(divide.3113, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.3115 = f32[1,31,1]{2,1,0} sqrt(add.3114), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.3116 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.3115), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.3117 = f32[1,31,1]{2,1,0} broadcast(divide.3116), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.3118 = f32[1,31]{1,0} reshape(broadcast.3117), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.3119 = f32[1,31,2304]{2,1,0} broadcast(reshape.3118), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.3120 = f32[1,31,2304]{2,1,0} multiply(dot.3105, broadcast.3119), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_120.121 = f32[2304]{0} parameter(120), metadata={op_name="state[1][118]"}
  add.3121 = f32[2304]{0} add(Arg_120.121, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3122 = f32[1,1,2304]{2,1,0} reshape(add.3121), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3123 = f32[1,1,2304]{2,1,0} broadcast(reshape.3122), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3124 = f32[1,2304]{1,0} reshape(broadcast.3123), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3125 = f32[1,31,2304]{2,1,0} broadcast(reshape.3124), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.3126 = f32[1,31,2304]{2,1,0} multiply(multiply.3120, broadcast.3125), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.3127 = f32[1,31,2304]{2,1,0} add(multiply.3126, add.3071), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_10/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.3128 = f32[1,31,2304]{2,1,0} multiply(add.3127, add.3127), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.3133 = f32[1,31]{1,0} reduce(multiply.3128, constant.342), dimensions={2}, to_apply=region_78.3129, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.3134 = f32[1,31,1]{2,1,0} reshape(reduce.3133), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.3135 = f32[1,31,1]{2,1,0} divide(reshape.3134, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.3136 = f32[1,31,1]{2,1,0} add(divide.3135, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.3137 = f32[1,31,1]{2,1,0} sqrt(add.3136), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.3138 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.3137), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.3139 = f32[1,31,1]{2,1,0} broadcast(divide.3138), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.3140 = f32[1,31]{1,0} reshape(broadcast.3139), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.3141 = f32[1,31,2304]{2,1,0} broadcast(reshape.3140), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.3142 = f32[1,31,2304]{2,1,0} multiply(add.3127, broadcast.3141), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_124.125 = f32[2304]{0} parameter(124), metadata={op_name="state[1][122]"}
  add.3143 = f32[2304]{0} add(Arg_124.125, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3144 = f32[1,1,2304]{2,1,0} reshape(add.3143), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3145 = f32[1,1,2304]{2,1,0} broadcast(reshape.3144), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3146 = f32[1,2304]{1,0} reshape(broadcast.3145), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3147 = f32[1,31,2304]{2,1,0} broadcast(reshape.3146), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.3148 = f32[1,31,2304]{2,1,0} multiply(multiply.3142, broadcast.3147), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_127.128 = f32[4,2304,256]{2,1,0} parameter(127), metadata={op_name="state[1][125]"}
  dot.3189 = f32[1,31,4,256]{3,2,1,0} dot(multiply.3148, Arg_127.128), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.3190 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.3191 = f32[128]{0} divide(broadcast.321, power.3190), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.3192 = f32[31,128]{1,0} dot(constant.319, divide.3191), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.3193 = f32[31,1,128]{2,1,0} reshape(dot.3192), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3194 = f32[31,1,128]{2,1,0} reshape(dot.3192), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3195 = f32[31,2,128]{2,1,0} concatenate(reshape.3193, reshape.3194), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3196 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.3195), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.3197 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.3196), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.3206 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.3197), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.3207 = f32[1,31,256]{2,1,0} reshape(broadcast.3206), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.3208 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.3207), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.3209 = f32[1,31,4,256]{3,2,1,0} multiply(dot.3189, broadcast.3208), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.3200 = f32[1,31,4,128]{3,2,1,0} slice(dot.3189), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.3201 = f32[1,31,4,128]{3,2,1,0} negate(slice.3200), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.3202 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.3201), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.3199 = f32[1,31,4,128]{3,2,1,0} slice(dot.3189), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3203 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.3199), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3204 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.3202, reshape.3203), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3205 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.3204), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.3198 = f32[1,31,1,256]{3,2,1,0} sine(reshape.3196), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.3210 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.3198), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.3211 = f32[1,31,256]{2,1,0} reshape(broadcast.3210), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.3212 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.3211), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.3213 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.3205, broadcast.3212), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.3214 = f32[1,31,4,256]{3,2,1,0} add(multiply.3209, multiply.3213), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.3215 = f32[1,31,4,128]{3,2,1,0} slice(add.3214), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3217 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.3215), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.3216 = f32[1,31,4,128]{3,2,1,0} slice(add.3214), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3218 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.3216), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3219 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.3217, reshape.3218), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3222 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.3219), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_128.129 = f32[4,2304,256]{2,1,0} parameter(128), metadata={op_name="state[1][126]"}
  dot.3221 = f32[1,31,4,256]{3,2,1,0} dot(multiply.3148, Arg_128.129), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.3223 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.3221), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3224 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.3222, reshape.3223), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6674 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.3224), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.3149 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.3150 = f32[31]{0} reshape(broadcast.3149), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.3151 = f32[31,31]{1,0} broadcast(reshape.3150), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.3152 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.3153 = f32[31]{0} reshape(broadcast.3152), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.3154 = f32[31,31]{1,0} broadcast(reshape.3153), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.3155 = pred[31,31]{1,0} compare(broadcast.3151, broadcast.3154), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.3156 = pred[1,31,31]{2,1,0} reshape(compare.3155), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.3265 = s32[1,31,31]{2,1,0} convert(reshape.3156), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.3266 = pred[1,31,31]{2,1,0} compare(convert.3265, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.3271 = pred[1,31]{1,0} reduce(compare.3266, constant.340), dimensions={2}, to_apply=region_81.3267, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.3272 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.3271), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.3220 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.3219), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_126.127 = f32[8,2304,256]{2,1,0} parameter(126), metadata={op_name="state[1][124]"}
  dot.3157 = f32[1,31,8,256]{3,2,1,0} dot(multiply.3148, Arg_126.127), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.3158 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.3159 = f32[128]{0} divide(broadcast.321, power.3158), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.3160 = f32[31,128]{1,0} dot(constant.319, divide.3159), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.3161 = f32[31,1,128]{2,1,0} reshape(dot.3160), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3162 = f32[31,1,128]{2,1,0} reshape(dot.3160), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3163 = f32[31,2,128]{2,1,0} concatenate(reshape.3161, reshape.3162), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3164 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.3163), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.3165 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.3164), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.3174 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.3165), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.3175 = f32[1,31,256]{2,1,0} reshape(broadcast.3174), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.3176 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.3175), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.3177 = f32[1,31,8,256]{3,2,1,0} multiply(dot.3157, broadcast.3176), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.3168 = f32[1,31,8,128]{3,2,1,0} slice(dot.3157), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.3169 = f32[1,31,8,128]{3,2,1,0} negate(slice.3168), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.3170 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.3169), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.3167 = f32[1,31,8,128]{3,2,1,0} slice(dot.3157), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3171 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.3167), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3172 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.3170, reshape.3171), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3173 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.3172), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.3166 = f32[1,31,1,256]{3,2,1,0} sine(reshape.3164), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.3178 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.3166), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.3179 = f32[1,31,256]{2,1,0} reshape(broadcast.3178), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.3180 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.3179), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.3181 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.3173, broadcast.3180), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.3182 = f32[1,31,8,256]{3,2,1,0} add(multiply.3177, multiply.3181), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/rotary_embedding_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.3183 = f32[1,31,8,128]{3,2,1,0} slice(add.3182), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3185 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.3183), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.3184 = f32[1,31,8,128]{3,2,1,0} slice(add.3182), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3186 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.3184), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3187 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.3185, reshape.3186), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3188 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.3187), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.3225 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.3188, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.3226 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.3225), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.3227 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.3220, reshape.3226), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.3228 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.3227), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.3229 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.3228, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.3230 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.3229), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.3231 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.3230, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.3232 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(compare.3155), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.3233 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.3232), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.3234 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.3233), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.3235 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.3234, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.3236 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.3235), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.3237 = f32[1,31,31]{2,1,0} reshape(broadcast.3236), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.3238 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.3237), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.3239 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.3231, broadcast.3238), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.3244 = f32[1,4,2,31]{3,2,1,0} reduce(add.3239, constant.339), dimensions={4}, to_apply=region_79.3240, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.3245 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.3244, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.3246 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.3245), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.3247 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.3246), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.3248 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.3247), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.3249 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.3248), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.3250 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.3239, broadcast.3249), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.3251 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.3250), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.3256 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.3251, constant.342), dimensions={4}, to_apply=region_80.3252, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.3257 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.3256), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.3258 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.3257), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.3259 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.3258), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.3260 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.3259), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.3261 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.3251, broadcast.3260), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/softmax_11/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.3262 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.3221, divide.3261), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.3263 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.3262), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.3264 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.3263), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.3281 = f32[1,31,8,256]{3,2,1,0} call(reshape.3272, broadcast.304, reshape.3264), to_apply=_where_0.3273
  Arg_129.130 = f32[8,256,2304]{2,1,0} parameter(129), metadata={op_name="state[1][127]"}
  dot.3282 = f32[1,31,2304]{2,1,0} dot(call.3281, Arg_129.130), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.3283 = f32[1,31,2304]{2,1,0} multiply(dot.3282, dot.3282), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.3288 = f32[1,31]{1,0} reduce(multiply.3283, constant.342), dimensions={2}, to_apply=region_82.3284, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.3289 = f32[1,31,1]{2,1,0} reshape(reduce.3288), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.3290 = f32[1,31,1]{2,1,0} divide(reshape.3289, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.3291 = f32[1,31,1]{2,1,0} add(divide.3290, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.3292 = f32[1,31,1]{2,1,0} sqrt(add.3291), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.3293 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.3292), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.3294 = f32[1,31,1]{2,1,0} broadcast(divide.3293), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.3295 = f32[1,31]{1,0} reshape(broadcast.3294), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.3296 = f32[1,31,2304]{2,1,0} broadcast(reshape.3295), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.3297 = f32[1,31,2304]{2,1,0} multiply(dot.3282, broadcast.3296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_125.126 = f32[2304]{0} parameter(125), metadata={op_name="state[1][123]"}
  add.3298 = f32[2304]{0} add(Arg_125.126, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3299 = f32[1,1,2304]{2,1,0} reshape(add.3298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3300 = f32[1,1,2304]{2,1,0} broadcast(reshape.3299), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3301 = f32[1,2304]{1,0} reshape(broadcast.3300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3302 = f32[1,31,2304]{2,1,0} broadcast(reshape.3301), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.3303 = f32[1,31,2304]{2,1,0} multiply(multiply.3297, broadcast.3302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.3304 = f32[1,31,2304]{2,1,0} add(add.3127, multiply.3303), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.3305 = f32[1,31,2304]{2,1,0} multiply(add.3304, add.3304), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.3310 = f32[1,31]{1,0} reduce(multiply.3305, constant.342), dimensions={2}, to_apply=region_83.3306, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.3311 = f32[1,31,1]{2,1,0} reshape(reduce.3310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.3312 = f32[1,31,1]{2,1,0} divide(reshape.3311, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.3313 = f32[1,31,1]{2,1,0} add(divide.3312, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.3314 = f32[1,31,1]{2,1,0} sqrt(add.3313), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.3315 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.3314), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.3316 = f32[1,31,1]{2,1,0} broadcast(divide.3315), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.3317 = f32[1,31]{1,0} reshape(broadcast.3316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.3318 = f32[1,31,2304]{2,1,0} broadcast(reshape.3317), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.3319 = f32[1,31,2304]{2,1,0} multiply(add.3304, broadcast.3318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_130.131 = f32[2304]{0} parameter(130), metadata={op_name="state[1][128]"}
  add.3320 = f32[2304]{0} add(Arg_130.131, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3321 = f32[1,1,2304]{2,1,0} reshape(add.3320), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3322 = f32[1,1,2304]{2,1,0} broadcast(reshape.3321), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3323 = f32[1,2304]{1,0} reshape(broadcast.3322), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3324 = f32[1,31,2304]{2,1,0} broadcast(reshape.3323), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.3325 = f32[1,31,2304]{2,1,0} multiply(multiply.3319, broadcast.3324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_132.133 = f32[2304,9216]{1,0} parameter(132), metadata={op_name="state[1][130]"}
  dot.3326 = f32[1,31,9216]{2,1,0} dot(multiply.3325, Arg_132.133), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.3328 = f32[1,31,9216]{2,1,0} multiply(dot.3326, dot.3326), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3329 = f32[1,31,9216]{2,1,0} multiply(multiply.3328, dot.3326), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3330 = f32[1,31,9216]{2,1,0} multiply(multiply.3329, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.3331 = f32[1,31,9216]{2,1,0} add(dot.3326, multiply.3330), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3332 = f32[1,31,9216]{2,1,0} multiply(add.3331, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.3333 = f32[1,31,9216]{2,1,0} tanh(multiply.3332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.3334 = f32[1,31,9216]{2,1,0} add(tanh.3333, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3335 = f32[1,31,9216]{2,1,0} multiply(add.3334, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3336 = f32[1,31,9216]{2,1,0} multiply(dot.3326, multiply.3335), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_133.134 = f32[2304,9216]{1,0} parameter(133), metadata={op_name="state[1][131]"}
  dot.3327 = f32[1,31,9216]{2,1,0} dot(multiply.3325, Arg_133.134), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.3337 = f32[1,31,9216]{2,1,0} multiply(multiply.3336, dot.3327), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_134.135 = f32[9216,2304]{1,0} parameter(134), metadata={op_name="state[1][132]"}
  dot.3338 = f32[1,31,2304]{2,1,0} dot(multiply.3337, Arg_134.135), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.3339 = f32[1,31,2304]{2,1,0} multiply(dot.3338, dot.3338), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.3344 = f32[1,31]{1,0} reduce(multiply.3339, constant.342), dimensions={2}, to_apply=region_84.3340, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.3345 = f32[1,31,1]{2,1,0} reshape(reduce.3344), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.3346 = f32[1,31,1]{2,1,0} divide(reshape.3345, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.3347 = f32[1,31,1]{2,1,0} add(divide.3346, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.3348 = f32[1,31,1]{2,1,0} sqrt(add.3347), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.3349 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.3348), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.3350 = f32[1,31,1]{2,1,0} broadcast(divide.3349), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.3351 = f32[1,31]{1,0} reshape(broadcast.3350), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.3352 = f32[1,31,2304]{2,1,0} broadcast(reshape.3351), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.3353 = f32[1,31,2304]{2,1,0} multiply(dot.3338, broadcast.3352), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_131.132 = f32[2304]{0} parameter(131), metadata={op_name="state[1][129]"}
  add.3354 = f32[2304]{0} add(Arg_131.132, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3355 = f32[1,1,2304]{2,1,0} reshape(add.3354), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3356 = f32[1,1,2304]{2,1,0} broadcast(reshape.3355), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3357 = f32[1,2304]{1,0} reshape(broadcast.3356), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3358 = f32[1,31,2304]{2,1,0} broadcast(reshape.3357), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.3359 = f32[1,31,2304]{2,1,0} multiply(multiply.3353, broadcast.3358), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.3360 = f32[1,31,2304]{2,1,0} add(multiply.3359, add.3304), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_11/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.3361 = f32[1,31,2304]{2,1,0} multiply(add.3360, add.3360), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.3366 = f32[1,31]{1,0} reduce(multiply.3361, constant.342), dimensions={2}, to_apply=region_85.3362, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.3367 = f32[1,31,1]{2,1,0} reshape(reduce.3366), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.3368 = f32[1,31,1]{2,1,0} divide(reshape.3367, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.3369 = f32[1,31,1]{2,1,0} add(divide.3368, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.3370 = f32[1,31,1]{2,1,0} sqrt(add.3369), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.3371 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.3370), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.3372 = f32[1,31,1]{2,1,0} broadcast(divide.3371), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.3373 = f32[1,31]{1,0} reshape(broadcast.3372), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.3374 = f32[1,31,2304]{2,1,0} broadcast(reshape.3373), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.3375 = f32[1,31,2304]{2,1,0} multiply(add.3360, broadcast.3374), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_135.136 = f32[2304]{0} parameter(135), metadata={op_name="state[1][133]"}
  add.3376 = f32[2304]{0} add(Arg_135.136, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3377 = f32[1,1,2304]{2,1,0} reshape(add.3376), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3378 = f32[1,1,2304]{2,1,0} broadcast(reshape.3377), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3379 = f32[1,2304]{1,0} reshape(broadcast.3378), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3380 = f32[1,31,2304]{2,1,0} broadcast(reshape.3379), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.3381 = f32[1,31,2304]{2,1,0} multiply(multiply.3375, broadcast.3380), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_138.139 = f32[4,2304,256]{2,1,0} parameter(138), metadata={op_name="state[1][136]"}
  dot.3422 = f32[1,31,4,256]{3,2,1,0} dot(multiply.3381, Arg_138.139), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.3423 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.3424 = f32[128]{0} divide(broadcast.321, power.3423), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.3425 = f32[31,128]{1,0} dot(constant.319, divide.3424), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.3426 = f32[31,1,128]{2,1,0} reshape(dot.3425), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3427 = f32[31,1,128]{2,1,0} reshape(dot.3425), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3428 = f32[31,2,128]{2,1,0} concatenate(reshape.3426, reshape.3427), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3429 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.3428), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.3430 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.3429), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.3439 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.3430), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.3440 = f32[1,31,256]{2,1,0} reshape(broadcast.3439), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.3441 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.3440), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.3442 = f32[1,31,4,256]{3,2,1,0} multiply(dot.3422, broadcast.3441), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.3433 = f32[1,31,4,128]{3,2,1,0} slice(dot.3422), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.3434 = f32[1,31,4,128]{3,2,1,0} negate(slice.3433), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.3435 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.3434), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.3432 = f32[1,31,4,128]{3,2,1,0} slice(dot.3422), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3436 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.3432), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3437 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.3435, reshape.3436), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3438 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.3437), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.3431 = f32[1,31,1,256]{3,2,1,0} sine(reshape.3429), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.3443 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.3431), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.3444 = f32[1,31,256]{2,1,0} reshape(broadcast.3443), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.3445 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.3444), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.3446 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.3438, broadcast.3445), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.3447 = f32[1,31,4,256]{3,2,1,0} add(multiply.3442, multiply.3446), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.3448 = f32[1,31,4,128]{3,2,1,0} slice(add.3447), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3450 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.3448), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.3449 = f32[1,31,4,128]{3,2,1,0} slice(add.3447), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3451 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.3449), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3452 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.3450, reshape.3451), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3455 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.3452), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_139.140 = f32[4,2304,256]{2,1,0} parameter(139), metadata={op_name="state[1][137]"}
  dot.3454 = f32[1,31,4,256]{3,2,1,0} dot(multiply.3381, Arg_139.140), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.3456 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.3454), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3457 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.3455, reshape.3456), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6675 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.3457), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.3382 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.3383 = f32[31]{0} reshape(broadcast.3382), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.3384 = f32[31,31]{1,0} broadcast(reshape.3383), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.3385 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.3386 = f32[31]{0} reshape(broadcast.3385), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.3387 = f32[31,31]{1,0} broadcast(reshape.3386), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.3388 = pred[31,31]{1,0} compare(broadcast.3384, broadcast.3387), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.3389 = pred[1,31,31]{2,1,0} reshape(compare.3388), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.3529 = s32[1,31,31]{2,1,0} convert(reshape.3389), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.3530 = pred[1,31,31]{2,1,0} compare(convert.3529, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.3535 = pred[1,31]{1,0} reduce(compare.3530, constant.340), dimensions={2}, to_apply=region_88.3531, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.3536 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.3535), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.3453 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.3452), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_137.138 = f32[8,2304,256]{2,1,0} parameter(137), metadata={op_name="state[1][135]"}
  dot.3390 = f32[1,31,8,256]{3,2,1,0} dot(multiply.3381, Arg_137.138), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.3391 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.3392 = f32[128]{0} divide(broadcast.321, power.3391), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.3393 = f32[31,128]{1,0} dot(constant.319, divide.3392), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.3394 = f32[31,1,128]{2,1,0} reshape(dot.3393), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3395 = f32[31,1,128]{2,1,0} reshape(dot.3393), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3396 = f32[31,2,128]{2,1,0} concatenate(reshape.3394, reshape.3395), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3397 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.3396), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.3398 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.3397), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.3407 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.3398), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.3408 = f32[1,31,256]{2,1,0} reshape(broadcast.3407), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.3409 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.3408), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.3410 = f32[1,31,8,256]{3,2,1,0} multiply(dot.3390, broadcast.3409), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.3401 = f32[1,31,8,128]{3,2,1,0} slice(dot.3390), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.3402 = f32[1,31,8,128]{3,2,1,0} negate(slice.3401), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.3403 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.3402), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.3400 = f32[1,31,8,128]{3,2,1,0} slice(dot.3390), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3404 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.3400), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3405 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.3403, reshape.3404), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3406 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.3405), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.3399 = f32[1,31,1,256]{3,2,1,0} sine(reshape.3397), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.3411 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.3399), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.3412 = f32[1,31,256]{2,1,0} reshape(broadcast.3411), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.3413 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.3412), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.3414 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.3406, broadcast.3413), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.3415 = f32[1,31,8,256]{3,2,1,0} add(multiply.3410, multiply.3414), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/rotary_embedding_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.3416 = f32[1,31,8,128]{3,2,1,0} slice(add.3415), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3418 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.3416), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.3417 = f32[1,31,8,128]{3,2,1,0} slice(add.3415), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3419 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.3417), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3420 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.3418, reshape.3419), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3421 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.3420), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.3458 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.3421, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.3459 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.3458), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.3460 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.3453, reshape.3459), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.3461 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.3460), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.3462 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.3461, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.3463 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.3462), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.3464 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.3463, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.3478 = pred[31,31]{1,0} call(broadcast.314), to_apply=triu.3465
  call.3492 = pred[31,31]{1,0} call(broadcast.314), to_apply=tril.3479
  and.3493 = pred[31,31]{1,0} and(call.3478, call.3492), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  reshape.3494 = pred[1,31,31]{2,1,0} reshape(and.3493), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.3495 = pred[1,31,31]{2,1,0} and(reshape.3389, reshape.3494), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.3496 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(and.3495), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.3497 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.3496), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.3498 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.3497), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.3499 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.3498, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.3500 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.3499), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.3501 = f32[1,31,31]{2,1,0} reshape(broadcast.3500), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.3502 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.3501), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.3503 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.3464, broadcast.3502), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.3508 = f32[1,4,2,31]{3,2,1,0} reduce(add.3503, constant.339), dimensions={4}, to_apply=region_86.3504, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.3509 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.3508, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.3510 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.3509), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.3511 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.3510), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.3512 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.3511), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.3513 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.3512), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.3514 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.3503, broadcast.3513), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.3515 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.3514), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.3520 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.3515, constant.342), dimensions={4}, to_apply=region_87.3516, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.3521 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.3520), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.3522 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.3521), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.3523 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.3522), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.3524 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.3523), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.3525 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.3515, broadcast.3524), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/softmax_12/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.3526 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.3454, divide.3525), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.3527 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.3526), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.3528 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.3527), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.3545 = f32[1,31,8,256]{3,2,1,0} call(reshape.3536, broadcast.304, reshape.3528), to_apply=_where_0.3537
  Arg_140.141 = f32[8,256,2304]{2,1,0} parameter(140), metadata={op_name="state[1][138]"}
  dot.3546 = f32[1,31,2304]{2,1,0} dot(call.3545, Arg_140.141), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.3547 = f32[1,31,2304]{2,1,0} multiply(dot.3546, dot.3546), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.3552 = f32[1,31]{1,0} reduce(multiply.3547, constant.342), dimensions={2}, to_apply=region_89.3548, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.3553 = f32[1,31,1]{2,1,0} reshape(reduce.3552), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.3554 = f32[1,31,1]{2,1,0} divide(reshape.3553, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.3555 = f32[1,31,1]{2,1,0} add(divide.3554, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.3556 = f32[1,31,1]{2,1,0} sqrt(add.3555), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.3557 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.3556), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.3558 = f32[1,31,1]{2,1,0} broadcast(divide.3557), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.3559 = f32[1,31]{1,0} reshape(broadcast.3558), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.3560 = f32[1,31,2304]{2,1,0} broadcast(reshape.3559), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.3561 = f32[1,31,2304]{2,1,0} multiply(dot.3546, broadcast.3560), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_136.137 = f32[2304]{0} parameter(136), metadata={op_name="state[1][134]"}
  add.3562 = f32[2304]{0} add(Arg_136.137, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3563 = f32[1,1,2304]{2,1,0} reshape(add.3562), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3564 = f32[1,1,2304]{2,1,0} broadcast(reshape.3563), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3565 = f32[1,2304]{1,0} reshape(broadcast.3564), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3566 = f32[1,31,2304]{2,1,0} broadcast(reshape.3565), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.3567 = f32[1,31,2304]{2,1,0} multiply(multiply.3561, broadcast.3566), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.3568 = f32[1,31,2304]{2,1,0} add(add.3360, multiply.3567), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.3569 = f32[1,31,2304]{2,1,0} multiply(add.3568, add.3568), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.3574 = f32[1,31]{1,0} reduce(multiply.3569, constant.342), dimensions={2}, to_apply=region_90.3570, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.3575 = f32[1,31,1]{2,1,0} reshape(reduce.3574), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.3576 = f32[1,31,1]{2,1,0} divide(reshape.3575, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.3577 = f32[1,31,1]{2,1,0} add(divide.3576, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.3578 = f32[1,31,1]{2,1,0} sqrt(add.3577), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.3579 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.3578), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.3580 = f32[1,31,1]{2,1,0} broadcast(divide.3579), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.3581 = f32[1,31]{1,0} reshape(broadcast.3580), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.3582 = f32[1,31,2304]{2,1,0} broadcast(reshape.3581), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.3583 = f32[1,31,2304]{2,1,0} multiply(add.3568, broadcast.3582), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_141.142 = f32[2304]{0} parameter(141), metadata={op_name="state[1][139]"}
  add.3584 = f32[2304]{0} add(Arg_141.142, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3585 = f32[1,1,2304]{2,1,0} reshape(add.3584), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3586 = f32[1,1,2304]{2,1,0} broadcast(reshape.3585), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3587 = f32[1,2304]{1,0} reshape(broadcast.3586), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3588 = f32[1,31,2304]{2,1,0} broadcast(reshape.3587), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.3589 = f32[1,31,2304]{2,1,0} multiply(multiply.3583, broadcast.3588), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_143.144 = f32[2304,9216]{1,0} parameter(143), metadata={op_name="state[1][141]"}
  dot.3590 = f32[1,31,9216]{2,1,0} dot(multiply.3589, Arg_143.144), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.3592 = f32[1,31,9216]{2,1,0} multiply(dot.3590, dot.3590), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3593 = f32[1,31,9216]{2,1,0} multiply(multiply.3592, dot.3590), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3594 = f32[1,31,9216]{2,1,0} multiply(multiply.3593, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.3595 = f32[1,31,9216]{2,1,0} add(dot.3590, multiply.3594), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3596 = f32[1,31,9216]{2,1,0} multiply(add.3595, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.3597 = f32[1,31,9216]{2,1,0} tanh(multiply.3596), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.3598 = f32[1,31,9216]{2,1,0} add(tanh.3597, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3599 = f32[1,31,9216]{2,1,0} multiply(add.3598, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3600 = f32[1,31,9216]{2,1,0} multiply(dot.3590, multiply.3599), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_144.145 = f32[2304,9216]{1,0} parameter(144), metadata={op_name="state[1][142]"}
  dot.3591 = f32[1,31,9216]{2,1,0} dot(multiply.3589, Arg_144.145), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.3601 = f32[1,31,9216]{2,1,0} multiply(multiply.3600, dot.3591), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_145.146 = f32[9216,2304]{1,0} parameter(145), metadata={op_name="state[1][143]"}
  dot.3602 = f32[1,31,2304]{2,1,0} dot(multiply.3601, Arg_145.146), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.3603 = f32[1,31,2304]{2,1,0} multiply(dot.3602, dot.3602), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.3608 = f32[1,31]{1,0} reduce(multiply.3603, constant.342), dimensions={2}, to_apply=region_91.3604, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.3609 = f32[1,31,1]{2,1,0} reshape(reduce.3608), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.3610 = f32[1,31,1]{2,1,0} divide(reshape.3609, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.3611 = f32[1,31,1]{2,1,0} add(divide.3610, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.3612 = f32[1,31,1]{2,1,0} sqrt(add.3611), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.3613 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.3612), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.3614 = f32[1,31,1]{2,1,0} broadcast(divide.3613), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.3615 = f32[1,31]{1,0} reshape(broadcast.3614), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.3616 = f32[1,31,2304]{2,1,0} broadcast(reshape.3615), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.3617 = f32[1,31,2304]{2,1,0} multiply(dot.3602, broadcast.3616), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_142.143 = f32[2304]{0} parameter(142), metadata={op_name="state[1][140]"}
  add.3618 = f32[2304]{0} add(Arg_142.143, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3619 = f32[1,1,2304]{2,1,0} reshape(add.3618), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3620 = f32[1,1,2304]{2,1,0} broadcast(reshape.3619), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3621 = f32[1,2304]{1,0} reshape(broadcast.3620), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3622 = f32[1,31,2304]{2,1,0} broadcast(reshape.3621), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.3623 = f32[1,31,2304]{2,1,0} multiply(multiply.3617, broadcast.3622), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.3624 = f32[1,31,2304]{2,1,0} add(multiply.3623, add.3568), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_12/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.3625 = f32[1,31,2304]{2,1,0} multiply(add.3624, add.3624), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.3630 = f32[1,31]{1,0} reduce(multiply.3625, constant.342), dimensions={2}, to_apply=region_92.3626, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.3631 = f32[1,31,1]{2,1,0} reshape(reduce.3630), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.3632 = f32[1,31,1]{2,1,0} divide(reshape.3631, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.3633 = f32[1,31,1]{2,1,0} add(divide.3632, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.3634 = f32[1,31,1]{2,1,0} sqrt(add.3633), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.3635 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.3634), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.3636 = f32[1,31,1]{2,1,0} broadcast(divide.3635), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.3637 = f32[1,31]{1,0} reshape(broadcast.3636), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.3638 = f32[1,31,2304]{2,1,0} broadcast(reshape.3637), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.3639 = f32[1,31,2304]{2,1,0} multiply(add.3624, broadcast.3638), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_146.147 = f32[2304]{0} parameter(146), metadata={op_name="state[1][144]"}
  add.3640 = f32[2304]{0} add(Arg_146.147, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3641 = f32[1,1,2304]{2,1,0} reshape(add.3640), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3642 = f32[1,1,2304]{2,1,0} broadcast(reshape.3641), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3643 = f32[1,2304]{1,0} reshape(broadcast.3642), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3644 = f32[1,31,2304]{2,1,0} broadcast(reshape.3643), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.3645 = f32[1,31,2304]{2,1,0} multiply(multiply.3639, broadcast.3644), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_149.150 = f32[4,2304,256]{2,1,0} parameter(149), metadata={op_name="state[1][147]"}
  dot.3686 = f32[1,31,4,256]{3,2,1,0} dot(multiply.3645, Arg_149.150), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.3687 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.3688 = f32[128]{0} divide(broadcast.321, power.3687), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.3689 = f32[31,128]{1,0} dot(constant.319, divide.3688), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.3690 = f32[31,1,128]{2,1,0} reshape(dot.3689), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3691 = f32[31,1,128]{2,1,0} reshape(dot.3689), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3692 = f32[31,2,128]{2,1,0} concatenate(reshape.3690, reshape.3691), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3693 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.3692), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.3694 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.3693), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.3703 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.3694), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.3704 = f32[1,31,256]{2,1,0} reshape(broadcast.3703), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.3705 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.3704), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.3706 = f32[1,31,4,256]{3,2,1,0} multiply(dot.3686, broadcast.3705), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.3697 = f32[1,31,4,128]{3,2,1,0} slice(dot.3686), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.3698 = f32[1,31,4,128]{3,2,1,0} negate(slice.3697), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.3699 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.3698), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.3696 = f32[1,31,4,128]{3,2,1,0} slice(dot.3686), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3700 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.3696), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3701 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.3699, reshape.3700), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3702 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.3701), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.3695 = f32[1,31,1,256]{3,2,1,0} sine(reshape.3693), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.3707 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.3695), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.3708 = f32[1,31,256]{2,1,0} reshape(broadcast.3707), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.3709 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.3708), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.3710 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.3702, broadcast.3709), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.3711 = f32[1,31,4,256]{3,2,1,0} add(multiply.3706, multiply.3710), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.3712 = f32[1,31,4,128]{3,2,1,0} slice(add.3711), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3714 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.3712), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.3713 = f32[1,31,4,128]{3,2,1,0} slice(add.3711), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3715 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.3713), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3716 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.3714, reshape.3715), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3719 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.3716), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_150.151 = f32[4,2304,256]{2,1,0} parameter(150), metadata={op_name="state[1][148]"}
  dot.3718 = f32[1,31,4,256]{3,2,1,0} dot(multiply.3645, Arg_150.151), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.3720 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.3718), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3721 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.3719, reshape.3720), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6676 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.3721), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.3646 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.3647 = f32[31]{0} reshape(broadcast.3646), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.3648 = f32[31,31]{1,0} broadcast(reshape.3647), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.3649 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.3650 = f32[31]{0} reshape(broadcast.3649), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.3651 = f32[31,31]{1,0} broadcast(reshape.3650), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.3652 = pred[31,31]{1,0} compare(broadcast.3648, broadcast.3651), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.3653 = pred[1,31,31]{2,1,0} reshape(compare.3652), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.3762 = s32[1,31,31]{2,1,0} convert(reshape.3653), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.3763 = pred[1,31,31]{2,1,0} compare(convert.3762, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.3768 = pred[1,31]{1,0} reduce(compare.3763, constant.340), dimensions={2}, to_apply=region_95.3764, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.3769 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.3768), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.3717 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.3716), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_148.149 = f32[8,2304,256]{2,1,0} parameter(148), metadata={op_name="state[1][146]"}
  dot.3654 = f32[1,31,8,256]{3,2,1,0} dot(multiply.3645, Arg_148.149), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.3655 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.3656 = f32[128]{0} divide(broadcast.321, power.3655), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.3657 = f32[31,128]{1,0} dot(constant.319, divide.3656), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.3658 = f32[31,1,128]{2,1,0} reshape(dot.3657), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3659 = f32[31,1,128]{2,1,0} reshape(dot.3657), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3660 = f32[31,2,128]{2,1,0} concatenate(reshape.3658, reshape.3659), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3661 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.3660), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.3662 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.3661), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.3671 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.3662), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.3672 = f32[1,31,256]{2,1,0} reshape(broadcast.3671), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.3673 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.3672), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.3674 = f32[1,31,8,256]{3,2,1,0} multiply(dot.3654, broadcast.3673), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.3665 = f32[1,31,8,128]{3,2,1,0} slice(dot.3654), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.3666 = f32[1,31,8,128]{3,2,1,0} negate(slice.3665), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.3667 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.3666), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.3664 = f32[1,31,8,128]{3,2,1,0} slice(dot.3654), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3668 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.3664), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3669 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.3667, reshape.3668), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3670 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.3669), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.3663 = f32[1,31,1,256]{3,2,1,0} sine(reshape.3661), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.3675 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.3663), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.3676 = f32[1,31,256]{2,1,0} reshape(broadcast.3675), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.3677 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.3676), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.3678 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.3670, broadcast.3677), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.3679 = f32[1,31,8,256]{3,2,1,0} add(multiply.3674, multiply.3678), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/rotary_embedding_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.3680 = f32[1,31,8,128]{3,2,1,0} slice(add.3679), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3682 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.3680), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.3681 = f32[1,31,8,128]{3,2,1,0} slice(add.3679), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3683 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.3681), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3684 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.3682, reshape.3683), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3685 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.3684), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.3722 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.3685, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.3723 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.3722), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.3724 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.3717, reshape.3723), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.3725 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.3724), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.3726 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.3725, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.3727 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.3726), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.3728 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.3727, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.3729 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(compare.3652), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.3730 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.3729), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.3731 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.3730), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.3732 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.3731, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.3733 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.3732), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.3734 = f32[1,31,31]{2,1,0} reshape(broadcast.3733), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.3735 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.3734), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.3736 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.3728, broadcast.3735), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.3741 = f32[1,4,2,31]{3,2,1,0} reduce(add.3736, constant.339), dimensions={4}, to_apply=region_93.3737, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.3742 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.3741, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.3743 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.3742), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.3744 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.3743), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.3745 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.3744), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.3746 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.3745), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.3747 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.3736, broadcast.3746), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.3748 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.3747), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.3753 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.3748, constant.342), dimensions={4}, to_apply=region_94.3749, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.3754 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.3753), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.3755 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.3754), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.3756 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.3755), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.3757 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.3756), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.3758 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.3748, broadcast.3757), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/softmax_13/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.3759 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.3718, divide.3758), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.3760 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.3759), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.3761 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.3760), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.3778 = f32[1,31,8,256]{3,2,1,0} call(reshape.3769, broadcast.304, reshape.3761), to_apply=_where_0.3770
  Arg_151.152 = f32[8,256,2304]{2,1,0} parameter(151), metadata={op_name="state[1][149]"}
  dot.3779 = f32[1,31,2304]{2,1,0} dot(call.3778, Arg_151.152), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.3780 = f32[1,31,2304]{2,1,0} multiply(dot.3779, dot.3779), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.3785 = f32[1,31]{1,0} reduce(multiply.3780, constant.342), dimensions={2}, to_apply=region_96.3781, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.3786 = f32[1,31,1]{2,1,0} reshape(reduce.3785), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.3787 = f32[1,31,1]{2,1,0} divide(reshape.3786, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.3788 = f32[1,31,1]{2,1,0} add(divide.3787, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.3789 = f32[1,31,1]{2,1,0} sqrt(add.3788), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.3790 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.3789), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.3791 = f32[1,31,1]{2,1,0} broadcast(divide.3790), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.3792 = f32[1,31]{1,0} reshape(broadcast.3791), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.3793 = f32[1,31,2304]{2,1,0} broadcast(reshape.3792), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.3794 = f32[1,31,2304]{2,1,0} multiply(dot.3779, broadcast.3793), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_147.148 = f32[2304]{0} parameter(147), metadata={op_name="state[1][145]"}
  add.3795 = f32[2304]{0} add(Arg_147.148, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3796 = f32[1,1,2304]{2,1,0} reshape(add.3795), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3797 = f32[1,1,2304]{2,1,0} broadcast(reshape.3796), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3798 = f32[1,2304]{1,0} reshape(broadcast.3797), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3799 = f32[1,31,2304]{2,1,0} broadcast(reshape.3798), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.3800 = f32[1,31,2304]{2,1,0} multiply(multiply.3794, broadcast.3799), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.3801 = f32[1,31,2304]{2,1,0} add(add.3624, multiply.3800), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.3802 = f32[1,31,2304]{2,1,0} multiply(add.3801, add.3801), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.3807 = f32[1,31]{1,0} reduce(multiply.3802, constant.342), dimensions={2}, to_apply=region_97.3803, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.3808 = f32[1,31,1]{2,1,0} reshape(reduce.3807), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.3809 = f32[1,31,1]{2,1,0} divide(reshape.3808, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.3810 = f32[1,31,1]{2,1,0} add(divide.3809, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.3811 = f32[1,31,1]{2,1,0} sqrt(add.3810), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.3812 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.3811), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.3813 = f32[1,31,1]{2,1,0} broadcast(divide.3812), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.3814 = f32[1,31]{1,0} reshape(broadcast.3813), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.3815 = f32[1,31,2304]{2,1,0} broadcast(reshape.3814), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.3816 = f32[1,31,2304]{2,1,0} multiply(add.3801, broadcast.3815), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_152.153 = f32[2304]{0} parameter(152), metadata={op_name="state[1][150]"}
  add.3817 = f32[2304]{0} add(Arg_152.153, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3818 = f32[1,1,2304]{2,1,0} reshape(add.3817), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3819 = f32[1,1,2304]{2,1,0} broadcast(reshape.3818), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3820 = f32[1,2304]{1,0} reshape(broadcast.3819), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3821 = f32[1,31,2304]{2,1,0} broadcast(reshape.3820), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.3822 = f32[1,31,2304]{2,1,0} multiply(multiply.3816, broadcast.3821), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_154.155 = f32[2304,9216]{1,0} parameter(154), metadata={op_name="state[1][152]"}
  dot.3823 = f32[1,31,9216]{2,1,0} dot(multiply.3822, Arg_154.155), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.3825 = f32[1,31,9216]{2,1,0} multiply(dot.3823, dot.3823), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3826 = f32[1,31,9216]{2,1,0} multiply(multiply.3825, dot.3823), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3827 = f32[1,31,9216]{2,1,0} multiply(multiply.3826, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.3828 = f32[1,31,9216]{2,1,0} add(dot.3823, multiply.3827), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3829 = f32[1,31,9216]{2,1,0} multiply(add.3828, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.3830 = f32[1,31,9216]{2,1,0} tanh(multiply.3829), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.3831 = f32[1,31,9216]{2,1,0} add(tanh.3830, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3832 = f32[1,31,9216]{2,1,0} multiply(add.3831, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.3833 = f32[1,31,9216]{2,1,0} multiply(dot.3823, multiply.3832), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_155.156 = f32[2304,9216]{1,0} parameter(155), metadata={op_name="state[1][153]"}
  dot.3824 = f32[1,31,9216]{2,1,0} dot(multiply.3822, Arg_155.156), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.3834 = f32[1,31,9216]{2,1,0} multiply(multiply.3833, dot.3824), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_156.157 = f32[9216,2304]{1,0} parameter(156), metadata={op_name="state[1][154]"}
  dot.3835 = f32[1,31,2304]{2,1,0} dot(multiply.3834, Arg_156.157), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.3836 = f32[1,31,2304]{2,1,0} multiply(dot.3835, dot.3835), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.3841 = f32[1,31]{1,0} reduce(multiply.3836, constant.342), dimensions={2}, to_apply=region_98.3837, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.3842 = f32[1,31,1]{2,1,0} reshape(reduce.3841), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.3843 = f32[1,31,1]{2,1,0} divide(reshape.3842, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.3844 = f32[1,31,1]{2,1,0} add(divide.3843, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.3845 = f32[1,31,1]{2,1,0} sqrt(add.3844), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.3846 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.3845), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.3847 = f32[1,31,1]{2,1,0} broadcast(divide.3846), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.3848 = f32[1,31]{1,0} reshape(broadcast.3847), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.3849 = f32[1,31,2304]{2,1,0} broadcast(reshape.3848), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.3850 = f32[1,31,2304]{2,1,0} multiply(dot.3835, broadcast.3849), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_153.154 = f32[2304]{0} parameter(153), metadata={op_name="state[1][151]"}
  add.3851 = f32[2304]{0} add(Arg_153.154, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3852 = f32[1,1,2304]{2,1,0} reshape(add.3851), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3853 = f32[1,1,2304]{2,1,0} broadcast(reshape.3852), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3854 = f32[1,2304]{1,0} reshape(broadcast.3853), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3855 = f32[1,31,2304]{2,1,0} broadcast(reshape.3854), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.3856 = f32[1,31,2304]{2,1,0} multiply(multiply.3850, broadcast.3855), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.3857 = f32[1,31,2304]{2,1,0} add(multiply.3856, add.3801), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_13/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.3858 = f32[1,31,2304]{2,1,0} multiply(add.3857, add.3857), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.3863 = f32[1,31]{1,0} reduce(multiply.3858, constant.342), dimensions={2}, to_apply=region_99.3859, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.3864 = f32[1,31,1]{2,1,0} reshape(reduce.3863), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.3865 = f32[1,31,1]{2,1,0} divide(reshape.3864, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.3866 = f32[1,31,1]{2,1,0} add(divide.3865, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.3867 = f32[1,31,1]{2,1,0} sqrt(add.3866), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.3868 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.3867), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.3869 = f32[1,31,1]{2,1,0} broadcast(divide.3868), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.3870 = f32[1,31]{1,0} reshape(broadcast.3869), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.3871 = f32[1,31,2304]{2,1,0} broadcast(reshape.3870), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.3872 = f32[1,31,2304]{2,1,0} multiply(add.3857, broadcast.3871), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_157.158 = f32[2304]{0} parameter(157), metadata={op_name="state[1][155]"}
  add.3873 = f32[2304]{0} add(Arg_157.158, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3874 = f32[1,1,2304]{2,1,0} reshape(add.3873), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3875 = f32[1,1,2304]{2,1,0} broadcast(reshape.3874), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.3876 = f32[1,2304]{1,0} reshape(broadcast.3875), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.3877 = f32[1,31,2304]{2,1,0} broadcast(reshape.3876), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.3878 = f32[1,31,2304]{2,1,0} multiply(multiply.3872, broadcast.3877), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_160.161 = f32[4,2304,256]{2,1,0} parameter(160), metadata={op_name="state[1][158]"}
  dot.3919 = f32[1,31,4,256]{3,2,1,0} dot(multiply.3878, Arg_160.161), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.3920 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.3921 = f32[128]{0} divide(broadcast.321, power.3920), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.3922 = f32[31,128]{1,0} dot(constant.319, divide.3921), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.3923 = f32[31,1,128]{2,1,0} reshape(dot.3922), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3924 = f32[31,1,128]{2,1,0} reshape(dot.3922), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3925 = f32[31,2,128]{2,1,0} concatenate(reshape.3923, reshape.3924), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3926 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.3925), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.3927 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.3926), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.3936 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.3927), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.3937 = f32[1,31,256]{2,1,0} reshape(broadcast.3936), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.3938 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.3937), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.3939 = f32[1,31,4,256]{3,2,1,0} multiply(dot.3919, broadcast.3938), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.3930 = f32[1,31,4,128]{3,2,1,0} slice(dot.3919), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.3931 = f32[1,31,4,128]{3,2,1,0} negate(slice.3930), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.3932 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.3931), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.3929 = f32[1,31,4,128]{3,2,1,0} slice(dot.3919), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3933 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.3929), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3934 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.3932, reshape.3933), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3935 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.3934), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.3928 = f32[1,31,1,256]{3,2,1,0} sine(reshape.3926), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.3940 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.3928), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.3941 = f32[1,31,256]{2,1,0} reshape(broadcast.3940), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.3942 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.3941), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.3943 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.3935, broadcast.3942), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.3944 = f32[1,31,4,256]{3,2,1,0} add(multiply.3939, multiply.3943), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.3945 = f32[1,31,4,128]{3,2,1,0} slice(add.3944), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3947 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.3945), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.3946 = f32[1,31,4,128]{3,2,1,0} slice(add.3944), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3948 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.3946), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3949 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.3947, reshape.3948), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3952 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.3949), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_161.162 = f32[4,2304,256]{2,1,0} parameter(161), metadata={op_name="state[1][159]"}
  dot.3951 = f32[1,31,4,256]{3,2,1,0} dot(multiply.3878, Arg_161.162), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.3953 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.3951), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3954 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.3952, reshape.3953), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6677 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.3954), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.3879 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.3880 = f32[31]{0} reshape(broadcast.3879), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.3881 = f32[31,31]{1,0} broadcast(reshape.3880), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.3882 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.3883 = f32[31]{0} reshape(broadcast.3882), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.3884 = f32[31,31]{1,0} broadcast(reshape.3883), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.3885 = pred[31,31]{1,0} compare(broadcast.3881, broadcast.3884), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.3886 = pred[1,31,31]{2,1,0} reshape(compare.3885), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.4026 = s32[1,31,31]{2,1,0} convert(reshape.3886), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.4027 = pred[1,31,31]{2,1,0} compare(convert.4026, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.4032 = pred[1,31]{1,0} reduce(compare.4027, constant.340), dimensions={2}, to_apply=region_102.4028, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.4033 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.4032), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.3950 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.3949), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_159.160 = f32[8,2304,256]{2,1,0} parameter(159), metadata={op_name="state[1][157]"}
  dot.3887 = f32[1,31,8,256]{3,2,1,0} dot(multiply.3878, Arg_159.160), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.3888 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.3889 = f32[128]{0} divide(broadcast.321, power.3888), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.3890 = f32[31,128]{1,0} dot(constant.319, divide.3889), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.3891 = f32[31,1,128]{2,1,0} reshape(dot.3890), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3892 = f32[31,1,128]{2,1,0} reshape(dot.3890), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3893 = f32[31,2,128]{2,1,0} concatenate(reshape.3891, reshape.3892), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3894 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.3893), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.3895 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.3894), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.3904 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.3895), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.3905 = f32[1,31,256]{2,1,0} reshape(broadcast.3904), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.3906 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.3905), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.3907 = f32[1,31,8,256]{3,2,1,0} multiply(dot.3887, broadcast.3906), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.3898 = f32[1,31,8,128]{3,2,1,0} slice(dot.3887), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.3899 = f32[1,31,8,128]{3,2,1,0} negate(slice.3898), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.3900 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.3899), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.3897 = f32[1,31,8,128]{3,2,1,0} slice(dot.3887), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3901 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.3897), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3902 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.3900, reshape.3901), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3903 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.3902), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.3896 = f32[1,31,1,256]{3,2,1,0} sine(reshape.3894), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.3908 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.3896), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.3909 = f32[1,31,256]{2,1,0} reshape(broadcast.3908), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.3910 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.3909), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.3911 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.3903, broadcast.3910), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.3912 = f32[1,31,8,256]{3,2,1,0} add(multiply.3907, multiply.3911), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/rotary_embedding_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.3913 = f32[1,31,8,128]{3,2,1,0} slice(add.3912), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3915 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.3913), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.3914 = f32[1,31,8,128]{3,2,1,0} slice(add.3912), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.3916 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.3914), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.3917 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.3915, reshape.3916), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.3918 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.3917), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.3955 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.3918, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.3956 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.3955), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.3957 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.3950, reshape.3956), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.3958 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.3957), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.3959 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.3958, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.3960 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.3959), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.3961 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.3960, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.3975 = pred[31,31]{1,0} call(broadcast.314), to_apply=triu.3962
  call.3989 = pred[31,31]{1,0} call(broadcast.314), to_apply=tril.3976
  and.3990 = pred[31,31]{1,0} and(call.3975, call.3989), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  reshape.3991 = pred[1,31,31]{2,1,0} reshape(and.3990), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.3992 = pred[1,31,31]{2,1,0} and(reshape.3886, reshape.3991), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.3993 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(and.3992), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.3994 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.3993), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.3995 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.3994), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.3996 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.3995, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.3997 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.3996), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.3998 = f32[1,31,31]{2,1,0} reshape(broadcast.3997), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.3999 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.3998), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.4000 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.3961, broadcast.3999), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.4005 = f32[1,4,2,31]{3,2,1,0} reduce(add.4000, constant.339), dimensions={4}, to_apply=region_100.4001, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.4006 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.4005, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.4007 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.4006), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.4008 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.4007), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.4009 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.4008), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.4010 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.4009), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.4011 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.4000, broadcast.4010), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.4012 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.4011), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.4017 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.4012, constant.342), dimensions={4}, to_apply=region_101.4013, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.4018 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.4017), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.4019 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.4018), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.4020 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.4019), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.4021 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.4020), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.4022 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.4012, broadcast.4021), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/softmax_14/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.4023 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.3951, divide.4022), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.4024 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.4023), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.4025 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.4024), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.4042 = f32[1,31,8,256]{3,2,1,0} call(reshape.4033, broadcast.304, reshape.4025), to_apply=_where_0.4034
  Arg_162.163 = f32[8,256,2304]{2,1,0} parameter(162), metadata={op_name="state[1][160]"}
  dot.4043 = f32[1,31,2304]{2,1,0} dot(call.4042, Arg_162.163), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.4044 = f32[1,31,2304]{2,1,0} multiply(dot.4043, dot.4043), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.4049 = f32[1,31]{1,0} reduce(multiply.4044, constant.342), dimensions={2}, to_apply=region_103.4045, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.4050 = f32[1,31,1]{2,1,0} reshape(reduce.4049), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.4051 = f32[1,31,1]{2,1,0} divide(reshape.4050, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.4052 = f32[1,31,1]{2,1,0} add(divide.4051, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.4053 = f32[1,31,1]{2,1,0} sqrt(add.4052), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.4054 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.4053), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.4055 = f32[1,31,1]{2,1,0} broadcast(divide.4054), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.4056 = f32[1,31]{1,0} reshape(broadcast.4055), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.4057 = f32[1,31,2304]{2,1,0} broadcast(reshape.4056), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.4058 = f32[1,31,2304]{2,1,0} multiply(dot.4043, broadcast.4057), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_158.159 = f32[2304]{0} parameter(158), metadata={op_name="state[1][156]"}
  add.4059 = f32[2304]{0} add(Arg_158.159, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4060 = f32[1,1,2304]{2,1,0} reshape(add.4059), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4061 = f32[1,1,2304]{2,1,0} broadcast(reshape.4060), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4062 = f32[1,2304]{1,0} reshape(broadcast.4061), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4063 = f32[1,31,2304]{2,1,0} broadcast(reshape.4062), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.4064 = f32[1,31,2304]{2,1,0} multiply(multiply.4058, broadcast.4063), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.4065 = f32[1,31,2304]{2,1,0} add(add.3857, multiply.4064), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.4066 = f32[1,31,2304]{2,1,0} multiply(add.4065, add.4065), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.4071 = f32[1,31]{1,0} reduce(multiply.4066, constant.342), dimensions={2}, to_apply=region_104.4067, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.4072 = f32[1,31,1]{2,1,0} reshape(reduce.4071), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.4073 = f32[1,31,1]{2,1,0} divide(reshape.4072, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.4074 = f32[1,31,1]{2,1,0} add(divide.4073, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.4075 = f32[1,31,1]{2,1,0} sqrt(add.4074), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.4076 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.4075), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.4077 = f32[1,31,1]{2,1,0} broadcast(divide.4076), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.4078 = f32[1,31]{1,0} reshape(broadcast.4077), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.4079 = f32[1,31,2304]{2,1,0} broadcast(reshape.4078), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.4080 = f32[1,31,2304]{2,1,0} multiply(add.4065, broadcast.4079), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_163.164 = f32[2304]{0} parameter(163), metadata={op_name="state[1][161]"}
  add.4081 = f32[2304]{0} add(Arg_163.164, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4082 = f32[1,1,2304]{2,1,0} reshape(add.4081), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4083 = f32[1,1,2304]{2,1,0} broadcast(reshape.4082), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4084 = f32[1,2304]{1,0} reshape(broadcast.4083), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4085 = f32[1,31,2304]{2,1,0} broadcast(reshape.4084), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.4086 = f32[1,31,2304]{2,1,0} multiply(multiply.4080, broadcast.4085), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_165.166 = f32[2304,9216]{1,0} parameter(165), metadata={op_name="state[1][163]"}
  dot.4087 = f32[1,31,9216]{2,1,0} dot(multiply.4086, Arg_165.166), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.4089 = f32[1,31,9216]{2,1,0} multiply(dot.4087, dot.4087), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4090 = f32[1,31,9216]{2,1,0} multiply(multiply.4089, dot.4087), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4091 = f32[1,31,9216]{2,1,0} multiply(multiply.4090, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.4092 = f32[1,31,9216]{2,1,0} add(dot.4087, multiply.4091), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4093 = f32[1,31,9216]{2,1,0} multiply(add.4092, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.4094 = f32[1,31,9216]{2,1,0} tanh(multiply.4093), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.4095 = f32[1,31,9216]{2,1,0} add(tanh.4094, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4096 = f32[1,31,9216]{2,1,0} multiply(add.4095, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4097 = f32[1,31,9216]{2,1,0} multiply(dot.4087, multiply.4096), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_166.167 = f32[2304,9216]{1,0} parameter(166), metadata={op_name="state[1][164]"}
  dot.4088 = f32[1,31,9216]{2,1,0} dot(multiply.4086, Arg_166.167), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.4098 = f32[1,31,9216]{2,1,0} multiply(multiply.4097, dot.4088), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_167.168 = f32[9216,2304]{1,0} parameter(167), metadata={op_name="state[1][165]"}
  dot.4099 = f32[1,31,2304]{2,1,0} dot(multiply.4098, Arg_167.168), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.4100 = f32[1,31,2304]{2,1,0} multiply(dot.4099, dot.4099), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.4105 = f32[1,31]{1,0} reduce(multiply.4100, constant.342), dimensions={2}, to_apply=region_105.4101, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.4106 = f32[1,31,1]{2,1,0} reshape(reduce.4105), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.4107 = f32[1,31,1]{2,1,0} divide(reshape.4106, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.4108 = f32[1,31,1]{2,1,0} add(divide.4107, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.4109 = f32[1,31,1]{2,1,0} sqrt(add.4108), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.4110 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.4109), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.4111 = f32[1,31,1]{2,1,0} broadcast(divide.4110), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.4112 = f32[1,31]{1,0} reshape(broadcast.4111), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.4113 = f32[1,31,2304]{2,1,0} broadcast(reshape.4112), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.4114 = f32[1,31,2304]{2,1,0} multiply(dot.4099, broadcast.4113), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_164.165 = f32[2304]{0} parameter(164), metadata={op_name="state[1][162]"}
  add.4115 = f32[2304]{0} add(Arg_164.165, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4116 = f32[1,1,2304]{2,1,0} reshape(add.4115), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4117 = f32[1,1,2304]{2,1,0} broadcast(reshape.4116), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4118 = f32[1,2304]{1,0} reshape(broadcast.4117), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4119 = f32[1,31,2304]{2,1,0} broadcast(reshape.4118), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.4120 = f32[1,31,2304]{2,1,0} multiply(multiply.4114, broadcast.4119), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.4121 = f32[1,31,2304]{2,1,0} add(multiply.4120, add.4065), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_14/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.4122 = f32[1,31,2304]{2,1,0} multiply(add.4121, add.4121), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.4127 = f32[1,31]{1,0} reduce(multiply.4122, constant.342), dimensions={2}, to_apply=region_106.4123, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.4128 = f32[1,31,1]{2,1,0} reshape(reduce.4127), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.4129 = f32[1,31,1]{2,1,0} divide(reshape.4128, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.4130 = f32[1,31,1]{2,1,0} add(divide.4129, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.4131 = f32[1,31,1]{2,1,0} sqrt(add.4130), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.4132 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.4131), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.4133 = f32[1,31,1]{2,1,0} broadcast(divide.4132), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.4134 = f32[1,31]{1,0} reshape(broadcast.4133), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.4135 = f32[1,31,2304]{2,1,0} broadcast(reshape.4134), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.4136 = f32[1,31,2304]{2,1,0} multiply(add.4121, broadcast.4135), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_168.169 = f32[2304]{0} parameter(168), metadata={op_name="state[1][166]"}
  add.4137 = f32[2304]{0} add(Arg_168.169, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4138 = f32[1,1,2304]{2,1,0} reshape(add.4137), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4139 = f32[1,1,2304]{2,1,0} broadcast(reshape.4138), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4140 = f32[1,2304]{1,0} reshape(broadcast.4139), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4141 = f32[1,31,2304]{2,1,0} broadcast(reshape.4140), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.4142 = f32[1,31,2304]{2,1,0} multiply(multiply.4136, broadcast.4141), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_171.172 = f32[4,2304,256]{2,1,0} parameter(171), metadata={op_name="state[1][169]"}
  dot.4183 = f32[1,31,4,256]{3,2,1,0} dot(multiply.4142, Arg_171.172), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.4184 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.4185 = f32[128]{0} divide(broadcast.321, power.4184), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.4186 = f32[31,128]{1,0} dot(constant.319, divide.4185), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.4187 = f32[31,1,128]{2,1,0} reshape(dot.4186), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4188 = f32[31,1,128]{2,1,0} reshape(dot.4186), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4189 = f32[31,2,128]{2,1,0} concatenate(reshape.4187, reshape.4188), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4190 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.4189), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.4191 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.4190), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.4200 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.4191), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.4201 = f32[1,31,256]{2,1,0} reshape(broadcast.4200), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.4202 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.4201), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.4203 = f32[1,31,4,256]{3,2,1,0} multiply(dot.4183, broadcast.4202), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.4194 = f32[1,31,4,128]{3,2,1,0} slice(dot.4183), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.4195 = f32[1,31,4,128]{3,2,1,0} negate(slice.4194), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.4196 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.4195), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.4193 = f32[1,31,4,128]{3,2,1,0} slice(dot.4183), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4197 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.4193), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4198 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.4196, reshape.4197), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4199 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.4198), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.4192 = f32[1,31,1,256]{3,2,1,0} sine(reshape.4190), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.4204 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.4192), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.4205 = f32[1,31,256]{2,1,0} reshape(broadcast.4204), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.4206 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.4205), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.4207 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.4199, broadcast.4206), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.4208 = f32[1,31,4,256]{3,2,1,0} add(multiply.4203, multiply.4207), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.4209 = f32[1,31,4,128]{3,2,1,0} slice(add.4208), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4211 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.4209), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.4210 = f32[1,31,4,128]{3,2,1,0} slice(add.4208), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4212 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.4210), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4213 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.4211, reshape.4212), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4216 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.4213), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_172.173 = f32[4,2304,256]{2,1,0} parameter(172), metadata={op_name="state[1][170]"}
  dot.4215 = f32[1,31,4,256]{3,2,1,0} dot(multiply.4142, Arg_172.173), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.4217 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.4215), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4218 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.4216, reshape.4217), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6678 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.4218), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.4143 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.4144 = f32[31]{0} reshape(broadcast.4143), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.4145 = f32[31,31]{1,0} broadcast(reshape.4144), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.4146 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.4147 = f32[31]{0} reshape(broadcast.4146), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.4148 = f32[31,31]{1,0} broadcast(reshape.4147), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.4149 = pred[31,31]{1,0} compare(broadcast.4145, broadcast.4148), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.4150 = pred[1,31,31]{2,1,0} reshape(compare.4149), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.4259 = s32[1,31,31]{2,1,0} convert(reshape.4150), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.4260 = pred[1,31,31]{2,1,0} compare(convert.4259, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.4265 = pred[1,31]{1,0} reduce(compare.4260, constant.340), dimensions={2}, to_apply=region_109.4261, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.4266 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.4265), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.4214 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.4213), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_170.171 = f32[8,2304,256]{2,1,0} parameter(170), metadata={op_name="state[1][168]"}
  dot.4151 = f32[1,31,8,256]{3,2,1,0} dot(multiply.4142, Arg_170.171), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.4152 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.4153 = f32[128]{0} divide(broadcast.321, power.4152), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.4154 = f32[31,128]{1,0} dot(constant.319, divide.4153), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.4155 = f32[31,1,128]{2,1,0} reshape(dot.4154), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4156 = f32[31,1,128]{2,1,0} reshape(dot.4154), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4157 = f32[31,2,128]{2,1,0} concatenate(reshape.4155, reshape.4156), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4158 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.4157), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.4159 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.4158), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.4168 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.4159), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.4169 = f32[1,31,256]{2,1,0} reshape(broadcast.4168), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.4170 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.4169), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.4171 = f32[1,31,8,256]{3,2,1,0} multiply(dot.4151, broadcast.4170), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.4162 = f32[1,31,8,128]{3,2,1,0} slice(dot.4151), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.4163 = f32[1,31,8,128]{3,2,1,0} negate(slice.4162), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.4164 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.4163), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.4161 = f32[1,31,8,128]{3,2,1,0} slice(dot.4151), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4165 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.4161), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4166 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.4164, reshape.4165), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4167 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.4166), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.4160 = f32[1,31,1,256]{3,2,1,0} sine(reshape.4158), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.4172 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.4160), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.4173 = f32[1,31,256]{2,1,0} reshape(broadcast.4172), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.4174 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.4173), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.4175 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.4167, broadcast.4174), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.4176 = f32[1,31,8,256]{3,2,1,0} add(multiply.4171, multiply.4175), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/rotary_embedding_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.4177 = f32[1,31,8,128]{3,2,1,0} slice(add.4176), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4179 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.4177), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.4178 = f32[1,31,8,128]{3,2,1,0} slice(add.4176), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4180 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.4178), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4181 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.4179, reshape.4180), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4182 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.4181), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.4219 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.4182, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.4220 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.4219), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.4221 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.4214, reshape.4220), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.4222 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.4221), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.4223 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.4222, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.4224 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.4223), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.4225 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.4224, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.4226 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(compare.4149), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.4227 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.4226), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.4228 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.4227), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.4229 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.4228, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.4230 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.4229), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.4231 = f32[1,31,31]{2,1,0} reshape(broadcast.4230), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.4232 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.4231), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.4233 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.4225, broadcast.4232), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.4238 = f32[1,4,2,31]{3,2,1,0} reduce(add.4233, constant.339), dimensions={4}, to_apply=region_107.4234, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.4239 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.4238, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.4240 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.4239), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.4241 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.4240), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.4242 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.4241), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.4243 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.4242), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.4244 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.4233, broadcast.4243), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.4245 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.4244), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.4250 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.4245, constant.342), dimensions={4}, to_apply=region_108.4246, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.4251 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.4250), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.4252 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.4251), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.4253 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.4252), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.4254 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.4253), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.4255 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.4245, broadcast.4254), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/softmax_15/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.4256 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.4215, divide.4255), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.4257 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.4256), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.4258 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.4257), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.4275 = f32[1,31,8,256]{3,2,1,0} call(reshape.4266, broadcast.304, reshape.4258), to_apply=_where_0.4267
  Arg_173.174 = f32[8,256,2304]{2,1,0} parameter(173), metadata={op_name="state[1][171]"}
  dot.4276 = f32[1,31,2304]{2,1,0} dot(call.4275, Arg_173.174), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.4277 = f32[1,31,2304]{2,1,0} multiply(dot.4276, dot.4276), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.4282 = f32[1,31]{1,0} reduce(multiply.4277, constant.342), dimensions={2}, to_apply=region_110.4278, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.4283 = f32[1,31,1]{2,1,0} reshape(reduce.4282), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.4284 = f32[1,31,1]{2,1,0} divide(reshape.4283, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.4285 = f32[1,31,1]{2,1,0} add(divide.4284, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.4286 = f32[1,31,1]{2,1,0} sqrt(add.4285), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.4287 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.4286), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.4288 = f32[1,31,1]{2,1,0} broadcast(divide.4287), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.4289 = f32[1,31]{1,0} reshape(broadcast.4288), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.4290 = f32[1,31,2304]{2,1,0} broadcast(reshape.4289), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.4291 = f32[1,31,2304]{2,1,0} multiply(dot.4276, broadcast.4290), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_169.170 = f32[2304]{0} parameter(169), metadata={op_name="state[1][167]"}
  add.4292 = f32[2304]{0} add(Arg_169.170, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4293 = f32[1,1,2304]{2,1,0} reshape(add.4292), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4294 = f32[1,1,2304]{2,1,0} broadcast(reshape.4293), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4295 = f32[1,2304]{1,0} reshape(broadcast.4294), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4296 = f32[1,31,2304]{2,1,0} broadcast(reshape.4295), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.4297 = f32[1,31,2304]{2,1,0} multiply(multiply.4291, broadcast.4296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.4298 = f32[1,31,2304]{2,1,0} add(add.4121, multiply.4297), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.4299 = f32[1,31,2304]{2,1,0} multiply(add.4298, add.4298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.4304 = f32[1,31]{1,0} reduce(multiply.4299, constant.342), dimensions={2}, to_apply=region_111.4300, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.4305 = f32[1,31,1]{2,1,0} reshape(reduce.4304), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.4306 = f32[1,31,1]{2,1,0} divide(reshape.4305, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.4307 = f32[1,31,1]{2,1,0} add(divide.4306, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.4308 = f32[1,31,1]{2,1,0} sqrt(add.4307), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.4309 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.4308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.4310 = f32[1,31,1]{2,1,0} broadcast(divide.4309), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.4311 = f32[1,31]{1,0} reshape(broadcast.4310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.4312 = f32[1,31,2304]{2,1,0} broadcast(reshape.4311), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.4313 = f32[1,31,2304]{2,1,0} multiply(add.4298, broadcast.4312), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_174.175 = f32[2304]{0} parameter(174), metadata={op_name="state[1][172]"}
  add.4314 = f32[2304]{0} add(Arg_174.175, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4315 = f32[1,1,2304]{2,1,0} reshape(add.4314), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4316 = f32[1,1,2304]{2,1,0} broadcast(reshape.4315), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4317 = f32[1,2304]{1,0} reshape(broadcast.4316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4318 = f32[1,31,2304]{2,1,0} broadcast(reshape.4317), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.4319 = f32[1,31,2304]{2,1,0} multiply(multiply.4313, broadcast.4318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_176.177 = f32[2304,9216]{1,0} parameter(176), metadata={op_name="state[1][174]"}
  dot.4320 = f32[1,31,9216]{2,1,0} dot(multiply.4319, Arg_176.177), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.4322 = f32[1,31,9216]{2,1,0} multiply(dot.4320, dot.4320), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4323 = f32[1,31,9216]{2,1,0} multiply(multiply.4322, dot.4320), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4324 = f32[1,31,9216]{2,1,0} multiply(multiply.4323, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.4325 = f32[1,31,9216]{2,1,0} add(dot.4320, multiply.4324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4326 = f32[1,31,9216]{2,1,0} multiply(add.4325, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.4327 = f32[1,31,9216]{2,1,0} tanh(multiply.4326), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.4328 = f32[1,31,9216]{2,1,0} add(tanh.4327, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4329 = f32[1,31,9216]{2,1,0} multiply(add.4328, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4330 = f32[1,31,9216]{2,1,0} multiply(dot.4320, multiply.4329), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_177.178 = f32[2304,9216]{1,0} parameter(177), metadata={op_name="state[1][175]"}
  dot.4321 = f32[1,31,9216]{2,1,0} dot(multiply.4319, Arg_177.178), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.4331 = f32[1,31,9216]{2,1,0} multiply(multiply.4330, dot.4321), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_178.179 = f32[9216,2304]{1,0} parameter(178), metadata={op_name="state[1][176]"}
  dot.4332 = f32[1,31,2304]{2,1,0} dot(multiply.4331, Arg_178.179), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.4333 = f32[1,31,2304]{2,1,0} multiply(dot.4332, dot.4332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.4338 = f32[1,31]{1,0} reduce(multiply.4333, constant.342), dimensions={2}, to_apply=region_112.4334, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.4339 = f32[1,31,1]{2,1,0} reshape(reduce.4338), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.4340 = f32[1,31,1]{2,1,0} divide(reshape.4339, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.4341 = f32[1,31,1]{2,1,0} add(divide.4340, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.4342 = f32[1,31,1]{2,1,0} sqrt(add.4341), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.4343 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.4342), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.4344 = f32[1,31,1]{2,1,0} broadcast(divide.4343), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.4345 = f32[1,31]{1,0} reshape(broadcast.4344), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.4346 = f32[1,31,2304]{2,1,0} broadcast(reshape.4345), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.4347 = f32[1,31,2304]{2,1,0} multiply(dot.4332, broadcast.4346), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_175.176 = f32[2304]{0} parameter(175), metadata={op_name="state[1][173]"}
  add.4348 = f32[2304]{0} add(Arg_175.176, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4349 = f32[1,1,2304]{2,1,0} reshape(add.4348), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4350 = f32[1,1,2304]{2,1,0} broadcast(reshape.4349), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4351 = f32[1,2304]{1,0} reshape(broadcast.4350), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4352 = f32[1,31,2304]{2,1,0} broadcast(reshape.4351), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.4353 = f32[1,31,2304]{2,1,0} multiply(multiply.4347, broadcast.4352), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.4354 = f32[1,31,2304]{2,1,0} add(multiply.4353, add.4298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_15/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.4355 = f32[1,31,2304]{2,1,0} multiply(add.4354, add.4354), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.4360 = f32[1,31]{1,0} reduce(multiply.4355, constant.342), dimensions={2}, to_apply=region_113.4356, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.4361 = f32[1,31,1]{2,1,0} reshape(reduce.4360), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.4362 = f32[1,31,1]{2,1,0} divide(reshape.4361, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.4363 = f32[1,31,1]{2,1,0} add(divide.4362, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.4364 = f32[1,31,1]{2,1,0} sqrt(add.4363), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.4365 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.4364), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.4366 = f32[1,31,1]{2,1,0} broadcast(divide.4365), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.4367 = f32[1,31]{1,0} reshape(broadcast.4366), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.4368 = f32[1,31,2304]{2,1,0} broadcast(reshape.4367), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.4369 = f32[1,31,2304]{2,1,0} multiply(add.4354, broadcast.4368), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_179.180 = f32[2304]{0} parameter(179), metadata={op_name="state[1][177]"}
  add.4370 = f32[2304]{0} add(Arg_179.180, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4371 = f32[1,1,2304]{2,1,0} reshape(add.4370), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4372 = f32[1,1,2304]{2,1,0} broadcast(reshape.4371), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4373 = f32[1,2304]{1,0} reshape(broadcast.4372), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4374 = f32[1,31,2304]{2,1,0} broadcast(reshape.4373), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.4375 = f32[1,31,2304]{2,1,0} multiply(multiply.4369, broadcast.4374), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_182.183 = f32[4,2304,256]{2,1,0} parameter(182), metadata={op_name="state[1][180]"}
  dot.4416 = f32[1,31,4,256]{3,2,1,0} dot(multiply.4375, Arg_182.183), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.4417 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.4418 = f32[128]{0} divide(broadcast.321, power.4417), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.4419 = f32[31,128]{1,0} dot(constant.319, divide.4418), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.4420 = f32[31,1,128]{2,1,0} reshape(dot.4419), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4421 = f32[31,1,128]{2,1,0} reshape(dot.4419), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4422 = f32[31,2,128]{2,1,0} concatenate(reshape.4420, reshape.4421), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4423 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.4422), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.4424 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.4423), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.4433 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.4424), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.4434 = f32[1,31,256]{2,1,0} reshape(broadcast.4433), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.4435 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.4434), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.4436 = f32[1,31,4,256]{3,2,1,0} multiply(dot.4416, broadcast.4435), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.4427 = f32[1,31,4,128]{3,2,1,0} slice(dot.4416), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.4428 = f32[1,31,4,128]{3,2,1,0} negate(slice.4427), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.4429 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.4428), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.4426 = f32[1,31,4,128]{3,2,1,0} slice(dot.4416), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4430 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.4426), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4431 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.4429, reshape.4430), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4432 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.4431), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.4425 = f32[1,31,1,256]{3,2,1,0} sine(reshape.4423), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.4437 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.4425), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.4438 = f32[1,31,256]{2,1,0} reshape(broadcast.4437), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.4439 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.4438), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.4440 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.4432, broadcast.4439), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.4441 = f32[1,31,4,256]{3,2,1,0} add(multiply.4436, multiply.4440), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.4442 = f32[1,31,4,128]{3,2,1,0} slice(add.4441), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4444 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.4442), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.4443 = f32[1,31,4,128]{3,2,1,0} slice(add.4441), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4445 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.4443), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4446 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.4444, reshape.4445), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4449 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.4446), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_183.184 = f32[4,2304,256]{2,1,0} parameter(183), metadata={op_name="state[1][181]"}
  dot.4448 = f32[1,31,4,256]{3,2,1,0} dot(multiply.4375, Arg_183.184), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.4450 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.4448), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4451 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.4449, reshape.4450), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6679 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.4451), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.4376 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.4377 = f32[31]{0} reshape(broadcast.4376), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.4378 = f32[31,31]{1,0} broadcast(reshape.4377), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.4379 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.4380 = f32[31]{0} reshape(broadcast.4379), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.4381 = f32[31,31]{1,0} broadcast(reshape.4380), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.4382 = pred[31,31]{1,0} compare(broadcast.4378, broadcast.4381), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.4383 = pred[1,31,31]{2,1,0} reshape(compare.4382), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.4523 = s32[1,31,31]{2,1,0} convert(reshape.4383), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.4524 = pred[1,31,31]{2,1,0} compare(convert.4523, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.4529 = pred[1,31]{1,0} reduce(compare.4524, constant.340), dimensions={2}, to_apply=region_116.4525, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.4530 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.4529), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.4447 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.4446), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_181.182 = f32[8,2304,256]{2,1,0} parameter(181), metadata={op_name="state[1][179]"}
  dot.4384 = f32[1,31,8,256]{3,2,1,0} dot(multiply.4375, Arg_181.182), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.4385 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.4386 = f32[128]{0} divide(broadcast.321, power.4385), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.4387 = f32[31,128]{1,0} dot(constant.319, divide.4386), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.4388 = f32[31,1,128]{2,1,0} reshape(dot.4387), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4389 = f32[31,1,128]{2,1,0} reshape(dot.4387), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4390 = f32[31,2,128]{2,1,0} concatenate(reshape.4388, reshape.4389), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4391 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.4390), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.4392 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.4391), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.4401 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.4392), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.4402 = f32[1,31,256]{2,1,0} reshape(broadcast.4401), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.4403 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.4402), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.4404 = f32[1,31,8,256]{3,2,1,0} multiply(dot.4384, broadcast.4403), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.4395 = f32[1,31,8,128]{3,2,1,0} slice(dot.4384), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.4396 = f32[1,31,8,128]{3,2,1,0} negate(slice.4395), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.4397 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.4396), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.4394 = f32[1,31,8,128]{3,2,1,0} slice(dot.4384), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4398 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.4394), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4399 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.4397, reshape.4398), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4400 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.4399), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.4393 = f32[1,31,1,256]{3,2,1,0} sine(reshape.4391), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.4405 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.4393), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.4406 = f32[1,31,256]{2,1,0} reshape(broadcast.4405), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.4407 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.4406), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.4408 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.4400, broadcast.4407), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.4409 = f32[1,31,8,256]{3,2,1,0} add(multiply.4404, multiply.4408), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/rotary_embedding_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.4410 = f32[1,31,8,128]{3,2,1,0} slice(add.4409), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4412 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.4410), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.4411 = f32[1,31,8,128]{3,2,1,0} slice(add.4409), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4413 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.4411), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4414 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.4412, reshape.4413), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4415 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.4414), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.4452 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.4415, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.4453 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.4452), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.4454 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.4447, reshape.4453), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.4455 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.4454), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.4456 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.4455, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.4457 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.4456), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.4458 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.4457, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.4472 = pred[31,31]{1,0} call(broadcast.314), to_apply=triu.4459
  call.4486 = pred[31,31]{1,0} call(broadcast.314), to_apply=tril.4473
  and.4487 = pred[31,31]{1,0} and(call.4472, call.4486), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  reshape.4488 = pred[1,31,31]{2,1,0} reshape(and.4487), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.4489 = pred[1,31,31]{2,1,0} and(reshape.4383, reshape.4488), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.4490 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(and.4489), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.4491 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.4490), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.4492 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.4491), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.4493 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.4492, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.4494 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.4493), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.4495 = f32[1,31,31]{2,1,0} reshape(broadcast.4494), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.4496 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.4495), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.4497 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.4458, broadcast.4496), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.4502 = f32[1,4,2,31]{3,2,1,0} reduce(add.4497, constant.339), dimensions={4}, to_apply=region_114.4498, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.4503 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.4502, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.4504 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.4503), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.4505 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.4504), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.4506 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.4505), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.4507 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.4506), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.4508 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.4497, broadcast.4507), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.4509 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.4508), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.4514 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.4509, constant.342), dimensions={4}, to_apply=region_115.4510, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.4515 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.4514), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.4516 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.4515), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.4517 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.4516), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.4518 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.4517), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.4519 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.4509, broadcast.4518), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/softmax_16/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.4520 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.4448, divide.4519), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.4521 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.4520), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.4522 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.4521), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.4539 = f32[1,31,8,256]{3,2,1,0} call(reshape.4530, broadcast.304, reshape.4522), to_apply=_where_0.4531
  Arg_184.185 = f32[8,256,2304]{2,1,0} parameter(184), metadata={op_name="state[1][182]"}
  dot.4540 = f32[1,31,2304]{2,1,0} dot(call.4539, Arg_184.185), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.4541 = f32[1,31,2304]{2,1,0} multiply(dot.4540, dot.4540), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.4546 = f32[1,31]{1,0} reduce(multiply.4541, constant.342), dimensions={2}, to_apply=region_117.4542, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.4547 = f32[1,31,1]{2,1,0} reshape(reduce.4546), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.4548 = f32[1,31,1]{2,1,0} divide(reshape.4547, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.4549 = f32[1,31,1]{2,1,0} add(divide.4548, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.4550 = f32[1,31,1]{2,1,0} sqrt(add.4549), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.4551 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.4550), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.4552 = f32[1,31,1]{2,1,0} broadcast(divide.4551), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.4553 = f32[1,31]{1,0} reshape(broadcast.4552), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.4554 = f32[1,31,2304]{2,1,0} broadcast(reshape.4553), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.4555 = f32[1,31,2304]{2,1,0} multiply(dot.4540, broadcast.4554), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_180.181 = f32[2304]{0} parameter(180), metadata={op_name="state[1][178]"}
  add.4556 = f32[2304]{0} add(Arg_180.181, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4557 = f32[1,1,2304]{2,1,0} reshape(add.4556), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4558 = f32[1,1,2304]{2,1,0} broadcast(reshape.4557), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4559 = f32[1,2304]{1,0} reshape(broadcast.4558), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4560 = f32[1,31,2304]{2,1,0} broadcast(reshape.4559), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.4561 = f32[1,31,2304]{2,1,0} multiply(multiply.4555, broadcast.4560), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.4562 = f32[1,31,2304]{2,1,0} add(add.4354, multiply.4561), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.4563 = f32[1,31,2304]{2,1,0} multiply(add.4562, add.4562), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.4568 = f32[1,31]{1,0} reduce(multiply.4563, constant.342), dimensions={2}, to_apply=region_118.4564, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.4569 = f32[1,31,1]{2,1,0} reshape(reduce.4568), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.4570 = f32[1,31,1]{2,1,0} divide(reshape.4569, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.4571 = f32[1,31,1]{2,1,0} add(divide.4570, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.4572 = f32[1,31,1]{2,1,0} sqrt(add.4571), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.4573 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.4572), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.4574 = f32[1,31,1]{2,1,0} broadcast(divide.4573), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.4575 = f32[1,31]{1,0} reshape(broadcast.4574), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.4576 = f32[1,31,2304]{2,1,0} broadcast(reshape.4575), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.4577 = f32[1,31,2304]{2,1,0} multiply(add.4562, broadcast.4576), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_185.186 = f32[2304]{0} parameter(185), metadata={op_name="state[1][183]"}
  add.4578 = f32[2304]{0} add(Arg_185.186, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4579 = f32[1,1,2304]{2,1,0} reshape(add.4578), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4580 = f32[1,1,2304]{2,1,0} broadcast(reshape.4579), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4581 = f32[1,2304]{1,0} reshape(broadcast.4580), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4582 = f32[1,31,2304]{2,1,0} broadcast(reshape.4581), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.4583 = f32[1,31,2304]{2,1,0} multiply(multiply.4577, broadcast.4582), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_187.188 = f32[2304,9216]{1,0} parameter(187), metadata={op_name="state[1][185]"}
  dot.4584 = f32[1,31,9216]{2,1,0} dot(multiply.4583, Arg_187.188), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.4586 = f32[1,31,9216]{2,1,0} multiply(dot.4584, dot.4584), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4587 = f32[1,31,9216]{2,1,0} multiply(multiply.4586, dot.4584), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4588 = f32[1,31,9216]{2,1,0} multiply(multiply.4587, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.4589 = f32[1,31,9216]{2,1,0} add(dot.4584, multiply.4588), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4590 = f32[1,31,9216]{2,1,0} multiply(add.4589, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.4591 = f32[1,31,9216]{2,1,0} tanh(multiply.4590), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.4592 = f32[1,31,9216]{2,1,0} add(tanh.4591, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4593 = f32[1,31,9216]{2,1,0} multiply(add.4592, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4594 = f32[1,31,9216]{2,1,0} multiply(dot.4584, multiply.4593), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_188.189 = f32[2304,9216]{1,0} parameter(188), metadata={op_name="state[1][186]"}
  dot.4585 = f32[1,31,9216]{2,1,0} dot(multiply.4583, Arg_188.189), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.4595 = f32[1,31,9216]{2,1,0} multiply(multiply.4594, dot.4585), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_189.190 = f32[9216,2304]{1,0} parameter(189), metadata={op_name="state[1][187]"}
  dot.4596 = f32[1,31,2304]{2,1,0} dot(multiply.4595, Arg_189.190), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.4597 = f32[1,31,2304]{2,1,0} multiply(dot.4596, dot.4596), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.4602 = f32[1,31]{1,0} reduce(multiply.4597, constant.342), dimensions={2}, to_apply=region_119.4598, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.4603 = f32[1,31,1]{2,1,0} reshape(reduce.4602), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.4604 = f32[1,31,1]{2,1,0} divide(reshape.4603, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.4605 = f32[1,31,1]{2,1,0} add(divide.4604, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.4606 = f32[1,31,1]{2,1,0} sqrt(add.4605), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.4607 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.4606), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.4608 = f32[1,31,1]{2,1,0} broadcast(divide.4607), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.4609 = f32[1,31]{1,0} reshape(broadcast.4608), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.4610 = f32[1,31,2304]{2,1,0} broadcast(reshape.4609), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.4611 = f32[1,31,2304]{2,1,0} multiply(dot.4596, broadcast.4610), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_186.187 = f32[2304]{0} parameter(186), metadata={op_name="state[1][184]"}
  add.4612 = f32[2304]{0} add(Arg_186.187, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4613 = f32[1,1,2304]{2,1,0} reshape(add.4612), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4614 = f32[1,1,2304]{2,1,0} broadcast(reshape.4613), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4615 = f32[1,2304]{1,0} reshape(broadcast.4614), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4616 = f32[1,31,2304]{2,1,0} broadcast(reshape.4615), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.4617 = f32[1,31,2304]{2,1,0} multiply(multiply.4611, broadcast.4616), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.4618 = f32[1,31,2304]{2,1,0} add(multiply.4617, add.4562), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_16/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.4619 = f32[1,31,2304]{2,1,0} multiply(add.4618, add.4618), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.4624 = f32[1,31]{1,0} reduce(multiply.4619, constant.342), dimensions={2}, to_apply=region_120.4620, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.4625 = f32[1,31,1]{2,1,0} reshape(reduce.4624), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.4626 = f32[1,31,1]{2,1,0} divide(reshape.4625, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.4627 = f32[1,31,1]{2,1,0} add(divide.4626, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.4628 = f32[1,31,1]{2,1,0} sqrt(add.4627), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.4629 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.4628), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.4630 = f32[1,31,1]{2,1,0} broadcast(divide.4629), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.4631 = f32[1,31]{1,0} reshape(broadcast.4630), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.4632 = f32[1,31,2304]{2,1,0} broadcast(reshape.4631), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.4633 = f32[1,31,2304]{2,1,0} multiply(add.4618, broadcast.4632), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_190.191 = f32[2304]{0} parameter(190), metadata={op_name="state[1][188]"}
  add.4634 = f32[2304]{0} add(Arg_190.191, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4635 = f32[1,1,2304]{2,1,0} reshape(add.4634), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4636 = f32[1,1,2304]{2,1,0} broadcast(reshape.4635), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4637 = f32[1,2304]{1,0} reshape(broadcast.4636), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4638 = f32[1,31,2304]{2,1,0} broadcast(reshape.4637), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.4639 = f32[1,31,2304]{2,1,0} multiply(multiply.4633, broadcast.4638), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_193.194 = f32[4,2304,256]{2,1,0} parameter(193), metadata={op_name="state[1][191]"}
  dot.4680 = f32[1,31,4,256]{3,2,1,0} dot(multiply.4639, Arg_193.194), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.4681 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.4682 = f32[128]{0} divide(broadcast.321, power.4681), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.4683 = f32[31,128]{1,0} dot(constant.319, divide.4682), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.4684 = f32[31,1,128]{2,1,0} reshape(dot.4683), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4685 = f32[31,1,128]{2,1,0} reshape(dot.4683), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4686 = f32[31,2,128]{2,1,0} concatenate(reshape.4684, reshape.4685), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4687 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.4686), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.4688 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.4687), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.4697 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.4688), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.4698 = f32[1,31,256]{2,1,0} reshape(broadcast.4697), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.4699 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.4698), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.4700 = f32[1,31,4,256]{3,2,1,0} multiply(dot.4680, broadcast.4699), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.4691 = f32[1,31,4,128]{3,2,1,0} slice(dot.4680), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.4692 = f32[1,31,4,128]{3,2,1,0} negate(slice.4691), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.4693 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.4692), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.4690 = f32[1,31,4,128]{3,2,1,0} slice(dot.4680), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4694 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.4690), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4695 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.4693, reshape.4694), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4696 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.4695), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.4689 = f32[1,31,1,256]{3,2,1,0} sine(reshape.4687), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.4701 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.4689), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.4702 = f32[1,31,256]{2,1,0} reshape(broadcast.4701), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.4703 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.4702), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.4704 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.4696, broadcast.4703), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.4705 = f32[1,31,4,256]{3,2,1,0} add(multiply.4700, multiply.4704), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.4706 = f32[1,31,4,128]{3,2,1,0} slice(add.4705), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4708 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.4706), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.4707 = f32[1,31,4,128]{3,2,1,0} slice(add.4705), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4709 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.4707), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4710 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.4708, reshape.4709), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4713 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.4710), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_194.195 = f32[4,2304,256]{2,1,0} parameter(194), metadata={op_name="state[1][192]"}
  dot.4712 = f32[1,31,4,256]{3,2,1,0} dot(multiply.4639, Arg_194.195), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.4714 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.4712), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4715 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.4713, reshape.4714), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6680 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.4715), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.4640 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.4641 = f32[31]{0} reshape(broadcast.4640), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.4642 = f32[31,31]{1,0} broadcast(reshape.4641), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.4643 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.4644 = f32[31]{0} reshape(broadcast.4643), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.4645 = f32[31,31]{1,0} broadcast(reshape.4644), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.4646 = pred[31,31]{1,0} compare(broadcast.4642, broadcast.4645), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.4647 = pred[1,31,31]{2,1,0} reshape(compare.4646), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.4756 = s32[1,31,31]{2,1,0} convert(reshape.4647), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.4757 = pred[1,31,31]{2,1,0} compare(convert.4756, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.4762 = pred[1,31]{1,0} reduce(compare.4757, constant.340), dimensions={2}, to_apply=region_123.4758, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.4763 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.4762), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.4711 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.4710), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_192.193 = f32[8,2304,256]{2,1,0} parameter(192), metadata={op_name="state[1][190]"}
  dot.4648 = f32[1,31,8,256]{3,2,1,0} dot(multiply.4639, Arg_192.193), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.4649 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.4650 = f32[128]{0} divide(broadcast.321, power.4649), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.4651 = f32[31,128]{1,0} dot(constant.319, divide.4650), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.4652 = f32[31,1,128]{2,1,0} reshape(dot.4651), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4653 = f32[31,1,128]{2,1,0} reshape(dot.4651), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4654 = f32[31,2,128]{2,1,0} concatenate(reshape.4652, reshape.4653), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4655 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.4654), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.4656 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.4655), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.4665 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.4656), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.4666 = f32[1,31,256]{2,1,0} reshape(broadcast.4665), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.4667 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.4666), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.4668 = f32[1,31,8,256]{3,2,1,0} multiply(dot.4648, broadcast.4667), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.4659 = f32[1,31,8,128]{3,2,1,0} slice(dot.4648), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.4660 = f32[1,31,8,128]{3,2,1,0} negate(slice.4659), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.4661 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.4660), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.4658 = f32[1,31,8,128]{3,2,1,0} slice(dot.4648), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4662 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.4658), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4663 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.4661, reshape.4662), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4664 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.4663), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.4657 = f32[1,31,1,256]{3,2,1,0} sine(reshape.4655), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.4669 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.4657), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.4670 = f32[1,31,256]{2,1,0} reshape(broadcast.4669), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.4671 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.4670), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.4672 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.4664, broadcast.4671), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.4673 = f32[1,31,8,256]{3,2,1,0} add(multiply.4668, multiply.4672), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/rotary_embedding_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.4674 = f32[1,31,8,128]{3,2,1,0} slice(add.4673), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4676 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.4674), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.4675 = f32[1,31,8,128]{3,2,1,0} slice(add.4673), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4677 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.4675), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4678 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.4676, reshape.4677), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4679 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.4678), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.4716 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.4679, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.4717 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.4716), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.4718 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.4711, reshape.4717), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.4719 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.4718), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.4720 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.4719, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.4721 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.4720), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.4722 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.4721, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.4723 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(compare.4646), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.4724 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.4723), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.4725 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.4724), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.4726 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.4725, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.4727 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.4726), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.4728 = f32[1,31,31]{2,1,0} reshape(broadcast.4727), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.4729 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.4728), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.4730 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.4722, broadcast.4729), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.4735 = f32[1,4,2,31]{3,2,1,0} reduce(add.4730, constant.339), dimensions={4}, to_apply=region_121.4731, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.4736 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.4735, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.4737 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.4736), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.4738 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.4737), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.4739 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.4738), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.4740 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.4739), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.4741 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.4730, broadcast.4740), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.4742 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.4741), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.4747 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.4742, constant.342), dimensions={4}, to_apply=region_122.4743, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.4748 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.4747), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.4749 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.4748), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.4750 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.4749), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.4751 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.4750), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.4752 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.4742, broadcast.4751), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/softmax_17/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.4753 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.4712, divide.4752), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.4754 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.4753), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.4755 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.4754), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.4772 = f32[1,31,8,256]{3,2,1,0} call(reshape.4763, broadcast.304, reshape.4755), to_apply=_where_0.4764
  Arg_195.196 = f32[8,256,2304]{2,1,0} parameter(195), metadata={op_name="state[1][193]"}
  dot.4773 = f32[1,31,2304]{2,1,0} dot(call.4772, Arg_195.196), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.4774 = f32[1,31,2304]{2,1,0} multiply(dot.4773, dot.4773), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.4779 = f32[1,31]{1,0} reduce(multiply.4774, constant.342), dimensions={2}, to_apply=region_124.4775, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.4780 = f32[1,31,1]{2,1,0} reshape(reduce.4779), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.4781 = f32[1,31,1]{2,1,0} divide(reshape.4780, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.4782 = f32[1,31,1]{2,1,0} add(divide.4781, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.4783 = f32[1,31,1]{2,1,0} sqrt(add.4782), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.4784 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.4783), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.4785 = f32[1,31,1]{2,1,0} broadcast(divide.4784), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.4786 = f32[1,31]{1,0} reshape(broadcast.4785), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.4787 = f32[1,31,2304]{2,1,0} broadcast(reshape.4786), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.4788 = f32[1,31,2304]{2,1,0} multiply(dot.4773, broadcast.4787), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_191.192 = f32[2304]{0} parameter(191), metadata={op_name="state[1][189]"}
  add.4789 = f32[2304]{0} add(Arg_191.192, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4790 = f32[1,1,2304]{2,1,0} reshape(add.4789), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4791 = f32[1,1,2304]{2,1,0} broadcast(reshape.4790), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4792 = f32[1,2304]{1,0} reshape(broadcast.4791), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4793 = f32[1,31,2304]{2,1,0} broadcast(reshape.4792), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.4794 = f32[1,31,2304]{2,1,0} multiply(multiply.4788, broadcast.4793), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.4795 = f32[1,31,2304]{2,1,0} add(add.4618, multiply.4794), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.4796 = f32[1,31,2304]{2,1,0} multiply(add.4795, add.4795), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.4801 = f32[1,31]{1,0} reduce(multiply.4796, constant.342), dimensions={2}, to_apply=region_125.4797, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.4802 = f32[1,31,1]{2,1,0} reshape(reduce.4801), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.4803 = f32[1,31,1]{2,1,0} divide(reshape.4802, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.4804 = f32[1,31,1]{2,1,0} add(divide.4803, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.4805 = f32[1,31,1]{2,1,0} sqrt(add.4804), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.4806 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.4805), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.4807 = f32[1,31,1]{2,1,0} broadcast(divide.4806), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.4808 = f32[1,31]{1,0} reshape(broadcast.4807), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.4809 = f32[1,31,2304]{2,1,0} broadcast(reshape.4808), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.4810 = f32[1,31,2304]{2,1,0} multiply(add.4795, broadcast.4809), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_196.197 = f32[2304]{0} parameter(196), metadata={op_name="state[1][194]"}
  add.4811 = f32[2304]{0} add(Arg_196.197, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4812 = f32[1,1,2304]{2,1,0} reshape(add.4811), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4813 = f32[1,1,2304]{2,1,0} broadcast(reshape.4812), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4814 = f32[1,2304]{1,0} reshape(broadcast.4813), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4815 = f32[1,31,2304]{2,1,0} broadcast(reshape.4814), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.4816 = f32[1,31,2304]{2,1,0} multiply(multiply.4810, broadcast.4815), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_198.199 = f32[2304,9216]{1,0} parameter(198), metadata={op_name="state[1][196]"}
  dot.4817 = f32[1,31,9216]{2,1,0} dot(multiply.4816, Arg_198.199), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.4819 = f32[1,31,9216]{2,1,0} multiply(dot.4817, dot.4817), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4820 = f32[1,31,9216]{2,1,0} multiply(multiply.4819, dot.4817), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4821 = f32[1,31,9216]{2,1,0} multiply(multiply.4820, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.4822 = f32[1,31,9216]{2,1,0} add(dot.4817, multiply.4821), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4823 = f32[1,31,9216]{2,1,0} multiply(add.4822, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.4824 = f32[1,31,9216]{2,1,0} tanh(multiply.4823), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.4825 = f32[1,31,9216]{2,1,0} add(tanh.4824, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4826 = f32[1,31,9216]{2,1,0} multiply(add.4825, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.4827 = f32[1,31,9216]{2,1,0} multiply(dot.4817, multiply.4826), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_199.200 = f32[2304,9216]{1,0} parameter(199), metadata={op_name="state[1][197]"}
  dot.4818 = f32[1,31,9216]{2,1,0} dot(multiply.4816, Arg_199.200), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.4828 = f32[1,31,9216]{2,1,0} multiply(multiply.4827, dot.4818), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_200.201 = f32[9216,2304]{1,0} parameter(200), metadata={op_name="state[1][198]"}
  dot.4829 = f32[1,31,2304]{2,1,0} dot(multiply.4828, Arg_200.201), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.4830 = f32[1,31,2304]{2,1,0} multiply(dot.4829, dot.4829), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.4835 = f32[1,31]{1,0} reduce(multiply.4830, constant.342), dimensions={2}, to_apply=region_126.4831, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.4836 = f32[1,31,1]{2,1,0} reshape(reduce.4835), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.4837 = f32[1,31,1]{2,1,0} divide(reshape.4836, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.4838 = f32[1,31,1]{2,1,0} add(divide.4837, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.4839 = f32[1,31,1]{2,1,0} sqrt(add.4838), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.4840 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.4839), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.4841 = f32[1,31,1]{2,1,0} broadcast(divide.4840), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.4842 = f32[1,31]{1,0} reshape(broadcast.4841), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.4843 = f32[1,31,2304]{2,1,0} broadcast(reshape.4842), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.4844 = f32[1,31,2304]{2,1,0} multiply(dot.4829, broadcast.4843), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_197.198 = f32[2304]{0} parameter(197), metadata={op_name="state[1][195]"}
  add.4845 = f32[2304]{0} add(Arg_197.198, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4846 = f32[1,1,2304]{2,1,0} reshape(add.4845), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4847 = f32[1,1,2304]{2,1,0} broadcast(reshape.4846), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4848 = f32[1,2304]{1,0} reshape(broadcast.4847), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4849 = f32[1,31,2304]{2,1,0} broadcast(reshape.4848), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.4850 = f32[1,31,2304]{2,1,0} multiply(multiply.4844, broadcast.4849), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.4851 = f32[1,31,2304]{2,1,0} add(multiply.4850, add.4795), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_17/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.4852 = f32[1,31,2304]{2,1,0} multiply(add.4851, add.4851), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.4857 = f32[1,31]{1,0} reduce(multiply.4852, constant.342), dimensions={2}, to_apply=region_127.4853, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.4858 = f32[1,31,1]{2,1,0} reshape(reduce.4857), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.4859 = f32[1,31,1]{2,1,0} divide(reshape.4858, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.4860 = f32[1,31,1]{2,1,0} add(divide.4859, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.4861 = f32[1,31,1]{2,1,0} sqrt(add.4860), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.4862 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.4861), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.4863 = f32[1,31,1]{2,1,0} broadcast(divide.4862), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.4864 = f32[1,31]{1,0} reshape(broadcast.4863), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.4865 = f32[1,31,2304]{2,1,0} broadcast(reshape.4864), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.4866 = f32[1,31,2304]{2,1,0} multiply(add.4851, broadcast.4865), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_201.202 = f32[2304]{0} parameter(201), metadata={op_name="state[1][199]"}
  add.4867 = f32[2304]{0} add(Arg_201.202, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4868 = f32[1,1,2304]{2,1,0} reshape(add.4867), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4869 = f32[1,1,2304]{2,1,0} broadcast(reshape.4868), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.4870 = f32[1,2304]{1,0} reshape(broadcast.4869), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.4871 = f32[1,31,2304]{2,1,0} broadcast(reshape.4870), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.4872 = f32[1,31,2304]{2,1,0} multiply(multiply.4866, broadcast.4871), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_204.205 = f32[4,2304,256]{2,1,0} parameter(204), metadata={op_name="state[1][202]"}
  dot.4913 = f32[1,31,4,256]{3,2,1,0} dot(multiply.4872, Arg_204.205), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.4914 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.4915 = f32[128]{0} divide(broadcast.321, power.4914), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.4916 = f32[31,128]{1,0} dot(constant.319, divide.4915), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.4917 = f32[31,1,128]{2,1,0} reshape(dot.4916), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4918 = f32[31,1,128]{2,1,0} reshape(dot.4916), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4919 = f32[31,2,128]{2,1,0} concatenate(reshape.4917, reshape.4918), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4920 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.4919), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.4921 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.4920), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.4930 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.4921), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.4931 = f32[1,31,256]{2,1,0} reshape(broadcast.4930), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.4932 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.4931), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.4933 = f32[1,31,4,256]{3,2,1,0} multiply(dot.4913, broadcast.4932), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.4924 = f32[1,31,4,128]{3,2,1,0} slice(dot.4913), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.4925 = f32[1,31,4,128]{3,2,1,0} negate(slice.4924), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.4926 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.4925), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.4923 = f32[1,31,4,128]{3,2,1,0} slice(dot.4913), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4927 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.4923), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4928 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.4926, reshape.4927), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4929 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.4928), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.4922 = f32[1,31,1,256]{3,2,1,0} sine(reshape.4920), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.4934 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.4922), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.4935 = f32[1,31,256]{2,1,0} reshape(broadcast.4934), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.4936 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.4935), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.4937 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.4929, broadcast.4936), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.4938 = f32[1,31,4,256]{3,2,1,0} add(multiply.4933, multiply.4937), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.4939 = f32[1,31,4,128]{3,2,1,0} slice(add.4938), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4941 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.4939), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.4940 = f32[1,31,4,128]{3,2,1,0} slice(add.4938), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4942 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.4940), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4943 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.4941, reshape.4942), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4946 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.4943), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_205.206 = f32[4,2304,256]{2,1,0} parameter(205), metadata={op_name="state[1][203]"}
  dot.4945 = f32[1,31,4,256]{3,2,1,0} dot(multiply.4872, Arg_205.206), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.4947 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.4945), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4948 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.4946, reshape.4947), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6681 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.4948), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.4873 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.4874 = f32[31]{0} reshape(broadcast.4873), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.4875 = f32[31,31]{1,0} broadcast(reshape.4874), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.4876 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.4877 = f32[31]{0} reshape(broadcast.4876), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.4878 = f32[31,31]{1,0} broadcast(reshape.4877), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.4879 = pred[31,31]{1,0} compare(broadcast.4875, broadcast.4878), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.4880 = pred[1,31,31]{2,1,0} reshape(compare.4879), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.5020 = s32[1,31,31]{2,1,0} convert(reshape.4880), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.5021 = pred[1,31,31]{2,1,0} compare(convert.5020, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.5026 = pred[1,31]{1,0} reduce(compare.5021, constant.340), dimensions={2}, to_apply=region_130.5022, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.5027 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.5026), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.4944 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.4943), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_203.204 = f32[8,2304,256]{2,1,0} parameter(203), metadata={op_name="state[1][201]"}
  dot.4881 = f32[1,31,8,256]{3,2,1,0} dot(multiply.4872, Arg_203.204), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.4882 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.4883 = f32[128]{0} divide(broadcast.321, power.4882), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.4884 = f32[31,128]{1,0} dot(constant.319, divide.4883), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.4885 = f32[31,1,128]{2,1,0} reshape(dot.4884), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4886 = f32[31,1,128]{2,1,0} reshape(dot.4884), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4887 = f32[31,2,128]{2,1,0} concatenate(reshape.4885, reshape.4886), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4888 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.4887), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.4889 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.4888), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.4898 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.4889), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.4899 = f32[1,31,256]{2,1,0} reshape(broadcast.4898), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.4900 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.4899), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.4901 = f32[1,31,8,256]{3,2,1,0} multiply(dot.4881, broadcast.4900), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.4892 = f32[1,31,8,128]{3,2,1,0} slice(dot.4881), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.4893 = f32[1,31,8,128]{3,2,1,0} negate(slice.4892), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.4894 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.4893), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.4891 = f32[1,31,8,128]{3,2,1,0} slice(dot.4881), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4895 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.4891), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4896 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.4894, reshape.4895), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4897 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.4896), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.4890 = f32[1,31,1,256]{3,2,1,0} sine(reshape.4888), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.4902 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.4890), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.4903 = f32[1,31,256]{2,1,0} reshape(broadcast.4902), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.4904 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.4903), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.4905 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.4897, broadcast.4904), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.4906 = f32[1,31,8,256]{3,2,1,0} add(multiply.4901, multiply.4905), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/rotary_embedding_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.4907 = f32[1,31,8,128]{3,2,1,0} slice(add.4906), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4909 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.4907), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.4908 = f32[1,31,8,128]{3,2,1,0} slice(add.4906), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.4910 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.4908), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.4911 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.4909, reshape.4910), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.4912 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.4911), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.4949 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.4912, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.4950 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.4949), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.4951 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.4944, reshape.4950), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.4952 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.4951), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.4953 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.4952, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.4954 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.4953), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.4955 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.4954, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.4969 = pred[31,31]{1,0} call(broadcast.314), to_apply=triu.4956
  call.4983 = pred[31,31]{1,0} call(broadcast.314), to_apply=tril.4970
  and.4984 = pred[31,31]{1,0} and(call.4969, call.4983), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  reshape.4985 = pred[1,31,31]{2,1,0} reshape(and.4984), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.4986 = pred[1,31,31]{2,1,0} and(reshape.4880, reshape.4985), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.4987 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(and.4986), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.4988 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.4987), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.4989 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.4988), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.4990 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.4989, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.4991 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.4990), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.4992 = f32[1,31,31]{2,1,0} reshape(broadcast.4991), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.4993 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.4992), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.4994 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.4955, broadcast.4993), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.4999 = f32[1,4,2,31]{3,2,1,0} reduce(add.4994, constant.339), dimensions={4}, to_apply=region_128.4995, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.5000 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.4999, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.5001 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.5000), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.5002 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.5001), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.5003 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.5002), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.5004 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.5003), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.5005 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.4994, broadcast.5004), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.5006 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.5005), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.5011 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.5006, constant.342), dimensions={4}, to_apply=region_129.5007, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.5012 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.5011), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.5013 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.5012), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.5014 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.5013), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.5015 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.5014), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.5016 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.5006, broadcast.5015), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/softmax_18/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.5017 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.4945, divide.5016), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.5018 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.5017), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.5019 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.5018), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.5036 = f32[1,31,8,256]{3,2,1,0} call(reshape.5027, broadcast.304, reshape.5019), to_apply=_where_0.5028
  Arg_206.207 = f32[8,256,2304]{2,1,0} parameter(206), metadata={op_name="state[1][204]"}
  dot.5037 = f32[1,31,2304]{2,1,0} dot(call.5036, Arg_206.207), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.5038 = f32[1,31,2304]{2,1,0} multiply(dot.5037, dot.5037), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.5043 = f32[1,31]{1,0} reduce(multiply.5038, constant.342), dimensions={2}, to_apply=region_131.5039, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.5044 = f32[1,31,1]{2,1,0} reshape(reduce.5043), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.5045 = f32[1,31,1]{2,1,0} divide(reshape.5044, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.5046 = f32[1,31,1]{2,1,0} add(divide.5045, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.5047 = f32[1,31,1]{2,1,0} sqrt(add.5046), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.5048 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.5047), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.5049 = f32[1,31,1]{2,1,0} broadcast(divide.5048), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.5050 = f32[1,31]{1,0} reshape(broadcast.5049), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.5051 = f32[1,31,2304]{2,1,0} broadcast(reshape.5050), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.5052 = f32[1,31,2304]{2,1,0} multiply(dot.5037, broadcast.5051), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_202.203 = f32[2304]{0} parameter(202), metadata={op_name="state[1][200]"}
  add.5053 = f32[2304]{0} add(Arg_202.203, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5054 = f32[1,1,2304]{2,1,0} reshape(add.5053), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5055 = f32[1,1,2304]{2,1,0} broadcast(reshape.5054), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5056 = f32[1,2304]{1,0} reshape(broadcast.5055), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5057 = f32[1,31,2304]{2,1,0} broadcast(reshape.5056), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.5058 = f32[1,31,2304]{2,1,0} multiply(multiply.5052, broadcast.5057), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.5059 = f32[1,31,2304]{2,1,0} add(add.4851, multiply.5058), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.5060 = f32[1,31,2304]{2,1,0} multiply(add.5059, add.5059), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.5065 = f32[1,31]{1,0} reduce(multiply.5060, constant.342), dimensions={2}, to_apply=region_132.5061, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.5066 = f32[1,31,1]{2,1,0} reshape(reduce.5065), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.5067 = f32[1,31,1]{2,1,0} divide(reshape.5066, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.5068 = f32[1,31,1]{2,1,0} add(divide.5067, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.5069 = f32[1,31,1]{2,1,0} sqrt(add.5068), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.5070 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.5069), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.5071 = f32[1,31,1]{2,1,0} broadcast(divide.5070), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.5072 = f32[1,31]{1,0} reshape(broadcast.5071), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.5073 = f32[1,31,2304]{2,1,0} broadcast(reshape.5072), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.5074 = f32[1,31,2304]{2,1,0} multiply(add.5059, broadcast.5073), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_207.208 = f32[2304]{0} parameter(207), metadata={op_name="state[1][205]"}
  add.5075 = f32[2304]{0} add(Arg_207.208, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5076 = f32[1,1,2304]{2,1,0} reshape(add.5075), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5077 = f32[1,1,2304]{2,1,0} broadcast(reshape.5076), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5078 = f32[1,2304]{1,0} reshape(broadcast.5077), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5079 = f32[1,31,2304]{2,1,0} broadcast(reshape.5078), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.5080 = f32[1,31,2304]{2,1,0} multiply(multiply.5074, broadcast.5079), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_209.210 = f32[2304,9216]{1,0} parameter(209), metadata={op_name="state[1][207]"}
  dot.5081 = f32[1,31,9216]{2,1,0} dot(multiply.5080, Arg_209.210), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.5083 = f32[1,31,9216]{2,1,0} multiply(dot.5081, dot.5081), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5084 = f32[1,31,9216]{2,1,0} multiply(multiply.5083, dot.5081), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5085 = f32[1,31,9216]{2,1,0} multiply(multiply.5084, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.5086 = f32[1,31,9216]{2,1,0} add(dot.5081, multiply.5085), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5087 = f32[1,31,9216]{2,1,0} multiply(add.5086, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.5088 = f32[1,31,9216]{2,1,0} tanh(multiply.5087), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.5089 = f32[1,31,9216]{2,1,0} add(tanh.5088, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5090 = f32[1,31,9216]{2,1,0} multiply(add.5089, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5091 = f32[1,31,9216]{2,1,0} multiply(dot.5081, multiply.5090), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_210.211 = f32[2304,9216]{1,0} parameter(210), metadata={op_name="state[1][208]"}
  dot.5082 = f32[1,31,9216]{2,1,0} dot(multiply.5080, Arg_210.211), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.5092 = f32[1,31,9216]{2,1,0} multiply(multiply.5091, dot.5082), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_211.212 = f32[9216,2304]{1,0} parameter(211), metadata={op_name="state[1][209]"}
  dot.5093 = f32[1,31,2304]{2,1,0} dot(multiply.5092, Arg_211.212), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.5094 = f32[1,31,2304]{2,1,0} multiply(dot.5093, dot.5093), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.5099 = f32[1,31]{1,0} reduce(multiply.5094, constant.342), dimensions={2}, to_apply=region_133.5095, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.5100 = f32[1,31,1]{2,1,0} reshape(reduce.5099), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.5101 = f32[1,31,1]{2,1,0} divide(reshape.5100, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.5102 = f32[1,31,1]{2,1,0} add(divide.5101, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.5103 = f32[1,31,1]{2,1,0} sqrt(add.5102), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.5104 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.5103), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.5105 = f32[1,31,1]{2,1,0} broadcast(divide.5104), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.5106 = f32[1,31]{1,0} reshape(broadcast.5105), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.5107 = f32[1,31,2304]{2,1,0} broadcast(reshape.5106), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.5108 = f32[1,31,2304]{2,1,0} multiply(dot.5093, broadcast.5107), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_208.209 = f32[2304]{0} parameter(208), metadata={op_name="state[1][206]"}
  add.5109 = f32[2304]{0} add(Arg_208.209, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5110 = f32[1,1,2304]{2,1,0} reshape(add.5109), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5111 = f32[1,1,2304]{2,1,0} broadcast(reshape.5110), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5112 = f32[1,2304]{1,0} reshape(broadcast.5111), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5113 = f32[1,31,2304]{2,1,0} broadcast(reshape.5112), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.5114 = f32[1,31,2304]{2,1,0} multiply(multiply.5108, broadcast.5113), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.5115 = f32[1,31,2304]{2,1,0} add(multiply.5114, add.5059), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_18/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.5116 = f32[1,31,2304]{2,1,0} multiply(add.5115, add.5115), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.5121 = f32[1,31]{1,0} reduce(multiply.5116, constant.342), dimensions={2}, to_apply=region_134.5117, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.5122 = f32[1,31,1]{2,1,0} reshape(reduce.5121), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.5123 = f32[1,31,1]{2,1,0} divide(reshape.5122, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.5124 = f32[1,31,1]{2,1,0} add(divide.5123, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.5125 = f32[1,31,1]{2,1,0} sqrt(add.5124), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.5126 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.5125), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.5127 = f32[1,31,1]{2,1,0} broadcast(divide.5126), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.5128 = f32[1,31]{1,0} reshape(broadcast.5127), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.5129 = f32[1,31,2304]{2,1,0} broadcast(reshape.5128), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.5130 = f32[1,31,2304]{2,1,0} multiply(add.5115, broadcast.5129), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_212.213 = f32[2304]{0} parameter(212), metadata={op_name="state[1][210]"}
  add.5131 = f32[2304]{0} add(Arg_212.213, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5132 = f32[1,1,2304]{2,1,0} reshape(add.5131), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5133 = f32[1,1,2304]{2,1,0} broadcast(reshape.5132), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5134 = f32[1,2304]{1,0} reshape(broadcast.5133), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5135 = f32[1,31,2304]{2,1,0} broadcast(reshape.5134), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.5136 = f32[1,31,2304]{2,1,0} multiply(multiply.5130, broadcast.5135), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_215.216 = f32[4,2304,256]{2,1,0} parameter(215), metadata={op_name="state[1][213]"}
  dot.5177 = f32[1,31,4,256]{3,2,1,0} dot(multiply.5136, Arg_215.216), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.5178 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.5179 = f32[128]{0} divide(broadcast.321, power.5178), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.5180 = f32[31,128]{1,0} dot(constant.319, divide.5179), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.5181 = f32[31,1,128]{2,1,0} reshape(dot.5180), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5182 = f32[31,1,128]{2,1,0} reshape(dot.5180), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5183 = f32[31,2,128]{2,1,0} concatenate(reshape.5181, reshape.5182), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5184 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.5183), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.5185 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.5184), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.5194 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.5185), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.5195 = f32[1,31,256]{2,1,0} reshape(broadcast.5194), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.5196 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.5195), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.5197 = f32[1,31,4,256]{3,2,1,0} multiply(dot.5177, broadcast.5196), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.5188 = f32[1,31,4,128]{3,2,1,0} slice(dot.5177), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.5189 = f32[1,31,4,128]{3,2,1,0} negate(slice.5188), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.5190 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.5189), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.5187 = f32[1,31,4,128]{3,2,1,0} slice(dot.5177), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5191 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.5187), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5192 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.5190, reshape.5191), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5193 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.5192), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.5186 = f32[1,31,1,256]{3,2,1,0} sine(reshape.5184), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.5198 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.5186), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.5199 = f32[1,31,256]{2,1,0} reshape(broadcast.5198), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.5200 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.5199), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.5201 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.5193, broadcast.5200), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.5202 = f32[1,31,4,256]{3,2,1,0} add(multiply.5197, multiply.5201), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.5203 = f32[1,31,4,128]{3,2,1,0} slice(add.5202), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5205 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.5203), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.5204 = f32[1,31,4,128]{3,2,1,0} slice(add.5202), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5206 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.5204), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5207 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.5205, reshape.5206), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5210 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.5207), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_216.217 = f32[4,2304,256]{2,1,0} parameter(216), metadata={op_name="state[1][214]"}
  dot.5209 = f32[1,31,4,256]{3,2,1,0} dot(multiply.5136, Arg_216.217), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.5211 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.5209), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5212 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.5210, reshape.5211), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6682 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.5212), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.5137 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.5138 = f32[31]{0} reshape(broadcast.5137), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.5139 = f32[31,31]{1,0} broadcast(reshape.5138), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.5140 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.5141 = f32[31]{0} reshape(broadcast.5140), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.5142 = f32[31,31]{1,0} broadcast(reshape.5141), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.5143 = pred[31,31]{1,0} compare(broadcast.5139, broadcast.5142), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.5144 = pred[1,31,31]{2,1,0} reshape(compare.5143), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.5253 = s32[1,31,31]{2,1,0} convert(reshape.5144), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.5254 = pred[1,31,31]{2,1,0} compare(convert.5253, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.5259 = pred[1,31]{1,0} reduce(compare.5254, constant.340), dimensions={2}, to_apply=region_137.5255, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.5260 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.5259), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.5208 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.5207), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_214.215 = f32[8,2304,256]{2,1,0} parameter(214), metadata={op_name="state[1][212]"}
  dot.5145 = f32[1,31,8,256]{3,2,1,0} dot(multiply.5136, Arg_214.215), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.5146 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.5147 = f32[128]{0} divide(broadcast.321, power.5146), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.5148 = f32[31,128]{1,0} dot(constant.319, divide.5147), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.5149 = f32[31,1,128]{2,1,0} reshape(dot.5148), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5150 = f32[31,1,128]{2,1,0} reshape(dot.5148), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5151 = f32[31,2,128]{2,1,0} concatenate(reshape.5149, reshape.5150), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5152 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.5151), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.5153 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.5152), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.5162 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.5153), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.5163 = f32[1,31,256]{2,1,0} reshape(broadcast.5162), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.5164 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.5163), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.5165 = f32[1,31,8,256]{3,2,1,0} multiply(dot.5145, broadcast.5164), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.5156 = f32[1,31,8,128]{3,2,1,0} slice(dot.5145), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.5157 = f32[1,31,8,128]{3,2,1,0} negate(slice.5156), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.5158 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.5157), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.5155 = f32[1,31,8,128]{3,2,1,0} slice(dot.5145), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5159 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.5155), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5160 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.5158, reshape.5159), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5161 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.5160), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.5154 = f32[1,31,1,256]{3,2,1,0} sine(reshape.5152), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.5166 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.5154), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.5167 = f32[1,31,256]{2,1,0} reshape(broadcast.5166), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.5168 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.5167), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.5169 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.5161, broadcast.5168), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.5170 = f32[1,31,8,256]{3,2,1,0} add(multiply.5165, multiply.5169), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/rotary_embedding_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.5171 = f32[1,31,8,128]{3,2,1,0} slice(add.5170), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5173 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.5171), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.5172 = f32[1,31,8,128]{3,2,1,0} slice(add.5170), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5174 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.5172), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5175 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.5173, reshape.5174), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5176 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.5175), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.5213 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.5176, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.5214 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.5213), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.5215 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.5208, reshape.5214), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.5216 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.5215), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.5217 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.5216, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.5218 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.5217), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.5219 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.5218, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.5220 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(compare.5143), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.5221 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.5220), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.5222 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.5221), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.5223 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.5222, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.5224 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.5223), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.5225 = f32[1,31,31]{2,1,0} reshape(broadcast.5224), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.5226 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.5225), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.5227 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.5219, broadcast.5226), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.5232 = f32[1,4,2,31]{3,2,1,0} reduce(add.5227, constant.339), dimensions={4}, to_apply=region_135.5228, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.5233 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.5232, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.5234 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.5233), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.5235 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.5234), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.5236 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.5235), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.5237 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.5236), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.5238 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.5227, broadcast.5237), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.5239 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.5238), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.5244 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.5239, constant.342), dimensions={4}, to_apply=region_136.5240, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.5245 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.5244), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.5246 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.5245), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.5247 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.5246), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.5248 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.5247), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.5249 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.5239, broadcast.5248), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/softmax_19/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.5250 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.5209, divide.5249), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.5251 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.5250), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.5252 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.5251), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.5269 = f32[1,31,8,256]{3,2,1,0} call(reshape.5260, broadcast.304, reshape.5252), to_apply=_where_0.5261
  Arg_217.218 = f32[8,256,2304]{2,1,0} parameter(217), metadata={op_name="state[1][215]"}
  dot.5270 = f32[1,31,2304]{2,1,0} dot(call.5269, Arg_217.218), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.5271 = f32[1,31,2304]{2,1,0} multiply(dot.5270, dot.5270), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.5276 = f32[1,31]{1,0} reduce(multiply.5271, constant.342), dimensions={2}, to_apply=region_138.5272, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.5277 = f32[1,31,1]{2,1,0} reshape(reduce.5276), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.5278 = f32[1,31,1]{2,1,0} divide(reshape.5277, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.5279 = f32[1,31,1]{2,1,0} add(divide.5278, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.5280 = f32[1,31,1]{2,1,0} sqrt(add.5279), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.5281 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.5280), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.5282 = f32[1,31,1]{2,1,0} broadcast(divide.5281), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.5283 = f32[1,31]{1,0} reshape(broadcast.5282), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.5284 = f32[1,31,2304]{2,1,0} broadcast(reshape.5283), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.5285 = f32[1,31,2304]{2,1,0} multiply(dot.5270, broadcast.5284), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_213.214 = f32[2304]{0} parameter(213), metadata={op_name="state[1][211]"}
  add.5286 = f32[2304]{0} add(Arg_213.214, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5287 = f32[1,1,2304]{2,1,0} reshape(add.5286), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5288 = f32[1,1,2304]{2,1,0} broadcast(reshape.5287), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5289 = f32[1,2304]{1,0} reshape(broadcast.5288), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5290 = f32[1,31,2304]{2,1,0} broadcast(reshape.5289), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.5291 = f32[1,31,2304]{2,1,0} multiply(multiply.5285, broadcast.5290), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.5292 = f32[1,31,2304]{2,1,0} add(add.5115, multiply.5291), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.5293 = f32[1,31,2304]{2,1,0} multiply(add.5292, add.5292), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.5298 = f32[1,31]{1,0} reduce(multiply.5293, constant.342), dimensions={2}, to_apply=region_139.5294, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.5299 = f32[1,31,1]{2,1,0} reshape(reduce.5298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.5300 = f32[1,31,1]{2,1,0} divide(reshape.5299, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.5301 = f32[1,31,1]{2,1,0} add(divide.5300, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.5302 = f32[1,31,1]{2,1,0} sqrt(add.5301), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.5303 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.5302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.5304 = f32[1,31,1]{2,1,0} broadcast(divide.5303), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.5305 = f32[1,31]{1,0} reshape(broadcast.5304), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.5306 = f32[1,31,2304]{2,1,0} broadcast(reshape.5305), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.5307 = f32[1,31,2304]{2,1,0} multiply(add.5292, broadcast.5306), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_218.219 = f32[2304]{0} parameter(218), metadata={op_name="state[1][216]"}
  add.5308 = f32[2304]{0} add(Arg_218.219, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5309 = f32[1,1,2304]{2,1,0} reshape(add.5308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5310 = f32[1,1,2304]{2,1,0} broadcast(reshape.5309), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5311 = f32[1,2304]{1,0} reshape(broadcast.5310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5312 = f32[1,31,2304]{2,1,0} broadcast(reshape.5311), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.5313 = f32[1,31,2304]{2,1,0} multiply(multiply.5307, broadcast.5312), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_220.221 = f32[2304,9216]{1,0} parameter(220), metadata={op_name="state[1][218]"}
  dot.5314 = f32[1,31,9216]{2,1,0} dot(multiply.5313, Arg_220.221), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.5316 = f32[1,31,9216]{2,1,0} multiply(dot.5314, dot.5314), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5317 = f32[1,31,9216]{2,1,0} multiply(multiply.5316, dot.5314), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5318 = f32[1,31,9216]{2,1,0} multiply(multiply.5317, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.5319 = f32[1,31,9216]{2,1,0} add(dot.5314, multiply.5318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5320 = f32[1,31,9216]{2,1,0} multiply(add.5319, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.5321 = f32[1,31,9216]{2,1,0} tanh(multiply.5320), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.5322 = f32[1,31,9216]{2,1,0} add(tanh.5321, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5323 = f32[1,31,9216]{2,1,0} multiply(add.5322, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5324 = f32[1,31,9216]{2,1,0} multiply(dot.5314, multiply.5323), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_221.222 = f32[2304,9216]{1,0} parameter(221), metadata={op_name="state[1][219]"}
  dot.5315 = f32[1,31,9216]{2,1,0} dot(multiply.5313, Arg_221.222), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.5325 = f32[1,31,9216]{2,1,0} multiply(multiply.5324, dot.5315), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_222.223 = f32[9216,2304]{1,0} parameter(222), metadata={op_name="state[1][220]"}
  dot.5326 = f32[1,31,2304]{2,1,0} dot(multiply.5325, Arg_222.223), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.5327 = f32[1,31,2304]{2,1,0} multiply(dot.5326, dot.5326), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.5332 = f32[1,31]{1,0} reduce(multiply.5327, constant.342), dimensions={2}, to_apply=region_140.5328, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.5333 = f32[1,31,1]{2,1,0} reshape(reduce.5332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.5334 = f32[1,31,1]{2,1,0} divide(reshape.5333, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.5335 = f32[1,31,1]{2,1,0} add(divide.5334, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.5336 = f32[1,31,1]{2,1,0} sqrt(add.5335), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.5337 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.5336), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.5338 = f32[1,31,1]{2,1,0} broadcast(divide.5337), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.5339 = f32[1,31]{1,0} reshape(broadcast.5338), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.5340 = f32[1,31,2304]{2,1,0} broadcast(reshape.5339), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.5341 = f32[1,31,2304]{2,1,0} multiply(dot.5326, broadcast.5340), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_219.220 = f32[2304]{0} parameter(219), metadata={op_name="state[1][217]"}
  add.5342 = f32[2304]{0} add(Arg_219.220, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5343 = f32[1,1,2304]{2,1,0} reshape(add.5342), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5344 = f32[1,1,2304]{2,1,0} broadcast(reshape.5343), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5345 = f32[1,2304]{1,0} reshape(broadcast.5344), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5346 = f32[1,31,2304]{2,1,0} broadcast(reshape.5345), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.5347 = f32[1,31,2304]{2,1,0} multiply(multiply.5341, broadcast.5346), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.5348 = f32[1,31,2304]{2,1,0} add(multiply.5347, add.5292), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_19/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.5349 = f32[1,31,2304]{2,1,0} multiply(add.5348, add.5348), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.5354 = f32[1,31]{1,0} reduce(multiply.5349, constant.342), dimensions={2}, to_apply=region_141.5350, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.5355 = f32[1,31,1]{2,1,0} reshape(reduce.5354), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.5356 = f32[1,31,1]{2,1,0} divide(reshape.5355, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.5357 = f32[1,31,1]{2,1,0} add(divide.5356, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.5358 = f32[1,31,1]{2,1,0} sqrt(add.5357), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.5359 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.5358), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.5360 = f32[1,31,1]{2,1,0} broadcast(divide.5359), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.5361 = f32[1,31]{1,0} reshape(broadcast.5360), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.5362 = f32[1,31,2304]{2,1,0} broadcast(reshape.5361), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.5363 = f32[1,31,2304]{2,1,0} multiply(add.5348, broadcast.5362), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_223.224 = f32[2304]{0} parameter(223), metadata={op_name="state[1][221]"}
  add.5364 = f32[2304]{0} add(Arg_223.224, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5365 = f32[1,1,2304]{2,1,0} reshape(add.5364), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5366 = f32[1,1,2304]{2,1,0} broadcast(reshape.5365), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5367 = f32[1,2304]{1,0} reshape(broadcast.5366), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5368 = f32[1,31,2304]{2,1,0} broadcast(reshape.5367), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.5369 = f32[1,31,2304]{2,1,0} multiply(multiply.5363, broadcast.5368), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_226.227 = f32[4,2304,256]{2,1,0} parameter(226), metadata={op_name="state[1][224]"}
  dot.5410 = f32[1,31,4,256]{3,2,1,0} dot(multiply.5369, Arg_226.227), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.5411 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.5412 = f32[128]{0} divide(broadcast.321, power.5411), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.5413 = f32[31,128]{1,0} dot(constant.319, divide.5412), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.5414 = f32[31,1,128]{2,1,0} reshape(dot.5413), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5415 = f32[31,1,128]{2,1,0} reshape(dot.5413), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5416 = f32[31,2,128]{2,1,0} concatenate(reshape.5414, reshape.5415), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5417 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.5416), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.5418 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.5417), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.5427 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.5418), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.5428 = f32[1,31,256]{2,1,0} reshape(broadcast.5427), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.5429 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.5428), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.5430 = f32[1,31,4,256]{3,2,1,0} multiply(dot.5410, broadcast.5429), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.5421 = f32[1,31,4,128]{3,2,1,0} slice(dot.5410), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.5422 = f32[1,31,4,128]{3,2,1,0} negate(slice.5421), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.5423 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.5422), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.5420 = f32[1,31,4,128]{3,2,1,0} slice(dot.5410), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5424 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.5420), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5425 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.5423, reshape.5424), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5426 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.5425), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.5419 = f32[1,31,1,256]{3,2,1,0} sine(reshape.5417), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.5431 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.5419), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.5432 = f32[1,31,256]{2,1,0} reshape(broadcast.5431), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.5433 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.5432), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.5434 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.5426, broadcast.5433), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.5435 = f32[1,31,4,256]{3,2,1,0} add(multiply.5430, multiply.5434), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.5436 = f32[1,31,4,128]{3,2,1,0} slice(add.5435), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5438 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.5436), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.5437 = f32[1,31,4,128]{3,2,1,0} slice(add.5435), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5439 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.5437), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5440 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.5438, reshape.5439), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5443 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.5440), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_227.228 = f32[4,2304,256]{2,1,0} parameter(227), metadata={op_name="state[1][225]"}
  dot.5442 = f32[1,31,4,256]{3,2,1,0} dot(multiply.5369, Arg_227.228), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.5444 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.5442), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5445 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.5443, reshape.5444), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6683 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.5445), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.5370 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.5371 = f32[31]{0} reshape(broadcast.5370), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.5372 = f32[31,31]{1,0} broadcast(reshape.5371), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.5373 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.5374 = f32[31]{0} reshape(broadcast.5373), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.5375 = f32[31,31]{1,0} broadcast(reshape.5374), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.5376 = pred[31,31]{1,0} compare(broadcast.5372, broadcast.5375), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.5377 = pred[1,31,31]{2,1,0} reshape(compare.5376), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.5517 = s32[1,31,31]{2,1,0} convert(reshape.5377), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.5518 = pred[1,31,31]{2,1,0} compare(convert.5517, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.5523 = pred[1,31]{1,0} reduce(compare.5518, constant.340), dimensions={2}, to_apply=region_144.5519, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.5524 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.5523), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.5441 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.5440), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_225.226 = f32[8,2304,256]{2,1,0} parameter(225), metadata={op_name="state[1][223]"}
  dot.5378 = f32[1,31,8,256]{3,2,1,0} dot(multiply.5369, Arg_225.226), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.5379 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.5380 = f32[128]{0} divide(broadcast.321, power.5379), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.5381 = f32[31,128]{1,0} dot(constant.319, divide.5380), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.5382 = f32[31,1,128]{2,1,0} reshape(dot.5381), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5383 = f32[31,1,128]{2,1,0} reshape(dot.5381), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5384 = f32[31,2,128]{2,1,0} concatenate(reshape.5382, reshape.5383), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5385 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.5384), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.5386 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.5385), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.5395 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.5386), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.5396 = f32[1,31,256]{2,1,0} reshape(broadcast.5395), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.5397 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.5396), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.5398 = f32[1,31,8,256]{3,2,1,0} multiply(dot.5378, broadcast.5397), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.5389 = f32[1,31,8,128]{3,2,1,0} slice(dot.5378), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.5390 = f32[1,31,8,128]{3,2,1,0} negate(slice.5389), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.5391 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.5390), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.5388 = f32[1,31,8,128]{3,2,1,0} slice(dot.5378), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5392 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.5388), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5393 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.5391, reshape.5392), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5394 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.5393), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.5387 = f32[1,31,1,256]{3,2,1,0} sine(reshape.5385), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.5399 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.5387), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.5400 = f32[1,31,256]{2,1,0} reshape(broadcast.5399), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.5401 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.5400), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.5402 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.5394, broadcast.5401), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.5403 = f32[1,31,8,256]{3,2,1,0} add(multiply.5398, multiply.5402), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/rotary_embedding_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.5404 = f32[1,31,8,128]{3,2,1,0} slice(add.5403), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5406 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.5404), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.5405 = f32[1,31,8,128]{3,2,1,0} slice(add.5403), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5407 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.5405), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5408 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.5406, reshape.5407), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5409 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.5408), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.5446 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.5409, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.5447 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.5446), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.5448 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.5441, reshape.5447), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.5449 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.5448), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.5450 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.5449, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.5451 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.5450), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.5452 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.5451, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.5466 = pred[31,31]{1,0} call(broadcast.314), to_apply=triu.5453
  call.5480 = pred[31,31]{1,0} call(broadcast.314), to_apply=tril.5467
  and.5481 = pred[31,31]{1,0} and(call.5466, call.5480), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  reshape.5482 = pred[1,31,31]{2,1,0} reshape(and.5481), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.5483 = pred[1,31,31]{2,1,0} and(reshape.5377, reshape.5482), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.5484 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(and.5483), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.5485 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.5484), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.5486 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.5485), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.5487 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.5486, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.5488 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.5487), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.5489 = f32[1,31,31]{2,1,0} reshape(broadcast.5488), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.5490 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.5489), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.5491 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.5452, broadcast.5490), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.5496 = f32[1,4,2,31]{3,2,1,0} reduce(add.5491, constant.339), dimensions={4}, to_apply=region_142.5492, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.5497 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.5496, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.5498 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.5497), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.5499 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.5498), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.5500 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.5499), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.5501 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.5500), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.5502 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.5491, broadcast.5501), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.5503 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.5502), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.5508 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.5503, constant.342), dimensions={4}, to_apply=region_143.5504, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.5509 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.5508), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.5510 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.5509), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.5511 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.5510), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.5512 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.5511), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.5513 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.5503, broadcast.5512), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/softmax_20/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.5514 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.5442, divide.5513), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.5515 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.5514), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.5516 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.5515), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.5533 = f32[1,31,8,256]{3,2,1,0} call(reshape.5524, broadcast.304, reshape.5516), to_apply=_where_0.5525
  Arg_228.229 = f32[8,256,2304]{2,1,0} parameter(228), metadata={op_name="state[1][226]"}
  dot.5534 = f32[1,31,2304]{2,1,0} dot(call.5533, Arg_228.229), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.5535 = f32[1,31,2304]{2,1,0} multiply(dot.5534, dot.5534), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.5540 = f32[1,31]{1,0} reduce(multiply.5535, constant.342), dimensions={2}, to_apply=region_145.5536, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.5541 = f32[1,31,1]{2,1,0} reshape(reduce.5540), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.5542 = f32[1,31,1]{2,1,0} divide(reshape.5541, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.5543 = f32[1,31,1]{2,1,0} add(divide.5542, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.5544 = f32[1,31,1]{2,1,0} sqrt(add.5543), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.5545 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.5544), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.5546 = f32[1,31,1]{2,1,0} broadcast(divide.5545), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.5547 = f32[1,31]{1,0} reshape(broadcast.5546), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.5548 = f32[1,31,2304]{2,1,0} broadcast(reshape.5547), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.5549 = f32[1,31,2304]{2,1,0} multiply(dot.5534, broadcast.5548), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_224.225 = f32[2304]{0} parameter(224), metadata={op_name="state[1][222]"}
  add.5550 = f32[2304]{0} add(Arg_224.225, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5551 = f32[1,1,2304]{2,1,0} reshape(add.5550), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5552 = f32[1,1,2304]{2,1,0} broadcast(reshape.5551), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5553 = f32[1,2304]{1,0} reshape(broadcast.5552), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5554 = f32[1,31,2304]{2,1,0} broadcast(reshape.5553), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.5555 = f32[1,31,2304]{2,1,0} multiply(multiply.5549, broadcast.5554), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.5556 = f32[1,31,2304]{2,1,0} add(add.5348, multiply.5555), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.5557 = f32[1,31,2304]{2,1,0} multiply(add.5556, add.5556), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.5562 = f32[1,31]{1,0} reduce(multiply.5557, constant.342), dimensions={2}, to_apply=region_146.5558, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.5563 = f32[1,31,1]{2,1,0} reshape(reduce.5562), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.5564 = f32[1,31,1]{2,1,0} divide(reshape.5563, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.5565 = f32[1,31,1]{2,1,0} add(divide.5564, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.5566 = f32[1,31,1]{2,1,0} sqrt(add.5565), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.5567 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.5566), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.5568 = f32[1,31,1]{2,1,0} broadcast(divide.5567), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.5569 = f32[1,31]{1,0} reshape(broadcast.5568), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.5570 = f32[1,31,2304]{2,1,0} broadcast(reshape.5569), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.5571 = f32[1,31,2304]{2,1,0} multiply(add.5556, broadcast.5570), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_229.230 = f32[2304]{0} parameter(229), metadata={op_name="state[1][227]"}
  add.5572 = f32[2304]{0} add(Arg_229.230, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5573 = f32[1,1,2304]{2,1,0} reshape(add.5572), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5574 = f32[1,1,2304]{2,1,0} broadcast(reshape.5573), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5575 = f32[1,2304]{1,0} reshape(broadcast.5574), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5576 = f32[1,31,2304]{2,1,0} broadcast(reshape.5575), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.5577 = f32[1,31,2304]{2,1,0} multiply(multiply.5571, broadcast.5576), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_231.232 = f32[2304,9216]{1,0} parameter(231), metadata={op_name="state[1][229]"}
  dot.5578 = f32[1,31,9216]{2,1,0} dot(multiply.5577, Arg_231.232), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.5580 = f32[1,31,9216]{2,1,0} multiply(dot.5578, dot.5578), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5581 = f32[1,31,9216]{2,1,0} multiply(multiply.5580, dot.5578), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5582 = f32[1,31,9216]{2,1,0} multiply(multiply.5581, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.5583 = f32[1,31,9216]{2,1,0} add(dot.5578, multiply.5582), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5584 = f32[1,31,9216]{2,1,0} multiply(add.5583, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.5585 = f32[1,31,9216]{2,1,0} tanh(multiply.5584), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.5586 = f32[1,31,9216]{2,1,0} add(tanh.5585, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5587 = f32[1,31,9216]{2,1,0} multiply(add.5586, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5588 = f32[1,31,9216]{2,1,0} multiply(dot.5578, multiply.5587), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_232.233 = f32[2304,9216]{1,0} parameter(232), metadata={op_name="state[1][230]"}
  dot.5579 = f32[1,31,9216]{2,1,0} dot(multiply.5577, Arg_232.233), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.5589 = f32[1,31,9216]{2,1,0} multiply(multiply.5588, dot.5579), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_233.234 = f32[9216,2304]{1,0} parameter(233), metadata={op_name="state[1][231]"}
  dot.5590 = f32[1,31,2304]{2,1,0} dot(multiply.5589, Arg_233.234), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.5591 = f32[1,31,2304]{2,1,0} multiply(dot.5590, dot.5590), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.5596 = f32[1,31]{1,0} reduce(multiply.5591, constant.342), dimensions={2}, to_apply=region_147.5592, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.5597 = f32[1,31,1]{2,1,0} reshape(reduce.5596), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.5598 = f32[1,31,1]{2,1,0} divide(reshape.5597, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.5599 = f32[1,31,1]{2,1,0} add(divide.5598, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.5600 = f32[1,31,1]{2,1,0} sqrt(add.5599), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.5601 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.5600), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.5602 = f32[1,31,1]{2,1,0} broadcast(divide.5601), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.5603 = f32[1,31]{1,0} reshape(broadcast.5602), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.5604 = f32[1,31,2304]{2,1,0} broadcast(reshape.5603), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.5605 = f32[1,31,2304]{2,1,0} multiply(dot.5590, broadcast.5604), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_230.231 = f32[2304]{0} parameter(230), metadata={op_name="state[1][228]"}
  add.5606 = f32[2304]{0} add(Arg_230.231, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5607 = f32[1,1,2304]{2,1,0} reshape(add.5606), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5608 = f32[1,1,2304]{2,1,0} broadcast(reshape.5607), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5609 = f32[1,2304]{1,0} reshape(broadcast.5608), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5610 = f32[1,31,2304]{2,1,0} broadcast(reshape.5609), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.5611 = f32[1,31,2304]{2,1,0} multiply(multiply.5605, broadcast.5610), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.5612 = f32[1,31,2304]{2,1,0} add(multiply.5611, add.5556), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_20/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.5613 = f32[1,31,2304]{2,1,0} multiply(add.5612, add.5612), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.5618 = f32[1,31]{1,0} reduce(multiply.5613, constant.342), dimensions={2}, to_apply=region_148.5614, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.5619 = f32[1,31,1]{2,1,0} reshape(reduce.5618), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.5620 = f32[1,31,1]{2,1,0} divide(reshape.5619, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.5621 = f32[1,31,1]{2,1,0} add(divide.5620, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.5622 = f32[1,31,1]{2,1,0} sqrt(add.5621), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.5623 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.5622), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.5624 = f32[1,31,1]{2,1,0} broadcast(divide.5623), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.5625 = f32[1,31]{1,0} reshape(broadcast.5624), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.5626 = f32[1,31,2304]{2,1,0} broadcast(reshape.5625), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.5627 = f32[1,31,2304]{2,1,0} multiply(add.5612, broadcast.5626), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_234.235 = f32[2304]{0} parameter(234), metadata={op_name="state[1][232]"}
  add.5628 = f32[2304]{0} add(Arg_234.235, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5629 = f32[1,1,2304]{2,1,0} reshape(add.5628), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5630 = f32[1,1,2304]{2,1,0} broadcast(reshape.5629), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5631 = f32[1,2304]{1,0} reshape(broadcast.5630), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5632 = f32[1,31,2304]{2,1,0} broadcast(reshape.5631), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.5633 = f32[1,31,2304]{2,1,0} multiply(multiply.5627, broadcast.5632), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_237.238 = f32[4,2304,256]{2,1,0} parameter(237), metadata={op_name="state[1][235]"}
  dot.5674 = f32[1,31,4,256]{3,2,1,0} dot(multiply.5633, Arg_237.238), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.5675 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.5676 = f32[128]{0} divide(broadcast.321, power.5675), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.5677 = f32[31,128]{1,0} dot(constant.319, divide.5676), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.5678 = f32[31,1,128]{2,1,0} reshape(dot.5677), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5679 = f32[31,1,128]{2,1,0} reshape(dot.5677), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5680 = f32[31,2,128]{2,1,0} concatenate(reshape.5678, reshape.5679), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5681 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.5680), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.5682 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.5681), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.5691 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.5682), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.5692 = f32[1,31,256]{2,1,0} reshape(broadcast.5691), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.5693 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.5692), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.5694 = f32[1,31,4,256]{3,2,1,0} multiply(dot.5674, broadcast.5693), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.5685 = f32[1,31,4,128]{3,2,1,0} slice(dot.5674), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.5686 = f32[1,31,4,128]{3,2,1,0} negate(slice.5685), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.5687 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.5686), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.5684 = f32[1,31,4,128]{3,2,1,0} slice(dot.5674), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5688 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.5684), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5689 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.5687, reshape.5688), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5690 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.5689), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.5683 = f32[1,31,1,256]{3,2,1,0} sine(reshape.5681), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.5695 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.5683), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.5696 = f32[1,31,256]{2,1,0} reshape(broadcast.5695), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.5697 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.5696), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.5698 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.5690, broadcast.5697), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.5699 = f32[1,31,4,256]{3,2,1,0} add(multiply.5694, multiply.5698), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.5700 = f32[1,31,4,128]{3,2,1,0} slice(add.5699), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5702 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.5700), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.5701 = f32[1,31,4,128]{3,2,1,0} slice(add.5699), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5703 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.5701), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5704 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.5702, reshape.5703), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5707 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.5704), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_238.239 = f32[4,2304,256]{2,1,0} parameter(238), metadata={op_name="state[1][236]"}
  dot.5706 = f32[1,31,4,256]{3,2,1,0} dot(multiply.5633, Arg_238.239), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.5708 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.5706), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5709 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.5707, reshape.5708), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6684 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.5709), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.5634 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.5635 = f32[31]{0} reshape(broadcast.5634), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.5636 = f32[31,31]{1,0} broadcast(reshape.5635), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.5637 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.5638 = f32[31]{0} reshape(broadcast.5637), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.5639 = f32[31,31]{1,0} broadcast(reshape.5638), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.5640 = pred[31,31]{1,0} compare(broadcast.5636, broadcast.5639), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.5641 = pred[1,31,31]{2,1,0} reshape(compare.5640), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.5750 = s32[1,31,31]{2,1,0} convert(reshape.5641), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.5751 = pred[1,31,31]{2,1,0} compare(convert.5750, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.5756 = pred[1,31]{1,0} reduce(compare.5751, constant.340), dimensions={2}, to_apply=region_151.5752, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.5757 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.5756), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.5705 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.5704), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_236.237 = f32[8,2304,256]{2,1,0} parameter(236), metadata={op_name="state[1][234]"}
  dot.5642 = f32[1,31,8,256]{3,2,1,0} dot(multiply.5633, Arg_236.237), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.5643 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.5644 = f32[128]{0} divide(broadcast.321, power.5643), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.5645 = f32[31,128]{1,0} dot(constant.319, divide.5644), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.5646 = f32[31,1,128]{2,1,0} reshape(dot.5645), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5647 = f32[31,1,128]{2,1,0} reshape(dot.5645), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5648 = f32[31,2,128]{2,1,0} concatenate(reshape.5646, reshape.5647), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5649 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.5648), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.5650 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.5649), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.5659 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.5650), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.5660 = f32[1,31,256]{2,1,0} reshape(broadcast.5659), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.5661 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.5660), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.5662 = f32[1,31,8,256]{3,2,1,0} multiply(dot.5642, broadcast.5661), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.5653 = f32[1,31,8,128]{3,2,1,0} slice(dot.5642), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.5654 = f32[1,31,8,128]{3,2,1,0} negate(slice.5653), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.5655 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.5654), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.5652 = f32[1,31,8,128]{3,2,1,0} slice(dot.5642), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5656 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.5652), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5657 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.5655, reshape.5656), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5658 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.5657), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.5651 = f32[1,31,1,256]{3,2,1,0} sine(reshape.5649), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.5663 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.5651), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.5664 = f32[1,31,256]{2,1,0} reshape(broadcast.5663), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.5665 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.5664), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.5666 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.5658, broadcast.5665), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.5667 = f32[1,31,8,256]{3,2,1,0} add(multiply.5662, multiply.5666), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/rotary_embedding_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.5668 = f32[1,31,8,128]{3,2,1,0} slice(add.5667), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5670 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.5668), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.5669 = f32[1,31,8,128]{3,2,1,0} slice(add.5667), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5671 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.5669), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5672 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.5670, reshape.5671), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5673 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.5672), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.5710 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.5673, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.5711 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.5710), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.5712 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.5705, reshape.5711), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.5713 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.5712), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.5714 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.5713, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.5715 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.5714), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.5716 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.5715, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.5717 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(compare.5640), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.5718 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.5717), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.5719 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.5718), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.5720 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.5719, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.5721 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.5720), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.5722 = f32[1,31,31]{2,1,0} reshape(broadcast.5721), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.5723 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.5722), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.5724 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.5716, broadcast.5723), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.5729 = f32[1,4,2,31]{3,2,1,0} reduce(add.5724, constant.339), dimensions={4}, to_apply=region_149.5725, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.5730 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.5729, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.5731 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.5730), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.5732 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.5731), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.5733 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.5732), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.5734 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.5733), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.5735 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.5724, broadcast.5734), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.5736 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.5735), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.5741 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.5736, constant.342), dimensions={4}, to_apply=region_150.5737, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.5742 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.5741), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.5743 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.5742), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.5744 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.5743), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.5745 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.5744), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.5746 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.5736, broadcast.5745), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/softmax_21/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.5747 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.5706, divide.5746), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.5748 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.5747), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.5749 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.5748), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.5766 = f32[1,31,8,256]{3,2,1,0} call(reshape.5757, broadcast.304, reshape.5749), to_apply=_where_0.5758
  Arg_239.240 = f32[8,256,2304]{2,1,0} parameter(239), metadata={op_name="state[1][237]"}
  dot.5767 = f32[1,31,2304]{2,1,0} dot(call.5766, Arg_239.240), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.5768 = f32[1,31,2304]{2,1,0} multiply(dot.5767, dot.5767), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.5773 = f32[1,31]{1,0} reduce(multiply.5768, constant.342), dimensions={2}, to_apply=region_152.5769, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.5774 = f32[1,31,1]{2,1,0} reshape(reduce.5773), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.5775 = f32[1,31,1]{2,1,0} divide(reshape.5774, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.5776 = f32[1,31,1]{2,1,0} add(divide.5775, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.5777 = f32[1,31,1]{2,1,0} sqrt(add.5776), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.5778 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.5777), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.5779 = f32[1,31,1]{2,1,0} broadcast(divide.5778), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.5780 = f32[1,31]{1,0} reshape(broadcast.5779), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.5781 = f32[1,31,2304]{2,1,0} broadcast(reshape.5780), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.5782 = f32[1,31,2304]{2,1,0} multiply(dot.5767, broadcast.5781), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_235.236 = f32[2304]{0} parameter(235), metadata={op_name="state[1][233]"}
  add.5783 = f32[2304]{0} add(Arg_235.236, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5784 = f32[1,1,2304]{2,1,0} reshape(add.5783), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5785 = f32[1,1,2304]{2,1,0} broadcast(reshape.5784), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5786 = f32[1,2304]{1,0} reshape(broadcast.5785), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5787 = f32[1,31,2304]{2,1,0} broadcast(reshape.5786), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.5788 = f32[1,31,2304]{2,1,0} multiply(multiply.5782, broadcast.5787), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.5789 = f32[1,31,2304]{2,1,0} add(add.5612, multiply.5788), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.5790 = f32[1,31,2304]{2,1,0} multiply(add.5789, add.5789), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.5795 = f32[1,31]{1,0} reduce(multiply.5790, constant.342), dimensions={2}, to_apply=region_153.5791, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.5796 = f32[1,31,1]{2,1,0} reshape(reduce.5795), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.5797 = f32[1,31,1]{2,1,0} divide(reshape.5796, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.5798 = f32[1,31,1]{2,1,0} add(divide.5797, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.5799 = f32[1,31,1]{2,1,0} sqrt(add.5798), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.5800 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.5799), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.5801 = f32[1,31,1]{2,1,0} broadcast(divide.5800), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.5802 = f32[1,31]{1,0} reshape(broadcast.5801), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.5803 = f32[1,31,2304]{2,1,0} broadcast(reshape.5802), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.5804 = f32[1,31,2304]{2,1,0} multiply(add.5789, broadcast.5803), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_240.241 = f32[2304]{0} parameter(240), metadata={op_name="state[1][238]"}
  add.5805 = f32[2304]{0} add(Arg_240.241, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5806 = f32[1,1,2304]{2,1,0} reshape(add.5805), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5807 = f32[1,1,2304]{2,1,0} broadcast(reshape.5806), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5808 = f32[1,2304]{1,0} reshape(broadcast.5807), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5809 = f32[1,31,2304]{2,1,0} broadcast(reshape.5808), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.5810 = f32[1,31,2304]{2,1,0} multiply(multiply.5804, broadcast.5809), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_242.243 = f32[2304,9216]{1,0} parameter(242), metadata={op_name="state[1][240]"}
  dot.5811 = f32[1,31,9216]{2,1,0} dot(multiply.5810, Arg_242.243), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.5813 = f32[1,31,9216]{2,1,0} multiply(dot.5811, dot.5811), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5814 = f32[1,31,9216]{2,1,0} multiply(multiply.5813, dot.5811), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5815 = f32[1,31,9216]{2,1,0} multiply(multiply.5814, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.5816 = f32[1,31,9216]{2,1,0} add(dot.5811, multiply.5815), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5817 = f32[1,31,9216]{2,1,0} multiply(add.5816, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.5818 = f32[1,31,9216]{2,1,0} tanh(multiply.5817), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.5819 = f32[1,31,9216]{2,1,0} add(tanh.5818, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5820 = f32[1,31,9216]{2,1,0} multiply(add.5819, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.5821 = f32[1,31,9216]{2,1,0} multiply(dot.5811, multiply.5820), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_243.244 = f32[2304,9216]{1,0} parameter(243), metadata={op_name="state[1][241]"}
  dot.5812 = f32[1,31,9216]{2,1,0} dot(multiply.5810, Arg_243.244), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.5822 = f32[1,31,9216]{2,1,0} multiply(multiply.5821, dot.5812), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_244.245 = f32[9216,2304]{1,0} parameter(244), metadata={op_name="state[1][242]"}
  dot.5823 = f32[1,31,2304]{2,1,0} dot(multiply.5822, Arg_244.245), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.5824 = f32[1,31,2304]{2,1,0} multiply(dot.5823, dot.5823), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.5829 = f32[1,31]{1,0} reduce(multiply.5824, constant.342), dimensions={2}, to_apply=region_154.5825, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.5830 = f32[1,31,1]{2,1,0} reshape(reduce.5829), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.5831 = f32[1,31,1]{2,1,0} divide(reshape.5830, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.5832 = f32[1,31,1]{2,1,0} add(divide.5831, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.5833 = f32[1,31,1]{2,1,0} sqrt(add.5832), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.5834 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.5833), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.5835 = f32[1,31,1]{2,1,0} broadcast(divide.5834), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.5836 = f32[1,31]{1,0} reshape(broadcast.5835), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.5837 = f32[1,31,2304]{2,1,0} broadcast(reshape.5836), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.5838 = f32[1,31,2304]{2,1,0} multiply(dot.5823, broadcast.5837), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_241.242 = f32[2304]{0} parameter(241), metadata={op_name="state[1][239]"}
  add.5839 = f32[2304]{0} add(Arg_241.242, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5840 = f32[1,1,2304]{2,1,0} reshape(add.5839), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5841 = f32[1,1,2304]{2,1,0} broadcast(reshape.5840), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5842 = f32[1,2304]{1,0} reshape(broadcast.5841), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5843 = f32[1,31,2304]{2,1,0} broadcast(reshape.5842), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.5844 = f32[1,31,2304]{2,1,0} multiply(multiply.5838, broadcast.5843), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.5845 = f32[1,31,2304]{2,1,0} add(multiply.5844, add.5789), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_21/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.5846 = f32[1,31,2304]{2,1,0} multiply(add.5845, add.5845), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.5851 = f32[1,31]{1,0} reduce(multiply.5846, constant.342), dimensions={2}, to_apply=region_155.5847, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.5852 = f32[1,31,1]{2,1,0} reshape(reduce.5851), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.5853 = f32[1,31,1]{2,1,0} divide(reshape.5852, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.5854 = f32[1,31,1]{2,1,0} add(divide.5853, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.5855 = f32[1,31,1]{2,1,0} sqrt(add.5854), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.5856 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.5855), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.5857 = f32[1,31,1]{2,1,0} broadcast(divide.5856), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.5858 = f32[1,31]{1,0} reshape(broadcast.5857), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.5859 = f32[1,31,2304]{2,1,0} broadcast(reshape.5858), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.5860 = f32[1,31,2304]{2,1,0} multiply(add.5845, broadcast.5859), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_245.246 = f32[2304]{0} parameter(245), metadata={op_name="state[1][243]"}
  add.5861 = f32[2304]{0} add(Arg_245.246, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5862 = f32[1,1,2304]{2,1,0} reshape(add.5861), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5863 = f32[1,1,2304]{2,1,0} broadcast(reshape.5862), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.5864 = f32[1,2304]{1,0} reshape(broadcast.5863), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.5865 = f32[1,31,2304]{2,1,0} broadcast(reshape.5864), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.5866 = f32[1,31,2304]{2,1,0} multiply(multiply.5860, broadcast.5865), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_248.249 = f32[4,2304,256]{2,1,0} parameter(248), metadata={op_name="state[1][246]"}
  dot.5907 = f32[1,31,4,256]{3,2,1,0} dot(multiply.5866, Arg_248.249), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.5908 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.5909 = f32[128]{0} divide(broadcast.321, power.5908), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.5910 = f32[31,128]{1,0} dot(constant.319, divide.5909), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.5911 = f32[31,1,128]{2,1,0} reshape(dot.5910), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5912 = f32[31,1,128]{2,1,0} reshape(dot.5910), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5913 = f32[31,2,128]{2,1,0} concatenate(reshape.5911, reshape.5912), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5914 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.5913), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.5915 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.5914), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.5924 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.5915), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.5925 = f32[1,31,256]{2,1,0} reshape(broadcast.5924), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.5926 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.5925), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.5927 = f32[1,31,4,256]{3,2,1,0} multiply(dot.5907, broadcast.5926), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.5918 = f32[1,31,4,128]{3,2,1,0} slice(dot.5907), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.5919 = f32[1,31,4,128]{3,2,1,0} negate(slice.5918), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.5920 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.5919), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.5917 = f32[1,31,4,128]{3,2,1,0} slice(dot.5907), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5921 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.5917), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5922 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.5920, reshape.5921), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5923 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.5922), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.5916 = f32[1,31,1,256]{3,2,1,0} sine(reshape.5914), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.5928 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.5916), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.5929 = f32[1,31,256]{2,1,0} reshape(broadcast.5928), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.5930 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.5929), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.5931 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.5923, broadcast.5930), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.5932 = f32[1,31,4,256]{3,2,1,0} add(multiply.5927, multiply.5931), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.5933 = f32[1,31,4,128]{3,2,1,0} slice(add.5932), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5935 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.5933), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.5934 = f32[1,31,4,128]{3,2,1,0} slice(add.5932), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5936 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.5934), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5937 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.5935, reshape.5936), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5940 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.5937), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_249.250 = f32[4,2304,256]{2,1,0} parameter(249), metadata={op_name="state[1][247]"}
  dot.5939 = f32[1,31,4,256]{3,2,1,0} dot(multiply.5866, Arg_249.250), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.5941 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.5939), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5942 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.5940, reshape.5941), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6685 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.5942), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.5867 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.5868 = f32[31]{0} reshape(broadcast.5867), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.5869 = f32[31,31]{1,0} broadcast(reshape.5868), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.5870 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.5871 = f32[31]{0} reshape(broadcast.5870), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.5872 = f32[31,31]{1,0} broadcast(reshape.5871), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.5873 = pred[31,31]{1,0} compare(broadcast.5869, broadcast.5872), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.5874 = pred[1,31,31]{2,1,0} reshape(compare.5873), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.6014 = s32[1,31,31]{2,1,0} convert(reshape.5874), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.6015 = pred[1,31,31]{2,1,0} compare(convert.6014, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.6020 = pred[1,31]{1,0} reduce(compare.6015, constant.340), dimensions={2}, to_apply=region_158.6016, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.6021 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.6020), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.5938 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.5937), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_247.248 = f32[8,2304,256]{2,1,0} parameter(247), metadata={op_name="state[1][245]"}
  dot.5875 = f32[1,31,8,256]{3,2,1,0} dot(multiply.5866, Arg_247.248), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.5876 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.5877 = f32[128]{0} divide(broadcast.321, power.5876), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.5878 = f32[31,128]{1,0} dot(constant.319, divide.5877), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.5879 = f32[31,1,128]{2,1,0} reshape(dot.5878), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5880 = f32[31,1,128]{2,1,0} reshape(dot.5878), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5881 = f32[31,2,128]{2,1,0} concatenate(reshape.5879, reshape.5880), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5882 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.5881), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.5883 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.5882), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.5892 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.5883), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.5893 = f32[1,31,256]{2,1,0} reshape(broadcast.5892), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.5894 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.5893), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.5895 = f32[1,31,8,256]{3,2,1,0} multiply(dot.5875, broadcast.5894), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.5886 = f32[1,31,8,128]{3,2,1,0} slice(dot.5875), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.5887 = f32[1,31,8,128]{3,2,1,0} negate(slice.5886), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.5888 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.5887), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.5885 = f32[1,31,8,128]{3,2,1,0} slice(dot.5875), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5889 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.5885), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5890 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.5888, reshape.5889), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5891 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.5890), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.5884 = f32[1,31,1,256]{3,2,1,0} sine(reshape.5882), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.5896 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.5884), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.5897 = f32[1,31,256]{2,1,0} reshape(broadcast.5896), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.5898 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.5897), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.5899 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.5891, broadcast.5898), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.5900 = f32[1,31,8,256]{3,2,1,0} add(multiply.5895, multiply.5899), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/rotary_embedding_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.5901 = f32[1,31,8,128]{3,2,1,0} slice(add.5900), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5903 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.5901), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.5902 = f32[1,31,8,128]{3,2,1,0} slice(add.5900), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.5904 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.5902), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.5905 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.5903, reshape.5904), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.5906 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.5905), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.5943 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.5906, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.5944 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.5943), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.5945 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.5938, reshape.5944), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.5946 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.5945), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.5947 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.5946, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.5948 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.5947), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.5949 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.5948, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.5963 = pred[31,31]{1,0} call(broadcast.314), to_apply=triu.5950
  call.5977 = pred[31,31]{1,0} call(broadcast.314), to_apply=tril.5964
  and.5978 = pred[31,31]{1,0} and(call.5963, call.5977), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  reshape.5979 = pred[1,31,31]{2,1,0} reshape(and.5978), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.5980 = pred[1,31,31]{2,1,0} and(reshape.5874, reshape.5979), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.5981 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(and.5980), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.5982 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.5981), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.5983 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.5982), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.5984 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.5983, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.5985 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.5984), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.5986 = f32[1,31,31]{2,1,0} reshape(broadcast.5985), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.5987 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.5986), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.5988 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.5949, broadcast.5987), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.5993 = f32[1,4,2,31]{3,2,1,0} reduce(add.5988, constant.339), dimensions={4}, to_apply=region_156.5989, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.5994 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.5993, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.5995 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.5994), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.5996 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.5995), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.5997 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.5996), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.5998 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.5997), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.5999 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.5988, broadcast.5998), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.6000 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.5999), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.6005 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.6000, constant.342), dimensions={4}, to_apply=region_157.6001, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.6006 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.6005), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.6007 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.6006), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.6008 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.6007), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.6009 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.6008), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.6010 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.6000, broadcast.6009), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/softmax_22/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.6011 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.5939, divide.6010), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.6012 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.6011), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.6013 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.6012), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.6030 = f32[1,31,8,256]{3,2,1,0} call(reshape.6021, broadcast.304, reshape.6013), to_apply=_where_0.6022
  Arg_250.251 = f32[8,256,2304]{2,1,0} parameter(250), metadata={op_name="state[1][248]"}
  dot.6031 = f32[1,31,2304]{2,1,0} dot(call.6030, Arg_250.251), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.6032 = f32[1,31,2304]{2,1,0} multiply(dot.6031, dot.6031), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.6037 = f32[1,31]{1,0} reduce(multiply.6032, constant.342), dimensions={2}, to_apply=region_159.6033, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.6038 = f32[1,31,1]{2,1,0} reshape(reduce.6037), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.6039 = f32[1,31,1]{2,1,0} divide(reshape.6038, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.6040 = f32[1,31,1]{2,1,0} add(divide.6039, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.6041 = f32[1,31,1]{2,1,0} sqrt(add.6040), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.6042 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.6041), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.6043 = f32[1,31,1]{2,1,0} broadcast(divide.6042), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.6044 = f32[1,31]{1,0} reshape(broadcast.6043), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.6045 = f32[1,31,2304]{2,1,0} broadcast(reshape.6044), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.6046 = f32[1,31,2304]{2,1,0} multiply(dot.6031, broadcast.6045), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_246.247 = f32[2304]{0} parameter(246), metadata={op_name="state[1][244]"}
  add.6047 = f32[2304]{0} add(Arg_246.247, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6048 = f32[1,1,2304]{2,1,0} reshape(add.6047), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6049 = f32[1,1,2304]{2,1,0} broadcast(reshape.6048), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6050 = f32[1,2304]{1,0} reshape(broadcast.6049), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6051 = f32[1,31,2304]{2,1,0} broadcast(reshape.6050), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.6052 = f32[1,31,2304]{2,1,0} multiply(multiply.6046, broadcast.6051), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.6053 = f32[1,31,2304]{2,1,0} add(add.5845, multiply.6052), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.6054 = f32[1,31,2304]{2,1,0} multiply(add.6053, add.6053), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.6059 = f32[1,31]{1,0} reduce(multiply.6054, constant.342), dimensions={2}, to_apply=region_160.6055, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.6060 = f32[1,31,1]{2,1,0} reshape(reduce.6059), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.6061 = f32[1,31,1]{2,1,0} divide(reshape.6060, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.6062 = f32[1,31,1]{2,1,0} add(divide.6061, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.6063 = f32[1,31,1]{2,1,0} sqrt(add.6062), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.6064 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.6063), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.6065 = f32[1,31,1]{2,1,0} broadcast(divide.6064), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.6066 = f32[1,31]{1,0} reshape(broadcast.6065), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.6067 = f32[1,31,2304]{2,1,0} broadcast(reshape.6066), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.6068 = f32[1,31,2304]{2,1,0} multiply(add.6053, broadcast.6067), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_251.252 = f32[2304]{0} parameter(251), metadata={op_name="state[1][249]"}
  add.6069 = f32[2304]{0} add(Arg_251.252, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6070 = f32[1,1,2304]{2,1,0} reshape(add.6069), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6071 = f32[1,1,2304]{2,1,0} broadcast(reshape.6070), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6072 = f32[1,2304]{1,0} reshape(broadcast.6071), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6073 = f32[1,31,2304]{2,1,0} broadcast(reshape.6072), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.6074 = f32[1,31,2304]{2,1,0} multiply(multiply.6068, broadcast.6073), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_253.254 = f32[2304,9216]{1,0} parameter(253), metadata={op_name="state[1][251]"}
  dot.6075 = f32[1,31,9216]{2,1,0} dot(multiply.6074, Arg_253.254), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.6077 = f32[1,31,9216]{2,1,0} multiply(dot.6075, dot.6075), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.6078 = f32[1,31,9216]{2,1,0} multiply(multiply.6077, dot.6075), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.6079 = f32[1,31,9216]{2,1,0} multiply(multiply.6078, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.6080 = f32[1,31,9216]{2,1,0} add(dot.6075, multiply.6079), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.6081 = f32[1,31,9216]{2,1,0} multiply(add.6080, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.6082 = f32[1,31,9216]{2,1,0} tanh(multiply.6081), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.6083 = f32[1,31,9216]{2,1,0} add(tanh.6082, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.6084 = f32[1,31,9216]{2,1,0} multiply(add.6083, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.6085 = f32[1,31,9216]{2,1,0} multiply(dot.6075, multiply.6084), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_254.255 = f32[2304,9216]{1,0} parameter(254), metadata={op_name="state[1][252]"}
  dot.6076 = f32[1,31,9216]{2,1,0} dot(multiply.6074, Arg_254.255), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.6086 = f32[1,31,9216]{2,1,0} multiply(multiply.6085, dot.6076), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_255.256 = f32[9216,2304]{1,0} parameter(255), metadata={op_name="state[1][253]"}
  dot.6087 = f32[1,31,2304]{2,1,0} dot(multiply.6086, Arg_255.256), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.6088 = f32[1,31,2304]{2,1,0} multiply(dot.6087, dot.6087), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.6093 = f32[1,31]{1,0} reduce(multiply.6088, constant.342), dimensions={2}, to_apply=region_161.6089, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.6094 = f32[1,31,1]{2,1,0} reshape(reduce.6093), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.6095 = f32[1,31,1]{2,1,0} divide(reshape.6094, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.6096 = f32[1,31,1]{2,1,0} add(divide.6095, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.6097 = f32[1,31,1]{2,1,0} sqrt(add.6096), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.6098 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.6097), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.6099 = f32[1,31,1]{2,1,0} broadcast(divide.6098), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.6100 = f32[1,31]{1,0} reshape(broadcast.6099), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.6101 = f32[1,31,2304]{2,1,0} broadcast(reshape.6100), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.6102 = f32[1,31,2304]{2,1,0} multiply(dot.6087, broadcast.6101), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_252.253 = f32[2304]{0} parameter(252), metadata={op_name="state[1][250]"}
  add.6103 = f32[2304]{0} add(Arg_252.253, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6104 = f32[1,1,2304]{2,1,0} reshape(add.6103), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6105 = f32[1,1,2304]{2,1,0} broadcast(reshape.6104), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6106 = f32[1,2304]{1,0} reshape(broadcast.6105), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6107 = f32[1,31,2304]{2,1,0} broadcast(reshape.6106), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.6108 = f32[1,31,2304]{2,1,0} multiply(multiply.6102, broadcast.6107), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.6109 = f32[1,31,2304]{2,1,0} add(multiply.6108, add.6053), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_22/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.6110 = f32[1,31,2304]{2,1,0} multiply(add.6109, add.6109), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.6115 = f32[1,31]{1,0} reduce(multiply.6110, constant.342), dimensions={2}, to_apply=region_162.6111, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.6116 = f32[1,31,1]{2,1,0} reshape(reduce.6115), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.6117 = f32[1,31,1]{2,1,0} divide(reshape.6116, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.6118 = f32[1,31,1]{2,1,0} add(divide.6117, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.6119 = f32[1,31,1]{2,1,0} sqrt(add.6118), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.6120 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.6119), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.6121 = f32[1,31,1]{2,1,0} broadcast(divide.6120), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.6122 = f32[1,31]{1,0} reshape(broadcast.6121), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.6123 = f32[1,31,2304]{2,1,0} broadcast(reshape.6122), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.6124 = f32[1,31,2304]{2,1,0} multiply(add.6109, broadcast.6123), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_256.257 = f32[2304]{0} parameter(256), metadata={op_name="state[1][254]"}
  add.6125 = f32[2304]{0} add(Arg_256.257, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6126 = f32[1,1,2304]{2,1,0} reshape(add.6125), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6127 = f32[1,1,2304]{2,1,0} broadcast(reshape.6126), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6128 = f32[1,2304]{1,0} reshape(broadcast.6127), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6129 = f32[1,31,2304]{2,1,0} broadcast(reshape.6128), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.6130 = f32[1,31,2304]{2,1,0} multiply(multiply.6124, broadcast.6129), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_259.260 = f32[4,2304,256]{2,1,0} parameter(259), metadata={op_name="state[1][257]"}
  dot.6171 = f32[1,31,4,256]{3,2,1,0} dot(multiply.6130, Arg_259.260), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.6172 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.6173 = f32[128]{0} divide(broadcast.321, power.6172), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.6174 = f32[31,128]{1,0} dot(constant.319, divide.6173), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.6175 = f32[31,1,128]{2,1,0} reshape(dot.6174), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6176 = f32[31,1,128]{2,1,0} reshape(dot.6174), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.6177 = f32[31,2,128]{2,1,0} concatenate(reshape.6175, reshape.6176), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6178 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.6177), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.6179 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.6178), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.6188 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.6179), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.6189 = f32[1,31,256]{2,1,0} reshape(broadcast.6188), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.6190 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.6189), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.6191 = f32[1,31,4,256]{3,2,1,0} multiply(dot.6171, broadcast.6190), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.6182 = f32[1,31,4,128]{3,2,1,0} slice(dot.6171), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.6183 = f32[1,31,4,128]{3,2,1,0} negate(slice.6182), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.6184 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.6183), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.6181 = f32[1,31,4,128]{3,2,1,0} slice(dot.6171), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.6185 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.6181), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.6186 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.6184, reshape.6185), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6187 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.6186), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.6180 = f32[1,31,1,256]{3,2,1,0} sine(reshape.6178), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.6192 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.6180), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.6193 = f32[1,31,256]{2,1,0} reshape(broadcast.6192), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.6194 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.6193), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.6195 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.6187, broadcast.6194), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.6196 = f32[1,31,4,256]{3,2,1,0} add(multiply.6191, multiply.6195), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.6197 = f32[1,31,4,128]{3,2,1,0} slice(add.6196), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.6199 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.6197), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.6198 = f32[1,31,4,128]{3,2,1,0} slice(add.6196), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.6200 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.6198), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.6201 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.6199, reshape.6200), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6204 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.6201), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_260.261 = f32[4,2304,256]{2,1,0} parameter(260), metadata={op_name="state[1][258]"}
  dot.6203 = f32[1,31,4,256]{3,2,1,0} dot(multiply.6130, Arg_260.261), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.6205 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.6203), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.6206 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.6204, reshape.6205), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6686 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.6206), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.6131 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.6132 = f32[31]{0} reshape(broadcast.6131), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.6133 = f32[31,31]{1,0} broadcast(reshape.6132), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.6134 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.6135 = f32[31]{0} reshape(broadcast.6134), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.6136 = f32[31,31]{1,0} broadcast(reshape.6135), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.6137 = pred[31,31]{1,0} compare(broadcast.6133, broadcast.6136), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.6138 = pred[1,31,31]{2,1,0} reshape(compare.6137), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.6247 = s32[1,31,31]{2,1,0} convert(reshape.6138), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.6248 = pred[1,31,31]{2,1,0} compare(convert.6247, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.6253 = pred[1,31]{1,0} reduce(compare.6248, constant.340), dimensions={2}, to_apply=region_165.6249, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.6254 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.6253), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.6202 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.6201), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_258.259 = f32[8,2304,256]{2,1,0} parameter(258), metadata={op_name="state[1][256]"}
  dot.6139 = f32[1,31,8,256]{3,2,1,0} dot(multiply.6130, Arg_258.259), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.6140 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.6141 = f32[128]{0} divide(broadcast.321, power.6140), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.6142 = f32[31,128]{1,0} dot(constant.319, divide.6141), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.6143 = f32[31,1,128]{2,1,0} reshape(dot.6142), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6144 = f32[31,1,128]{2,1,0} reshape(dot.6142), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.6145 = f32[31,2,128]{2,1,0} concatenate(reshape.6143, reshape.6144), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6146 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.6145), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.6147 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.6146), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.6156 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.6147), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.6157 = f32[1,31,256]{2,1,0} reshape(broadcast.6156), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.6158 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.6157), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.6159 = f32[1,31,8,256]{3,2,1,0} multiply(dot.6139, broadcast.6158), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.6150 = f32[1,31,8,128]{3,2,1,0} slice(dot.6139), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.6151 = f32[1,31,8,128]{3,2,1,0} negate(slice.6150), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.6152 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.6151), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.6149 = f32[1,31,8,128]{3,2,1,0} slice(dot.6139), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.6153 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.6149), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.6154 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.6152, reshape.6153), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6155 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.6154), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.6148 = f32[1,31,1,256]{3,2,1,0} sine(reshape.6146), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.6160 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.6148), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.6161 = f32[1,31,256]{2,1,0} reshape(broadcast.6160), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.6162 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.6161), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.6163 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.6155, broadcast.6162), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.6164 = f32[1,31,8,256]{3,2,1,0} add(multiply.6159, multiply.6163), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/rotary_embedding_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.6165 = f32[1,31,8,128]{3,2,1,0} slice(add.6164), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.6167 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.6165), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.6166 = f32[1,31,8,128]{3,2,1,0} slice(add.6164), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.6168 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.6166), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.6169 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.6167, reshape.6168), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6170 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.6169), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.6207 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.6170, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.6208 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.6207), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.6209 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.6202, reshape.6208), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.6210 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.6209), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.6211 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.6210, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.6212 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.6211), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.6213 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.6212, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  reshape.6214 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(compare.6137), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.6215 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.6214), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.6216 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.6215), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.6217 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.6216, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.6218 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.6217), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.6219 = f32[1,31,31]{2,1,0} reshape(broadcast.6218), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.6220 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.6219), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.6221 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.6213, broadcast.6220), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.6226 = f32[1,4,2,31]{3,2,1,0} reduce(add.6221, constant.339), dimensions={4}, to_apply=region_163.6222, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.6227 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.6226, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.6228 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.6227), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.6229 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.6228), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.6230 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.6229), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.6231 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.6230), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.6232 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.6221, broadcast.6231), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.6233 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.6232), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.6238 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.6233, constant.342), dimensions={4}, to_apply=region_164.6234, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.6239 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.6238), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.6240 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.6239), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.6241 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.6240), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.6242 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.6241), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.6243 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.6233, broadcast.6242), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/softmax_23/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.6244 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.6203, divide.6243), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.6245 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.6244), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.6246 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.6245), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.6263 = f32[1,31,8,256]{3,2,1,0} call(reshape.6254, broadcast.304, reshape.6246), to_apply=_where_0.6255
  Arg_261.262 = f32[8,256,2304]{2,1,0} parameter(261), metadata={op_name="state[1][259]"}
  dot.6264 = f32[1,31,2304]{2,1,0} dot(call.6263, Arg_261.262), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.6265 = f32[1,31,2304]{2,1,0} multiply(dot.6264, dot.6264), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.6270 = f32[1,31]{1,0} reduce(multiply.6265, constant.342), dimensions={2}, to_apply=region_166.6266, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.6271 = f32[1,31,1]{2,1,0} reshape(reduce.6270), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.6272 = f32[1,31,1]{2,1,0} divide(reshape.6271, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.6273 = f32[1,31,1]{2,1,0} add(divide.6272, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.6274 = f32[1,31,1]{2,1,0} sqrt(add.6273), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.6275 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.6274), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.6276 = f32[1,31,1]{2,1,0} broadcast(divide.6275), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.6277 = f32[1,31]{1,0} reshape(broadcast.6276), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.6278 = f32[1,31,2304]{2,1,0} broadcast(reshape.6277), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.6279 = f32[1,31,2304]{2,1,0} multiply(dot.6264, broadcast.6278), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_257.258 = f32[2304]{0} parameter(257), metadata={op_name="state[1][255]"}
  add.6280 = f32[2304]{0} add(Arg_257.258, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6281 = f32[1,1,2304]{2,1,0} reshape(add.6280), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6282 = f32[1,1,2304]{2,1,0} broadcast(reshape.6281), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6283 = f32[1,2304]{1,0} reshape(broadcast.6282), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6284 = f32[1,31,2304]{2,1,0} broadcast(reshape.6283), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.6285 = f32[1,31,2304]{2,1,0} multiply(multiply.6279, broadcast.6284), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.6286 = f32[1,31,2304]{2,1,0} add(add.6109, multiply.6285), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.6287 = f32[1,31,2304]{2,1,0} multiply(add.6286, add.6286), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.6292 = f32[1,31]{1,0} reduce(multiply.6287, constant.342), dimensions={2}, to_apply=region_167.6288, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.6293 = f32[1,31,1]{2,1,0} reshape(reduce.6292), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.6294 = f32[1,31,1]{2,1,0} divide(reshape.6293, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.6295 = f32[1,31,1]{2,1,0} add(divide.6294, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.6296 = f32[1,31,1]{2,1,0} sqrt(add.6295), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.6297 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.6296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.6298 = f32[1,31,1]{2,1,0} broadcast(divide.6297), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.6299 = f32[1,31]{1,0} reshape(broadcast.6298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.6300 = f32[1,31,2304]{2,1,0} broadcast(reshape.6299), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.6301 = f32[1,31,2304]{2,1,0} multiply(add.6286, broadcast.6300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_262.263 = f32[2304]{0} parameter(262), metadata={op_name="state[1][260]"}
  add.6302 = f32[2304]{0} add(Arg_262.263, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6303 = f32[1,1,2304]{2,1,0} reshape(add.6302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6304 = f32[1,1,2304]{2,1,0} broadcast(reshape.6303), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6305 = f32[1,2304]{1,0} reshape(broadcast.6304), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6306 = f32[1,31,2304]{2,1,0} broadcast(reshape.6305), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.6307 = f32[1,31,2304]{2,1,0} multiply(multiply.6301, broadcast.6306), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_264.265 = f32[2304,9216]{1,0} parameter(264), metadata={op_name="state[1][262]"}
  dot.6308 = f32[1,31,9216]{2,1,0} dot(multiply.6307, Arg_264.265), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.6310 = f32[1,31,9216]{2,1,0} multiply(dot.6308, dot.6308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.6311 = f32[1,31,9216]{2,1,0} multiply(multiply.6310, dot.6308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.6312 = f32[1,31,9216]{2,1,0} multiply(multiply.6311, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.6313 = f32[1,31,9216]{2,1,0} add(dot.6308, multiply.6312), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.6314 = f32[1,31,9216]{2,1,0} multiply(add.6313, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.6315 = f32[1,31,9216]{2,1,0} tanh(multiply.6314), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.6316 = f32[1,31,9216]{2,1,0} add(tanh.6315, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.6317 = f32[1,31,9216]{2,1,0} multiply(add.6316, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.6318 = f32[1,31,9216]{2,1,0} multiply(dot.6308, multiply.6317), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_265.266 = f32[2304,9216]{1,0} parameter(265), metadata={op_name="state[1][263]"}
  dot.6309 = f32[1,31,9216]{2,1,0} dot(multiply.6307, Arg_265.266), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.6319 = f32[1,31,9216]{2,1,0} multiply(multiply.6318, dot.6309), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_266.267 = f32[9216,2304]{1,0} parameter(266), metadata={op_name="state[1][264]"}
  dot.6320 = f32[1,31,2304]{2,1,0} dot(multiply.6319, Arg_266.267), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.6321 = f32[1,31,2304]{2,1,0} multiply(dot.6320, dot.6320), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.6326 = f32[1,31]{1,0} reduce(multiply.6321, constant.342), dimensions={2}, to_apply=region_168.6322, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.6327 = f32[1,31,1]{2,1,0} reshape(reduce.6326), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.6328 = f32[1,31,1]{2,1,0} divide(reshape.6327, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.6329 = f32[1,31,1]{2,1,0} add(divide.6328, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.6330 = f32[1,31,1]{2,1,0} sqrt(add.6329), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.6331 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.6330), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.6332 = f32[1,31,1]{2,1,0} broadcast(divide.6331), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.6333 = f32[1,31]{1,0} reshape(broadcast.6332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.6334 = f32[1,31,2304]{2,1,0} broadcast(reshape.6333), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.6335 = f32[1,31,2304]{2,1,0} multiply(dot.6320, broadcast.6334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_263.264 = f32[2304]{0} parameter(263), metadata={op_name="state[1][261]"}
  add.6336 = f32[2304]{0} add(Arg_263.264, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6337 = f32[1,1,2304]{2,1,0} reshape(add.6336), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6338 = f32[1,1,2304]{2,1,0} broadcast(reshape.6337), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6339 = f32[1,2304]{1,0} reshape(broadcast.6338), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6340 = f32[1,31,2304]{2,1,0} broadcast(reshape.6339), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.6341 = f32[1,31,2304]{2,1,0} multiply(multiply.6335, broadcast.6340), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.6342 = f32[1,31,2304]{2,1,0} add(multiply.6341, add.6286), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_23/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.6343 = f32[1,31,2304]{2,1,0} multiply(add.6342, add.6342), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.6348 = f32[1,31]{1,0} reduce(multiply.6343, constant.342), dimensions={2}, to_apply=region_169.6344, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.6349 = f32[1,31,1]{2,1,0} reshape(reduce.6348), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.6350 = f32[1,31,1]{2,1,0} divide(reshape.6349, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.6351 = f32[1,31,1]{2,1,0} add(divide.6350, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.6352 = f32[1,31,1]{2,1,0} sqrt(add.6351), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.6353 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.6352), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.6354 = f32[1,31,1]{2,1,0} broadcast(divide.6353), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.6355 = f32[1,31]{1,0} reshape(broadcast.6354), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.6356 = f32[1,31,2304]{2,1,0} broadcast(reshape.6355), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.6357 = f32[1,31,2304]{2,1,0} multiply(add.6342, broadcast.6356), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_267.268 = f32[2304]{0} parameter(267), metadata={op_name="state[1][265]"}
  add.6358 = f32[2304]{0} add(Arg_267.268, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6359 = f32[1,1,2304]{2,1,0} reshape(add.6358), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6360 = f32[1,1,2304]{2,1,0} broadcast(reshape.6359), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6361 = f32[1,2304]{1,0} reshape(broadcast.6360), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6362 = f32[1,31,2304]{2,1,0} broadcast(reshape.6361), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.6363 = f32[1,31,2304]{2,1,0} multiply(multiply.6357, broadcast.6362), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_270.271 = f32[4,2304,256]{2,1,0} parameter(270), metadata={op_name="state[1][268]"}
  dot.6404 = f32[1,31,4,256]{3,2,1,0} dot(multiply.6363, Arg_270.271), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.6405 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.6406 = f32[128]{0} divide(broadcast.321, power.6405), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.6407 = f32[31,128]{1,0} dot(constant.319, divide.6406), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.6408 = f32[31,1,128]{2,1,0} reshape(dot.6407), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6409 = f32[31,1,128]{2,1,0} reshape(dot.6407), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.6410 = f32[31,2,128]{2,1,0} concatenate(reshape.6408, reshape.6409), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6411 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.6410), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.6412 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.6411), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.6421 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.6412), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.6422 = f32[1,31,256]{2,1,0} reshape(broadcast.6421), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.6423 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.6422), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.6424 = f32[1,31,4,256]{3,2,1,0} multiply(dot.6404, broadcast.6423), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.6415 = f32[1,31,4,128]{3,2,1,0} slice(dot.6404), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.6416 = f32[1,31,4,128]{3,2,1,0} negate(slice.6415), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.6417 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.6416), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.6414 = f32[1,31,4,128]{3,2,1,0} slice(dot.6404), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.6418 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.6414), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.6419 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.6417, reshape.6418), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6420 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.6419), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.6413 = f32[1,31,1,256]{3,2,1,0} sine(reshape.6411), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.6425 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.6413), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.6426 = f32[1,31,256]{2,1,0} reshape(broadcast.6425), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.6427 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.6426), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.6428 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.6420, broadcast.6427), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.6429 = f32[1,31,4,256]{3,2,1,0} add(multiply.6424, multiply.6428), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.6430 = f32[1,31,4,128]{3,2,1,0} slice(add.6429), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.6432 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.6430), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.6431 = f32[1,31,4,128]{3,2,1,0} slice(add.6429), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.6433 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.6431), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.6434 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.6432, reshape.6433), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6437 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.6434), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_271.272 = f32[4,2304,256]{2,1,0} parameter(271), metadata={op_name="state[1][269]"}
  dot.6436 = f32[1,31,4,256]{3,2,1,0} dot(multiply.6363, Arg_271.272), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.6438 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.6436), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.6439 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.6437, reshape.6438), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6687 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.6439), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  broadcast.6364 = f32[31,1]{1,0} broadcast(constant.326), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.6365 = f32[31]{0} reshape(broadcast.6364), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.6366 = f32[31,31]{1,0} broadcast(reshape.6365), dimensions={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.6367 = f32[1,31]{1,0} broadcast(constant.325), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.6368 = f32[31]{0} reshape(broadcast.6367), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  broadcast.6369 = f32[31,31]{1,0} broadcast(reshape.6368), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  compare.6370 = pred[31,31]{1,0} compare(broadcast.6366, broadcast.6369), direction=GE, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/ge" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/transformer_layer_utils.py" source_line=47}
  reshape.6371 = pred[1,31,31]{2,1,0} reshape(compare.6370), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  convert.6511 = s32[1,31,31]{2,1,0} convert(reshape.6371), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  compare.6512 = pred[1,31,31]{2,1,0} compare(convert.6511, broadcast.306), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  reduce.6517 = pred[1,31]{1,0} reduce(compare.6512, constant.340), dimensions={2}, to_apply=region_172.6513, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/reduce_and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=231}
  reshape.6518 = pred[1,31,1,1]{3,2,1,0} reshape(reduce.6517), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=223}
  reshape.6435 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.6434), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  Arg_269.270 = f32[8,2304,256]{2,1,0} parameter(269), metadata={op_name="state[1][267]"}
  dot.6372 = f32[1,31,8,256]{3,2,1,0} dot(multiply.6363, Arg_269.270), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/query/btd,ndh->btnh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.6373 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.6374 = f32[128]{0} divide(broadcast.321, power.6373), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.6375 = f32[31,128]{1,0} dot(constant.319, divide.6374), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.6376 = f32[31,1,128]{2,1,0} reshape(dot.6375), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6377 = f32[31,1,128]{2,1,0} reshape(dot.6375), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.6378 = f32[31,2,128]{2,1,0} concatenate(reshape.6376, reshape.6377), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6379 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.6378), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.6380 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.6379), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.6389 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.6380), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.6390 = f32[1,31,256]{2,1,0} reshape(broadcast.6389), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.6391 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.6390), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.6392 = f32[1,31,8,256]{3,2,1,0} multiply(dot.6372, broadcast.6391), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.6383 = f32[1,31,8,128]{3,2,1,0} slice(dot.6372), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.6384 = f32[1,31,8,128]{3,2,1,0} negate(slice.6383), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.6385 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(negate.6384), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.6382 = f32[1,31,8,128]{3,2,1,0} slice(dot.6372), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.6386 = f32[1,31,8,1,128]{4,3,2,1,0} reshape(slice.6382), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.6387 = f32[1,31,8,2,128]{4,3,2,1,0} concatenate(reshape.6385, reshape.6386), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6388 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.6387), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.6381 = f32[1,31,1,256]{3,2,1,0} sine(reshape.6379), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.6393 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.6381), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.6394 = f32[1,31,256]{2,1,0} reshape(broadcast.6393), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.6395 = f32[1,31,8,256]{3,2,1,0} broadcast(reshape.6394), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.6396 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.6388, broadcast.6395), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.6397 = f32[1,31,8,256]{3,2,1,0} add(multiply.6392, multiply.6396), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/rotary_embedding_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.6398 = f32[1,31,8,128]{3,2,1,0} slice(add.6397), slice={[0:1], [0:31], [0:8], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.6400 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.6398), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.6399 = f32[1,31,8,128]{3,2,1,0} slice(add.6397), slice={[0:1], [0:31], [0:8], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.6401 = f32[1,31,8,128,1]{4,3,2,1,0} reshape(slice.6399), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.6402 = f32[1,31,8,128,2]{4,3,2,1,0} concatenate(reshape.6400, reshape.6401), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6403 = f32[1,31,8,256]{3,2,1,0} reshape(concatenate.6402), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  multiply.6440 = f32[1,31,8,256]{3,2,1,0} multiply(reshape.6403, broadcast.318), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=121}
  reshape.6441 = f32[1,31,4,2,256]{4,3,2,1,0} reshape(multiply.6440), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  dot.6442 = f32[1,4,31,31,2]{4,3,2,1,0} dot(reshape.6435, reshape.6441), lhs_batch_dims={0,2}, lhs_contracting_dims={3}, rhs_batch_dims={0,2}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/btkgh,bskh->bkgts/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.6443 = f32[1,4,2,31,31]{2,3,4,1,0} transpose(dot.6442), dimensions={0,1,4,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/btkgh,bskh->bkgts/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  divide.6444 = f32[1,4,2,31,31]{2,3,4,1,0} divide(transpose.6443, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1139}
  tanh.6445 = f32[1,4,2,31,31]{2,3,4,1,0} tanh(divide.6444), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1044}
  multiply.6446 = f32[1,4,2,31,31]{2,3,4,1,0} multiply(tanh.6445, broadcast.316), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=162}
  call.6460 = pred[31,31]{1,0} call(broadcast.314), to_apply=triu.6447
  call.6474 = pred[31,31]{1,0} call(broadcast.314), to_apply=tril.6461
  and.6475 = pred[31,31]{1,0} and(call.6460, call.6474), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=178}
  reshape.6476 = pred[1,31,31]{2,1,0} reshape(and.6475), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  and.6477 = pred[1,31,31]{2,1,0} and(reshape.6371, reshape.6476), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  reshape.6478 = pred[1,1,1,31,31]{4,3,2,1,0} reshape(and.6477), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_attention.py" source_line=148}
  convert.6479 = f32[1,1,1,31,31]{4,3,2,1,0} convert(reshape.6478), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  subtract.6480 = f32[1,1,1,31,31]{4,3,2,1,0} subtract(broadcast.312, convert.6479), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=55}
  multiply.6481 = f32[1,1,1,31,31]{4,3,2,1,0} multiply(subtract.6480, broadcast.310), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=54}
  broadcast.6482 = f32[1,1,1,31,31]{4,3,2,1,0} broadcast(multiply.6481), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reshape.6483 = f32[1,31,31]{2,1,0} reshape(broadcast.6482), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  broadcast.6484 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.6483), dimensions={0,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  add.6485 = f32[1,4,2,31,31]{2,3,4,1,0} add(multiply.6446, broadcast.6484), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/layers/activations/softmax.py" source_line=57}
  reduce.6490 = f32[1,4,2,31]{3,2,1,0} reduce(add.6485, constant.339), dimensions={4}, to_apply=region_170.6486, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/reduce_max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  maximum.6491 = f32[1,4,2,31]{3,2,1,0} maximum(reduce.6490, broadcast.308), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/max" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.6492 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(maximum.6491), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.6493 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.6492), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.6494 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.6493), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.6495 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.6494), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  subtract.6496 = f32[1,4,2,31,31]{2,3,4,1,0} subtract(add.6485, broadcast.6495), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  exponential.6497 = f32[1,4,2,31,31]{2,3,4,1,0} exponential(subtract.6496), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/exp" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reduce.6502 = f32[1,4,2,31]{3,2,1,0} reduce(exponential.6497, constant.342), dimensions={4}, to_apply=region_171.6498, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.6503 = f32[1,4,2,31,1]{4,3,2,1,0} reshape(reduce.6502), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.6504 = f32[1,4,2,31,1]{4,3,2,1,0} broadcast(reshape.6503), dimensions={0,1,2,3,4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  reshape.6505 = f32[1,4,2,31]{3,2,1,0} reshape(broadcast.6504), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  broadcast.6506 = f32[1,4,2,31,31]{4,3,2,1,0} broadcast(reshape.6505), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  divide.6507 = f32[1,4,2,31,31]{2,3,4,1,0} divide(exponential.6497, broadcast.6506), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/softmax_24/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=142}
  dot.6508 = f32[1,4,256,2,31]{4,3,2,1,0} dot(dot.6436, divide.6507), lhs_batch_dims={0,2}, lhs_contracting_dims={1}, rhs_batch_dims={0,1}, rhs_contracting_dims={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/bkgts,bskh->btkgh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  transpose.6509 = f32[1,31,4,2,256]{1,3,4,2,0} transpose(dot.6508), dimensions={0,4,1,3,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/bkgts,bskh->btkgh/transpose" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.6510 = f32[1,31,8,256]{3,2,1,0} reshape(transpose.6509), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  call.6527 = f32[1,31,8,256]{3,2,1,0} call(reshape.6518, broadcast.304, reshape.6510), to_apply=_where_0.6519
  Arg_272.273 = f32[8,256,2304]{2,1,0} parameter(272), metadata={op_name="state[1][270]"}
  dot.6528 = f32[1,31,2304]{2,1,0} dot(call.6527, Arg_272.273), lhs_contracting_dims={3,2}, rhs_contracting_dims={1,0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/attention/attention_output/btnh,nhd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.6529 = f32[1,31,2304]{2,1,0} multiply(dot.6528, dot.6528), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.6534 = f32[1,31]{1,0} reduce(multiply.6529, constant.342), dimensions={2}, to_apply=region_173.6530, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.6535 = f32[1,31,1]{2,1,0} reshape(reduce.6534), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.6536 = f32[1,31,1]{2,1,0} divide(reshape.6535, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.6537 = f32[1,31,1]{2,1,0} add(divide.6536, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.6538 = f32[1,31,1]{2,1,0} sqrt(add.6537), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.6539 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.6538), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.6540 = f32[1,31,1]{2,1,0} broadcast(divide.6539), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.6541 = f32[1,31]{1,0} reshape(broadcast.6540), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.6542 = f32[1,31,2304]{2,1,0} broadcast(reshape.6541), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.6543 = f32[1,31,2304]{2,1,0} multiply(dot.6528, broadcast.6542), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_268.269 = f32[2304]{0} parameter(268), metadata={op_name="state[1][266]"}
  add.6544 = f32[2304]{0} add(Arg_268.269, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6545 = f32[1,1,2304]{2,1,0} reshape(add.6544), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6546 = f32[1,1,2304]{2,1,0} broadcast(reshape.6545), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6547 = f32[1,2304]{1,0} reshape(broadcast.6546), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6548 = f32[1,31,2304]{2,1,0} broadcast(reshape.6547), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.6549 = f32[1,31,2304]{2,1,0} multiply(multiply.6543, broadcast.6548), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.6550 = f32[1,31,2304]{2,1,0} add(add.6342, multiply.6549), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=192}
  multiply.6551 = f32[1,31,2304]{2,1,0} multiply(add.6550, add.6550), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.6556 = f32[1,31]{1,0} reduce(multiply.6551, constant.342), dimensions={2}, to_apply=region_174.6552, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.6557 = f32[1,31,1]{2,1,0} reshape(reduce.6556), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.6558 = f32[1,31,1]{2,1,0} divide(reshape.6557, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.6559 = f32[1,31,1]{2,1,0} add(divide.6558, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.6560 = f32[1,31,1]{2,1,0} sqrt(add.6559), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.6561 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.6560), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.6562 = f32[1,31,1]{2,1,0} broadcast(divide.6561), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.6563 = f32[1,31]{1,0} reshape(broadcast.6562), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.6564 = f32[1,31,2304]{2,1,0} broadcast(reshape.6563), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.6565 = f32[1,31,2304]{2,1,0} multiply(add.6550, broadcast.6564), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_273.274 = f32[2304]{0} parameter(273), metadata={op_name="state[1][271]"}
  add.6566 = f32[2304]{0} add(Arg_273.274, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6567 = f32[1,1,2304]{2,1,0} reshape(add.6566), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6568 = f32[1,1,2304]{2,1,0} broadcast(reshape.6567), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6569 = f32[1,2304]{1,0} reshape(broadcast.6568), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6570 = f32[1,31,2304]{2,1,0} broadcast(reshape.6569), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.6571 = f32[1,31,2304]{2,1,0} multiply(multiply.6565, broadcast.6570), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/pre_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_275.276 = f32[2304,9216]{1,0} parameter(275), metadata={op_name="state[1][273]"}
  dot.6572 = f32[1,31,9216]{2,1,0} dot(multiply.6571, Arg_275.276), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/ffw_gating/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.6574 = f32[1,31,9216]{2,1,0} multiply(dot.6572, dot.6572), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.6575 = f32[1,31,9216]{2,1,0} multiply(multiply.6574, dot.6572), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.6576 = f32[1,31,9216]{2,1,0} multiply(multiply.6575, broadcast.302), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.6577 = f32[1,31,9216]{2,1,0} add(dot.6572, multiply.6576), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.6578 = f32[1,31,9216]{2,1,0} multiply(add.6577, broadcast.300), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  tanh.6579 = f32[1,31,9216]{2,1,0} tanh(multiply.6578), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/tanh" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  add.6580 = f32[1,31,9216]{2,1,0} add(tanh.6579, broadcast.298), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.6581 = f32[1,31,9216]{2,1,0} multiply(add.6580, broadcast.296), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  multiply.6582 = f32[1,31,9216]{2,1,0} multiply(dot.6572, multiply.6581), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/nn.py" source_line=112}
  Arg_276.277 = f32[2304,9216]{1,0} parameter(276), metadata={op_name="state[1][274]"}
  dot.6573 = f32[1,31,9216]{2,1,0} dot(multiply.6571, Arg_276.277), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/ffw_gating_2/btd,df->btf/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.6583 = f32[1,31,9216]{2,1,0} multiply(multiply.6582, dot.6573), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=197}
  Arg_277.278 = f32[9216,2304]{1,0} parameter(277), metadata={op_name="state[1][275]"}
  dot.6584 = f32[1,31,2304]{2,1,0} dot(multiply.6583, Arg_277.278), lhs_contracting_dims={2}, rhs_contracting_dims={0}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/ffw_linear/btf,fd->btd/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  multiply.6585 = f32[1,31,2304]{2,1,0} multiply(dot.6584, dot.6584), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.6590 = f32[1,31]{1,0} reduce(multiply.6585, constant.342), dimensions={2}, to_apply=region_175.6586, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.6591 = f32[1,31,1]{2,1,0} reshape(reduce.6590), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.6592 = f32[1,31,1]{2,1,0} divide(reshape.6591, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.6593 = f32[1,31,1]{2,1,0} add(divide.6592, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.6594 = f32[1,31,1]{2,1,0} sqrt(add.6593), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.6595 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.6594), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.6596 = f32[1,31,1]{2,1,0} broadcast(divide.6595), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.6597 = f32[1,31]{1,0} reshape(broadcast.6596), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.6598 = f32[1,31,2304]{2,1,0} broadcast(reshape.6597), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.6599 = f32[1,31,2304]{2,1,0} multiply(dot.6584, broadcast.6598), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_274.275 = f32[2304]{0} parameter(274), metadata={op_name="state[1][272]"}
  add.6600 = f32[2304]{0} add(Arg_274.275, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6601 = f32[1,1,2304]{2,1,0} reshape(add.6600), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6602 = f32[1,1,2304]{2,1,0} broadcast(reshape.6601), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6603 = f32[1,2304]{1,0} reshape(broadcast.6602), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6604 = f32[1,31,2304]{2,1,0} broadcast(reshape.6603), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.6605 = f32[1,31,2304]{2,1,0} multiply(multiply.6599, broadcast.6604), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/post_ffw_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  add.6606 = f32[1,31,2304]{2,1,0} add(multiply.6605, add.6550), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_24/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_decoder_block.py" source_line=203}
  multiply.6607 = f32[1,31,2304]{2,1,0} multiply(add.6606, add.6606), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/square" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1168}
  reduce.6612 = f32[1,31]{1,0} reduce(multiply.6607, constant.342), dimensions={2}, to_apply=region_176.6608, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  reshape.6613 = f32[1,31,1]{2,1,0} reshape(reduce.6612), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  divide.6614 = f32[1,31,1]{2,1,0} divide(reshape.6613, broadcast.334), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=201}
  add.6615 = f32[1,31,1]{2,1,0} add(divide.6614, broadcast.332), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  sqrt.6616 = f32[1,31,1]{2,1,0} sqrt(add.6615), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/sqrt" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1176}
  divide.6617 = f32[1,31,1]{2,1,0} divide(broadcast.330, sqrt.6616), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/integer_pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=921}
  broadcast.6618 = f32[1,31,1]{2,1,0} broadcast(divide.6617), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  reshape.6619 = f32[1,31]{1,0} reshape(broadcast.6618), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  broadcast.6620 = f32[1,31,2304]{2,1,0} broadcast(reshape.6619), dimensions={0,1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  multiply.6621 = f32[1,31,2304]{2,1,0} multiply(add.6606, broadcast.6620), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=24}
  Arg_278.279 = f32[2304]{0} parameter(278), metadata={op_name="state[1][276]"}
  add.6622 = f32[2304]{0} add(Arg_278.279, broadcast.328), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6623 = f32[1,1,2304]{2,1,0} reshape(add.6622), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6624 = f32[1,1,2304]{2,1,0} broadcast(reshape.6623), dimensions={0,1,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  reshape.6625 = f32[1,2304]{1,0} reshape(broadcast.6624), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  broadcast.6626 = f32[1,31,2304]{2,1,0} broadcast(reshape.6625), dimensions={0,2}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  multiply.6627 = f32[1,31,2304]{2,1,0} multiply(multiply.6621, broadcast.6626), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/pre_attention_norm/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/rms_normalization.py" source_line=25}
  Arg_281.282 = f32[4,2304,256]{2,1,0} parameter(281), metadata={op_name="state[1][279]"}
  dot.6628 = f32[1,31,4,256]{3,2,1,0} dot(multiply.6627, Arg_281.282), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/key/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  power.6629 = f32[128]{0} power(broadcast.323, constant.324), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/pow" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  divide.6630 = f32[128]{0} divide(broadcast.321, power.6629), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/div" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=139}
  dot.6631 = f32[31,128]{1,0} dot(constant.319, divide.6630), lhs_contracting_dims={}, rhs_contracting_dims={}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/i,j->ij/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.6632 = f32[31,1,128]{2,1,0} reshape(dot.6631), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6633 = f32[31,1,128]{2,1,0} reshape(dot.6631), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.6634 = f32[31,2,128]{2,1,0} concatenate(reshape.6632, reshape.6633), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6635 = f32[1,31,1,256]{3,2,1,0} reshape(concatenate.6634), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=603}
  cosine.6636 = f32[1,31,1,256]{3,2,1,0} cosine(reshape.6635), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/cos" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=482}
  broadcast.6645 = f32[1,31,1,256]{3,2,1,0} broadcast(cosine.6636), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.6646 = f32[1,31,256]{2,1,0} reshape(broadcast.6645), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.6647 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.6646), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.6648 = f32[1,31,4,256]{3,2,1,0} multiply(dot.6628, broadcast.6647), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.6639 = f32[1,31,4,128]{3,2,1,0} slice(dot.6628), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  negate.6640 = f32[1,31,4,128]{3,2,1,0} negate(slice.6639), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/neg" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=95}
  reshape.6641 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(negate.6640), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.6638 = f32[1,31,4,128]{3,2,1,0} slice(dot.6628), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.6642 = f32[1,31,4,1,128]{4,3,2,1,0} reshape(slice.6638), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.6643 = f32[1,31,4,2,128]{4,3,2,1,0} concatenate(reshape.6641, reshape.6642), dimensions={3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6644 = f32[1,31,4,256]{3,2,1,0} reshape(concatenate.6643), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/reshape" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=940}
  sine.6637 = f32[1,31,1,256]{3,2,1,0} sine(reshape.6635), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/sin" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=972}
  broadcast.6649 = f32[1,31,1,256]{3,2,1,0} broadcast(sine.6637), dimensions={0,1,2,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  reshape.6650 = f32[1,31,256]{2,1,0} reshape(broadcast.6649), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  broadcast.6651 = f32[1,31,4,256]{3,2,1,0} broadcast(reshape.6650), dimensions={0,1,3}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  multiply.6652 = f32[1,31,4,256]{3,2,1,0} multiply(reshape.6644, broadcast.6651), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/mul" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  add.6653 = f32[1,31,4,256]{3,2,1,0} add(multiply.6648, multiply.6652), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/rotary_embedding_25/add" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/layers/modeling/rotary_embedding.py" source_line=97}
  slice.6654 = f32[1,31,4,128]{3,2,1,0} slice(add.6653), slice={[0:1], [0:31], [0:4], [0:128]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.6656 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.6654), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  slice.6655 = f32[1,31,4,128]{3,2,1,0} slice(add.6653), slice={[0:1], [0:31], [0:4], [128:256]}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/split" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=996}
  reshape.6657 = f32[1,31,4,128,1]{4,3,2,1,0} reshape(slice.6655), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.6658 = f32[1,31,4,128,2]{4,3,2,1,0} concatenate(reshape.6656, reshape.6657), dimensions={4}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6660 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(concatenate.6658), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_282.283 = f32[4,2304,256]{2,1,0} parameter(282), metadata={op_name="state[1][280]"}
  dot.6659 = f32[1,31,4,256]{3,2,1,0} dot(multiply.6627, Arg_282.283), lhs_contracting_dims={2}, rhs_contracting_dims={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/value/bsd,kdh->bskh/dot_general" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=83}
  reshape.6661 = f32[1,1,31,4,256]{4,3,2,1,0} reshape(dot.6659), metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.6662 = f32[1,2,31,4,256]{4,3,2,1,0} concatenate(reshape.6660, reshape.6661), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/decoder_block_25/attention/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  reshape.6688 = f32[1,1,2,31,4,256]{5,4,3,2,1,0} reshape(concatenate.6662), metadata={op_name="jit(compiled_generate_function)/jit(main)/broadcast_in_dim" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  concatenate.6689 = f32[1,26,2,31,4,256]{5,4,3,2,1,0} concatenate(reshape.6663, reshape.6664, reshape.6665, reshape.6666, reshape.6667, /*index=5*/reshape.6668, reshape.6669, reshape.6670, reshape.6671, reshape.6672, /*index=10*/reshape.6673, reshape.6674, reshape.6675, reshape.6676, reshape.6677, /*index=15*/reshape.6678, reshape.6679, reshape.6680, reshape.6681, reshape.6682, /*index=20*/reshape.6683, reshape.6684, reshape.6685, reshape.6686, reshape.6687, /*index=25*/reshape.6688), dimensions={1}, metadata={op_name="jit(compiled_generate_function)/jit(main)/concatenate" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1000}
  Arg_0.1 = pred[1,31]{1,0} parameter(0), metadata={op_name="inputs[\'padding_mask\']"}
  convert.6690 = s32[1,31]{1,0} convert(Arg_0.1), metadata={op_name="jit(compiled_generate_function)/jit(main)/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  constant.341 = s32[] constant(0)
  reduce.6695 = s32[1]{0} reduce(convert.6690, constant.341), dimensions={1}, to_apply=region_177.6691, metadata={op_name="jit(compiled_generate_function)/jit(main)/reduce_sum" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=1237}
  constant.338 = s32[] constant(2147483647)
  reduce.6700 = s32[] reduce(reduce.6695, constant.338), dimensions={0}, to_apply=region_178.6696, metadata={op_name="jit(compiled_generate_function)/jit(main)/reduce_min" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=816}
  constant.337 = s32[] constant(31)
  subtract.6701 = s32[] subtract(constant.337, reduce.6700), metadata={op_name="jit(compiled_generate_function)/jit(main)/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/samplers/sampler.py" source_line=123}
  Arg_280.281 = f32[8,2304,256]{2,1,0} parameter(280), metadata={op_name="state[1][278]"}
  Arg_283.284 = f32[8,256,2304]{2,1,0} parameter(283), metadata={op_name="state[1][281]"}
  Arg_279.280 = f32[2304]{0} parameter(279), metadata={op_name="state[1][277]"}
  Arg_284.285 = f32[2304]{0} parameter(284), metadata={op_name="state[1][282]"}
  Arg_286.287 = f32[2304,9216]{1,0} parameter(286), metadata={op_name="state[1][284]"}
  Arg_287.288 = f32[2304,9216]{1,0} parameter(287), metadata={op_name="state[1][285]"}
  Arg_288.289 = f32[9216,2304]{1,0} parameter(288), metadata={op_name="state[1][286]"}
  Arg_285.286 = f32[2304]{0} parameter(285), metadata={op_name="state[1][283]"}
  Arg_289.290 = f32[2304]{0} parameter(289), metadata={op_name="state[1][287]"}
  tuple.6702 = (s32[1,31]{1,0}, f32[1,26,2,31,4,256]{5,4,3,2,1,0}, s32[], s32[], pred[1,31]{1,0}, /*index=5*/s32[], f32[256000,2304]{1,0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=10*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=15*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=20*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=25*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=30*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=35*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=40*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=45*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=50*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=55*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=60*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=65*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=70*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=75*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=80*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=85*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=90*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=95*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=100*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=105*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=110*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=115*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=120*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=125*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=130*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=135*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=140*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=145*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=150*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=155*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=160*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=165*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=170*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=175*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=180*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=185*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=190*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=195*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=200*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=205*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=210*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=215*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=220*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=225*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=230*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=235*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=240*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=245*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=250*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=255*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=260*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=265*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=270*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=275*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=280*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=285*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=290*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}) tuple(Arg_1.2, concatenate.6689, reduce.6700, constant.341, Arg_0.1, /*index=5*/subtract.6701, Arg_2.3, Arg_3.4, Arg_5.6, Arg_6.7, /*index=10*/Arg_7.8, Arg_8.9, Arg_4.5, Arg_9.10, Arg_11.12, /*index=15*/Arg_12.13, Arg_13.14, Arg_10.11, Arg_14.15, Arg_16.17, /*index=20*/Arg_17.18, Arg_18.19, Arg_19.20, Arg_15.16, Arg_20.21, /*index=25*/Arg_22.23, Arg_23.24, Arg_24.25, Arg_21.22, Arg_25.26, /*index=30*/Arg_27.28, Arg_28.29, Arg_29.30, Arg_30.31, Arg_26.27, /*index=35*/Arg_31.32, Arg_33.34, Arg_34.35, Arg_35.36, Arg_32.33, /*index=40*/Arg_36.37, Arg_38.39, Arg_39.40, Arg_40.41, Arg_41.42, /*index=45*/Arg_37.38, Arg_42.43, Arg_44.45, Arg_45.46, Arg_46.47, /*index=50*/Arg_43.44, Arg_47.48, Arg_49.50, Arg_50.51, Arg_51.52, /*index=55*/Arg_52.53, Arg_48.49, Arg_53.54, Arg_55.56, Arg_56.57, /*index=60*/Arg_57.58, Arg_54.55, Arg_58.59, Arg_60.61, Arg_61.62, /*index=65*/Arg_62.63, Arg_63.64, Arg_59.60, Arg_64.65, Arg_66.67, /*index=70*/Arg_67.68, Arg_68.69, Arg_65.66, Arg_69.70, Arg_71.72, /*index=75*/Arg_72.73, Arg_73.74, Arg_74.75, Arg_70.71, Arg_75.76, /*index=80*/Arg_77.78, Arg_78.79, Arg_79.80, Arg_76.77, Arg_80.81, /*index=85*/Arg_82.83, Arg_83.84, Arg_84.85, Arg_85.86, Arg_81.82, /*index=90*/Arg_86.87, Arg_88.89, Arg_89.90, Arg_90.91, Arg_87.88, /*index=95*/Arg_91.92, Arg_93.94, Arg_94.95, Arg_95.96, Arg_96.97, /*index=100*/Arg_92.93, Arg_97.98, Arg_99.100, Arg_100.101, Arg_101.102, /*index=105*/Arg_98.99, Arg_102.103, Arg_104.105, Arg_105.106, Arg_106.107, /*index=110*/Arg_107.108, Arg_103.104, Arg_108.109, Arg_110.111, Arg_111.112, /*index=115*/Arg_112.113, Arg_109.110, Arg_113.114, Arg_115.116, Arg_116.117, /*index=120*/Arg_117.118, Arg_118.119, Arg_114.115, Arg_119.120, Arg_121.122, /*index=125*/Arg_122.123, Arg_123.124, Arg_120.121, Arg_124.125, Arg_126.127, /*index=130*/Arg_127.128, Arg_128.129, Arg_129.130, Arg_125.126, Arg_130.131, /*index=135*/Arg_132.133, Arg_133.134, Arg_134.135, Arg_131.132, Arg_135.136, /*index=140*/Arg_137.138, Arg_138.139, Arg_139.140, Arg_140.141, Arg_136.137, /*index=145*/Arg_141.142, Arg_143.144, Arg_144.145, Arg_145.146, Arg_142.143, /*index=150*/Arg_146.147, Arg_148.149, Arg_149.150, Arg_150.151, Arg_151.152, /*index=155*/Arg_147.148, Arg_152.153, Arg_154.155, Arg_155.156, Arg_156.157, /*index=160*/Arg_153.154, Arg_157.158, Arg_159.160, Arg_160.161, Arg_161.162, /*index=165*/Arg_162.163, Arg_158.159, Arg_163.164, Arg_165.166, Arg_166.167, /*index=170*/Arg_167.168, Arg_164.165, Arg_168.169, Arg_170.171, Arg_171.172, /*index=175*/Arg_172.173, Arg_173.174, Arg_169.170, Arg_174.175, Arg_176.177, /*index=180*/Arg_177.178, Arg_178.179, Arg_175.176, Arg_179.180, Arg_181.182, /*index=185*/Arg_182.183, Arg_183.184, Arg_184.185, Arg_180.181, Arg_185.186, /*index=190*/Arg_187.188, Arg_188.189, Arg_189.190, Arg_186.187, Arg_190.191, /*index=195*/Arg_192.193, Arg_193.194, Arg_194.195, Arg_195.196, Arg_191.192, /*index=200*/Arg_196.197, Arg_198.199, Arg_199.200, Arg_200.201, Arg_197.198, /*index=205*/Arg_201.202, Arg_203.204, Arg_204.205, Arg_205.206, Arg_206.207, /*index=210*/Arg_202.203, Arg_207.208, Arg_209.210, Arg_210.211, Arg_211.212, /*index=215*/Arg_208.209, Arg_212.213, Arg_214.215, Arg_215.216, Arg_216.217, /*index=220*/Arg_217.218, Arg_213.214, Arg_218.219, Arg_220.221, Arg_221.222, /*index=225*/Arg_222.223, Arg_219.220, Arg_223.224, Arg_225.226, Arg_226.227, /*index=230*/Arg_227.228, Arg_228.229, Arg_224.225, Arg_229.230, Arg_231.232, /*index=235*/Arg_232.233, Arg_233.234, Arg_230.231, Arg_234.235, Arg_236.237, /*index=240*/Arg_237.238, Arg_238.239, Arg_239.240, Arg_235.236, Arg_240.241, /*index=245*/Arg_242.243, Arg_243.244, Arg_244.245, Arg_241.242, Arg_245.246, /*index=250*/Arg_247.248, Arg_248.249, Arg_249.250, Arg_250.251, Arg_246.247, /*index=255*/Arg_251.252, Arg_253.254, Arg_254.255, Arg_255.256, Arg_252.253, /*index=260*/Arg_256.257, Arg_258.259, Arg_259.260, Arg_260.261, Arg_261.262, /*index=265*/Arg_257.258, Arg_262.263, Arg_264.265, Arg_265.266, Arg_266.267, /*index=270*/Arg_263.264, Arg_267.268, Arg_269.270, Arg_270.271, Arg_271.272, /*index=275*/Arg_272.273, Arg_268.269, Arg_273.274, Arg_275.276, Arg_276.277, /*index=280*/Arg_277.278, Arg_274.275, Arg_278.279, Arg_280.281, Arg_281.282, /*index=285*/Arg_282.283, Arg_283.284, Arg_279.280, Arg_284.285, Arg_286.287, /*index=290*/Arg_287.288, Arg_288.289, Arg_285.286, Arg_289.290), metadata={op_name="jit(compiled_generate_function)/jit(main)/while" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=333}
  while.14219 = (s32[1,31]{1,0}, f32[1,26,2,31,4,256]{5,4,3,2,1,0}, s32[], s32[], pred[1,31]{1,0}, /*index=5*/s32[], f32[256000,2304]{1,0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=10*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=15*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=20*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=25*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=30*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=35*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=40*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=45*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=50*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=55*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=60*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=65*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=70*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=75*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=80*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=85*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=90*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=95*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=100*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=105*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=110*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=115*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=120*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=125*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=130*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=135*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=140*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=145*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=150*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=155*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=160*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=165*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=170*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=175*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=180*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=185*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=190*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=195*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=200*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=205*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=210*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=215*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=220*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=225*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=230*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=235*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, /*index=240*/f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, /*index=245*/f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, /*index=250*/f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, /*index=255*/f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, /*index=260*/f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, /*index=265*/f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, /*index=270*/f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=275*/f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, f32[2304,9216]{1,0}, /*index=280*/f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}, f32[8,2304,256]{2,1,0}, f32[4,2304,256]{2,1,0}, /*index=285*/f32[4,2304,256]{2,1,0}, f32[8,256,2304]{2,1,0}, f32[2304]{0}, f32[2304]{0}, f32[2304,9216]{1,0}, /*index=290*/f32[2304,9216]{1,0}, f32[9216,2304]{1,0}, f32[2304]{0}, f32[2304]{0}) while(tuple.6702), condition=region_367.13911, body=region_179.8048, metadata={op_name="jit(compiled_generate_function)/jit(main)/while" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=333}
  get-tuple-element.14221 = f32[1,26,2,31,4,256]{5,4,3,2,1,0} get-tuple-element(while.14219), index=1, metadata={op_name="jit(compiled_generate_function)/jit(main)/while" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=333}
  get-tuple-element.14222 = s32[] get-tuple-element(while.14219), index=2, metadata={op_name="jit(compiled_generate_function)/jit(main)/while" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=333}
  get-tuple-element.14223 = s32[] get-tuple-element(while.14219), index=3, metadata={op_name="jit(compiled_generate_function)/jit(main)/while" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=333}
  get-tuple-element.14220 = s32[1,31]{1,0} get-tuple-element(while.14219), index=0, metadata={op_name="jit(compiled_generate_function)/jit(main)/while" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=333}
  constant.293 = s32[] constant(1)
  broadcast.294 = s32[1,31]{1,0} broadcast(constant.293), dimensions={}
  compare.14225 = pred[1,31]{1,0} compare(get-tuple-element.14220, broadcast.294), direction=EQ, metadata={op_name="jit(compiled_generate_function)/jit(main)/eq" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=569}
  not.14224 = pred[1,31]{1,0} not(Arg_0.1), metadata={op_name="jit(compiled_generate_function)/jit(main)/not" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=765}
  and.14226 = pred[1,31]{1,0} and(compare.14225, not.14224), metadata={op_name="jit(compiled_generate_function)/jit(main)/and" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=760}
  convert.14227 = s32[1,31]{1,0} convert(and.14226), metadata={op_name="jit(compiled_generate_function)/jit(main)/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  call.14239 = s32[1,31]{1,0} call(convert.14227), to_apply=cumsum.14236
  subtract.14240 = s32[1,31]{1,0} subtract(call.14239, convert.14227), metadata={op_name="jit(compiled_generate_function)/jit(main)/sub" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras_hub/src/models/gemma/gemma_causal_lm.py" source_line=294}
  constant.291 = s32[] constant(0)
  broadcast.292 = s32[1,31]{1,0} broadcast(constant.291), dimensions={}
  compare.14241 = pred[1,31]{1,0} compare(subtract.14240, broadcast.292), direction=NE, metadata={op_name="jit(compiled_generate_function)/jit(main)/convert_element_type" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/core.py" source_line=77}
  not.14242 = pred[1,31]{1,0} not(compare.14241), metadata={op_name="jit(compiled_generate_function)/jit(main)/not" source_file="/home/penporn/venv/gemma2-keras/lib/python3.10/site-packages/keras/src/backend/jax/numpy.py" source_line=765}
  ROOT tuple.14243 = (pred[1,31]{1,0}, s32[1,31]{1,0}) tuple(not.14242, get-tuple-element.14220)
} // main.14244

